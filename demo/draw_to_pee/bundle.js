(()=>{var sy=Object.create;var Ic=Object.defineProperty,iy=Object.defineProperties,qg=Object.getOwnPropertyDescriptor,ry=Object.getOwnPropertyDescriptors,ny=Object.getOwnPropertyNames,md=Object.getOwnPropertySymbols,oy=Object.getPrototypeOf,Rm=Object.prototype.hasOwnProperty,zg=Object.prototype.propertyIsEnumerable;var Hg=(s,t,e)=>t in s?Ic(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,li=(s,t)=>{for(var e in t||(t={}))Rm.call(t,e)&&Hg(s,e,t[e]);if(md)for(var e of md(t))zg.call(t,e)&&Hg(s,e,t[e]);return s},pd=(s,t)=>iy(s,ry(t));var Kg=(s,t)=>{var e={};for(var i in s)Rm.call(s,i)&&t.indexOf(i)<0&&(e[i]=s[i]);if(s!=null&&md)for(var i of md(s))t.indexOf(i)<0&&zg.call(s,i)&&(e[i]=s[i]);return e};var ds=(s,t)=>()=>(t||s((t={exports:{}}).exports,t),t.exports),Tc=(s,t)=>{for(var e in t)Ic(s,e,{get:t[e],enumerable:!0})},ay=(s,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of ny(t))!Rm.call(s,r)&&r!==e&&Ic(s,r,{get:()=>t[r],enumerable:!(i=qg(t,r))||i.enumerable});return s};var Io=(s,t,e)=>(e=s!=null?sy(oy(s)):{},ay(t||!s||!s.__esModule?Ic(e,"default",{value:s,enumerable:!0}):e,s));var gd=(s,t,e,i)=>{for(var r=i>1?void 0:i?qg(t,e):t,n=s.length-1,l;n>=0;n--)(l=s[n])&&(r=(i?l(t,e,r):l(r))||r);return i&&r&&Ic(t,e,r),r};var Zg=(s,t,e)=>{if(!t.has(s))throw TypeError("Cannot "+e)};var Ye=(s,t,e)=>(Zg(s,t,"read from private field"),e?e.call(s):t.get(s)),Nl=(s,t,e)=>{if(t.has(s))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(s):t.set(s,e)},Sc=(s,t,e,i)=>(Zg(s,t,"write to private field"),i?i.call(s,e):t.set(s,e),e);var $=(s,t,e)=>new Promise((i,r)=>{var n=o=>{try{a(e.next(o))}catch(h){r(h)}},l=o=>{try{a(e.throw(o))}catch(h){r(h)}},a=o=>o.done?i(o.value):Promise.resolve(o.value).then(n,l);a((e=e.apply(s,t)).next())});var wd=ds((XT,vd)=>{(function s(t,e,i){var r=function(o){return Object.prototype.toString.call(o)==="[object Array]"},n=function(o){return o!==i};function l(o,h){if(!(this instanceof l))return new l(o,h);r(o)?(h=o[1],o=o[0]):typeof o=="object"&&o&&(h=o.y,o=o.x),this.x=l.clean(o||0),this.y=l.clean(h||0)}l.prototype={change:function(o){if(typeof o=="function")this.observers?this.observers.push(o):this.observers=[o];else if(this.observers&&this.observers.length)for(var h=this.observers.length-1;h>=0;h--)this.observers[h](this,o);return this},ignore:function(o){if(this.observers)if(!o)this.observers=[];else for(var h=this.observers,c=h.length;c--;)h[c]===o&&h.splice(c,1);return this},set:function(o,h,c){if(typeof o!="number"&&(c=h,h=o.y,o=o.x),this.x===o&&this.y===h)return this;var u=null;if(c!==!1&&this.observers&&this.observers.length&&(u=this.clone()),this.x=l.clean(o),this.y=l.clean(h),c!==!1)return this.change(u)},zero:function(){return this.set(0,0)},clone:function(){return new this.constructor(this.x,this.y)},negate:function(o){return o?new this.constructor(-this.x,-this.y):this.set(-this.x,-this.y)},add:function(o,h,c){return typeof o!="number"&&(c=h,r(o)?(h=o[1],o=o[0]):(h=o.y,o=o.x)),o+=this.x,h+=this.y,c?new this.constructor(o,h):this.set(o,h)},subtract:function(o,h,c){return typeof o!="number"&&(c=h,r(o)?(h=o[1],o=o[0]):(h=o.y,o=o.x)),o=this.x-o,h=this.y-h,c?new this.constructor(o,h):this.set(o,h)},multiply:function(o,h,c){return typeof o!="number"?(c=h,r(o)?(h=o[1],o=o[0]):(h=o.y,o=o.x)):typeof h!="number"&&(c=h,h=o),o*=this.x,h*=this.y,c?new this.constructor(o,h):this.set(o,h)},rotate:function(o,h,c){var u=this.x,d=this.y,f=Math.cos(o),m=Math.sin(o),p,g;return h=h?-1:1,p=f*u-h*m*d,g=h*m*u+f*d,c?new this.constructor(p,g):this.set(p,g)},length:function(){var o=this.x,h=this.y;return Math.sqrt(o*o+h*h)},lengthSquared:function(){var o=this.x,h=this.y;return o*o+h*h},distance:function(o){var h=this.x-o.x,c=this.y-o.y;return Math.sqrt(h*h+c*c)},nearest:function(o){for(var h=Number.MAX_VALUE,c=null,u,d=o.length-1;d>=0;d--)u=this.distance(o[d]),u<=h&&(h=u,c=o[d]);return c},normalize:function(o){var h=this.length(),c=h<Number.MIN_VALUE?0:1/h;return o?new this.constructor(this.x*c,this.y*c):this.set(this.x*c,this.y*c)},equal:function(o,h){return typeof o!="number"&&(r(o)?(h=o[1],o=o[0]):(h=o.y,o=o.x)),l.clean(o)===this.x&&l.clean(h)===this.y},abs:function(o){var h=Math.abs(this.x),c=Math.abs(this.y);return o?new this.constructor(h,c):this.set(h,c)},min:function(o,h){var c=this.x,u=this.y,d=o.x,f=o.y,m=c<d?c:d,p=u<f?u:f;return h?new this.constructor(m,p):this.set(m,p)},max:function(o,h){var c=this.x,u=this.y,d=o.x,f=o.y,m=c>d?c:d,p=u>f?u:f;return h?new this.constructor(m,p):this.set(m,p)},clamp:function(o,h,c){var u=this.min(h,!0).max(o);return c?u:this.set(u.x,u.y)},lerp:function(o,h,c){return this.add(o.subtract(this,!0).multiply(h),c)},skew:function(o){return o?new this.constructor(-this.y,this.x):this.set(-this.y,this.x)},dot:function(o){return l.clean(this.x*o.x+o.y*this.y)},perpDot:function(o){return l.clean(this.x*o.y-this.y*o.x)},angleTo:function(o){return Math.atan2(this.perpDot(o),this.dot(o))},divide:function(o,h,c){if(typeof o!="number"?(c=h,r(o)?(h=o[1],o=o[0]):(h=o.y,o=o.x)):typeof h!="number"&&(c=h,h=o),o===0||h===0)throw new Error("division by zero");if(isNaN(o)||isNaN(h))throw new Error("NaN detected");return c?new this.constructor(this.x/o,this.y/h):this.set(this.x/o,this.y/h)},isPointOnLine:function(o,h){return(o.y-this.y)*(o.x-h.x)===(o.y-h.y)*(o.x-this.x)},toArray:function(){return[this.x,this.y]},fromArray:function(o){return this.set(o[0],o[1])},toJSON:function(){return{x:this.x,y:this.y}},toString:function(){return"("+this.x+", "+this.y+")"},constructor:l},l.fromArray=function(o,h){return new(h||l)(o[0],o[1])},l.precision=e||8;var a=Math.pow(10,l.precision);return l.clean=t||function(o){if(isNaN(o))throw new Error("NaN detected");if(!isFinite(o))throw new Error("Infinity detected");return Math.round(o)===o?o:Math.round(o*a)/a},l.inject=s,t||(l.fast=s(function(o){return o}),typeof vd!="undefined"&&typeof vd.exports=="object"?vd.exports=l:window.Vec2=window.Vec2||l),l})()});var hp=ds((fR,Mb)=>{"use strict";var lp=class{constructor(){this._data=[]}get root(){return this._data[0]}get size(){return this._data.length}_compare(t,e){let[i,r]=[this._data[t],this._data[e]];return i.key>r.key?1:i.key<r.key?-1:0}_swap(t,e){[this._data[t],this._data[e]]=[this._data[e],this._data[t]]}children(t){let e={},i=this.childIndices(t);return Object.keys(i).forEach(r=>{e[r]=this.node(i[r])}),e}childIndices(t){let e={},i=this.leftIndex(t),r=this.rightIndex(t);return i<this.size&&(e.left=i),r<this.size&&(e.right=r),e}clear(){return this._data=[],this}degree(t){return Object.keys(this.children(t)).length}fullNodes(){let t=[];return this._data.forEach((e,i)=>{this.isFullNode(i)&&t.push(e)}),t}height(){return Math.ceil(Math.log2(this.size+1))-1}includes(t){for(let e of this._data)if(e.key===t)return!0;return!1}indexOf(t){let e=0;for(let i of this._data){if(i.key===t)return e;e+=1}return-1}internalNodes(){let t=[];return this._data.forEach((e,i)=>{this.isInternalNode(i)&&t.push(e)}),t}isEmpty(){return this._data.length===0}isFullNode(t){return this.left(t)!==void 0&&this.right(t)!==void 0}isInternalNode(t){return this.left(t)!==void 0||this.right(t)!==void 0}isLeafNode(t){return!this.left(t)&&!this.right(t)}isPartialNode(t){return this.degree(t)===1}keys(){let t=[];return this._data.forEach(e=>t.push(e.key)),t}leafNodes(){let t=[];return this._data.forEach((e,i)=>{this.isLeafNode(i)&&t.push(e)}),t}left(t){return this._data[this.leftIndex(t)]}leftIndex(t){return 2*t+1}levelOrder(t){return this._data.forEach(e=>t(e)),this}maxChild(t){return this._data[this.maxChildIndex(t)]}maxChildIndex(t){let{left:e,right:i}=this.childIndices(t);return e?i&&this._compare(i,e)>0?i:e:-1}minChild(t){return this._data[this.minChildIndex(t)]}minChildIndex(t){let{left:e,right:i}=this.childIndices(t);return e?i&&this._compare(e,i)>0?i:e:-1}node(t){return this._data[t]}parent(t){return this._data[this.parentIndex(t)]}parentIndex(t){return Math.floor((t-1)/2)}partialNodes(){let t=[];return this._data.forEach((e,i)=>{this.isPartialNode(i)&&t.push(e)}),t}right(t){return this._data[this.rightIndex(t)]}rightIndex(t){return 2*t+2}search(t){for(let e of this._data)if(e.key===t)return e}toArray(){let t=[];return this._data.forEach(e=>t.push(e)),t}toPairs(){let t=[];return this._data.forEach(e=>t.push(e.toPair())),t}update(t,e){let i=this.indexOf(t);return i>=0&&(this._data[i].value=e),this}values(){let t=[];return this._data.forEach(e=>t.push(e.value)),t}};Mb.exports=lp});var tf=ds((mR,kb)=>{"use strict";var cp=class{constructor(t,e){this._key=t,this._value=e}get key(){return this._key}get value(){return this._value}set value(t){this._value=t}toPair(){return[this.key,this.value]}};kb.exports=cp});var Ob=ds((pR,Pb)=>{"use strict";var aw=hp(),lw=tf(),up=class extends aw{_isMaxOrdered(t){let e=this.childIndices(t);for(let i in e)if(this._compare(t,e[i])<0)return!1;return!0}extract(t){let e=this._data[t];return this.remove(t),e}extractMax(){return this.extract(0)}insert(t,e){let i=new lw(t,e);this._data.push(i);let r=this.size-1,n=this.parentIndex(r);for(;n>=0&&this._compare(r,n)>0;)this._swap(r,n),r=n,n=this.parentIndex(r);return this}remove(t){if(t>=0&&t<this.size)if(t===this.size-1)this._data.pop();else{let e=t;for(this._data[e]=this._data.pop();!this._isMaxOrdered(e);){let i=this.maxChildIndex(e);this._swap(e,i),e=i}}return this}};Pb.exports=up});var Fb=ds((gR,Nb)=>{"use strict";var hw=hp(),cw=tf(),dp=class extends hw{_isMinOrdered(t){let e=this.childIndices(t);for(let i in e)if(this._compare(t,e[i])>0)return!1;return!0}extract(t){let e=this._data[t];return this.remove(t),e}extractMin(){return this.extract(0)}insert(t,e){let i=new cw(t,e);this._data.push(i);let r=this.size-1,n=this.parentIndex(r);for(;n>=0&&this._compare(r,n)<0;)this._swap(r,n),r=n,n=this.parentIndex(r);return this}remove(t){if(t>=0&&t<this.size)if(t===this.size-1)this._data.pop();else{let e=t;for(this._data[e]=this._data.pop();!this._isMinOrdered(e);){let i=this.minChildIndex(e);this._swap(e,i),e=i}}return this}};Nb.exports=dp});var Lb=ds((xR,Bb)=>{"use strict";var uw=Ob(),dw=Fb(),fw=tf();Bb.exports=Object.assign({},{MaxHeap:uw},{MinHeap:dw},{Node:fw})});var Qb=ds((SN,xp)=>{"use strict";var pw=Object.prototype.hasOwnProperty,We="~";function hu(){}Object.create&&(hu.prototype=Object.create(null),new hu().__proto__||(We=!1));function gw(s,t,e){this.fn=s,this.context=t,this.once=e||!1}function Zb(s,t,e,i,r){if(typeof e!="function")throw new TypeError("The listener must be a function");var n=new gw(e,i||s,r),l=We?We+t:t;return s._events[l]?s._events[l].fn?s._events[l]=[s._events[l],n]:s._events[l].push(n):(s._events[l]=n,s._eventsCount++),s}function uf(s,t){--s._eventsCount===0?s._events=new hu:delete s._events[t]}function Ue(){this._events=new hu,this._eventsCount=0}Ue.prototype.eventNames=function(){var t=[],e,i;if(this._eventsCount===0)return t;for(i in e=this._events)pw.call(e,i)&&t.push(We?i.slice(1):i);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(e)):t};Ue.prototype.listeners=function(t){var e=We?We+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,n=i.length,l=new Array(n);r<n;r++)l[r]=i[r].fn;return l};Ue.prototype.listenerCount=function(t){var e=We?We+t:t,i=this._events[e];return i?i.fn?1:i.length:0};Ue.prototype.emit=function(t,e,i,r,n,l){var a=We?We+t:t;if(!this._events[a])return!1;var o=this._events[a],h=arguments.length,c,u;if(o.fn){switch(o.once&&this.removeListener(t,o.fn,void 0,!0),h){case 1:return o.fn.call(o.context),!0;case 2:return o.fn.call(o.context,e),!0;case 3:return o.fn.call(o.context,e,i),!0;case 4:return o.fn.call(o.context,e,i,r),!0;case 5:return o.fn.call(o.context,e,i,r,n),!0;case 6:return o.fn.call(o.context,e,i,r,n,l),!0}for(u=1,c=new Array(h-1);u<h;u++)c[u-1]=arguments[u];o.fn.apply(o.context,c)}else{var d=o.length,f;for(u=0;u<d;u++)switch(o[u].once&&this.removeListener(t,o[u].fn,void 0,!0),h){case 1:o[u].fn.call(o[u].context);break;case 2:o[u].fn.call(o[u].context,e);break;case 3:o[u].fn.call(o[u].context,e,i);break;case 4:o[u].fn.call(o[u].context,e,i,r);break;default:if(!c)for(f=1,c=new Array(h-1);f<h;f++)c[f-1]=arguments[f];o[u].fn.apply(o[u].context,c)}}return!0};Ue.prototype.on=function(t,e,i){return Zb(this,t,e,i,!1)};Ue.prototype.once=function(t,e,i){return Zb(this,t,e,i,!0)};Ue.prototype.removeListener=function(t,e,i,r){var n=We?We+t:t;if(!this._events[n])return this;if(!e)return uf(this,n),this;var l=this._events[n];if(l.fn)l.fn===e&&(!r||l.once)&&(!i||l.context===i)&&uf(this,n);else{for(var a=0,o=[],h=l.length;a<h;a++)(l[a].fn!==e||r&&!l[a].once||i&&l[a].context!==i)&&o.push(l[a]);o.length?this._events[n]=o.length===1?o[0]:o:uf(this,n)}return this};Ue.prototype.removeAllListeners=function(t){var e;return t?(e=We?We+t:t,this._events[e]&&uf(this,e)):(this._events=new hu,this._eventsCount=0),this};Ue.prototype.off=Ue.prototype.removeListener;Ue.prototype.addListener=Ue.prototype.on;Ue.prefixed=We;Ue.EventEmitter=Ue;typeof xp!="undefined"&&(xp.exports=Ue)});var i_=ds((CN,vp)=>{"use strict";vp.exports=mf;vp.exports.default=mf;function mf(s,t,e){e=e||2;var i=t&&t.length,r=i?t[0]*e:s.length,n=t_(s,0,r,e,!0),l=[];if(!n||n.next===n.prev)return l;var a,o,h,c,u,d,f;if(i&&(n=vw(s,t,n,e)),s.length>80*e){a=h=s[0],o=c=s[1];for(var m=e;m<r;m+=e)u=s[m],d=s[m+1],u<a&&(a=u),d<o&&(o=d),u>h&&(h=u),d>c&&(c=d);f=Math.max(h-a,c-o),f=f!==0?32767/f:0}return cu(n,l,e,a,o,f,0),l}function t_(s,t,e,i,r){var n,l;if(r===yp(s,t,e,i)>0)for(n=t;n<e;n+=i)l=Jb(n,s[n],s[n+1],l);else for(n=e-i;n>=t;n-=i)l=Jb(n,s[n],s[n+1],l);return l&&pf(l,l.next)&&(du(l),l=l.next),l}function qa(s,t){if(!s)return s;t||(t=s);var e=s,i;do if(i=!1,!e.steiner&&(pf(e,e.next)||Ht(e.prev,e,e.next)===0)){if(du(e),e=t=e.prev,e===e.next)break;i=!0}else e=e.next;while(i||e!==t);return t}function cu(s,t,e,i,r,n,l){if(!!s){!l&&n&&Tw(s,i,r,n);for(var a=s,o,h;s.prev!==s.next;){if(o=s.prev,h=s.next,n?bw(s,i,r,n):xw(s)){t.push(o.i/e|0),t.push(s.i/e|0),t.push(h.i/e|0),du(s),s=h.next,a=h.next;continue}if(s=h,s===a){l?l===1?(s=_w(qa(s),t,e),cu(s,t,e,i,r,n,2)):l===2&&yw(s,t,e,i,r,n):cu(qa(s),t,e,i,r,n,1);break}}}}function xw(s){var t=s.prev,e=s,i=s.next;if(Ht(t,e,i)>=0)return!1;for(var r=t.x,n=e.x,l=i.x,a=t.y,o=e.y,h=i.y,c=r<n?r<l?r:l:n<l?n:l,u=a<o?a<h?a:h:o<h?o:h,d=r>n?r>l?r:l:n>l?n:l,f=a>o?a>h?a:h:o>h?o:h,m=i.next;m!==t;){if(m.x>=c&&m.x<=d&&m.y>=u&&m.y<=f&&rh(r,a,n,o,l,h,m.x,m.y)&&Ht(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function bw(s,t,e,i){var r=s.prev,n=s,l=s.next;if(Ht(r,n,l)>=0)return!1;for(var a=r.x,o=n.x,h=l.x,c=r.y,u=n.y,d=l.y,f=a<o?a<h?a:h:o<h?o:h,m=c<u?c<d?c:d:u<d?u:d,p=a>o?a>h?a:h:o>h?o:h,g=c>u?c>d?c:d:u>d?u:d,y=bp(f,m,t,e,i),_=bp(p,g,t,e,i),b=s.prevZ,x=s.nextZ;b&&b.z>=y&&x&&x.z<=_;){if(b.x>=f&&b.x<=p&&b.y>=m&&b.y<=g&&b!==r&&b!==l&&rh(a,c,o,u,h,d,b.x,b.y)&&Ht(b.prev,b,b.next)>=0||(b=b.prevZ,x.x>=f&&x.x<=p&&x.y>=m&&x.y<=g&&x!==r&&x!==l&&rh(a,c,o,u,h,d,x.x,x.y)&&Ht(x.prev,x,x.next)>=0))return!1;x=x.nextZ}for(;b&&b.z>=y;){if(b.x>=f&&b.x<=p&&b.y>=m&&b.y<=g&&b!==r&&b!==l&&rh(a,c,o,u,h,d,b.x,b.y)&&Ht(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;x&&x.z<=_;){if(x.x>=f&&x.x<=p&&x.y>=m&&x.y<=g&&x!==r&&x!==l&&rh(a,c,o,u,h,d,x.x,x.y)&&Ht(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function _w(s,t,e){var i=s;do{var r=i.prev,n=i.next.next;!pf(r,n)&&e_(r,i,i.next,n)&&uu(r,n)&&uu(n,r)&&(t.push(r.i/e|0),t.push(i.i/e|0),t.push(n.i/e|0),du(i),du(i.next),i=s=n),i=i.next}while(i!==s);return qa(i)}function yw(s,t,e,i,r,n){var l=s;do{for(var a=l.next.next;a!==l.prev;){if(l.i!==a.i&&Rw(l,a)){var o=s_(l,a);l=qa(l,l.next),o=qa(o,o.next),cu(l,t,e,i,r,n,0),cu(o,t,e,i,r,n,0);return}a=a.next}l=l.next}while(l!==s)}function vw(s,t,e,i){var r=[],n,l,a,o,h;for(n=0,l=t.length;n<l;n++)a=t[n]*i,o=n<l-1?t[n+1]*i:s.length,h=t_(s,a,o,i,!1),h===h.next&&(h.steiner=!0),r.push(Cw(h));for(r.sort(ww),n=0;n<r.length;n++)e=Ew(r[n],e);return e}function ww(s,t){return s.x-t.x}function Ew(s,t){var e=Aw(s,t);if(!e)return t;var i=s_(e,s);return qa(i,i.next),qa(e,e.next)}function Aw(s,t){var e=t,i=s.x,r=s.y,n=-1/0,l;do{if(r<=e.y&&r>=e.next.y&&e.next.y!==e.y){var a=e.x+(r-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(a<=i&&a>n&&(n=a,l=e.x<e.next.x?e:e.next,a===i))return l}e=e.next}while(e!==t);if(!l)return null;var o=l,h=l.x,c=l.y,u=1/0,d;e=l;do i>=e.x&&e.x>=h&&i!==e.x&&rh(r<c?i:n,r,h,c,r<c?n:i,r,e.x,e.y)&&(d=Math.abs(r-e.y)/(i-e.x),uu(e,s)&&(d<u||d===u&&(e.x>l.x||e.x===l.x&&Iw(l,e)))&&(l=e,u=d)),e=e.next;while(e!==o);return l}function Iw(s,t){return Ht(s.prev,s,t.prev)<0&&Ht(t.next,s,s.next)<0}function Tw(s,t,e,i){var r=s;do r.z===0&&(r.z=bp(r.x,r.y,t,e,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==s);r.prevZ.nextZ=null,r.prevZ=null,Sw(r)}function Sw(s){var t,e,i,r,n,l,a,o,h=1;do{for(e=s,s=null,n=null,l=0;e;){for(l++,i=e,a=0,t=0;t<h&&(a++,i=i.nextZ,!!i);t++);for(o=h;a>0||o>0&&i;)a!==0&&(o===0||!i||e.z<=i.z)?(r=e,e=e.nextZ,a--):(r=i,i=i.nextZ,o--),n?n.nextZ=r:s=r,r.prevZ=n,n=r;e=i}n.nextZ=null,h*=2}while(l>1);return s}function bp(s,t,e,i,r){return s=(s-e)*r|0,t=(t-i)*r|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,s|t<<1}function Cw(s){var t=s,e=s;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==s);return e}function rh(s,t,e,i,r,n,l,a){return(r-l)*(t-a)>=(s-l)*(n-a)&&(s-l)*(i-a)>=(e-l)*(t-a)&&(e-l)*(n-a)>=(r-l)*(i-a)}function Rw(s,t){return s.next.i!==t.i&&s.prev.i!==t.i&&!Mw(s,t)&&(uu(s,t)&&uu(t,s)&&kw(s,t)&&(Ht(s.prev,s,t.prev)||Ht(s,t.prev,t))||pf(s,t)&&Ht(s.prev,s,s.next)>0&&Ht(t.prev,t,t.next)>0)}function Ht(s,t,e){return(t.y-s.y)*(e.x-t.x)-(t.x-s.x)*(e.y-t.y)}function pf(s,t){return s.x===t.x&&s.y===t.y}function e_(s,t,e,i){var r=ff(Ht(s,t,e)),n=ff(Ht(s,t,i)),l=ff(Ht(e,i,s)),a=ff(Ht(e,i,t));return!!(r!==n&&l!==a||r===0&&df(s,e,t)||n===0&&df(s,i,t)||l===0&&df(e,s,i)||a===0&&df(e,t,i))}function df(s,t,e){return t.x<=Math.max(s.x,e.x)&&t.x>=Math.min(s.x,e.x)&&t.y<=Math.max(s.y,e.y)&&t.y>=Math.min(s.y,e.y)}function ff(s){return s>0?1:s<0?-1:0}function Mw(s,t){var e=s;do{if(e.i!==s.i&&e.next.i!==s.i&&e.i!==t.i&&e.next.i!==t.i&&e_(e,e.next,s,t))return!0;e=e.next}while(e!==s);return!1}function uu(s,t){return Ht(s.prev,s,s.next)<0?Ht(s,t,s.next)>=0&&Ht(s,s.prev,t)>=0:Ht(s,t,s.prev)<0||Ht(s,s.next,t)<0}function kw(s,t){var e=s,i=!1,r=(s.x+t.x)/2,n=(s.y+t.y)/2;do e.y>n!=e.next.y>n&&e.next.y!==e.y&&r<(e.next.x-e.x)*(n-e.y)/(e.next.y-e.y)+e.x&&(i=!i),e=e.next;while(e!==s);return i}function s_(s,t){var e=new _p(s.i,s.x,s.y),i=new _p(t.i,t.x,t.y),r=s.next,n=t.prev;return s.next=t,t.prev=s,e.next=r,r.prev=e,i.next=e,e.prev=i,n.next=i,i.prev=n,i}function Jb(s,t,e,i){var r=new _p(s,t,e);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function du(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function _p(s,t,e){this.i=s,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}mf.deviation=function(s,t,e,i){var r=t&&t.length,n=r?t[0]*e:s.length,l=Math.abs(yp(s,0,n,e));if(r)for(var a=0,o=t.length;a<o;a++){var h=t[a]*e,c=a<o-1?t[a+1]*e:s.length;l-=Math.abs(yp(s,h,c,e))}var u=0;for(a=0;a<i.length;a+=3){var d=i[a]*e,f=i[a+1]*e,m=i[a+2]*e;u+=Math.abs((s[d]-s[m])*(s[f+1]-s[d+1])-(s[d]-s[f])*(s[m+1]-s[d+1]))}return l===0&&u===0?0:Math.abs((u-l)/l)};function yp(s,t,e,i){for(var r=0,n=t,l=e-i;n<e;n+=i)r+=(s[l]-s[n])*(s[n+1]+s[l+1]),l=n;return r}mf.flatten=function(s){for(var t=s[0][0].length,e={vertices:[],holes:[],dimensions:t},i=0,r=0;r<s.length;r++){for(var n=0;n<s[r].length;n++)for(var l=0;l<t;l++)e.vertices.push(s[r][n][l]);r>0&&(i+=s[r-1].length,e.holes.push(i))}return e}});var r_=ds((nh,oh)=>{(function(s){var t=typeof nh=="object"&&nh&&!nh.nodeType&&nh,e=typeof oh=="object"&&oh&&!oh.nodeType&&oh,i=typeof global=="object"&&global;(i.global===i||i.window===i||i.self===i)&&(s=i);var r,n=2147483647,l=36,a=1,o=26,h=38,c=700,u=72,d=128,f="-",m=/^xn--/,p=/[^\x20-\x7E]/,g=/[\x2E\u3002\uFF0E\uFF61]/g,y={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},_=l-a,b=Math.floor,x=String.fromCharCode,v;function w(O){throw RangeError(y[O])}function E(O,L){for(var B=O.length,W=[];B--;)W[B]=L(O[B]);return W}function A(O,L){var B=O.split("@"),W="";B.length>1&&(W=B[0]+"@",O=B[1]),O=O.replace(g,".");var j=O.split("."),V=E(j,L).join(".");return W+V}function T(O){for(var L=[],B=0,W=O.length,j,V;B<W;)j=O.charCodeAt(B++),j>=55296&&j<=56319&&B<W?(V=O.charCodeAt(B++),(V&64512)==56320?L.push(((j&1023)<<10)+(V&1023)+65536):(L.push(j),B--)):L.push(j);return L}function C(O){return E(O,function(L){var B="";return L>65535&&(L-=65536,B+=x(L>>>10&1023|55296),L=56320|L&1023),B+=x(L),B}).join("")}function R(O){return O-48<10?O-22:O-65<26?O-65:O-97<26?O-97:l}function N(O,L){return O+22+75*(O<26)-((L!=0)<<5)}function P(O,L,B){var W=0;for(O=B?b(O/c):O>>1,O+=b(O/L);O>_*o>>1;W+=l)O=b(O/_);return b(W+(_+1)*O/(O+h))}function M(O){var L=[],B=O.length,W,j=0,V=d,U=u,st,nt,pt,At,ot,gt,yt,Nt,Lt;for(st=O.lastIndexOf(f),st<0&&(st=0),nt=0;nt<st;++nt)O.charCodeAt(nt)>=128&&w("not-basic"),L.push(O.charCodeAt(nt));for(pt=st>0?st+1:0;pt<B;){for(At=j,ot=1,gt=l;pt>=B&&w("invalid-input"),yt=R(O.charCodeAt(pt++)),(yt>=l||yt>b((n-j)/ot))&&w("overflow"),j+=yt*ot,Nt=gt<=U?a:gt>=U+o?o:gt-U,!(yt<Nt);gt+=l)Lt=l-Nt,ot>b(n/Lt)&&w("overflow"),ot*=Lt;W=L.length+1,U=P(j-At,W,At==0),b(j/W)>n-V&&w("overflow"),V+=b(j/W),j%=W,L.splice(j++,0,V)}return C(L)}function D(O){var L,B,W,j,V,U,st,nt,pt,At,ot,gt=[],yt,Nt,Lt,Xe;for(O=T(O),yt=O.length,L=d,B=0,V=u,U=0;U<yt;++U)ot=O[U],ot<128&&gt.push(x(ot));for(W=j=gt.length,j&&gt.push(f);W<yt;){for(st=n,U=0;U<yt;++U)ot=O[U],ot>=L&&ot<st&&(st=ot);for(Nt=W+1,st-L>b((n-B)/Nt)&&w("overflow"),B+=(st-L)*Nt,L=st,U=0;U<yt;++U)if(ot=O[U],ot<L&&++B>n&&w("overflow"),ot==L){for(nt=B,pt=l;At=pt<=V?a:pt>=V+o?o:pt-V,!(nt<At);pt+=l)Xe=nt-At,Lt=l-At,gt.push(x(N(At+Xe%Lt,0))),nt=b(Xe/Lt);gt.push(x(N(nt,0))),V=P(B,Nt,W==j),B=0,++W}++B,++L}return gt.join("")}function q(O){return A(O,function(L){return m.test(L)?M(L.slice(4).toLowerCase()):L})}function X(O){return A(O,function(L){return p.test(L)?"xn--"+D(L):L})}if(r={version:"1.3.2",ucs2:{decode:T,encode:C},decode:M,encode:D,toASCII:X,toUnicode:q},typeof define=="function"&&typeof define.amd=="object"&&define.amd)define("punycode",function(){return r});else if(t&&e)if(oh.exports==t)e.exports=r;else for(v in r)r.hasOwnProperty(v)&&(t[v]=r[v]);else s.punycode=r})(nh)});var o_=ds((RN,n_)=>{"use strict";n_.exports={isString:function(s){return typeof s=="string"},isObject:function(s){return typeof s=="object"&&s!==null},isNull:function(s){return s===null},isNullOrUndefined:function(s){return s==null}}});var l_=ds((MN,a_)=>{"use strict";function Pw(s,t){return Object.prototype.hasOwnProperty.call(s,t)}a_.exports=function(s,t,e,i){t=t||"&",e=e||"=";var r={};if(typeof s!="string"||s.length===0)return r;var n=/\+/g;s=s.split(t);var l=1e3;i&&typeof i.maxKeys=="number"&&(l=i.maxKeys);var a=s.length;l>0&&a>l&&(a=l);for(var o=0;o<a;++o){var h=s[o].replace(n,"%20"),c=h.indexOf(e),u,d,f,m;c>=0?(u=h.substr(0,c),d=h.substr(c+1)):(u=h,d=""),f=decodeURIComponent(u),m=decodeURIComponent(d),Pw(r,f)?Array.isArray(r[f])?r[f].push(m):r[f]=[r[f],m]:r[f]=m}return r}});var c_=ds((kN,h_)=>{"use strict";var fu=function(s){switch(typeof s){case"string":return s;case"boolean":return s?"true":"false";case"number":return isFinite(s)?s:"";default:return""}};h_.exports=function(s,t,e,i){return t=t||"&",e=e||"=",s===null&&(s=void 0),typeof s=="object"?Object.keys(s).map(function(r){var n=encodeURIComponent(fu(r))+e;return Array.isArray(s[r])?s[r].map(function(l){return n+encodeURIComponent(fu(l))}).join(t):n+encodeURIComponent(fu(s[r]))}).join(t):i?encodeURIComponent(fu(i))+e+encodeURIComponent(fu(s)):""}});var u_=ds(mu=>{"use strict";mu.decode=mu.parse=l_();mu.encode=mu.stringify=c_()});var p_=ds(lh=>{"use strict";var Ow=r_(),Pi=o_();lh.parse=pu;lh.resolve=Yw;lh.resolveObject=jw;lh.format=Xw;lh.Url=Ks;function Ks(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Nw=/^([a-z0-9.+-]+:)/i,Fw=/:[0-9]*$/,Bw=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Lw=["<",">",'"',"`"," ","\r",`
`,"	"],Uw=["{","}","|","\\","^","`"].concat(Lw),wp=["'"].concat(Uw),d_=["%","/","?",";","#"].concat(wp),f_=["/","?","#"],Dw=255,m_=/^[+a-z0-9A-Z_-]{0,63}$/,Vw=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Gw={javascript:!0,"javascript:":!0},Ep={javascript:!0,"javascript:":!0},ah={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Ap=u_();function pu(s,t,e){if(s&&Pi.isObject(s)&&s instanceof Ks)return s;var i=new Ks;return i.parse(s,t,e),i}Ks.prototype.parse=function(s,t,e){if(!Pi.isString(s))throw new TypeError("Parameter 'url' must be a string, not "+typeof s);var i=s.indexOf("?"),r=i!==-1&&i<s.indexOf("#")?"?":"#",n=s.split(r),l=/\\/g;n[0]=n[0].replace(l,"/"),s=n.join(r);var a=s;if(a=a.trim(),!e&&s.split("#").length===1){var o=Bw.exec(a);if(o)return this.path=a,this.href=a,this.pathname=o[1],o[2]?(this.search=o[2],t?this.query=Ap.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var h=Nw.exec(a);if(h){h=h[0];var c=h.toLowerCase();this.protocol=c,a=a.substr(h.length)}if(e||h||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var u=a.substr(0,2)==="//";u&&!(h&&Ep[h])&&(a=a.substr(2),this.slashes=!0)}if(!Ep[h]&&(u||h&&!ah[h])){for(var d=-1,f=0;f<f_.length;f++){var m=a.indexOf(f_[f]);m!==-1&&(d===-1||m<d)&&(d=m)}var p,g;d===-1?g=a.lastIndexOf("@"):g=a.lastIndexOf("@",d),g!==-1&&(p=a.slice(0,g),a=a.slice(g+1),this.auth=decodeURIComponent(p)),d=-1;for(var f=0;f<d_.length;f++){var m=a.indexOf(d_[f]);m!==-1&&(d===-1||m<d)&&(d=m)}d===-1&&(d=a.length),this.host=a.slice(0,d),a=a.slice(d),this.parseHost(),this.hostname=this.hostname||"";var y=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!y)for(var _=this.hostname.split(/\./),f=0,b=_.length;f<b;f++){var x=_[f];if(!!x&&!x.match(m_)){for(var v="",w=0,E=x.length;w<E;w++)x.charCodeAt(w)>127?v+="x":v+=x[w];if(!v.match(m_)){var A=_.slice(0,f),T=_.slice(f+1),C=x.match(Vw);C&&(A.push(C[1]),T.unshift(C[2])),T.length&&(a="/"+T.join(".")+a),this.hostname=A.join(".");break}}}this.hostname.length>Dw?this.hostname="":this.hostname=this.hostname.toLowerCase(),y||(this.hostname=Ow.toASCII(this.hostname));var R=this.port?":"+this.port:"",N=this.hostname||"";this.host=N+R,this.href+=this.host,y&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!Gw[c])for(var f=0,b=wp.length;f<b;f++){var P=wp[f];if(a.indexOf(P)!==-1){var M=encodeURIComponent(P);M===P&&(M=escape(P)),a=a.split(P).join(M)}}var D=a.indexOf("#");D!==-1&&(this.hash=a.substr(D),a=a.slice(0,D));var q=a.indexOf("?");if(q!==-1?(this.search=a.substr(q),this.query=a.substr(q+1),t&&(this.query=Ap.parse(this.query)),a=a.slice(0,q)):t&&(this.search="",this.query={}),a&&(this.pathname=a),ah[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var R=this.pathname||"",X=this.search||"";this.path=R+X}return this.href=this.format(),this};function Xw(s){return Pi.isString(s)&&(s=pu(s)),s instanceof Ks?s.format():Ks.prototype.format.call(s)}Ks.prototype.format=function(){var s=this.auth||"";s&&(s=encodeURIComponent(s),s=s.replace(/%3A/i,":"),s+="@");var t=this.protocol||"",e=this.pathname||"",i=this.hash||"",r=!1,n="";this.host?r=s+this.host:this.hostname&&(r=s+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&Pi.isObject(this.query)&&Object.keys(this.query).length&&(n=Ap.stringify(this.query));var l=this.search||n&&"?"+n||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||ah[t])&&r!==!1?(r="//"+(r||""),e&&e.charAt(0)!=="/"&&(e="/"+e)):r||(r=""),i&&i.charAt(0)!=="#"&&(i="#"+i),l&&l.charAt(0)!=="?"&&(l="?"+l),e=e.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),l=l.replace("#","%23"),t+r+e+l+i};function Yw(s,t){return pu(s,!1,!0).resolve(t)}Ks.prototype.resolve=function(s){return this.resolveObject(pu(s,!1,!0)).format()};function jw(s,t){return s?pu(s,!1,!0).resolveObject(t):t}Ks.prototype.resolveObject=function(s){if(Pi.isString(s)){var t=new Ks;t.parse(s,!1,!0),s=t}for(var e=new Ks,i=Object.keys(this),r=0;r<i.length;r++){var n=i[r];e[n]=this[n]}if(e.hash=s.hash,s.href==="")return e.href=e.format(),e;if(s.slashes&&!s.protocol){for(var l=Object.keys(s),a=0;a<l.length;a++){var o=l[a];o!=="protocol"&&(e[o]=s[o])}return ah[e.protocol]&&e.hostname&&!e.pathname&&(e.path=e.pathname="/"),e.href=e.format(),e}if(s.protocol&&s.protocol!==e.protocol){if(!ah[s.protocol]){for(var h=Object.keys(s),c=0;c<h.length;c++){var u=h[c];e[u]=s[u]}return e.href=e.format(),e}if(e.protocol=s.protocol,!s.host&&!Ep[s.protocol]){for(var b=(s.pathname||"").split("/");b.length&&!(s.host=b.shift()););s.host||(s.host=""),s.hostname||(s.hostname=""),b[0]!==""&&b.unshift(""),b.length<2&&b.unshift(""),e.pathname=b.join("/")}else e.pathname=s.pathname;if(e.search=s.search,e.query=s.query,e.host=s.host||"",e.auth=s.auth,e.hostname=s.hostname||s.host,e.port=s.port,e.pathname||e.search){var d=e.pathname||"",f=e.search||"";e.path=d+f}return e.slashes=e.slashes||s.slashes,e.href=e.format(),e}var m=e.pathname&&e.pathname.charAt(0)==="/",p=s.host||s.pathname&&s.pathname.charAt(0)==="/",g=p||m||e.host&&s.pathname,y=g,_=e.pathname&&e.pathname.split("/")||[],b=s.pathname&&s.pathname.split("/")||[],x=e.protocol&&!ah[e.protocol];if(x&&(e.hostname="",e.port=null,e.host&&(_[0]===""?_[0]=e.host:_.unshift(e.host)),e.host="",s.protocol&&(s.hostname=null,s.port=null,s.host&&(b[0]===""?b[0]=s.host:b.unshift(s.host)),s.host=null),g=g&&(b[0]===""||_[0]==="")),p)e.host=s.host||s.host===""?s.host:e.host,e.hostname=s.hostname||s.hostname===""?s.hostname:e.hostname,e.search=s.search,e.query=s.query,_=b;else if(b.length)_||(_=[]),_.pop(),_=_.concat(b),e.search=s.search,e.query=s.query;else if(!Pi.isNullOrUndefined(s.search)){if(x){e.hostname=e.host=_.shift();var v=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;v&&(e.auth=v.shift(),e.host=e.hostname=v.shift())}return e.search=s.search,e.query=s.query,(!Pi.isNull(e.pathname)||!Pi.isNull(e.search))&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!_.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var w=_.slice(-1)[0],E=(e.host||s.host||_.length>1)&&(w==="."||w==="..")||w==="",A=0,T=_.length;T>=0;T--)w=_[T],w==="."?_.splice(T,1):w===".."?(_.splice(T,1),A++):A&&(_.splice(T,1),A--);if(!g&&!y)for(;A--;A)_.unshift("..");g&&_[0]!==""&&(!_[0]||_[0].charAt(0)!=="/")&&_.unshift(""),E&&_.join("/").substr(-1)!=="/"&&_.push("");var C=_[0]===""||_[0]&&_[0].charAt(0)==="/";if(x){e.hostname=e.host=C?"":_.length?_.shift():"";var v=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;v&&(e.auth=v.shift(),e.host=e.hostname=v.shift())}return g=g||e.host&&_.length,g&&!C&&_.unshift(""),_.length?e.pathname=_.join("/"):(e.pathname=null,e.path=null),(!Pi.isNull(e.pathname)||!Pi.isNull(e.search))&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=s.auth||e.auth,e.slashes=e.slashes||s.slashes,e.href=e.format(),e};Ks.prototype.parseHost=function(){var s=this.host,t=Fw.exec(s);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),s=s.substr(0,s.length-t.length)),s&&(this.hostname=s)}});function Mm(s,t){let e=s.indexOf(t);if(e!=-1)return s.splice(e,1),Mm(s,t)}var zi=class{constructor(t){this.all=new Map;this.sender=t}on(t,e){let i=this.all.get(t);return i&&i.push(e)||this.all.set(t,[e]),e}off(t,e){let i=this.all.get(t);i&&(e?i.splice(i.indexOf(e)>>>0,1):i.length=0)}emit(t,...e){(this.all.get(t)||[]).slice().map(i=>{i(...e)})}dispose(){this.all.clear()}};var Qg=1,Cc=class{constructor(){this.ev=new zi(this);this.id=Qg,Qg+=1}get game(){return Y.inst}},Is=class extends Cc{constructor(){super(...arguments);this._updateHandler=null;this._delayAndIntervals=new Set;this.components=[];this.tags={};this.disposed=!1}enableUpdate(){this.game&&(this._updateHandler=this.update.bind(this),this.game.ev.on("update",this._updateHandler))}disableUpdate(){this.game&&this.game.ev.off("update",this._updateHandler)}init(){}dispose(){if(this.disposed){console.error("\u91CD\u590D\u5220\u9664\u4E00\u4E2A\u5BF9\u8C61");debugger;return}this.ev.emit("dispose"),this.disposed=!0,this._updateHandler&&this.game.ev.off("update",this._updateHandler);for(let e of this._delayAndIntervals)this.game.task.cancel(e);this.components.forEach(e=>{e.dispose()}),this.components=null,this.tags=null}$nextTick(e){this.game.$nextTick(e)}$delay(e,i=null){let r=this.game.task.delay(e,()=>{this._delayAndIntervals.delete(r),i&&i()});return this._delayAndIntervals.add(r),r}$interval(e=null,i=10){let r=this.game.task.interval(i,e);return this._delayAndIntervals.add(r),r}$wait(e,i,r=10){return new Promise((n,l)=>{let a=()=>{e()&&(this.$stop(o),i&&i(),n())},o=this.game.task.interval(r,a)})}$until(e){return new Promise(i=>{let r=(...n)=>{i(n),this.ev.off(e,r)};this.ev.on(e,r)})}$stop(e){this.game.task.cancel(e)}update(e){for(let i of this.components)i.enabled&&i.update(e)}addComponentSync(e,i){return $(this,null,function*(){let r=new e;return i=i||r.tag,this.tags[i]&&console.warn("\u5C1D\u8BD5\u8986\u76D6\u4E00\u4E2A\u6807\u7B7E",i,r),r.tag=i,this.tags[i]=r,this.components.push(r),r.bind(this)})}addComponent(e,i){let r=new e;return i=i||r.tag,this.tags[i]&&console.warn("\u5C1D\u8BD5\u8986\u76D6\u4E00\u4E2A\u6807\u7B7E",i,r),r.tag=i,this.tags[i]=r,this.components.push(r),r.bind(this),r}removeComponent(e){Mm(this.components,e),delete this.tags[e.tag],e.enabled=!1,e.dispose()}};var Vt=class extends Is{init(){}start(){}};var xd=class{};var kt={custom_elements:"assets/custom_elements.js",eruda:"assets/eruda.js",gen:{"":"assets/gen/.gitkeep",ui:{loading:"assets/gen/ui/loading.txt","loading@atlas0":"assets/gen/ui/loading@atlas0.png",main:"assets/gen/ui/main.txt","main@atlas0":"assets/gen/ui/main@atlas0.png","main@atlas0_1":"assets/gen/ui/main@atlas0_1.png"}},image:{pixi_logo:"assets/image/pixi_logo.png",star:"assets/image/star.png"},libs:{abandon:"assets/libs/abandon.js",fairyguimin:"assets/libs/fairygui.min.js",fairyguiv6:"assets/libs/fairyguiv6.js",fairyguiv7:"assets/libs/fairyguiv7.js",pixisound:"assets/libs/pixi-sound.js",pixispine:"assets/libs/pixi-spine.js",pixispinejs:"assets/libs/pixi-spine.js.map",pixi:"assets/libs/pixi.js",piximin:"assets/libs/pixi.min.js",pixiv6:"assets/libs/pixiv6.js",pixiv720:"assets/libs/pixiv720.js",statsmin:"assets/libs/stats.min.js",tweenumdmin:"assets/libs/tween.umd.min.js",tweenjsmin:"assets/libs/tweenjs.min.js",zlibmin:"assets/libs/zlib.min.js"},load:"assets/load.js",loader:{ktx2Decoder:"assets/loader/ktx2Decoder.js",meshopt_decoder:"assets/loader/meshopt_decoder.js",transcoder:{msc_basis_transcoder:"assets/loader/transcoder/msc_basis_transcoder.wasm",uastc_astc:"assets/loader/transcoder/uastc_astc.wasm",uastc_bc7:"assets/loader/transcoder/uastc_bc7.wasm",uastc_rgba32_srgb:"assets/loader/transcoder/uastc_rgba32_srgb.wasm",uastc_rgba32_unorm:"assets/loader/transcoder/uastc_rgba32_unorm.wasm",zstddec:"assets/loader/transcoder/zstddec.wasm"}},png:{bleachbypass:"assets/png/bleach-bypass.png",candlelight:"assets/png/candle-light.png",coolcontrast:"assets/png/cool-contrast.png",desaturatedfog:"assets/png/desaturated-fog.png",evening:"assets/png/evening.png",fall:"assets/png/fall.png",filmic1:"assets/png/filmic1.png",filmic2:"assets/png/filmic2.png",matrixgreen:"assets/png/matrix-green.png",strongamber:"assets/png/strong-amber.png",warmcontrast:"assets/png/warm-contrast.png"},sound:{Bluewalk1:"assets/sound/Blue walk1.mp3",Bluewalk2:"assets/sound/Blue walk2.mp3",Bluexuathien1:"assets/sound/Blue xuat hien1.mp3",Bluexuathien2:"assets/sound/Blue xuat hien2.mp3",Button:"assets/sound/Button.mp3",Combat:"assets/sound/Combat.mp3",Contact:"assets/sound/Contact.mp3",Dead:"assets/sound/Dead.mp3",Drawing1:"assets/sound/Drawing1.mp3",Drawing2:"assets/sound/Drawing2.mp3",Greenwalk1:"assets/sound/Green walk1.mp3",Greenwalk2:"assets/sound/Green walk2.mp3",Greenxuathien1:"assets/sound/Green xuathien1.mp3",Greenxuathien2:"assets/sound/Green xuathien2.mp3",Hint:"assets/sound/Hint.mp3",Hit3:"assets/sound/Hit 3.mp3",Hit4:"assets/sound/Hit 4.mp3",Hit5:"assets/sound/Hit 5.mp3",Lose:"assets/sound/Lose.mp3",Moving:"assets/sound/Moving.mp3",Music1:"assets/sound/Music1.mp3",Music2:"assets/sound/Music2.mp3",Noel:"assets/sound/Noel.mp3",Orangewalk1:"assets/sound/Orange walk1.mp3",Orangewalk2:"assets/sound/Orange walk2.mp3",Orangexuathien1:"assets/sound/Orange xuathien1.mp3",Orangexuathien2:"assets/sound/Orange xuathien2.mp3",PopPrize:"assets/sound/PopPrize.mp3",RopeInteract:"assets/sound/RopeInteract.mp3",Star3:"assets/sound/Star3.mp3",Walk1:"assets/sound/Walk1.mp3",Walk2:"assets/sound/Walk2.mp3",Win:"assets/sound/Win.mp3"},spine:{female:{skeleton:"assets/spine/female/skeleton.png"},female_win:{skeleton:"assets/spine/female_win/skeleton.png"},fight_cloud:{skeleton:"assets/spine/fight_cloud/skeleton.png"},hit:{skeleton:"assets/spine/hit/skeleton.png"},male:{skeleton:"assets/spine/male/skeleton.png"},male_win:{skeleton:"assets/spine/male_win/skeleton.png"},monster_blue:{skeleton:"assets/spine/monster_blue/skeleton.png"},monster_green:{skeleton:"assets/spine/monster_green/skeleton.png"},monster_orange:{skeleton:"assets/spine/monster_orange/skeleton.png"},norti:{skeleton:"assets/spine/norti/skeleton.png"},play:{skeleton:"assets/spine/play/skeleton.png"},skin_btn:{skeleton:"assets/spine/skin_btn/skeleton.png"},title:{skeleton:"assets/spine/title/skeleton.png"},toilet:{skeleton:"assets/spine/toilet/skeleton.png"}},test:"assets/test.glb",_solve:"assets/_solve.py"};var ee={names:{female:"female",female_win:"female_win",fight_cloud:"fight_cloud",hit:"hit",male:"male",male_win:"male_win",monster_blue:"monster_blue",monster_green:"monster_green",monster_orange:"monster_orange",norti:"norti",play:"play",skin_btn:"skin_btn",title:"title",toilet:"toilet"},female:{slots:{"lady/Layer 1":"lady/Layer 1","lady/Shape 10":"lady/Shape 10","lady/Layer 4":"lady/Layer 4","lady/Layer22":"lady/Layer22","lady/Rectangle 1":"lady/Rectangle 1","lady/Shape 59 copy":"lady/Shape 59 copy","lady/Shape 63 copy":"lady/Shape 63 copy","lady/Shape 63 copy 2":"lady/Shape 63 copy 2","lady/Shape 8 copy":"lady/Shape 8 copy","lady/Shape 8 copy2":"lady/Shape 8 copy2","lady/Shape 7 copy 4":"lady/Shape 7 copy 4","lady/Shape 7 copy 5":"lady/Shape 7 copy 5","lady/Shape 56 copy":"lady/Shape 56 copy","lady/Shape 72":"lady/Shape 72","lady/rope":"lady/rope","lady/Shape 5":"lady/Shape 5","lady/choang":"lady/choang","lady/Layer 2":"lady/Layer 2","lady/Shape 24":"lady/Shape 24","lady/Shape 4":"lady/Shape 4","lady/Shape 3":"lady/Shape 3","lady/Layer 3":"lady/Layer 3","lady/Layer 5":"lady/Layer 5","lady/Shape 6":"lady/Shape 6",bone46:"bone46","lady/Layer 2 copy":"lady/Layer 2 copy",noel:"noel","lady/Shape 58 copy 2":"lady/Shape 58 copy 2","lady/Shape 71 copy":"lady/Shape 71 copy","lady/choang2":"lady/choang2"},skins:{lady:"lady",lady1:"lady1",lady2:"lady2",lady3:"lady3",lady4:"lady4",lady5:"lady5",lady6:"lady6",lady7:"lady7",lady8:"lady8"},anims:{choang:"choang",gethit:"gethit",idle:"idle",run:"run",slide:"slide",slide_main_menu:"slide_main_menu"}},female_win:{slots:{"lady_win/Shape 56 copy":"lady_win/Shape 56 copy","lady_win/Shape 72":"lady_win/Shape 72","lady_win/Shape 7 copy 5":"lady_win/Shape 7 copy 5","lady_win/Rectangle 1":"lady_win/Rectangle 1","lady_win/Shape 59 copy":"lady_win/Shape 59 copy","lady_win/Shape 42":"lady_win/Shape 42","lady_win/Shape 63 copy 2":"lady_win/Shape 63 copy 2","lady_win/Shape 63 copy":"lady_win/Shape 63 copy","lady_win/Shape 7 copy 4":"lady_win/Shape 7 copy 4","lady_win/Layer 6 copy 2":"lady_win/Layer 6 copy 2",noel:"noel","lady_win/Shape 71 copy":"lady_win/Shape 71 copy","lady_win/Shape 58 copy 2":"lady_win/Shape 58 copy 2","lady/Screenshot_2":"lady/Screenshot_2"},skins:{lady_win:"lady_win",lady_win1:"lady_win1",lady_win2:"lady_win2",lady_win3:"lady_win3",lady_win4:"lady_win4",lady_win5:"lady_win5",lady_win6:"lady_win6",lady_win7:"lady_win7",lady_win8:"lady_win8"},anims:{idle:"idle"}},fight_cloud:{slots:{fight_clound:"fight_clound"},skins:{default:"default"},anims:{animation:"animation"}},hit:{slots:{gethit_small:"gethit_small"},skins:{default:"default"},anims:{animation:"animation"}},male:{slots:{"char/Shape 8 copy":"char/Shape 8 copy","char/Shape 7":"char/Shape 7","char/Shape 5":"char/Shape 5","char/Shape 4":"char/Shape 4","char/Shape 24":"char/Shape 24","char/Shape 3":"char/Shape 3","char/rope":"char/rope","char/Layer 1":"char/Layer 1","char/Layer 2":"char/Layer 2","char/Layer 4":"char/Layer 4","char/Shape 10":"char/Shape 10","char/Shape 6":"char/Shape 6","fx/choang":"fx/choang","char/noel":"char/noel",noel:"noel"},skins:{char:"char",char1:"char1",char2:"char2",char3:"char3",char4:"char4",char5:"char5",char6:"char6",char7:"char7",char8:"char8",char9:"char9",char10:"char10",char11:"char11"},anims:{fall:"fall",gethit:"gethit",idle:"idle",run:"run",slide:"slide",slide_main_menu:"slide_main_menu",stune:"stune"}},male_win:{slots:{"char_win/Shape 5 copy":"char_win/Shape 5 copy","char_win/Shape 4 copy":"char_win/Shape 4 copy","char_win/Shape 10 copy 2-1":"char_win/Shape 10 copy 2-1","char_win/Shape 24 copy":"char_win/Shape 24 copy","char_win/Shape 6 copy":"char_win/Shape 6 copy","char_win/Shape 10 copy 2":"char_win/Shape 10 copy 2","char_win/Shape 3 copy":"char_win/Shape 3 copy","char_win/Layer 6":"char_win/Layer 6","char_win/Shape 42":"char_win/Shape 42","char_win/hand":"char_win/hand","char_win/Shape 3":"char_win/Shape 3",noel:"noel"},skins:{char_win:"char_win",char_win1:"char_win1",char_win2:"char_win2",char_win3:"char_win3",char_win4:"char_win4",char_win5:"char_win5",char_win6:"char_win6",char_win7:"char_win7",char_win8:"char_win8",char_win9:"char_win9",char_win10:"char_win10",char_win11:"char_win11"},anims:{ohyeah:"ohyeah"}},monster_blue:{slots:{"monster_blue/thign_r":"monster_blue/thign_r","monster_blue/shin_r":"monster_blue/shin_r","monster_blue/uper_arm_r":"monster_blue/uper_arm_r","monster_blue/lower_Arm_r":"monster_blue/lower_Arm_r","monster_blue/torso":"monster_blue/torso","monster_blue/dau":"monster_blue/dau","monster_blue/thign_l":"monster_blue/thign_l","monster_blue/uper_arm_l":"monster_blue/uper_arm_l","monster_blue/shin_l":"monster_blue/shin_l","monster_blue/lower_arm_l":"monster_blue/lower_arm_l"},skins:{default:"default"},anims:{idle:"idle",walk:"walk"}},monster_green:{slots:{"monster_green/Group 1":"monster_green/Group 1","monster_green/Shape 55":"monster_green/Shape 55","monster_green/Group 10":"monster_green/Group 10","monster_green/Group 3":"monster_green/Group 3","monster_green/Group 11":"monster_green/Group 11","monster_green/Shape 37":"monster_green/Shape 37","monster_green/Shape 43":"monster_green/Shape 43","monster_green/Group 4":"monster_green/Group 4","monster_green/Group 13":"monster_green/Group 13","monster_green/Group 12":"monster_green/Group 12","monster_green/Shape 54":"monster_green/Shape 54","monster_green/Group 2":"monster_green/Group 2"},skins:{default:"default"},anims:{idle:"idle",walk:"walk"}},monster_orange:{slots:{"monster_orange/Shape 66":"monster_orange/Shape 66","monster_orange/Shape 65":"monster_orange/Shape 65","monster_orange/Group 10":"monster_orange/Group 10","monster_orange/Group 9":"monster_orange/Group 9","monster_orange/Shape 58":"monster_orange/Shape 58","monster_orange/Shape 69 copy 15":"monster_orange/Shape 69 copy 15","monster_orange/Shape 69 copy 25":"monster_orange/Shape 69 copy 25","monster_orange/Shape 63":"monster_orange/Shape 63","monster_orange/Shape 64":"monster_orange/Shape 64","monster_orange/Shape 68":"monster_orange/Shape 68","monster_orange/Group 7":"monster_orange/Group 7","monster_orange/Group 8":"monster_orange/Group 8","monster_orange/Group 6":"monster_orange/Group 6"},skins:{default:"default"},anims:{idle:"idle",walk:"walk"}},norti:{slots:{"PNG/norti/norti":"PNG/norti/norti"},skins:{default:"default"},anims:{idle:"idle"}},play:{slots:{"play_button/Shape 5":"play_button/Shape 5","play_button/Shape 6":"play_button/Shape 6"},skins:{default:"default"},anims:{animation:"animation"}},skin_btn:{slots:{"skin_button/skins_btn":"skin_button/skins_btn"},skins:{default:"default"},anims:{animation:"animation"}},title:{slots:{"title/Layer 3":"title/Layer 3"},skins:{default:"default"},anims:{animation:"animation"}},toilet:{slots:{1:"1",2:"2",3:"3",4:"4",5:"5",6:"6"},skins:{skin1:"skin1",skin2:"skin2",skin3:"skin3",skin4:"skin4",skin5:"skin5",skin6:"skin6",skin7:"skin7"},anims:{idle:"idle"}}};var Rc=class extends Vt{init(){super.init()}start(){super.start()}loadSpine(){return $(this,null,function*(){let t=[];Object.keys(ee.names).forEach(e=>{t.push(`assets/spine/${e}/skeleton.json`)}),yield PIXI.Assets.load(t)})}loadSound(){return $(this,null,function*(){let t=Object.values(kt.sound);yield PIXI.Assets.load(t)})}getSpine(t){return PIXI.Assets.load(`assets/spine/${t}/skeleton.json`)}};var bd=class extends Vt{constructor(){super(...arguments);this.playing=!1}start(){fgui.UIConfig.defaultButtonSound=kt.sound.Button}playBGM(e){return $(this,null,function*(){e!=this.bgmPath&&(this.bgm&&this.bgm.stop(),this.bgmPath=e,this.bgm=yield this.play(e,!0))})}stopBGM(){this.bgm&&this.bgm.stop(),this.bgm=null,this.bgmPath=null}play(e,i=!1){return $(this,null,function*(){if(!e)debugger;let r=yield PIXI.Assets.load(e);return r.loop=i,yield this.$wait(()=>this.playing==!1),r.play(),this.playing=!0,this.$nextTick(()=>this.playing=!1),r})}};function ly(s,t){if(!!s){if(typeof s=="string")return Jg(s,t);var e=Object.prototype.toString.call(s).slice(8,-1);if(e==="Object"&&s.constructor&&(e=s.constructor.name),e==="Map"||e==="Set")return Array.from(s);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Jg(s,t)}}function Jg(s,t){(t==null||t>s.length)&&(t=s.length);for(var e=0,i=new Array(t);e<t;e++)i[e]=s[e];return i}function Mc(s,t){var e=typeof Symbol!="undefined"&&s[Symbol.iterator]||s["@@iterator"];if(e)return(e=e.call(s)).next.bind(e);if(Array.isArray(s)||(e=ly(s))||t&&s&&typeof s.length=="number"){e&&(s=e);var i=0;return function(){return i>=s.length?{done:!0}:{done:!1,value:s[i++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function km(s,t){if(isNaN(s)||s<=0)throw new Error('"'+t+'" must be a positive integer, but was '+s+" ("+typeof s+")")}var Bl=1e-10;function tx(s,t,e){return Math.abs(t-s)<Math.abs(e-s)?t:e}function Pm(s,t,e,i,r,n){return{x:tx(r,s,s+e),y:tx(n,t,t+i)}}function kc(s,t,e,i,r,n,l,a,o,h){for(var c=isNaN(o)?0:o,u=isNaN(h)?1:h,d=l-r,f=a-n,m,p,g=0,y=0,_=0,b=0,x,v,w,E=0,A=[1,2,3,4];E<A.length;E++){var T=A[E];if(T===1?(m=-1,p=0,x=-d,v=r-s):T===2?(m=1,p=0,x=d,v=s+e-r):T===3?(m=0,p=-1,x=-f,v=n-t):(m=0,p=1,x=f,v=t+i-n),x===0){if(v<=0)return[void 0,void 0,void 0,void 0,void 0,void 0]}else if(w=v/x,x<0){if(w>u)return[void 0,void 0,void 0,void 0,void 0,void 0];w>c&&(c=w,g=m,y=p)}else{if(w<c)return[void 0,void 0,void 0,void 0,void 0,void 0];w<u&&(u=w,_=m,b=p)}}return[c,u,g,y,_,b]}function hx(s,t,e,i,r,n,l,a){return{x:r-s-e,y:n-t-i,w:e+l,h:i+a}}function Nm(s,t,e,i,r,n){return r-s>Bl&&n-t>Bl&&s+e-r>Bl&&t+i-n>Bl}function cx(s,t,e,i,r,n,l,a){return s<r+l&&r<s+e&&t<n+a&&n<t+i}function Om(s,t,e,i,r,n,l,a){var o=s-r+(e-l)/2,h=t-n+(i-a)/2;return o*o+h*h}function ux(s,t,e,i,r,n,l,a,o,h){var c=isNaN(o)?s:o,u=isNaN(h)?t:h,d=c-s,f=u-t,m=hx(s,t,e,i,r,n,l,a),p=m.x,g=m.y,y=m.w,_=m.h,b,x,v,w;if(Nm(p,g,y,_,0,0)){var E=Pm(p,g,y,_,0,0),A=E.x,T=E.y,C=Math.min(e,Math.abs(A)),R=Math.min(i,Math.abs(T));w=-C*R,b=!0}else{var N=kc(p,g,y,_,0,0,d,f,-Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),P=N[0],M=N[1],D=N[2],q=N[3];P=P,!isNaN(P)&&P<1&&Math.abs(P-(M||0))>=Bl&&(0<P+Bl||P===0&&(M||0)>0)&&(w=P,x=D,v=q,b=!1)}if(!isNaN(w)){var X,O;if(b)if(d===0&&f===0){var L=Pm(p,g,y,_,0,0),B=L.x,W=L.y;Math.abs(B)<Math.abs(W)?W=0:B=0,x=Math.sign(B),v=Math.sign(W),X=s+B,O=t+W}else{var j=kc(p,g,y,_,0,0,d,f,-Number.MAX_SAFE_INTEGER,1),V=j[0],U=j[2],st=j[3];if(x=U,v=st,!V)return;X=s+d*V,O=t+f*V}else X=s+d*w,O=t+f*w;return{overlaps:b,ti:w,move:{x:d,y:f},normal:{x,y:v},touch:{x:X,y:O},itemRect:{x:s,y:t,w:e,h:i},otherRect:{x:r,y:n,w:l,h:a}}}}function hy(s,t,e){return[(t-1)*s,(e-1)*s]}function yd(s,t,e){return[Math.floor(t/s)+1,Math.floor(e/s)+1]}function ex(s,t,e,i){var r=i-e;return r>0?[1,s/r,((t+r)*s-e)/r]:r<0?[-1,-s/r,((t+r-1)*s-e)/r]:[0,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER]}function cy(s,t,e,i,r,n){var l=yd(s,t,e),a=l[0],o=l[1],h=yd(s,i,r),c=h[0],u=h[1],d=ex(s,a,t,i),f=d[0],m=d[1],p=d[2],g=ex(s,o,e,r),y=g[0],_=g[1],b=g[2],x=a,v=o;n(x,v);do if(p<b){var w=[p+m,x+f];p=w[0],x=w[1],n(x,v)}else p==b&&n(x+f,v),b=b+_,v=v+y,n(x,v);while(Math.abs(x-c)+Math.abs(v-u)>1);(x!=c||v!=u)&&n(c,u)}function Fl(s,t,e,i,r){var n=yd(s,t,e),l=n[0],a=n[1],o=Math.ceil((t+i)/s),h=Math.ceil((e+r)/s);return[l,a,o-l+1,h-a+1]}function sx(s,t,e){if(typeof t!==s)throw new Error('"'+e+'" must be a '+s+", but was a "+t+" ("+typeof t+")")}function _d(s,t,e,i){sx("number",s,"x"),sx("number",t,"y"),km(e,"w"),km(i,"h")}function ix(s,t,e,i,r,n,l,a,o){return{x:t.touch.x,y:t.touch.y,collisions:[]}}function rx(s,t,e,i,r,n,l,a,o){var h=s.project(t.item,e,i,r,n,l,a,o);return{x:l,y:a,collisions:h}}function nx(s,t,e,i,r,n,l,a,o){var h=isNaN(l)?e:l,c=isNaN(a)?i:a,u=t.touch,d=t.move;(d.x!==0||d.y!==0)&&(t.normal.x!==0?h=u.x:c=u.y),t.slide={x:h,y:c};var f=u.x,m=u.y,p=s.project(t.item,f,m,r,n,h,c,o);return{x:h,y:c,collisions:p}}function ox(s,t,e,i,r,n,l,a,o){var h=isNaN(l)?e:l,c=isNaN(a)?i:a,u=t.touch,d=t.move,f=u.x,m=u.y;if(d.x!==0||d.y!==0){var p=h-u.x,g=c-u.y;t.normal.x===0?g=-g:p=-p,f=u.x+p,m=u.y+g}t.bounce={x:f,y:m};var y=s.project(t.item,u.x,u.y,r,n,f,m,o);return{x:f,y:m,collisions:y}}function uy(s,t){if(s.ti===t.ti){var e=s.itemRect,i=s.otherRect,r=t.otherRect,n=Om(e.x,e.y,e.w,e.h,i.x,i.y,i.w,i.h),l=Om(e.x,e.y,e.w,e.h,r.x,r.y,r.w,r.h);return n-l}return s.ti-t.ti}function ax(){return"slide"}function dy(s,t){return s.weight-t.weight}function fy(s,t,e,i,r){var n=[],l={};return cy(s.cellSize,t,e,i,r,function(a,o){var h=s.rows[o];if(!!h){var c=h[a];!c||l[c.ID]||(l[c.ID]=!0,n.push(c))}}),n}function lx(s,t,e,i,r,n){for(var l=fy(s,t,e,i,r),a,o,h,c,u,d,f,m={},p=[],g=Mc(l),y;!(y=g()).done;){var _=y.value;if(_!=null&&_.items)for(var b=0,x=Object.keys(_.items);b<x.length;b++){var v=x[b];if(!m[v]&&(m[v]=!0,!n||n(v))){a=s.rects[v],o=a.x,h=a.y,c=a.w,u=a.h;var w=kc(o,h,c,u,t,e,i,r,0,1);if(d=w[0],f=w[1],!isNaN(d)&&(0<d&&d<1||0<f&&f<1)){var E=kc(o,h,c,u,t,e,i,r,-Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),A=E[0],T=E[1];p.push({item:v,ti1:d,ti2:f,weight:Math.min(A||0,T||0)})}}}}return p.sort(dy)}var my=function(){function s(e){this.responses={},this.cellSize=0,this.cellSize=e.cellSize,this.rects=e.rects,this.rows=e.rows,this.nonEmptyCells=e.nonEmptyCells,this.responses=e.responses}var t=s.prototype;return t.addResponse=function(i,r){this.responses[i]=r},t.getResponseByName=function(i){var r=this.responses[i];if(!r)throw new Error("Unknown collision type: "+i+" ("+typeof i+")");return r},t.project=function(i,r,n,l,a,o,h,c){_d(r,n,l,a);var u=isNaN(o)?r:o,d=isNaN(h)?n:h,f=c||ax,m=[],p={};i&&(p[i]=!0);for(var g=Math.min(u,r),y=Math.min(d,n),_=Math.max(u+l,r+l),b=Math.max(d+a,n+a),x=_-g,v=b-y,w=Fl(this.cellSize,g,y,x,v),E=w[0],A=w[1],T=w[2],C=w[3],R=this.getDictItemsInCellRect(E,A,T,C),N=0,P=Object.keys(R);N<P.length;N++){var M=P[N];if(!p[M]){p[M]=!0;var D=f(i,M);if(D&&this.hasItem(M)){var q=this.getRect(M),X=ux(r,n,l,a,q.x,q.y,q.w,q.h,u,d);X&&(X.other=M,X.item=i,X.type=D,m.push(X))}}}return m.sort(uy)},t.countCells=function(){for(var i=0,r=Mc(this.rows.filter(function(c){return!!c})),n;!(n=r()).done;)for(var l=n.value,a=Mc(l),o;!(o=a()).done;){var h=o.value;h&&i++}return i},t.hasItem=function(i){return!!this.rects[i]},t.getItems=function(){var i=this;return Object.keys(this.rects).map(function(r){return i.rects[r]})},t.countItems=function(){return Object.keys(this.rects).length},t.addItemToCell=function(i,r,n){this.rows[n]=this.rows[n]||[];var l=this.rows[n];l[r]||(l[r]={ID:"Cell_"+Math.ceil(Math.random()*Date.now()).toString(36),x:r,y:n,items:{}});var a=l[r];this.nonEmptyCells[a.ID]=!0,a.items[i]||(a.items[i]=!0)},t.getRect=function(i){var r=this.rects[i];if(!r)throw new Error('Item "'+i+'" must be added to the world before getting its rect. Use world:add(item, x,y,w,h) to add it first.');return{x:r.x,y:r.y,w:r.w,h:r.h}},t.getDictItemsInCellRect=function(i,r,n,l){for(var a={},o=r;o<=r+l-1;o++){var h=this.rows[o];if(h)for(var c=i;c<=i+n-1;c++){var u,d=h[c];if(d!=null&&d.items&&((u=Object.keys(d.items))==null?void 0:u.length)>0)for(var f=0,m=Object.keys(d.items);f<m.length;f++){var p=m[f];a[p]=!0}}}return a},t.removeItemFromCell=function(i,r,n){var l,a,o,h=this.rows[n];if(!(h!=null&&(l=h[r])!=null&&(a=l.items)!=null&&a[i]))return!1;var c=h[r];return delete c.items[i],((o=Object.keys(c.items))==null?void 0:o.length)===0&&delete this.nonEmptyCells[c.ID],!0},t.toWorld=function(i,r){return hy(this.cellSize,i,r)},t.toCell=function(i,r){return yd(this.cellSize,i,r)},t.queryRect=function(i,r,n,l,a){_d(i,r,n,l);for(var o=Fl(this.cellSize,i,r,n,l),h=o[0],c=o[1],u=o[2],d=o[3],f=this.getDictItemsInCellRect(h,c,u,d),m=[],p=0,g=Object.keys(f);p<g.length;p++){var y=g[p];(!a||a(y))&&cx(i,r,n,l,this.rects[y].x,this.rects[y].y,this.rects[y].w,this.rects[y].h)&&m.push(y)}return m},t.queryPoint=function(i,r,n){for(var l=this.toCell(i,r),a=l[0],o=l[1],h=this.getDictItemsInCellRect(a,o,1,1),c=[],u=0,d=Object.keys(h);u<d.length;u++){var f=d[u];(!n||n(f))&&Nm(this.rects[f].x,this.rects[f].y,this.rects[f].w,this.rects[f].h,i,r)&&c.push(f)}return c},t.querySegment=function(i,r,n,l,a){var o=lx(this,i,r,n,l,a),h=[];if(o)for(var c=Mc(o),u;!(u=c()).done;){var d=u.value;h.push(d.item)}return h},t.querySegmentWithCoords=function(i,r,n,l,a){for(var o=lx(this,i,r,n,l,a),h=n-i,c=l-r,u,d,f,m=Mc(o),p;!(p=m()).done;){var g=p.value;u=g,d=u.ti1,f=u.ti2,u.weight=null,u.x1=i+h*d,u.y1=r+c*d,u.x2=i+h*f,u.y2=r+c*f}return o},t.add=function(i,r,n,l,a){var o=this.rects[i];if(o)throw new Error('Item "'+i+'" added to the world twice.');_d(r,n,l,a),this.rects[i]={x:r,y:n,w:l,h:a};for(var h=Fl(this.cellSize,r,n,l,a),c=h[0],u=h[1],d=h[2],f=h[3],m=u;m<u+f;m++)for(var p=c;p<c+d;p++)this.addItemToCell(i,p,m);return i},t.remove=function(i){var r=JSON.parse(JSON.stringify(this.getRect(i)));delete this.rects[i];for(var n=Fl(this.cellSize,r.x,r.y,r.w,r.h),l=n[0],a=n[1],o=n[2],h=n[3],c=a;c<a+h;c++)for(var u=l;u<l+o;u++)this.removeItemFromCell(i,u,c)},t.update=function(i,r,n,l,a){var o=this.getRect(i);if(l=isNaN(l)?o.w:l,a=isNaN(a)?o.h:a,_d(r,n,l,a),o.x!=r||o.y!=n||o.w!=l||o.h!=a){var h=Fl(this.cellSize,o.x,o.y,o.w,o.h),c=h[0],u=h[1],d=h[2],f=h[3],m=Fl(this.cellSize,r,n,l,a),p=m[0],g=m[1],y=m[2],_=m[3];if(c!=p||u!=g||d!=y||f!=_){for(var b=c+d-1,x=u+f-1,v=p+y-1,w=g+_-1,E,A=u;A<=x;A++){E=Number(A)<g||A>w;for(var T=c;T<=b;T++)(E||T<p||T>v)&&this.removeItemFromCell(i,T,A)}for(var C=g;C<=w;C++){E=C<u||C>x;for(var R=p;R<=v;R++)(E||R<c||R>b)&&this.addItemToCell(i,R,C)}}var N=this.rects[i];N.x=r,N.y=n,N.w=l,N.h=a}},t.move=function(i,r,n,l){var a=this.check(i,r,n,l),o=a.x,h=a.y,c=a.collisions;return this.update(i,o,h),{x:o,y:h,collisions:c}},t.check=function(i,r,n,l){var a,o=r,h=n,c=l||ax,u={};u[i]=!0;for(var d=function(A,T){return u[T]?!1:c(A,T)},f=[],m=this.getRect(i),p=this.project(i,m.x,m.y,m.w,m.h,o,h,d),g=((a=p)==null?void 0:a.length)||0;g>0;){var y=p[0];f.push(y),u[y.other]=!0;var _=this.getResponseByName(y.type),b=_(this,y,m.x,m.y,m.w,m.h,o,h,d),x=b.x,v=b.y,w=b.collisions;o=x,h=v,p=w,g=(w==null?void 0:w.length)||0}return{x:o,y:h,collisions:f}},s}(),py={newWorld:function(t){t=t||64,km(t,"cellSize");var e=new my({cellSize:t,rects:{},rows:[],nonEmptyCells:{},responses:{}});return e.addResponse("touch",ix),e.addResponse("cross",rx),e.addResponse("slide",nx),e.addResponse("bounce",ox),e},rect:{getNearestCorner:Pm,getSegmentIntersectionIndices:kc,getDiff:hx,containsPoint:Nm,isIntersecting:cx,getSquareDistance:Om,detectCollision:ux},responses:{touch:ix,cross:rx,slide:nx,bounce:ox}},gy=Object.freeze(py),dx=gy;var Oc=Io(wd());var Hr={width:900,height:1600},Fm="draw_to_pee",Ed=200;function Bm(s,t){let e=s.indexOf(t);return e==-1?null:s.splice(e,1)[0]}function qr(s){return s[Math.floor(Math.random()*s.length)]}var Ki=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","monster_obj")}onConstruct(){this.m_type=this.getControllerAt(0)}};Ki.URL="ui://j8b2cwkb84is8r";var Zi=class extends fgui.GLabel{static createInstance(){return fgui.UIPackage.createObject("main","move_obj")}onConstruct(){this.m_bg=this.getChildAt(0)}};Zi.URL="ui://j8b2cwkblcub8u";var Ti=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","player_slot")}onConstruct(){this.m_type=this.getControllerAt(0)}};Ti.URL="ui://j8b2cwkbkmld8c";var Qi=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","toilet_door")}onConstruct(){this.m_type=this.getControllerAt(0)}};Qi.URL="ui://j8b2cwkbkmld8b";var Ji=class extends fgui.GLabel{static createInstance(){return fgui.UIPackage.createObject("main","token_obj")}onConstruct(){this.m_bg=this.getChildAt(0)}};Ji.URL="ui://j8b2cwkblcub8z";var tr=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","trigger_door_obj")}onConstruct(){this.m_type=this.getControllerAt(0)}};tr.URL="ui://j8b2cwkblcub8w";var er=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","trigger_obj")}onConstruct(){this.m_type=this.getControllerAt(0),this.m_state=this.getControllerAt(1),this.m_down=this.getChildAt(0),this.m_up=this.getChildAt(1)}};er.URL="ui://j8b2cwkblcub8v";var sr=class extends fgui.GLabel{static createInstance(){return fgui.UIPackage.createObject("main","wall_obj")}onConstruct(){this.m_bg=this.getChildAt(0)}};sr.URL="ui://j8b2cwkb84is8o";function xy(s,t,e,i){PIXI.Assets?_y(s,t,e):by(s,t,e,i)}function by(s,t,e,i){let r={loadType:PIXI.LoaderResource.LOAD_TYPE.XHR,xhrType:PIXI.LoaderResource.XHR_RESPONSE_TYPE.BUFFER},n=new fgui.utils.AssetLoader;if(s.includes(",")){let l=s.split(","),a=t.split(",");for(let o=0;o<l.length;o++)n.add(l[o],a[o],a[o].endsWith(".txt")?r:null)}else n.add(s,t,t.endsWith(".txt")?r:null);return i&&n.onProgress.add((...l)=>{console.log("\u662F\u5426\u6709\u8FC7\u7A0B\u8FD4\u56DE",l),i(...l)}),e&&n.onComplete.add((l,a)=>{e(a),n.destroy()}),n.load(),n}function _y(s,t,e,i){let r=PIXI.Assets;if(s.includes(",")){let n=s.split(","),l=t.split(",");for(let a=0;a<n.length;a++)r.add(n[a],l[a]);r.load(n).then(a=>{e&&e(a)})}else r.add(s,t),r.load(s).then(n=>{console.log("load done",n),e&&e(n)})}function fx(s,t){return new Promise((e,i)=>{xy(s,t,r=>{s.includes(",")?e(r):e(r[s]||r)})})}function yy(s){fgui.UIObjectFactory.setPackageItemExtension(s.URL,s)}var Ad=class extends Vt{constructor(){super(...arguments);this.binds=[];this.config={designWidth:900,designHeight:1600,orientation:"auto",packages:[]};this.domElements=[]}get view(){return fgui.GRoot.inst.numChildren>0&&fgui.GRoot.inst.getChildAt(0)}setupFgui(){fgui.GRoot.inst.attachTo(this.game.render2d.app,{designWidth:this.config.designWidth,designHeight:this.config.designHeight,scaleMode:"exactFit",orientation:this.config.orientation,initliazeHTMLInput:!1,alignV:0,alignH:3}),this.game.render2d&&(this.game.render2d.canvas.addEventListener("pointermove",i=>{fgui.GRoot.globalMouseStatus.mouseX=i.clientX,fgui.GRoot.globalMouseStatus.mouseY=i.clientY}),this.game.render2d.canvas.addEventListener("pointerdown",i=>{fgui.GRoot.globalMouseStatus.touchDown=!0}),this.game.render2d.canvas.addEventListener("pointerup",i=>{fgui.GRoot.globalMouseStatus.touchDown=!1}),this.game.render2d.canvas.addEventListener("mouseout",i=>{fgui.GRoot.globalMouseStatus.touchDown=!1}),this.game.render2d.ev.on("render",i=>{i.render(fgui.GRoot.inst.$container)}));let e=Y.inst;this.ev.on("loaded",()=>this.doResize(window.innerWidth,window.innerHeight)),e.ev.on("resize",()=>this.doResize(window.innerWidth,window.innerHeight)),e.ev.on("render",()=>{for(let i of this.domElements){let r=i.obj.parent.parent,n=i.el;n.style.left=`${(r.x+i.obj.x)*fgui.GRoot.inst.scaleX}px`,n.style.top=`${(r.y+i.obj.y)*fgui.GRoot.inst.scaleY}px`}})}doResize(e=window.innerWidth,i=window.innerHeight){if(this.game.render2d.app.renderer.resize(e,i),this.view){let r=e<i?e/Hr.width:i/Hr.height;this.view.setSize(e/r,i/r),fgui.GRoot.inst.scaleX=r,fgui.GRoot.inst.scaleY=r}}loadPackages(e){return $(this,null,function*(){let i=[],r=[],n,l=[];for(let a of this.config.packages)if(a.mode==e){i.push(a.name),r.push(a.path),l.push(a.name),a.mode=="entry"&&(n=a.name);for(let o of a.res)r.push(o.path),i.push(o.name);a.binder.bindAll()}yield fx(i.join(","),r.join(","));for(let a of l)fgui.UIPackage.addPackage(a);this.bindExtension(),n&&this.setupCurrentView(n)})}setupCurrentView(e){let r=this.config.packages.find(n=>n.name==e).cls.createInstance();fgui.GRoot.inst.addChild(r),r.relations.add(fgui.GRoot.inst,24),this.doResize(window.innerWidth,window.innerHeight)}changePackageTo(e){this.view&&this.view.dispose(),this.setupCurrentView(e)}bindExtension(){for(let e of this.binds)yy(e)}init(){return $(this,null,function*(){this.setupFgui(),yield this.loadPackages("entry"),this.ev.emit("loaded")})}};function Id(){let s=window.innerWidth,t=window.innerHeight;return s<t?s/Hr.width:t/Hr.height}function Fe(s,t=0,e=0){let i=s.localToGlobal(t,e),r=Id();return new PIXI.Point(i.x/r,i.y/r)}function mx(s,t,e){let i=Id();return s.globalToLocal(t*i,e*i,new PIXI.Point)}var fe=class extends Is{constructor(){super(...arguments);this.width=0;this.height=0;this.shrink=1;this.cx=0;this.cy=0;this.idExt=""}bindView(e){this.view=e,this.createAnim(),this.createAABB(),this.bindEvents()}bindEvents(){}unbindEvents(){}createAnim(){return $(this,null,function*(){})}createAABB(){let e=this.view.rotation;this.view.rotation=0;let i=Fe(this.view),r=Fe(this.view,this.view.width*.5,this.view.height*.5);if(this.cx=r.x,this.cy=r.y,this.view.rotation=e,this.width=(r.x-i.x)*2*this.shrink,this.height=(r.y-i.y)*2*this.shrink,Math.abs(e%180)==90){let n=this.height;this.height=this.width,this.width=n}this.game.gameplay.world.add(this.id+this.idExt,r.x-this.width*.5,r.y-this.height*.5,this.width,this.height),this.game.gameplay.regObjectToWorld(this)}botCenterToLeftTop(e,i){let r=e-this.width*.5*this.shrink,n=i-this.height*.5-this.height*.5*this.shrink;return[r,n]}leftTopToBotCenter(e,i){let r=e+this.width*.5*this.shrink,n=i+this.height*.5+this.height*.5*this.shrink;return[r,n]}destroyAABB(){this.game.gameplay.world.hasItem(this.id+this.idExt)&&this.game.gameplay.world.remove(this.id+this.idExt)}dispose(){this.unbindEvents(),super.dispose()}};var Ll=class extends fe{bindView(e){this.view=e,this.type=this.view.m_type.selectedPage,this.createAABB()}onTrigger(){this.destroyAABB(),new TWEEN.Tween(this.view).to({alpha:0},1e3).start()}dispose(){this.destroyAABB(),this.view.dispose(),super.dispose()}};var Si=class extends fe{constructor(){super(...arguments);this.used=!1;this.idExt="_click"}bindView(e){this.view=e,this.type=e.m_type.selectedPage,this.createAABB(),this.createAnim()}createAnim(){return $(this,null,function*(){if(!Y.inst.profile.data.skin_toilet)return;let e=Y.inst.profile.getSkinConfig("toilet");this.anim=yield this.game.ui.bindSpineToCom("toilet",this.view.getChildAt(0),1),this.anim.skeleton.setSkinByName(e.skin),this.anim.state.setAnimation(0,"idle",!0),this.anim.scale.set(.6)})}dispose(){this.destroyAABB(),this.view.dispose(),super.dispose()}};var zr=class extends fe{constructor(){super(...arguments);this.used=!1}bindView(e){this.view=e,this.type=this.view.m_type.selectedPage,this.createAABB()}onTouch(){this.used=!0,this.view.m_state.selectedPage="down",this.destroyAABB()}dispose(){this.destroyAABB(),this.view.dispose(),super.dispose()}};var Ul=class{constructor(t=[]){this.points=[];this.lengthList=[];this.distance=0;t.forEach(e=>{this.addPoint(e[0],e[1])})}addPoint(t,e){let i=[t,e],r=this.getLastPoint()||i;this.points.push(i);let n=this.getPointsDist(r,i);this.distance+=n,this.lengthList.push(this.distance)}getLastPoint(){return this.points[this.points.length-1]}getFirstPoint(){return this.points[0]}getPointsDist(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}getPointAt(t){if(t>=1)return this.getLastPoint();let e=t*this.distance,i=0;for(;this.lengthList[i+1]<e;)i+=1;let r=this.lengthList[i],n=this.lengthList[i+1],l=(e-r)/(n-r),a=this.points[i],o=this.points[i+1],h=a[0]+(o[0]-a[0])*l,c=a[1]+(o[1]-a[1])*l;return[h,c]}};var Kr=class extends Is{constructor(){super(...arguments);this.path=new Ul;this.color=65280;this.onTouchMove=(e,i)=>{this.pen.moveTo(this.cx,this.cy),this.pen.lineTo(e,i),this.cx=e,this.cy=i,this.path.addPoint(e,i)}}start(e,i){this.root=this.game.gameplay.view.m_stage.displayObject,this.pen=new PIXI.Graphics,this.pen.zIndex=-1,this.root.addChildAt(this.pen,0),this.pen.lineStyle({width:24,color:this.color,join:PIXI.LINE_JOIN.ROUND,cap:PIXI.LINE_CAP.ROUND}),this.cx=e,this.cy=i,this.pen.moveTo(e,i),this.bindEvents()}bindEvents(){this.game.gameplay.ev.on("move",this.onTouchMove),Y.inst.sound.play(kt.sound.Drawing1).then(e=>{this.sound=e})}unbindEvent(){var e;this.game.gameplay.ev.off("move",this.onTouchMove),(e=this.sound)==null||e.stop()}dispose(){var e;this.unbindEvent(),(e=this.pen)==null||e.destroy(),super.dispose()}};var hi=class extends fe{constructor(){super(...arguments);this.pen=new Kr;this.ready=!1;this.arrived=!1;this.paths=[];this.width=0;this.height=0;this.shrink=.5;this.speed=Ed;this.totalDistance=0;this.prevX=0;this.stopped=!1;this.stopMove=()=>{this.stopped=!0,console.log("\u505C\u6B62\u79FB\u52A8\uFF01"),this.currentPath=null,this.paths=[],this.unbindEvents()};this.moveFilter=(e,i)=>{if(i.endsWith("_click"))return!1;let r=this.game.gameplay.objects[i],n=this.game.gameplay.objects[e];return!r||r instanceof Si?!1:r instanceof zr?(console.log("\u78B0\u649E\u5230\u4E86\u5F00\u5173\u4E86\uFF01\uFF01\uFF01"),"cross"):r==n?!1:"touch"}}startDraw(e,i){this.pen.color=this.type=="male"?170:11141120,this.pen.start(e,i)}bindView(e){this.view=e,this.type=this.view.m_type.selectedPage,this.createAnim(),this.createAABB(),this.bindEvents()}bindEvents(){this.game.gameplay.ev.on("stop",this.stopMove)}unbindEvents(){this.game.gameplay.ev.off("stop",this.stopMove)}createAnim(){return $(this,null,function*(){let e=Y.inst.profile.getSkinConfig(this.type);this.anim=yield this.game.ui.bindSpineToCom(this.type,this.view,1),this.anim.skeleton.setSkinByName(e.skin),this.anim.state.setAnimation(0,ee.male.anims.idle,!0),this.anim.scale.set(.6)})}createWinAnim(){return $(this,null,function*(){let e=Y.inst.profile.getSkinConfig(this.type),i=this.type=="male"?ee.male_win.anims.ohyeah:ee.female_win.anims.idle,r=yield this.game.ui.bindSpineToCom(this.type+"_win",this.view,1);r.skeleton.setSkinByName(e.skin_win),r.state.setAnimation(0,i,!0),r.scale.set(.6),r.position.set(this.toilet.view.x+this.toilet.view.width*.5,this.toilet.view.y+this.toilet.view.height),this.anim.destroy(),this.anim=r})}playHitAnim(){this.anim.state.setAnimation(0,"gethit",!1)}playMoveAnim(){this.anim.state.setAnimation(0,"run",!0)}playFallAnim(){let e=this.type=="male"?ee.male.anims.fall:ee.female.anims.choang;this.anim.state.setAnimation(0,e,!0)}createAABB(){let e=Fe(this.view),i=Fe(this.view,this.view.width*.5,this.view.height*.5);this.width=(i.x-e.x)*2,this.height=(i.y-e.y)*2,this.game.gameplay.world.add(this.id+"",i.x-this.width*.5*this.shrink,i.y-this.height*.5*this.shrink,this.width*this.shrink,this.height*this.shrink),this.game.gameplay.regObjectToWorld(this),this.game.gameplay.world.add(this.id+"_click",i.x-this.width*.5,i.y-this.height*.5,this.width,this.height)}startMove(e){return $(this,null,function*(){this.speed=e,this.playMoveAnim(),this.enableUpdate()})}calcPath(){let e=Fe(this.view.parent,this.anim.x,this.anim.y),i=new Ul([[e.x,e.y],this.pen.path.getFirstPoint()]),r=this.pen.path;this.currentPath=null,this.paths=[i,r],this.totalDistance=0,this.paths.forEach(n=>{this.totalDistance+=n.distance})}update(e){if(!this.currentPath&&this.paths.length>0&&(this.currentPath=this.paths.shift(),this.pathDuration=this.currentPath.distance/this.speed,this.pathTime=0),this.currentPath)if(this.pathTime+=e,this.pathTime>this.pathDuration)this.currentPath=null,this.paths.length==0&&this.onArrivedToToilet();else{let i=this.pathTime/this.pathDuration,r=this.currentPath.getPointAt(i),n=this.moveAnimToPos(r[0],r[1]);r[0]>this.prevX?this.anim.scale.x=Math.abs(this.anim.scale.x):this.anim.scale.x=-Math.abs(this.anim.scale.x),this.prevX=r[0],n?this.game.gameplay.onObjectColl(this,n[0]):this.checkArriveToilet()&&this.onArrivedToToilet()}}moveAnimToPos(e,i){let r=this.botCenterToLeftTop(e,i),n=this.game.gameplay.world.move(this.id+"",r[0],r[1],this.moveFilter);if(n.collisions.length>0)return n.collisions;let l=this.leftTopToBotCenter(n.x,n.y),a=mx(this.view.parent,l[0],l[1]);return this.anim.position.set(a.x,a.y),null}resetPen(){this.pen.dispose(),this.pen=new Kr}setReady(e){this.ready=!0,this.toilet=e,this.pen.unbindEvent(),this.game.gameplay.world.remove(this.id+"_click")}checkArriveToilet(){let e=Fe(this.toilet.view,this.toilet.view.width*.5,this.toilet.view.height*.5),i=Fe(this.view.parent,this.anim.x,this.anim.y);return Math.abs(e.x-i.x)+Math.abs(e.y-i.y)<80}onArrivedToToilet(){this.toilet.used?(this.stopMove(),this.resetPen(),this.playHitAnim(),Y.inst.gameplay.loseGame()):(this.toilet.used=!0,this.arrived=!0,this.stopMove(),this.resetPen(),this.createWinAnim())}dispose(){this.game.gameplay.world.remove(this.id+""),this.view.dispose(),this.view=null,this.anim.destroy(),this.anim=null,this.pen&&this.pen.dispose(),this.pen=null,this.unbindEvents(),super.dispose()}};var Dl=class extends fe{constructor(){super(...arguments);this.speed=0;this.range=600;this.stopped=!0;this.shrink=1;this.stopMove=()=>{this.game.gameplay.ev.off("stop",this.stopMove),this.game.gameplay.ev.off("start",this.startMove),this.stopped=!0};this.startMove=()=>{this.stopped=!1}}bindView(e){this.view=e,this.type=this.view.m_type.selectedPage,this.type=="green"?(this.speed=50,this.name=ee.names.monster_green,this.sounds=[kt.sound.Greenxuathien1,kt.sound.Greenxuathien2]):this.type=="blue"?(this.speed=80,this.name=ee.names.monster_blue,this.sounds=[kt.sound.Bluexuathien1,kt.sound.Bluexuathien2]):this.type=="orange"&&(this.name=ee.names.monster_orange,this.speed=100,this.sounds=[kt.sound.Orangexuathien1,kt.sound.Orangexuathien2]),this.createAnim(),this.createAABB(),this.bindEvents()}bindEvents(){this.game.gameplay.ev.on("start",this.startMove),this.game.gameplay.ev.on("stop",this.stopMove),this.enableUpdate()}createAnim(){return $(this,null,function*(){this.anim=yield this.game.ui.bindSpineToCom(this.name,this.view,1),this.anim.scale.set(.6)})}update(e){this.stopped||(this.getNearestPlayer(),this.target?(this.action!=ee.monster_blue.anims.walk&&(this.action=ee.monster_blue.anims.walk,this.anim.state.setAnimation(0,this.action,!0)),this.moveToTarget(e)):this.action!=ee.monster_blue.anims.idle&&(this.action=ee.monster_blue.anims.idle,this.anim.state.setAnimation(0,this.action,!0)))}moveToTarget(e){let i=this.target.anim.x-this.anim.x,r=this.target.anim.y-this.anim.y,n=Math.sqrt(Math.pow(i,2)+Math.pow(r,2)),l=e*this.speed*i/n,a=e*this.speed*r/n;l>0?this.anim.scale.x=-Math.abs(this.anim.scale.x):this.anim.scale.x=Math.abs(this.anim.scale.x),this.anim.position.set(this.anim.position.x+l,this.anim.position.y+a);let o=this.botCenterToLeftTop(this.anim.position.x,this.anim.position.y),h=Fe(this.view.parent,o[0],o[1]);this.game.gameplay.world.update(this.id+this.idExt,h.x,h.y)}getNearestPlayer(){let e,i=1/0;Object.values(this.game.gameplay.objects).filter(n=>n instanceof hi&&!n.stopped).forEach(n=>{let l=Math.abs(n.anim.x-this.anim.x)+Math.abs(n.anim.y-this.anim.y);l<this.range&&l<i&&(i=l,e=n)}),this.target=e}dispose(){this.view.dispose(),this.anim.destroy(),this.unbindEvents(),super.dispose()}playHitSound(){this.game.sound.play(qr(this.sounds),!1)}};var Pc=class extends fe{constructor(){super(...arguments);this.stopped=!1;this.stopMove=()=>{this.stopped=!0,this.game.gameplay.ev.off("stop",this.stopMove)}}bindView(e){this.view=e,this.createAABB(),this.bindEvents()}bindEvents(){this.game.gameplay.ev.on("stop",this.stopMove),this.enableUpdate()}update(e){if(this.stopped)return;let i=this.view.rotation;this.view.rotation=0;let r=Fe(this.view),n=Fe(this.view,this.view.width*.5,this.view.height*.5);if(this.view.rotation=i,this.width=(n.x-r.x)*2,this.height=(n.y-r.y)*2,Math.abs(i%180)==90){let l=this.height;this.height=this.width,this.width=l}this.game.gameplay.world.update(this.id+this.idExt,n.x-this.width*.5,n.y-this.height*.5,this.width,this.height)}dispose(){this.stopMove(),super.dispose()}};var ir=class extends fe{constructor(){super(...arguments);this.pens=[];this.connects=[];this.linked=!1}bindView(e){this.view=e,this.createAABB()}startDraw(e,i){let r=new Kr;r.color=0,r.start(e,i),this.pens.push(r)}stopDraw(){this.pens[this.pens.length-1].unbindEvent()}resetPen(){this.pens.pop().dispose()}regConnect(e){this.connects.includes(e)||this.connects.push(e),e.connects.includes(this)||e.connects.push(this)}dispose(){this.pens.forEach(e=>{e.dispose()}),super.dispose()}getAllConnects(){let e=[this],i=r=>{r.connects.forEach(n=>{e.includes(n)||(e.push(n),i(n))})};return i(this),e}getCenterPos(){return Fe(this.view,this.view.width*.5,this.view.height*.5)}};var Vl=class extends fe{constructor(){super(...arguments);this.idExt="_click"}bindView(e){this.view=e,this.createAABB()}dispose(){this.destroyAABB(),this.view.dispose(),super.dispose()}};var rr=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","Game")}onConstruct(){this.m_status=this.getControllerAt(0),this.m_bg=this.getChildAt(0),this.m_title=this.getChildAt(1),this.m_game=this.getChildAt(2),this.m_win=this.getChildAt(3),this.m_lose=this.getChildAt(4),this.m_shop=this.getChildAt(5),this.m_setting=this.getChildAt(6),this.m_new=this.getChildAt(7),this.m_mask=this.getChildAt(8)}};rr.URL="ui://j8b2cwkbqrgtu";var Gl=class extends rr{onConstruct(){super.onConstruct(),this.bindEvents()}bindEvents(){}changeStateTo(t,...e){let i=new TWEEN.Tween(this.m_mask).to({alpha:0},200);new TWEEN.Tween(this.m_mask).to({alpha:1},200).onComplete(()=>{this.m_status.selectedPage=t,Y.inst.ui.ev.emit("stateChanged",t,...e),i.start()}).start()}};var Nc=class extends Vt{constructor(){super(...arguments);this.world=dx.newWorld(64);this.objects={};this.started=!1;this.pairs=[];this.roles=[];this.toilets=[]}get view(){return this.game.ui.view.m_game}start(){return $(this,null,function*(){this.bindEvents(),window.addEventListener("keypress",e=>{e.key==" "&&(Y.inst.enabled=!Y.inst.enabled)})})}regObjectToWorld(e){this.objects[e.id]=e}onTouchDown(e,i){this.hideTutorial(),this.world.queryPoint(e,i).forEach(a=>{console.log("\u70B9\u51FB\u6D4B\u8BD5",this.objects[a])}),console.log("-------------------");let l=this.world.queryPoint(e,i,a=>a.endsWith("_click")).find(a=>this.objects[a.substring(0,a.indexOf("_"))]instanceof hi);l&&(l=l.substring(0,l.indexOf("_")),this.target=this.objects[l],console.log("\u5F00\u59CB\u753B\u7EBF",this.target),this.target.ready||this.target.startDraw(e,i))}onTouchDownSP(e,i){this.hidePairLink(),this.world.queryPoint(e,i).forEach(a=>{console.log("\u70B9\u51FB\u6D4B\u8BD5",this.objects[a])}),console.log("-------------------");let l=this.world.queryPoint(e,i).find(a=>this.objects[a]instanceof ir);l&&(console.log("\u5F00\u59CB\u753B\u7EBF"),this.targetSP=this.objects[l],this.targetSP.startDraw(e,i))}onTouchMoveSP(e,i){if(!this.targetSP)return;let n=this.world.queryPoint(e,i).find(l=>this.objects[l]instanceof ir);if(n){let l=this.objects[n];if(l==this.targetSP)return;let a=l.connects.includes(this.targetSP);console.log(">>>>>",a,l.connects),a?(this.targetSP.resetPen(),this.targetSP=null):(this.targetSP.regConnect(l),this.targetSP.stopDraw(),this.checkAllSetSP(),this.targetSP=null)}}onTouchUpSP(e,i){!this.targetSP||(this.targetSP.resetPen(),this.targetSP=null)}onTouchUp(e,i){!this.target||this.target.ready||(this.target.resetPen(),this.target=null)}onTouchMove(e,i){if(!this.target||this.target.ready)return;let r=this.world.queryPoint(e,i,a=>a.endsWith("_click")),n=r.find(a=>this.objects[a.substring(0,a.indexOf("_"))]instanceof Si);if(n){n=n.substring(0,n.indexOf("_"));let a=this.objects[n];(this.target.type==a.type||a.type=="mix")&&(this.target.setReady(a),this.checkAllSet())}r.find(a=>this.objects[a.substring(0,a.indexOf("_"))]instanceof Vl)&&(this.target.resetPen(),this.target=null)}bindEvents(){this.game.task.interval(500,()=>this.checkWin()),Y.inst.ui.ev.on("stateChanged",e=>{e=="game"&&this.startGame()}),this.ev.on("down",(e,i)=>{this.game.profile.mode=="rush"?this.onTouchDown(e,i):this.onTouchDownSP(e,i)}),this.ev.on("up",(e,i)=>{this.game.profile.mode=="rush"?this.onTouchUp(e,i):this.onTouchUpSP(e,i)}),this.ev.on("move",(e,i)=>{this.game.profile.mode=="rush"?this.onTouchMove(e,i):this.onTouchMoveSP(e,i)})}checkAllSet(){let e=!0,i=[];Object.values(this.objects).forEach(r=>{r instanceof hi&&(i.push(r),r.ready||(e=!1))}),e&&this.moveAllRoles(i)}moveAllRoles(e){Y.inst.sound.play(qr([kt.sound.Walk1,kt.sound.Walk2])),e.forEach(n=>n.calcPath());let r=e.sort((n,l)=>n.totalDistance-l.totalDistance)[0].totalDistance/Ed;e.forEach(n=>n.startMove(n.totalDistance/r)),this.ev.emit("start")}checkAllSetSP(){let e=!0;Object.values(this.objects).forEach(i=>{i instanceof ir&&i.connects.length==0&&(e=!1)}),e&&this.checkWinSP()}startGame(){this.clearGame();let e=Y.inst.profile,i=e.mode=="link"?e.getSPLevel():e.getLevel();this.createLevel(i),this.parseLevel(),e.mode=="link"&&this.parseLevelConfig(),this.started=!0}parseLevelConfig(){this.level.getChild("ctrl").customData.split(`
`).forEach(r=>{let n=r.split(","),l=n.shift();if(l=="t")this.title=n[0],this.view.m_level.title=n[0],console.log(">>>>>>",n);else if(l=="p"){let a=[];n.forEach(o=>{let h=Object.values(this.objects).find(c=>c.view.name=="n"+o);h||console.error("\u672A\u77E5\u7684\u914D\u5BF9\u7EC4\u4EF6\u540D",o),a.push(h)}),this.pairs.push(a)}}),console.log(this.pairs)}stopGame(){this.started=!1,this.ev.emit("stop"),Y.inst.sound.stopBGM()}clearGame(){var e;Object.values(this.objects).forEach(i=>{i.disposed||i.dispose()}),this.objects={},(e=this.level)==null||e.dispose(),this.level=null,this.pairs=[]}createLevel(e){let i=fgui.UIPackage.createObjectFromURL("ui://main/"+e),r=Math.min(this.view.width/i.width,this.view.height/i.height);i.setScale(r,r);let n=-(i.width*r-this.view.width)*.5,l=-(i.height*r-this.view.height)*.5;i.setPosition(n,l),this.view.addChildAt(i,this.view.getChildIndex(this.view.m_stage)+1),this.level=i}parseLevel(){for(let e=0;e<this.level.numChildren;e++){let i=this.level.getChildAt(e);i instanceof Ti&&this.level.setChildIndex(i,this.level.numChildren-2)}for(let e=0;e<this.level.numChildren;e++){let i=this.level.getChildAt(e);i instanceof Ti?new hi().bindView(i):i instanceof Qi?new Si().bindView(i):i instanceof sr?new Vl().bindView(i):i instanceof Ki?new Dl().bindView(i):i instanceof Zi?new Pc().bindView(i):i instanceof er?new zr().bindView(i):i instanceof tr?new Ll().bindView(i):i instanceof Ji&&new ir().bindView(i)}}checkWin(){if(!this.started||Y.inst.profile.mode!="rush")return;let e=!0,i=!1;Object.values(this.objects).filter(r=>r instanceof hi).forEach(r=>{i=!0,e&&(r.arrived||(e=!1))}),e&&i&&(Object.values(this.objects).filter(r=>r instanceof Si).forEach(r=>{console.log("\u521B\u5EFA\u7C92\u5B50\uFF01"),this.createParticle(this.view.displayObject,new Oc.default(r.cx,r.cy),[new Oc.default(-500,-500),new Oc.default(500,-1500)],1)}),this.winGame())}winGame(){this.stopGame(),Y.inst.sound.play(kt.sound.Win),this.game.task.delay(1e3,()=>{console.log("\u83B7\u5F97\u80DC\u5229"),Y.inst.ui.view.changeStateTo("win")})}checkWinSP(){let e=Object.values(this.objects).filter(r=>r instanceof ir),i=!0;for(;e.length>0;){let r=e.pop(),n=this.pairs.find(a=>a.includes(r)),l=r.getAllConnects();if(n.length==l.length){let a=l.filter(o=>n.includes(o));if(a.length!=l.length){console.log("\u94FE\u63A5\u4E0D\u5339\u914D",n,l,a),i=!1;break}else{e=e.filter(o=>!n.includes(o));continue}}else{console.log("\u94FE\u63A5\u4E0D\u5339\u914D",n,l),i=!1;break}}i?this.winGame():this.loseGame()}onObjectColl(e,i){return $(this,null,function*(){let r=this.objects[i.other];console.log("\u53D1\u751F\u78B0\u649E\uFF01",e,r,i.touch),r instanceof hi?(Y.inst.sound.play(kt.sound.Combat),(yield this.createSpineEffect(ee.names.fight_cloud,this.view.displayObject,i.touch.x,i.touch.y)).scale.set(.6),e.anim.visible=!1,r.anim.visible=!1,this.loseGame()):r instanceof zr?r.used||(r.onTouch(),this.openTriggerDoor(r.type),Y.inst.sound.play(kt.sound.Hint)):(Y.inst.sound.play(qr([kt.sound.Hit3,kt.sound.Hit4,kt.sound.Hit5])),r instanceof Dl&&r.playHitSound(),(yield this.createSpineEffect(ee.names.hit,this.view.displayObject,i.touch.x,i.touch.y,-1)).scale.set(.6),e.playFallAnim(),this.loseGame())})}loseGame(){this.stopGame(),Y.inst.sound.play(kt.sound.Lose,!1),this.game.task.delay(2e3,()=>{Y.inst.ui.view.changeStateTo("lose")})}createSpineEffect(e,i,r,n,l=1500){return $(this,null,function*(){let a=yield Y.inst.assets.getSpine(e),o=new PIXI.spine.Spine(a.spineData);o.skeleton.setToSetupPose(),o.update(0),o.autoUpdate=!0,o.position.set(r,n);let h=o.skeleton.data.animations[0];h&&o.state.setAnimation(0,h.name,l!=-1);let c=o.skeleton.data.skins[0];return c&&o.skeleton.setSkinByName(c.name),i.addChild(o),l==-1?o.state.addListener({complete:()=>{o.destroy()}}):this.$delay(l,()=>{o.destroy()}),o})}changeToiletToMix(){Object.values(this.objects).forEach(e=>{e instanceof Si&&(e.type="mix",e.view.m_type.selectedPage="mix")})}openTriggerDoor(e){Object.values(this.objects).forEach(i=>{i instanceof Ll&&i.type==e&&i.onTrigger()})}showPairLink(){let e=this.view.m_stage.displayObject,i=new PIXI.Graphics;this.pairTipHelper=i,e.addChild(i),i.lineStyle({width:24,color:11141120,join:PIXI.LINE_JOIN.ROUND,cap:PIXI.LINE_CAP.ROUND}),this.pairs.forEach(r=>{for(let n=0;n<=r.length-2;n++){let l=r[n].getCenterPos(),a=r[n+1].getCenterPos();i.moveTo(l.x,l.y),i.lineTo(a.x,a.y)}})}hidePairLink(){!this.pairTipHelper||(this.pairTipHelper.destroy(),this.pairTipHelper=null)}hideTutorial(){for(let e=0;e<this.level.numChildren;e++){let i=this.level.getChildAt(e);i.name.includes("t_")&&(i.visible=!1)}}createParticle(e,i,r,n){this.game.particles.createParticle(e,{image:kt.image.star,pos:i,vel:r,gravity:new Oc.default(0,2e3),scale:[.5*n,.1*n],alpha:[1,0],vr:[-10,10],life:2,burstCount:12,freq:2,wave:1,delay:0})}};function Ct(s){for(var t=arguments.length,e=new Array(t>1?t-1:0),i=1;i<t;i++)e[i-1]=arguments[i];if(!1)var r;throw new Error(typeof s=="number"?"[MobX] minified error nr: "+s+(e.length?" "+e.map(String).join(","):"")+". Find the full error at: https://github.com/mobxjs/mobx/blob/main/packages/mobx/src/errors.ts":"[MobX] "+s)}var vy={};function Mx(){return typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:vy}var wy=Object.assign,Rd=Object.getOwnPropertyDescriptor,ar=Object.defineProperty,Ld=Object.prototype,Gm=[];Object.freeze(Gm);var kx={};Object.freeze(kx);var Ey=typeof Proxy!="undefined",Ay=Object.toString();function Px(){Ey||Ct("Proxy not available")}function Ox(s){var t=!1;return function(){if(!t)return t=!0,s.apply(this,arguments)}}var Yl=function(){};function di(s){return typeof s=="function"}function Co(s){var t=typeof s;switch(t){case"string":case"symbol":case"number":return!0}return!1}function Ud(s){return s!==null&&typeof s=="object"}function tn(s){if(!Ud(s))return!1;var t=Object.getPrototypeOf(s);if(t==null)return!0;var e=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return typeof e=="function"&&e.toString()===Ay}function Nx(s){var t=s==null?void 0:s.constructor;return t?t.name==="GeneratorFunction"||t.displayName==="GeneratorFunction":!1}function Dd(s,t,e){ar(s,t,{enumerable:!1,writable:!0,configurable:!0,value:e})}function Fx(s,t,e){ar(s,t,{enumerable:!1,writable:!1,configurable:!0,value:e})}function Mo(s,t){var e="isMobX"+s;return t.prototype[e]=!0,function(i){return Ud(i)&&i[e]===!0}}function Kl(s){return s instanceof Map}function Gc(s){return s instanceof Set}var Bx=typeof Object.getOwnPropertySymbols!="undefined";function Iy(s){var t=Object.keys(s);if(!Bx)return t;var e=Object.getOwnPropertySymbols(s);return e.length?[].concat(t,e.filter(function(i){return Ld.propertyIsEnumerable.call(s,i)})):t}var Vd=typeof Reflect!="undefined"&&Reflect.ownKeys?Reflect.ownKeys:Bx?function(s){return Object.getOwnPropertyNames(s).concat(Object.getOwnPropertySymbols(s))}:Object.getOwnPropertyNames;function Lx(s){return s===null?null:typeof s=="object"?""+s:s}function lr(s,t){return Ld.hasOwnProperty.call(s,t)}var Ty=Object.getOwnPropertyDescriptors||function(t){var e={};return Vd(t).forEach(function(i){e[i]=Rd(t,i)}),e};function px(s,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,i.key,i)}}function qm(s,t,e){return t&&px(s.prototype,t),e&&px(s,e),Object.defineProperty(s,"prototype",{writable:!1}),s}function $l(){return $l=Object.assign||function(s){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(s[i]=e[i])}return s},$l.apply(this,arguments)}function Ux(s,t){s.prototype=Object.create(t.prototype),s.prototype.constructor=s,Xm(s,t)}function Xm(s,t){return Xm=Object.setPrototypeOf||function(i,r){return i.__proto__=r,i},Xm(s,t)}function Lm(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function Sy(s,t){if(!!s){if(typeof s=="string")return gx(s,t);var e=Object.prototype.toString.call(s).slice(8,-1);if(e==="Object"&&s.constructor&&(e=s.constructor.name),e==="Map"||e==="Set")return Array.from(s);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return gx(s,t)}}function gx(s,t){(t==null||t>s.length)&&(t=s.length);for(var e=0,i=new Array(t);e<t;e++)i[e]=s[e];return i}function jl(s,t){var e=typeof Symbol!="undefined"&&s[Symbol.iterator]||s["@@iterator"];if(e)return(e=e.call(s)).next.bind(e);if(Array.isArray(s)||(e=Sy(s))||t&&s&&typeof s.length=="number"){e&&(s=e);var i=0;return function(){return i>=s.length?{done:!0}:{done:!1,value:s[i++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Ci=Symbol("mobx-stored-annotations");function Ri(s){function t(e,i){Xc(e,i,s)}return Object.assign(t,s)}function Xc(s,t,e){if(lr(s,Ci)||Dd(s,Ci,$l({},s[Ci])),!1)var i;Cy(s,e,t),Ly(e)||(s[Ci][t]=e)}function Cy(s,t,e){if(!1)var i,r,n}function Ry(s){return lr(s,Ci)||Dd(s,Ci,$l({},s[Ci])),s[Ci]}var dt=Symbol("mobx administration"),Yc=function(){function s(e){e===void 0&&(e="Atom"),this.name_=void 0,this.isPendingUnobservation_=!1,this.isBeingObserved_=!1,this.observers_=new Set,this.diffValue_=0,this.lastAccessedBy_=0,this.lowestObserverState_=St.NOT_TRACKING_,this.onBOL=void 0,this.onBUOL=void 0,this.name_=e}var t=s.prototype;return t.onBO=function(){this.onBOL&&this.onBOL.forEach(function(i){return i()})},t.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(i){return i()})},t.reportObserved=function(){return ib(this)},t.reportChanged=function(){Ts(),rb(this),Ss()},t.toString=function(){return this.name_},s}(),zm=Mo("Atom",Yc);function Dx(s,t,e){t===void 0&&(t=Yl),e===void 0&&(e=Yl);var i=new Yc(s);return t!==Yl&&Lv(i,t),e!==Yl&&ub(i,e),i}function My(s,t){return s===t}function ky(s,t){return ep(s,t)}function Py(s,t){return ep(s,t,1)}function Oy(s,t){return Object.is?Object.is(s,t):s===t?s!==0||1/s===1/t:s!==s&&t!==t}var Md={identity:My,structural:ky,default:Oy,shallow:Py};function Hl(s,t,e){return mb(s)?s:Array.isArray(s)?me.array(s,{name:e}):tn(s)?me.object(s,void 0,{name:e}):Kl(s)?me.map(s,{name:e}):Gc(s)?me.set(s,{name:e}):typeof s=="function"&&!Qm(s)&&!Nd(s)?Nx(s)?Uc(s):Lc(e,s):s}function Ny(s,t,e){if(s==null||Dc(s)||Wd(s)||ko(s)||Ql(s))return s;if(Array.isArray(s))return me.array(s,{name:e,deep:!1});if(tn(s))return me.object(s,void 0,{name:e,deep:!1});if(Kl(s))return me.map(s,{name:e,deep:!1});if(Gc(s))return me.set(s,{name:e,deep:!1})}function Gd(s){return s}function Fy(s,t){return ep(s,t)?t:s}var By="override";function Ly(s){return s.annotationType_===By}function jc(s,t){return{annotationType_:s,options_:t,make_:Uy,extend_:Dy}}function Uy(s,t,e,i){var r;if((r=this.options_)!=null&&r.bound)return this.extend_(s,t,e,!1)===null?0:1;if(i===s.target_)return this.extend_(s,t,e,!1)===null?0:2;if(Qm(e.value))return 1;var n=Vx(s,this,t,e,!1);return ar(i,t,n),2}function Dy(s,t,e,i){var r=Vx(s,this,t,e);return s.defineProperty_(t,r,i)}function Vy(s,t,e,i){var r=t.annotationType_,n=i.value}function Vx(s,t,e,i,r){var n,l,a,o,h,c,u;r===void 0&&(r=Q.safeDescriptors),Vy(s,t,e,i);var d=i.value;if((n=t.options_)!=null&&n.bound){var f;d=d.bind((f=s.proxy_)!=null?f:s.target_)}return{value:ql((l=(a=t.options_)==null?void 0:a.name)!=null?l:e.toString(),d,(o=(h=t.options_)==null?void 0:h.autoAction)!=null?o:!1,(c=t.options_)!=null&&c.bound?(u=s.proxy_)!=null?u:s.target_:void 0),configurable:r?s.isPlainObject_:!0,enumerable:!1,writable:!r}}function Gx(s,t){return{annotationType_:s,options_:t,make_:Gy,extend_:Xy}}function Gy(s,t,e,i){var r;if(i===s.target_)return this.extend_(s,t,e,!1)===null?0:2;if((r=this.options_)!=null&&r.bound&&(!lr(s.target_,t)||!Nd(s.target_[t]))&&this.extend_(s,t,e,!1)===null)return 0;if(Nd(e.value))return 1;var n=Xx(s,this,t,e,!1,!1);return ar(i,t,n),2}function Xy(s,t,e,i){var r,n=Xx(s,this,t,e,(r=this.options_)==null?void 0:r.bound);return s.defineProperty_(t,n,i)}function Yy(s,t,e,i){var r=t.annotationType_,n=i.value}function Xx(s,t,e,i,r,n){n===void 0&&(n=Q.safeDescriptors),Yy(s,t,e,i);var l=i.value;if(Nd(l)||(l=Uc(l)),r){var a;l=l.bind((a=s.proxy_)!=null?a:s.target_),l.isMobXFlow=!0}return{value:l,configurable:n?s.isPlainObject_:!0,enumerable:!1,writable:!n}}function Km(s,t){return{annotationType_:s,options_:t,make_:jy,extend_:Wy}}function jy(s,t,e){return this.extend_(s,t,e,!1)===null?0:1}function Wy(s,t,e,i){return $y(s,this,t,e),s.defineComputedProperty_(t,$l({},this.options_,{get:e.get,set:e.set}),i)}function $y(s,t,e,i){var r=t.annotationType_,n=i.get}function Xd(s,t){return{annotationType_:s,options_:t,make_:Hy,extend_:qy}}function Hy(s,t,e){return this.extend_(s,t,e,!1)===null?0:1}function qy(s,t,e,i){var r,n;return zy(s,this,t,e),s.defineObservableProperty_(t,e.value,(r=(n=this.options_)==null?void 0:n.enhancer)!=null?r:Hl,i)}function zy(s,t,e,i){var r=t.annotationType_}var Ky="true",Zy=Yx();function Yx(s){return{annotationType_:Ky,options_:s,make_:Qy,extend_:Jy}}function Qy(s,t,e,i){var r,n;if(e.get)return Yd.make_(s,t,e,i);if(e.set){var l=ql(t.toString(),e.set);return i===s.target_?s.defineProperty_(t,{configurable:Q.safeDescriptors?s.isPlainObject_:!0,set:l})===null?0:2:(ar(i,t,{configurable:!0,set:l}),2)}if(i!==s.target_&&typeof e.value=="function"){var a;if(Nx(e.value)){var o,h=(o=this.options_)!=null&&o.autoBind?Uc.bound:Uc;return h.make_(s,t,e,i)}var c=(a=this.options_)!=null&&a.autoBind?Lc.bound:Lc;return c.make_(s,t,e,i)}var u=((r=this.options_)==null?void 0:r.deep)===!1?me.ref:me;if(typeof e.value=="function"&&(n=this.options_)!=null&&n.autoBind){var d;e.value=e.value.bind((d=s.proxy_)!=null?d:s.target_)}return u.make_(s,t,e,i)}function Jy(s,t,e,i){var r,n;if(e.get)return Yd.extend_(s,t,e,i);if(e.set)return s.defineProperty_(t,{configurable:Q.safeDescriptors?s.isPlainObject_:!0,set:ql(t.toString(),e.set)},i);if(typeof e.value=="function"&&(r=this.options_)!=null&&r.autoBind){var l;e.value=e.value.bind((l=s.proxy_)!=null?l:s.target_)}var a=((n=this.options_)==null?void 0:n.deep)===!1?me.ref:me;return a.extend_(s,t,e,i)}var tv="observable",ev="observable.ref",sv="observable.shallow",iv="observable.struct",jx={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};Object.freeze(jx);function Td(s){return s||jx}var Wx=Xd(tv),rv=Xd(ev,{enhancer:Gd}),nv=Xd(sv,{enhancer:Ny}),ov=Xd(iv,{enhancer:Fy}),$x=Ri(Wx);function Sd(s){return s.deep===!0?Hl:s.deep===!1?Gd:lv(s.defaultDecorator)}function av(s){var t;return s?(t=s.defaultDecorator)!=null?t:Yx(s):void 0}function lv(s){var t,e;return s&&(t=(e=s.options_)==null?void 0:e.enhancer)!=null?t:Hl}function Hx(s,t,e){if(Co(t)){Xc(s,t,Wx);return}return mb(s)?s:tn(s)?me.object(s,t,e):Array.isArray(s)?me.array(s,t):Kl(s)?me.map(s,t):Gc(s)?me.set(s,t):typeof s=="object"&&s!==null?s:me.box(s,t)}Object.assign(Hx,$x);var hv={box:function(t,e){var i=Td(e);return new Wl(t,Sd(i),i.name,!0,i.equals)},array:function(t,e){var i=Td(e);return(Q.useProxies===!1||i.proxy===!1?iw:qv)(t,Sd(i),i.name)},map:function(t,e){var i=Td(e);return new _b(t,Sd(i),i.name)},set:function(t,e){var i=Td(e);return new wb(t,Sd(i),i.name)},object:function(t,e,i){return Uv(Q.useProxies===!1||(i==null?void 0:i.proxy)===!1?$d({},i):Wv({},i),t,e)},ref:Ri(rv),shallow:Ri(nv),deep:$x,struct:Ri(ov)},me=wy(Hx,hv),qx="computed",cv="computed.struct",zx=Km(qx),uv=Km(cv,{equals:Md.structural}),Yd=function(t,e){if(Co(e))return Xc(t,e,zx);if(tn(t))return Ri(Km(qx,t));var i=tn(e)?e:{};return i.get=t,i.name||(i.name=t.name||""),new Bc(i)};Object.assign(Yd,zx);Yd.struct=Ri(uv);var xx,bx,kd=0,dv=1,fv=(xx=(bx=Rd(function(){},"name"))==null?void 0:bx.configurable)!=null?xx:!1,_x={value:"action",configurable:!0,writable:!1,enumerable:!1};function ql(s,t,e,i){e===void 0&&(e=!1);function r(){return mv(s,e,t,i||this,arguments)}return r.isMobxAction=!0,fv&&(_x.value=s,Object.defineProperty(r,"name",_x)),r}function mv(s,t,e,i,r){var n=pv(s,t,i,r);try{return e.apply(i,r)}catch(l){throw n.error_=l,l}finally{gv(n)}}function pv(s,t,e,i){var r=!1,n=0;if(!1)var l;var a=Q.trackingDerivation,o=!t||!a;Ts();var h=Q.allowStateChanges;o&&(Zl(),h=Wc(!0));var c=Zm(!0),u={runAsAction_:o,prevDerivation_:a,prevAllowStateChanges_:h,prevAllowStateReads_:c,notifySpy_:r,startTime_:n,actionId_:dv++,parentActionId_:kd};return kd=u.actionId_,u}function gv(s){kd!==s.actionId_&&Ct(30),kd=s.parentActionId_,s.error_!==void 0&&(Q.suppressReactionErrors=!0),$c(s.prevAllowStateChanges_),Fc(s.prevAllowStateReads_),Ss(),s.runAsAction_&&Jr(s.prevDerivation_),Q.suppressReactionErrors=!1}function xv(s,t){var e=Wc(s);try{return t()}finally{$c(e)}}function Wc(s){var t=Q.allowStateChanges;return Q.allowStateChanges=s,t}function $c(s){Q.allowStateChanges=s}var Kx;Kx=Symbol.toPrimitive;var Wl=function(s){Ux(t,s);function t(i,r,n,l,a){var o;return n===void 0&&(n="ObservableValue"),l===void 0&&(l=!0),a===void 0&&(a=Md.default),o=s.call(this,n)||this,o.enhancer=void 0,o.name_=void 0,o.equals=void 0,o.hasUnreportedChange_=!1,o.interceptors_=void 0,o.changeListeners_=void 0,o.value_=void 0,o.dehancer=void 0,o.enhancer=r,o.name_=n,o.equals=a,o.value_=r(i,void 0,n),o}var e=t.prototype;return e.dehanceValue=function(r){return this.dehancer!==void 0?this.dehancer(r):r},e.set=function(r){var n=this.value_;if(r=this.prepareNewValue_(r),r!==Q.UNCHANGED){var l=So();this.setNewValue_(r)}},e.prepareNewValue_=function(r){if(zl(this),Hs(this)){var n=qs(this,{object:this,type:Mi,newValue:r});if(!n)return Q.UNCHANGED;r=n.newValue}return r=this.enhancer(r,this.value_,this.name_),this.equals(this.value_,r)?Q.UNCHANGED:r},e.setNewValue_=function(r){var n=this.value_;this.value_=r,this.reportChanged(),ci(this)&&ui(this,{type:Mi,object:this,newValue:r,oldValue:n})},e.get=function(){return this.reportObserved(),this.dehanceValue(this.value_)},e.intercept_=function(r){return Hc(this,r)},e.observe_=function(r,n){return n&&r({observableKind:"value",debugObjectName:this.name_,object:this,type:Mi,newValue:this.value_,oldValue:void 0}),qc(this,r)},e.raw=function(){return this.value_},e.toJSON=function(){return this.get()},e.toString=function(){return this.name_+"["+this.value_+"]"},e.valueOf=function(){return Lx(this.get())},e[Kx]=function(){return this.valueOf()},t}(Yc);var Zx;Zx=Symbol.toPrimitive;var Bc=function(){function s(e){this.dependenciesState_=St.NOT_TRACKING_,this.observing_=[],this.newObserving_=null,this.isBeingObserved_=!1,this.isPendingUnobservation_=!1,this.observers_=new Set,this.diffValue_=0,this.runId_=0,this.lastAccessedBy_=0,this.lowestObserverState_=St.UP_TO_DATE_,this.unboundDepsCount_=0,this.value_=new Pd(null),this.name_=void 0,this.triggeredBy_=void 0,this.isComputing_=!1,this.isRunningSetter_=!1,this.derivation=void 0,this.setter_=void 0,this.isTracing_=Qr.NONE,this.scope_=void 0,this.equals_=void 0,this.requiresReaction_=void 0,this.keepAlive_=void 0,this.onBOL=void 0,this.onBUOL=void 0,e.get||Ct(31),this.derivation=e.get,this.name_=e.name||"ComputedValue",e.set&&(this.setter_=ql("ComputedValue-setter",e.set)),this.equals_=e.equals||(e.compareStructural||e.struct?Md.structural:Md.default),this.scope_=e.context,this.requiresReaction_=e.requiresReaction,this.keepAlive_=!!e.keepAlive}var t=s.prototype;return t.onBecomeStale_=function(){wv(this)},t.onBO=function(){this.onBOL&&this.onBOL.forEach(function(i){return i()})},t.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(i){return i()})},t.get=function(){if(this.isComputing_&&Ct(32,this.name_,this.derivation),Q.inBatch===0&&this.observers_.size===0&&!this.keepAlive_)Ym(this)&&(this.warnAboutUntrackedRead_(),Ts(),this.value_=this.computeValue_(!1),Ss());else if(ib(this),Ym(this)){var i=Q.trackingContext;this.keepAlive_&&!i&&(Q.trackingContext=this),this.trackAndCompute()&&vv(this),Q.trackingContext=i}var r=this.value_;if(Cd(r))throw r.cause;return r},t.set=function(i){if(this.setter_){this.isRunningSetter_&&Ct(33,this.name_),this.isRunningSetter_=!0;try{this.setter_.call(this.scope_,i)}finally{this.isRunningSetter_=!1}}else Ct(34,this.name_)},t.trackAndCompute=function(){var i=this.value_,r=this.dependenciesState_===St.NOT_TRACKING_,n=this.computeValue_(!0),l=r||Cd(i)||Cd(n)||!this.equals_(i,n);return l&&(this.value_=n),l},t.computeValue_=function(i){this.isComputing_=!0;var r=Wc(!1),n;if(i)n=Qx(this,this.derivation,this.scope_);else if(Q.disableErrorBoundaries===!0)n=this.derivation.call(this.scope_);else try{n=this.derivation.call(this.scope_)}catch(l){n=new Pd(l)}return $c(r),this.isComputing_=!1,n},t.suspend_=function(){this.keepAlive_||(jm(this),this.value_=void 0)},t.observe_=function(i,r){var n=this,l=!0,a=void 0;return Pv(function(){var o=n.get();if(!l||r){var h=Zl();i({observableKind:"computed",debugObjectName:n.name_,type:Mi,object:n,newValue:o,oldValue:a}),Jr(h)}l=!1,a=o})},t.warnAboutUntrackedRead_=function(){},t.toString=function(){return this.name_+"["+this.derivation.toString()+"]"},t.valueOf=function(){return Lx(this.get())},t[Zx]=function(){return this.valueOf()},s}(),jd=Mo("ComputedValue",Bc),St;(function(s){s[s.NOT_TRACKING_=-1]="NOT_TRACKING_",s[s.UP_TO_DATE_=0]="UP_TO_DATE_",s[s.POSSIBLY_STALE_=1]="POSSIBLY_STALE_",s[s.STALE_=2]="STALE_"})(St||(St={}));var Qr;(function(s){s[s.NONE=0]="NONE",s[s.LOG=1]="LOG",s[s.BREAK=2]="BREAK"})(Qr||(Qr={}));var Pd=function(t){this.cause=void 0,this.cause=t};function Cd(s){return s instanceof Pd}function Ym(s){switch(s.dependenciesState_){case St.UP_TO_DATE_:return!1;case St.NOT_TRACKING_:case St.STALE_:return!0;case St.POSSIBLY_STALE_:{for(var t=Zm(!0),e=Zl(),i=s.observing_,r=i.length,n=0;n<r;n++){var l=i[n];if(jd(l)){if(Q.disableErrorBoundaries)l.get();else try{l.get()}catch(a){return Jr(e),Fc(t),!0}if(s.dependenciesState_===St.STALE_)return Jr(e),Fc(t),!0}}return tb(s),Jr(e),Fc(t),!1}}}function zl(s){return;var t}function Qx(s,t,e){var i=Zm(!0);tb(s),s.newObserving_=new Array(s.observing_.length+100),s.unboundDepsCount_=0,s.runId_=++Q.runId;var r=Q.trackingDerivation;Q.trackingDerivation=s,Q.inBatch++;var n;if(Q.disableErrorBoundaries===!0)n=t.call(e);else try{n=t.call(e)}catch(l){n=new Pd(l)}return Q.inBatch--,Q.trackingDerivation=r,bv(s),Fc(i),n}function bv(s){for(var t=s.observing_,e=s.observing_=s.newObserving_,i=St.UP_TO_DATE_,r=0,n=s.unboundDepsCount_,l=0;l<n;l++){var a=e[l];a.diffValue_===0&&(a.diffValue_=1,r!==l&&(e[r]=a),r++),a.dependenciesState_>i&&(i=a.dependenciesState_)}for(e.length=r,s.newObserving_=null,n=t.length;n--;){var o=t[n];o.diffValue_===0&&eb(o,s),o.diffValue_=0}for(;r--;){var h=e[r];h.diffValue_===1&&(h.diffValue_=0,yv(h,s))}i!==St.UP_TO_DATE_&&(s.dependenciesState_=i,s.onBecomeStale_())}function jm(s){var t=s.observing_;s.observing_=[];for(var e=t.length;e--;)eb(t[e],s);s.dependenciesState_=St.NOT_TRACKING_}function Jx(s){var t=Zl();try{return s()}finally{Jr(t)}}function Zl(){var s=Q.trackingDerivation;return Q.trackingDerivation=null,s}function Jr(s){Q.trackingDerivation=s}function Zm(s){var t=Q.allowStateReads;return Q.allowStateReads=s,t}function Fc(s){Q.allowStateReads=s}function tb(s){if(s.dependenciesState_!==St.UP_TO_DATE_){s.dependenciesState_=St.UP_TO_DATE_;for(var t=s.observing_,e=t.length;e--;)t[e].lowestObserverState_=St.UP_TO_DATE_}}var Um=function(){this.version=6,this.UNCHANGED={},this.trackingDerivation=null,this.trackingContext=null,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!1,this.allowStateReads=!0,this.enforceActions=!0,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1,this.useProxies=!0,this.verifyProxies=!1,this.safeDescriptors=!0},Dm=!0,_v=!1,Q=function(){var s=Mx();return s.__mobxInstanceCount>0&&!s.__mobxGlobals&&(Dm=!1),s.__mobxGlobals&&s.__mobxGlobals.version!==new Um().version&&(Dm=!1),Dm?s.__mobxGlobals?(s.__mobxInstanceCount+=1,s.__mobxGlobals.UNCHANGED||(s.__mobxGlobals.UNCHANGED={}),s.__mobxGlobals):(s.__mobxInstanceCount=1,s.__mobxGlobals=new Um):(setTimeout(function(){_v||Ct(35)},1),new Um)}();function yv(s,t){s.observers_.add(t),s.lowestObserverState_>t.dependenciesState_&&(s.lowestObserverState_=t.dependenciesState_)}function eb(s,t){s.observers_.delete(t),s.observers_.size===0&&sb(s)}function sb(s){s.isPendingUnobservation_===!1&&(s.isPendingUnobservation_=!0,Q.pendingUnobservations.push(s))}function Ts(){Q.inBatch++}function Ss(){if(--Q.inBatch===0){nb();for(var s=Q.pendingUnobservations,t=0;t<s.length;t++){var e=s[t];e.isPendingUnobservation_=!1,e.observers_.size===0&&(e.isBeingObserved_&&(e.isBeingObserved_=!1,e.onBUO()),e instanceof Bc&&e.suspend_())}Q.pendingUnobservations=[]}}function ib(s){var t=Q.trackingDerivation;return t!==null?(t.runId_!==s.lastAccessedBy_&&(s.lastAccessedBy_=t.runId_,t.newObserving_[t.unboundDepsCount_++]=s,!s.isBeingObserved_&&Q.trackingContext&&(s.isBeingObserved_=!0,s.onBO())),s.isBeingObserved_):(s.observers_.size===0&&Q.inBatch>0&&sb(s),!1)}function rb(s){s.lowestObserverState_!==St.STALE_&&(s.lowestObserverState_=St.STALE_,s.observers_.forEach(function(t){t.dependenciesState_===St.UP_TO_DATE_&&t.onBecomeStale_(),t.dependenciesState_=St.STALE_}))}function vv(s){s.lowestObserverState_!==St.STALE_&&(s.lowestObserverState_=St.STALE_,s.observers_.forEach(function(t){t.dependenciesState_===St.POSSIBLY_STALE_?t.dependenciesState_=St.STALE_:t.dependenciesState_===St.UP_TO_DATE_&&(s.lowestObserverState_=St.UP_TO_DATE_)}))}function wv(s){s.lowestObserverState_===St.UP_TO_DATE_&&(s.lowestObserverState_=St.POSSIBLY_STALE_,s.observers_.forEach(function(t){t.dependenciesState_===St.UP_TO_DATE_&&(t.dependenciesState_=St.POSSIBLY_STALE_,t.onBecomeStale_())}))}var Wm=function(){function s(e,i,r,n){e===void 0&&(e="Reaction"),this.name_=void 0,this.onInvalidate_=void 0,this.errorHandler_=void 0,this.requiresObservable_=void 0,this.observing_=[],this.newObserving_=[],this.dependenciesState_=St.NOT_TRACKING_,this.diffValue_=0,this.runId_=0,this.unboundDepsCount_=0,this.isDisposed_=!1,this.isScheduled_=!1,this.isTrackPending_=!1,this.isRunning_=!1,this.isTracing_=Qr.NONE,this.name_=e,this.onInvalidate_=i,this.errorHandler_=r,this.requiresObservable_=n}var t=s.prototype;return t.onBecomeStale_=function(){this.schedule_()},t.schedule_=function(){this.isScheduled_||(this.isScheduled_=!0,Q.pendingReactions.push(this),nb())},t.isScheduled=function(){return this.isScheduled_},t.runReaction_=function(){if(!this.isDisposed_){Ts(),this.isScheduled_=!1;var i=Q.trackingContext;if(Q.trackingContext=this,Ym(this)){this.isTrackPending_=!0;try{this.onInvalidate_()}catch(r){this.reportExceptionInDerivation_(r)}}Q.trackingContext=i,Ss()}},t.track=function(i){if(!this.isDisposed_){Ts();var r=So(),n;this.isRunning_=!0;var l=Q.trackingContext;Q.trackingContext=this;var a=Qx(this,i,void 0);Q.trackingContext=l,this.isRunning_=!1,this.isTrackPending_=!1,this.isDisposed_&&jm(this),Cd(a)&&this.reportExceptionInDerivation_(a.cause),Ss()}},t.reportExceptionInDerivation_=function(i){var r=this;if(this.errorHandler_){this.errorHandler_(i,this);return}if(Q.disableErrorBoundaries)throw i;var n="[mobx] uncaught error in '"+this+"'";Q.suppressReactionErrors||console.error(n,i),Q.globalReactionErrorHandlers.forEach(function(l){return l(i,r)})},t.dispose=function(){this.isDisposed_||(this.isDisposed_=!0,this.isRunning_||(Ts(),jm(this),Ss()))},t.getDisposer_=function(){var i=this.dispose.bind(this);return i[dt]=this,i},t.toString=function(){return"Reaction["+this.name_+"]"},t.trace=function(i){i===void 0&&(i=!1),Xv(this,i)},s}();var Ev=100,Av=function(t){return t()};function nb(){Q.inBatch>0||Q.isRunningReactions||Av(Iv)}function Iv(){Q.isRunningReactions=!0;for(var s=Q.pendingReactions,t=0;s.length>0;){++t===Ev&&(console.error("[mobx] cycle in reaction: "+s[0]),s.splice(0));for(var e=s.splice(0),i=0,r=e.length;i<r;i++)e[i].runReaction_()}Q.isRunningReactions=!1}var Od=Mo("Reaction",Wm);function So(){return!1}function Tv(s){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}var ob="action",Sv="action.bound",ab="autoAction",Cv="autoAction.bound",Rv="<unnamed action>",lb=jc(ob),Mv=jc(Sv,{bound:!0}),hb=jc(ab,{autoAction:!0}),kv=jc(Cv,{autoAction:!0,bound:!0});function cb(s){var t=function(i,r){if(di(i))return ql(i.name||Rv,i,s);if(di(r))return ql(i,r,s);if(Co(r))return Xc(i,r,s?hb:lb);if(Co(i))return Ri(jc(s?ab:ob,{name:i,autoAction:s}))};return t}var or=cb(!1);Object.assign(or,lb);var Lc=cb(!0);Object.assign(Lc,hb);or.bound=Ri(Mv);Lc.bound=Ri(kv);function Qm(s){return di(s)&&s.isMobxAction===!0}function Pv(s,t){var e,i;t===void 0&&(t=kx);var r=(e=(i=t)==null?void 0:i.name)!=null?e:"Autorun",n=!t.scheduler&&!t.delay,l;if(n)l=new Wm(r,function(){this.track(h)},t.onError,t.requiresObservable);else{var a=Nv(t),o=!1;l=new Wm(r,function(){o||(o=!0,a(function(){o=!1,l.isDisposed_||l.track(h)}))},t.onError,t.requiresObservable)}function h(){s(l)}return l.schedule_(),l.getDisposer_()}var Ov=function(t){return t()};function Nv(s){return s.scheduler?s.scheduler:s.delay?function(t){return setTimeout(t,s.delay)}:Ov}var Fv="onBO",Bv="onBUO";function Lv(s,t,e){return db(Fv,s,t,e)}function ub(s,t,e){return db(Bv,s,t,e)}function db(s,t,e,i){var r=typeof i=="function"?Ro(t,e):Ro(t),n=di(i)?i:e,l=s+"L";return r[l]?r[l].add(n):r[l]=new Set([n]),function(){var a=r[l];a&&(a.delete(n),a.size===0&&delete r[l])}}function Uv(s,t,e,i){var r=Ty(t),n=$d(s,i)[dt];Ts();try{Vd(r).forEach(function(l){n.extend_(l,r[l],e&&l in e?e[l]:!0)})}finally{Ss()}return s}var Dv=0;function fb(){this.message="FLOW_CANCELLED"}fb.prototype=Object.create(Error.prototype);var yx=Gx("flow"),Vv=Gx("flow.bound",{bound:!0}),Uc=Object.assign(function(t,e){if(Co(e))return Xc(t,e,yx);var i=t,r=i.name||"<unnamed flow>",n=function(){var a=this,o=arguments,h=++Dv,c=or(r+" - runid: "+h+" - init",i).apply(a,o),u,d=void 0,f=new Promise(function(m,p){var g=0;u=p;function y(x){d=void 0;var v;try{v=or(r+" - runid: "+h+" - yield "+g++,c.next).call(c,x)}catch(w){return p(w)}b(v)}function _(x){d=void 0;var v;try{v=or(r+" - runid: "+h+" - yield "+g++,c.throw).call(c,x)}catch(w){return p(w)}b(v)}function b(x){if(di(x==null?void 0:x.then)){x.then(b,p);return}return x.done?m(x.value):(d=Promise.resolve(x.value),d.then(y,_))}y(void 0)});return f.cancel=or(r+" - runid: "+h+" - cancel",function(){try{d&&vx(d);var m=c.return(void 0),p=Promise.resolve(m.value);p.then(Yl,Yl),vx(p),u(new fb)}catch(g){u(g)}}),f};return n.isMobXFlow=!0,n},yx);Uc.bound=Ri(Vv);function vx(s){di(s.cancel)&&s.cancel()}function Nd(s){return(s==null?void 0:s.isMobXFlow)===!0}function Gv(s,t){return s?t!==void 0?Dc(s)?s[dt].values_.has(t):!1:Dc(s)||!!s[dt]||zm(s)||Od(s)||jd(s):!1}function mb(s){return Gv(s)}function Xv(){Ct("trace() is not available in production builds");for(var s=!1,t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];typeof e[e.length-1]=="boolean"&&(s=e.pop());var r=Yv(e);if(!r)return Ct("'trace(break?)' can only be used inside a tracked computed value or a Reaction. Consider passing in the computed value or reaction explicitly");r.isTracing_===Qr.NONE&&console.log("[mobx.trace] '"+r.name_+"' tracing enabled"),r.isTracing_=s?Qr.BREAK:Qr.LOG}function Yv(s){switch(s.length){case 0:return Q.trackingDerivation;case 1:return Ro(s[0]);case 2:return Ro(s[0],s[1])}}function nr(s,t){t===void 0&&(t=void 0),Ts();try{return s.apply(t)}finally{Ss()}}function Xl(s){return s[dt]}var jv={has:function(t,e){return Xl(t).has_(e)},get:function(t,e){return Xl(t).get_(e)},set:function(t,e,i){var r;return Co(e)?(r=Xl(t).set_(e,i,!0))!=null?r:!0:!1},deleteProperty:function(t,e){var i;return Co(e)?(i=Xl(t).delete_(e,!0))!=null?i:!0:!1},defineProperty:function(t,e,i){var r;return(r=Xl(t).defineProperty_(e,i))!=null?r:!0},ownKeys:function(t){return Xl(t).ownKeys_()},preventExtensions:function(t){Ct(13)}};function Wv(s,t){var e,i;return Px(),s=$d(s,t),(i=(e=s[dt]).proxy_)!=null?i:e.proxy_=new Proxy(s,jv)}function Hs(s){return s.interceptors_!==void 0&&s.interceptors_.length>0}function Hc(s,t){var e=s.interceptors_||(s.interceptors_=[]);return e.push(t),Ox(function(){var i=e.indexOf(t);i!==-1&&e.splice(i,1)})}function qs(s,t){var e=Zl();try{for(var i=[].concat(s.interceptors_||[]),r=0,n=i.length;r<n&&(t=i[r](t),t&&!t.type&&Ct(14),!!t);r++);return t}finally{Jr(e)}}function ci(s){return s.changeListeners_!==void 0&&s.changeListeners_.length>0}function qc(s,t){var e=s.changeListeners_||(s.changeListeners_=[]);return e.push(t),Ox(function(){var i=e.indexOf(t);i!==-1&&e.splice(i,1)})}function ui(s,t){var e=Zl(),i=s.changeListeners_;if(!!i){i=i.slice();for(var r=0,n=i.length;r<n;r++)i[r](t);Jr(e)}}function pb(s,t,e){var i=$d(s,e)[dt];Ts();try{var r;(r=t)!=null||(t=Ry(s)),Vd(t).forEach(function(n){return i.make_(n,t[n])})}finally{Ss()}return s}var wx="splice",Mi="update",$v=1e4,Hv={get:function(t,e){var i=t[dt];return e===dt?i:e==="length"?i.getArrayLength_():typeof e=="string"&&!isNaN(e)?i.get_(parseInt(e)):lr(Fd,e)?Fd[e]:t[e]},set:function(t,e,i){var r=t[dt];return e==="length"&&r.setArrayLength_(i),typeof e=="symbol"||isNaN(e)?t[e]=i:r.set_(parseInt(e),i),!0},preventExtensions:function(){Ct(15)}},Jm=function(){function s(e,i,r,n){e===void 0&&(e="ObservableArray"),this.owned_=void 0,this.legacyMode_=void 0,this.atom_=void 0,this.values_=[],this.interceptors_=void 0,this.changeListeners_=void 0,this.enhancer_=void 0,this.dehancer=void 0,this.proxy_=void 0,this.lastKnownLength_=0,this.owned_=r,this.legacyMode_=n,this.atom_=new Yc(e),this.enhancer_=function(l,a){return i(l,a,"ObservableArray[..]")}}var t=s.prototype;return t.dehanceValue_=function(i){return this.dehancer!==void 0?this.dehancer(i):i},t.dehanceValues_=function(i){return this.dehancer!==void 0&&i.length>0?i.map(this.dehancer):i},t.intercept_=function(i){return Hc(this,i)},t.observe_=function(i,r){return r===void 0&&(r=!1),r&&i({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0}),qc(this,i)},t.getArrayLength_=function(){return this.atom_.reportObserved(),this.values_.length},t.setArrayLength_=function(i){(typeof i!="number"||isNaN(i)||i<0)&&Ct("Out of range: "+i);var r=this.values_.length;if(i!==r)if(i>r){for(var n=new Array(i-r),l=0;l<i-r;l++)n[l]=void 0;this.spliceWithArray_(r,0,n)}else this.spliceWithArray_(i,r-i)},t.updateArrayLength_=function(i,r){i!==this.lastKnownLength_&&Ct(16),this.lastKnownLength_+=r,this.legacyMode_&&r>0&&Tb(i+r+1)},t.spliceWithArray_=function(i,r,n){var l=this;zl(this.atom_);var a=this.values_.length;if(i===void 0?i=0:i>a?i=a:i<0&&(i=Math.max(0,a+i)),arguments.length===1?r=a-i:r==null?r=0:r=Math.max(0,Math.min(r,a-i)),n===void 0&&(n=Gm),Hs(this)){var o=qs(this,{object:this.proxy_,type:wx,index:i,removedCount:r,added:n});if(!o)return Gm;r=o.removedCount,n=o.added}if(n=n.length===0?n:n.map(function(u){return l.enhancer_(u,void 0)}),this.legacyMode_){var h=n.length-r;this.updateArrayLength_(a,h)}var c=this.spliceItemsIntoValues_(i,r,n);return(r!==0||n.length!==0)&&this.notifyArraySplice_(i,n,c),this.dehanceValues_(c)},t.spliceItemsIntoValues_=function(i,r,n){if(n.length<$v){var l;return(l=this.values_).splice.apply(l,[i,r].concat(n))}else{var a=this.values_.slice(i,i+r),o=this.values_.slice(i+r);this.values_.length+=n.length-r;for(var h=0;h<n.length;h++)this.values_[i+h]=n[h];for(var c=0;c<o.length;c++)this.values_[i+n.length+c]=o[c];return a}},t.notifyArrayChildUpdate_=function(i,r,n){var l=!this.owned_&&So(),a=ci(this),o=a||l?{observableKind:"array",object:this.proxy_,type:Mi,debugObjectName:this.atom_.name_,index:i,newValue:r,oldValue:n}:null;this.atom_.reportChanged(),a&&ui(this,o)},t.notifyArraySplice_=function(i,r,n){var l=!this.owned_&&So(),a=ci(this),o=a||l?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:wx,index:i,removed:n,added:r,removedCount:n.length,addedCount:r.length}:null;this.atom_.reportChanged(),a&&ui(this,o)},t.get_=function(i){if(this.legacyMode_&&i>=this.values_.length){console.warn("[mobx] Out of bounds read: "+i);return}return this.atom_.reportObserved(),this.dehanceValue_(this.values_[i])},t.set_=function(i,r){var n=this.values_;if(this.legacyMode_&&i>n.length&&Ct(17,i,n.length),i<n.length){zl(this.atom_);var l=n[i];if(Hs(this)){var a=qs(this,{type:Mi,object:this.proxy_,index:i,newValue:r});if(!a)return;r=a.newValue}r=this.enhancer_(r,l);var o=r!==l;o&&(n[i]=r,this.notifyArrayChildUpdate_(i,r,l))}else{for(var h=new Array(i+1-n.length),c=0;c<h.length-1;c++)h[c]=void 0;h[h.length-1]=r,this.spliceWithArray_(n.length,0,h)}},s}();function qv(s,t,e,i){e===void 0&&(e="ObservableArray"),i===void 0&&(i=!1),Px();var r=new Jm(e,t,i,!1);Fx(r.values_,dt,r);var n=new Proxy(r.values_,Hv);if(r.proxy_=n,s&&s.length){var l=Wc(!0);r.spliceWithArray_(0,0,s),$c(l)}return n}var Fd={clear:function(){return this.splice(0)},replace:function(t){var e=this[dt];return e.spliceWithArray_(0,e.values_.length,t)},toJSON:function(){return this.slice()},splice:function(t,e){for(var i=arguments.length,r=new Array(i>2?i-2:0),n=2;n<i;n++)r[n-2]=arguments[n];var l=this[dt];switch(arguments.length){case 0:return[];case 1:return l.spliceWithArray_(t);case 2:return l.spliceWithArray_(t,e)}return l.spliceWithArray_(t,e,r)},spliceWithArray:function(t,e,i){return this[dt].spliceWithArray_(t,e,i)},push:function(){for(var t=this[dt],e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];return t.spliceWithArray_(t.values_.length,0,i),t.values_.length},pop:function(){return this.splice(Math.max(this[dt].values_.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var t=this[dt],e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];return t.spliceWithArray_(0,0,i),t.values_.length},reverse:function(){return Q.trackingDerivation&&Ct(37,"reverse"),this.replace(this.slice().reverse()),this},sort:function(){Q.trackingDerivation&&Ct(37,"sort");var t=this.slice();return t.sort.apply(t,arguments),this.replace(t),this},remove:function(t){var e=this[dt],i=e.dehanceValues_(e.values_).indexOf(t);return i>-1?(this.splice(i,1),!0):!1}};pe("concat",hr);pe("flat",hr);pe("includes",hr);pe("indexOf",hr);pe("join",hr);pe("lastIndexOf",hr);pe("slice",hr);pe("toString",hr);pe("toLocaleString",hr);pe("every",en);pe("filter",en);pe("find",en);pe("findIndex",en);pe("flatMap",en);pe("forEach",en);pe("map",en);pe("some",en);pe("reduce",gb);pe("reduceRight",gb);function pe(s,t){typeof Array.prototype[s]=="function"&&(Fd[s]=t(s))}function hr(s){return function(){var t=this[dt];t.atom_.reportObserved();var e=t.dehanceValues_(t.values_);return e[s].apply(e,arguments)}}function en(s){return function(t,e){var i=this,r=this[dt];r.atom_.reportObserved();var n=r.dehanceValues_(r.values_);return n[s](function(l,a){return t.call(e,l,a,i)})}}function gb(s){return function(){var t=this,e=this[dt];e.atom_.reportObserved();var i=e.dehanceValues_(e.values_),r=arguments[0];return arguments[0]=function(n,l,a){return r(n,l,a,t)},i[s].apply(i,arguments)}}var zv=Mo("ObservableArrayAdministration",Jm);function Wd(s){return Ud(s)&&zv(s[dt])}var xb,bb,Kv={},Zr="add",Bd="delete";xb=Symbol.iterator;bb=Symbol.toStringTag;var _b=function(){function s(e,i,r){var n=this;i===void 0&&(i=Hl),r===void 0&&(r="ObservableMap"),this.enhancer_=void 0,this.name_=void 0,this[dt]=Kv,this.data_=void 0,this.hasMap_=void 0,this.keysAtom_=void 0,this.interceptors_=void 0,this.changeListeners_=void 0,this.dehancer=void 0,this.enhancer_=i,this.name_=r,di(Map)||Ct(18),this.keysAtom_=Dx("ObservableMap.keys()"),this.data_=new Map,this.hasMap_=new Map,xv(!0,function(){n.merge(e)})}var t=s.prototype;return t.has_=function(i){return this.data_.has(i)},t.has=function(i){var r=this;if(!Q.trackingDerivation)return this.has_(i);var n=this.hasMap_.get(i);if(!n){var l=n=new Wl(this.has_(i),Gd,"ObservableMap.key?",!1);this.hasMap_.set(i,l),ub(l,function(){return r.hasMap_.delete(i)})}return n.get()},t.set=function(i,r){var n=this.has_(i);if(Hs(this)){var l=qs(this,{type:n?Mi:Zr,object:this,newValue:r,name:i});if(!l)return this;r=l.newValue}return n?this.updateValue_(i,r):this.addValue_(i,r),this},t.delete=function(i){var r=this;if(zl(this.keysAtom_),Hs(this)){var n=qs(this,{type:Bd,object:this,name:i});if(!n)return!1}if(this.has_(i)){var l=So(),a=ci(this),o=a||l?{observableKind:"map",debugObjectName:this.name_,type:Bd,object:this,oldValue:this.data_.get(i).value_,name:i}:null;return nr(function(){var h;r.keysAtom_.reportChanged(),(h=r.hasMap_.get(i))==null||h.setNewValue_(!1);var c=r.data_.get(i);c.setNewValue_(void 0),r.data_.delete(i)}),a&&ui(this,o),!0}return!1},t.updateValue_=function(i,r){var n=this.data_.get(i);if(r=n.prepareNewValue_(r),r!==Q.UNCHANGED){var l=So(),a=ci(this),o=a||l?{observableKind:"map",debugObjectName:this.name_,type:Mi,object:this,oldValue:n.value_,name:i,newValue:r}:null;n.setNewValue_(r),a&&ui(this,o)}},t.addValue_=function(i,r){var n=this;zl(this.keysAtom_),nr(function(){var h,c=new Wl(r,n.enhancer_,"ObservableMap.key",!1);n.data_.set(i,c),r=c.value_,(h=n.hasMap_.get(i))==null||h.setNewValue_(!0),n.keysAtom_.reportChanged()});var l=So(),a=ci(this),o=a||l?{observableKind:"map",debugObjectName:this.name_,type:Zr,object:this,name:i,newValue:r}:null;a&&ui(this,o)},t.get=function(i){return this.has(i)?this.dehanceValue_(this.data_.get(i).get()):this.dehanceValue_(void 0)},t.dehanceValue_=function(i){return this.dehancer!==void 0?this.dehancer(i):i},t.keys=function(){return this.keysAtom_.reportObserved(),this.data_.keys()},t.values=function(){var i=this,r=this.keys();return Vc({next:function(){var l=r.next(),a=l.done,o=l.value;return{done:a,value:a?void 0:i.get(o)}}})},t.entries=function(){var i=this,r=this.keys();return Vc({next:function(){var l=r.next(),a=l.done,o=l.value;return{done:a,value:a?void 0:[o,i.get(o)]}}})},t[xb]=function(){return this.entries()},t.forEach=function(i,r){for(var n=jl(this),l;!(l=n()).done;){var a=l.value,o=a[0],h=a[1];i.call(r,h,o,this)}},t.merge=function(i){var r=this;return ko(i)&&(i=new Map(i)),nr(function(){tn(i)?Iy(i).forEach(function(n){return r.set(n,i[n])}):Array.isArray(i)?i.forEach(function(n){var l=n[0],a=n[1];return r.set(l,a)}):Kl(i)?(i.constructor!==Map&&Ct(19,i),i.forEach(function(n,l){return r.set(l,n)})):i!=null&&Ct(20,i)}),this},t.clear=function(){var i=this;nr(function(){Jx(function(){for(var r=jl(i.keys()),n;!(n=r()).done;){var l=n.value;i.delete(l)}})})},t.replace=function(i){var r=this;return nr(function(){for(var n=Zv(i),l=new Map,a=!1,o=jl(r.data_.keys()),h;!(h=o()).done;){var c=h.value;if(!n.has(c)){var u=r.delete(c);if(u)a=!0;else{var d=r.data_.get(c);l.set(c,d)}}}for(var f=jl(n.entries()),m;!(m=f()).done;){var p=m.value,g=p[0],y=p[1],_=r.data_.has(g);if(r.set(g,y),r.data_.has(g)){var b=r.data_.get(g);l.set(g,b),_||(a=!0)}}if(!a)if(r.data_.size!==l.size)r.keysAtom_.reportChanged();else for(var x=r.data_.keys(),v=l.keys(),w=x.next(),E=v.next();!w.done;){if(w.value!==E.value){r.keysAtom_.reportChanged();break}w=x.next(),E=v.next()}r.data_=l}),this},t.toString=function(){return"[object ObservableMap]"},t.toJSON=function(){return Array.from(this)},t.observe_=function(i,r){return qc(this,i)},t.intercept_=function(i){return Hc(this,i)},qm(s,[{key:"size",get:function(){return this.keysAtom_.reportObserved(),this.data_.size}},{key:bb,get:function(){return"Map"}}]),s}(),ko=Mo("ObservableMap",_b);function Zv(s){if(Kl(s)||ko(s))return s;if(Array.isArray(s))return new Map(s);if(tn(s)){var t=new Map;for(var e in s)t.set(e,s[e]);return t}else return Ct(21,s)}var yb,vb,Qv={};yb=Symbol.iterator;vb=Symbol.toStringTag;var wb=function(){function s(e,i,r){i===void 0&&(i=Hl),r===void 0&&(r="ObservableSet"),this.name_=void 0,this[dt]=Qv,this.data_=new Set,this.atom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.dehancer=void 0,this.enhancer_=void 0,this.name_=r,di(Set)||Ct(22),this.atom_=Dx(this.name_),this.enhancer_=function(n,l){return i(n,l,r)},e&&this.replace(e)}var t=s.prototype;return t.dehanceValue_=function(i){return this.dehancer!==void 0?this.dehancer(i):i},t.clear=function(){var i=this;nr(function(){Jx(function(){for(var r=jl(i.data_.values()),n;!(n=r()).done;){var l=n.value;i.delete(l)}})})},t.forEach=function(i,r){for(var n=jl(this),l;!(l=n()).done;){var a=l.value;i.call(r,a,a,this)}},t.add=function(i){var r=this;if(zl(this.atom_),Hs(this)){var n=qs(this,{type:Zr,object:this,newValue:i});if(!n)return this}if(!this.has(i)){nr(function(){r.data_.add(r.enhancer_(i,void 0)),r.atom_.reportChanged()});var l=!1,a=ci(this),o=a||l?{observableKind:"set",debugObjectName:this.name_,type:Zr,object:this,newValue:i}:null;a&&ui(this,o)}return this},t.delete=function(i){var r=this;if(Hs(this)){var n=qs(this,{type:Bd,object:this,oldValue:i});if(!n)return!1}if(this.has(i)){var l=!1,a=ci(this),o=a||l?{observableKind:"set",debugObjectName:this.name_,type:Bd,object:this,oldValue:i}:null;return nr(function(){r.atom_.reportChanged(),r.data_.delete(i)}),a&&ui(this,o),!0}return!1},t.has=function(i){return this.atom_.reportObserved(),this.data_.has(this.dehanceValue_(i))},t.entries=function(){var i=0,r=Array.from(this.keys()),n=Array.from(this.values());return Vc({next:function(){var a=i;return i+=1,a<n.length?{value:[r[a],n[a]],done:!1}:{done:!0}}})},t.keys=function(){return this.values()},t.values=function(){this.atom_.reportObserved();var i=this,r=0,n=Array.from(this.data_.values());return Vc({next:function(){return r<n.length?{value:i.dehanceValue_(n[r++]),done:!1}:{done:!0}}})},t.replace=function(i){var r=this;return Ql(i)&&(i=new Set(i)),nr(function(){Array.isArray(i)?(r.clear(),i.forEach(function(n){return r.add(n)})):Gc(i)?(r.clear(),i.forEach(function(n){return r.add(n)})):i!=null&&Ct("Cannot initialize set from "+i)}),this},t.observe_=function(i,r){return qc(this,i)},t.intercept_=function(i){return Hc(this,i)},t.toJSON=function(){return Array.from(this)},t.toString=function(){return"[object ObservableSet]"},t[yb]=function(){return this.values()},qm(s,[{key:"size",get:function(){return this.atom_.reportObserved(),this.data_.size}},{key:vb,get:function(){return"Set"}}]),s}(),Ql=Mo("ObservableSet",wb),Ex=Object.create(null),Ax="remove",Eb=function(){function s(e,i,r,n){i===void 0&&(i=new Map),n===void 0&&(n=Zy),this.target_=void 0,this.values_=void 0,this.name_=void 0,this.defaultAnnotation_=void 0,this.keysAtom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.proxy_=void 0,this.isPlainObject_=void 0,this.appliedAnnotations_=void 0,this.pendingKeys_=void 0,this.target_=e,this.values_=i,this.name_=r,this.defaultAnnotation_=n,this.keysAtom_=new Yc("ObservableObject.keys"),this.isPlainObject_=tn(this.target_)}var t=s.prototype;return t.getObservablePropValue_=function(i){return this.values_.get(i).get()},t.setObservablePropValue_=function(i,r){var n=this.values_.get(i);if(n instanceof Bc)return n.set(r),!0;if(Hs(this)){var l=qs(this,{type:Mi,object:this.proxy_||this.target_,name:i,newValue:r});if(!l)return null;r=l.newValue}if(r=n.prepareNewValue_(r),r!==Q.UNCHANGED){var a=ci(this),o=!1,h=a||o?{type:Mi,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:n.value_,name:i,newValue:r}:null;n.setNewValue_(r),a&&ui(this,h)}return!0},t.get_=function(i){return Q.trackingDerivation&&!lr(this.target_,i)&&this.has_(i),this.target_[i]},t.set_=function(i,r,n){return n===void 0&&(n=!1),lr(this.target_,i)?this.values_.has(i)?this.setObservablePropValue_(i,r):n?Reflect.set(this.target_,i,r):(this.target_[i]=r,!0):this.extend_(i,{value:r,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,n)},t.has_=function(i){if(!Q.trackingDerivation)return i in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var r=this.pendingKeys_.get(i);return r||(r=new Wl(i in this.target_,Gd,"ObservableObject.key?",!1),this.pendingKeys_.set(i,r)),r.get()},t.make_=function(i,r){if(r===!0&&(r=this.defaultAnnotation_),r!==!1){if(Sx(this,r,i),!(i in this.target_)){var n;if((n=this.target_[Ci])!=null&&n[i])return;Ct(1,r.annotationType_,this.name_+"."+i.toString())}for(var l=this.target_;l&&l!==Ld;){var a=Rd(l,i);if(a){var o=r.make_(this,i,a,l);if(o===0)return;if(o===1)break}l=Object.getPrototypeOf(l)}Tx(this,r,i)}},t.extend_=function(i,r,n,l){if(l===void 0&&(l=!1),n===!0&&(n=this.defaultAnnotation_),n===!1)return this.defineProperty_(i,r,l);Sx(this,n,i);var a=n.extend_(this,i,r,l);return a&&Tx(this,n,i),a},t.defineProperty_=function(i,r,n){n===void 0&&(n=!1);try{Ts();var l=this.delete_(i);if(!l)return l;if(Hs(this)){var a=qs(this,{object:this.proxy_||this.target_,name:i,type:Zr,newValue:r.value});if(!a)return null;var o=a.newValue;r.value!==o&&(r=$l({},r,{value:o}))}if(n){if(!Reflect.defineProperty(this.target_,i,r))return!1}else ar(this.target_,i,r);this.notifyPropertyAddition_(i,r.value)}finally{Ss()}return!0},t.defineObservableProperty_=function(i,r,n,l){l===void 0&&(l=!1);try{Ts();var a=this.delete_(i);if(!a)return a;if(Hs(this)){var o=qs(this,{object:this.proxy_||this.target_,name:i,type:Zr,newValue:r});if(!o)return null;r=o.newValue}var h=Ix(i),c={configurable:Q.safeDescriptors?this.isPlainObject_:!0,enumerable:!0,get:h.get,set:h.set};if(l){if(!Reflect.defineProperty(this.target_,i,c))return!1}else ar(this.target_,i,c);var u=new Wl(r,n,"ObservableObject.key",!1);this.values_.set(i,u),this.notifyPropertyAddition_(i,u.value_)}finally{Ss()}return!0},t.defineComputedProperty_=function(i,r,n){n===void 0&&(n=!1);try{Ts();var l=this.delete_(i);if(!l)return l;if(Hs(this)){var a=qs(this,{object:this.proxy_||this.target_,name:i,type:Zr,newValue:void 0});if(!a)return null}r.name||(r.name="ObservableObject.key"),r.context=this.proxy_||this.target_;var o=Ix(i),h={configurable:Q.safeDescriptors?this.isPlainObject_:!0,enumerable:!1,get:o.get,set:o.set};if(n){if(!Reflect.defineProperty(this.target_,i,h))return!1}else ar(this.target_,i,h);this.values_.set(i,new Bc(r)),this.notifyPropertyAddition_(i,void 0)}finally{Ss()}return!0},t.delete_=function(i,r){if(r===void 0&&(r=!1),!lr(this.target_,i))return!0;if(Hs(this)){var n=qs(this,{object:this.proxy_||this.target_,name:i,type:Ax});if(!n)return null}try{var l,a;Ts();var o=ci(this),h=!1,c=this.values_.get(i),u=void 0;if(!c&&(o||h)){var d;u=(d=Rd(this.target_,i))==null?void 0:d.value}if(r){if(!Reflect.deleteProperty(this.target_,i))return!1}else delete this.target_[i];if(c&&(this.values_.delete(i),c instanceof Wl&&(u=c.value_),rb(c)),this.keysAtom_.reportChanged(),(l=this.pendingKeys_)==null||(a=l.get(i))==null||a.set(i in this.target_),o||h){var f={type:Ax,observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:u,name:i};o&&ui(this,f)}}finally{Ss()}return!0},t.observe_=function(i,r){return qc(this,i)},t.intercept_=function(i){return Hc(this,i)},t.notifyPropertyAddition_=function(i,r){var n,l,a=ci(this),o=!1;if(a||o){var h=a||o?{type:Zr,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:i,newValue:r}:null;a&&ui(this,h)}(n=this.pendingKeys_)==null||(l=n.get(i))==null||l.set(!0),this.keysAtom_.reportChanged()},t.ownKeys_=function(){return this.keysAtom_.reportObserved(),Vd(this.target_)},t.keys_=function(){return this.keysAtom_.reportObserved(),Object.keys(this.target_)},s}();function $d(s,t){var e;if(lr(s,dt))return s;var i=(e=t==null?void 0:t.name)!=null?e:"ObservableObject",r=new Eb(s,new Map,String(i),av(t));return Dd(s,dt,r),s}var Jv=Mo("ObservableObjectAdministration",Eb);function Ix(s){return Ex[s]||(Ex[s]={get:function(){return this[dt].getObservablePropValue_(s)},set:function(e){return this[dt].setObservablePropValue_(s,e)}})}function Dc(s){return Ud(s)?Jv(s[dt]):!1}function Tx(s,t,e){var i;(i=s.target_[Ci])==null||delete i[e]}function Sx(s,t,e){if(!1)var i,r,n}var tw=Ib(0),Vm=0,Ab=function(){};function ew(s,t){Object.setPrototypeOf?Object.setPrototypeOf(s.prototype,t):s.prototype.__proto__!==void 0?s.prototype.__proto__=t:s.prototype=t}ew(Ab,Array.prototype);var tp=function(s,t,e){Ux(i,s);function i(n,l,a,o){var h;a===void 0&&(a="ObservableArray"),o===void 0&&(o=!1),h=s.call(this)||this;var c=new Jm(a,l,o,!0);if(c.proxy_=Lm(h),Fx(Lm(h),dt,c),n&&n.length){var u=Wc(!0);h.spliceWithArray(0,0,n),$c(u)}return Object.defineProperty(Lm(h),"0",tw),h}var r=i.prototype;return r.concat=function(){this[dt].atom_.reportObserved();for(var l=arguments.length,a=new Array(l),o=0;o<l;o++)a[o]=arguments[o];return Array.prototype.concat.apply(this.slice(),a.map(function(h){return Wd(h)?h.slice():h}))},r[e]=function(){var n=this,l=0;return Vc({next:function(){return l<n.length?{value:n[l++],done:!1}:{done:!0,value:void 0}}})},qm(i,[{key:"length",get:function(){return this[dt].getArrayLength_()},set:function(l){this[dt].setArrayLength_(l)}},{key:t,get:function(){return"Array"}}]),i}(Ab,Symbol.toStringTag,Symbol.iterator);Object.entries(Fd).forEach(function(s){var t=s[0],e=s[1];t!=="concat"&&Dd(tp.prototype,t,e)});function Ib(s){return{enumerable:!1,configurable:!0,get:function(){return this[dt].get_(s)},set:function(e){this[dt].set_(s,e)}}}function sw(s){ar(tp.prototype,""+s,Ib(s))}function Tb(s){if(s>Vm){for(var t=Vm;t<s+100;t++)sw(t);Vm=s}}Tb(1e3);function iw(s,t,e){return new tp(s,t,e)}function Ro(s,t){if(typeof s=="object"&&s!==null){if(Wd(s))return t!==void 0&&Ct(23),s[dt].atom_;if(Ql(s))return s[dt];if(ko(s)){if(t===void 0)return s.keysAtom_;var e=s.data_.get(t)||s.hasMap_.get(t);return e||Ct(25,t,$m(s)),e}if(Dc(s)){if(!t)return Ct(26);var i=s[dt].values_.get(t);return i||Ct(27,t,$m(s)),i}if(zm(s)||jd(s)||Od(s))return s}else if(di(s)&&Od(s[dt]))return s[dt];Ct(28)}function Sb(s,t){if(s||Ct(29),t!==void 0)return Sb(Ro(s,t));if(zm(s)||jd(s)||Od(s)||ko(s)||Ql(s))return s;if(s[dt])return s[dt];Ct(24,s)}function $m(s,t){var e;if(t!==void 0)e=Ro(s,t);else{if(Qm(s))return s.name;Dc(s)||ko(s)||Ql(s)?e=Sb(s):e=Ro(s)}return e.name_}var Cx=Ld.toString;function ep(s,t,e){return e===void 0&&(e=-1),Hm(s,t,e)}function Hm(s,t,e,i,r){if(s===t)return s!==0||1/s===1/t;if(s==null||t==null)return!1;if(s!==s)return t!==t;var n=typeof s;if(n!=="function"&&n!=="object"&&typeof t!="object")return!1;var l=Cx.call(s);if(l!==Cx.call(t))return!1;switch(l){case"[object RegExp]":case"[object String]":return""+s==""+t;case"[object Number]":return+s!=+s?+t!=+t:+s==0?1/+s===1/t:+s==+t;case"[object Date]":case"[object Boolean]":return+s==+t;case"[object Symbol]":return typeof Symbol!="undefined"&&Symbol.valueOf.call(s)===Symbol.valueOf.call(t);case"[object Map]":case"[object Set]":e>=0&&e++;break}s=Rx(s),t=Rx(t);var a=l==="[object Array]";if(!a){if(typeof s!="object"||typeof t!="object")return!1;var o=s.constructor,h=t.constructor;if(o!==h&&!(di(o)&&o instanceof o&&di(h)&&h instanceof h)&&"constructor"in s&&"constructor"in t)return!1}if(e===0)return!1;e<0&&(e=-1),i=i||[],r=r||[];for(var c=i.length;c--;)if(i[c]===s)return r[c]===t;if(i.push(s),r.push(t),a){if(c=s.length,c!==t.length)return!1;for(;c--;)if(!Hm(s[c],t[c],e-1,i,r))return!1}else{var u=Object.keys(s),d;if(c=u.length,Object.keys(t).length!==c)return!1;for(;c--;)if(d=u[c],!(lr(t,d)&&Hm(s[d],t[d],e-1,i,r)))return!1}return i.pop(),r.pop(),!0}function Rx(s){return Wd(s)?s.slice():Kl(s)||ko(s)||Gc(s)||Ql(s)?Array.from(s.entries()):s}function Vc(s){return s[Symbol.iterator]=rw,s}function rw(){return this}["Symbol","Map","Set"].forEach(function(s){var t=Mx();typeof t[s]=="undefined"&&Ct("MobX requires global '"+s+"' to be available or polyfilled")});typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:Tv,extras:{getDebugName:$m},$mobx:dt});var Hd={cash:{id:1001,title:"\u73B0\u91D1",type:"money"},repute:{id:1002,title:"\u58F0\u671B",type:"money"},gold:{id:2001,title:"\u91D1\u77FF\u77F3",type:"mineral"},relic1:{id:3001,title:"Ancient currency",type:"relic",extra:{cash:10,repute:1}},relic2:{id:3002,title:"Statue",type:"relic",extra:{cash:20,repute:2}},relic3:{id:3003,title:"Fossil",type:"relic",extra:{cash:30,repute:2}},tech_mine:{id:9001,title:"\u79D1\u6280\uFF1A\u6316\u77FF",type:"hide"},tech_craft:{id:9002,title:"\u79D1\u6280\uFF1A\u5DE5\u7A0B",type:"hide"}},Cb={};for(let[s,t]of Object.entries(Hd))t.name=s,Cb[t.id]=t;var Po=class extends Vt{constructor(){super(...arguments);this.pay=this.cost;this.canPay=this.canCost}get(e){return this.points[e]||0}getById(e){return this.get(Cb[e].name)}tryCost(e,i=null){return $(this,null,function*(){return this.canCost(e)?this.cost(e,i):!1})}tryEarn(){}canCost(e){for(let i of Object.keys(e))if(this.points[i]<e[i])return!1;return!0}cost(e,i=null){return $(this,null,function*(){for(let r of Object.keys(e)){let n=e[r];n<0&&(n=0),this.points[r]-=n}return!0})}canEarn(e){for(let i of Object.keys(e))if(Hd[i].limit!==null&&(this.points[i]||0)+e[i]>Hd[i].limit)return!1;return!0}earn(e,i=null){for(let r of Object.keys(e)){let n=e[r];n<0&&(n=0);let l=this.points;l[r]||(l[r]=0),l[r]+=n}return!0}getAllItems(e){}sync(){return $(this,null,function*(){})}save(){return this.points}load(e){Object.assign(this.points,e);let i=this.points}init(){this.points={};for(let[e,i]of Object.entries(Hd))this.points[i]=0;this.points.cash=100,this.points.repute=0,pb(this)}};gd([me],Po.prototype,"points",2),gd([or],Po.prototype,"cost",1),gd([or],Po.prototype,"earn",1);var Jl=Io(wd());var UC=new Jl.default(1,0),qd=new Jl.default(0,0);function zd(s,t,e){return s+(t-s)*e}function nw(s){if(s==null)return null;switch(typeof s){case"number":return s;case"object":return zd(s[0],s[1],Math.random());case"function":return s(0)}}function Rb(s,t){if(s==null)return null;switch(typeof s){case"number":return s;case"object":return zd(s[0],s[1],t);case"function":return s(t)}}function ow(s){return s==null?null:s instanceof Jl.default?s.clone():s instanceof Function?s(0):new Jl.default(zd(s[0].x,s[1].x,Math.random()),zd(s[0].y,s[1].y,Math.random()))}function op(s){Object.getOwnPropertyNames(this).forEach(t=>{typeof this[t]=="number"?this[t]=nw(s[t])||this[t]:this[t]instanceof Jl.default?this[t]=ow(s[t])||this[t]:typeof this[t]=="string"&&(this[t]=s[t]||this[t])})}var sp=class extends Is{constructor(e){super();this.config=e;this.life=1;this._duration=1;this.vr=0;this.image="";this.scale=1;this.alpha=1;this.pos=qd;this.rot=0;this.vel=qd;op.bind(this)(e),this._duration=this.life,this.enableUpdate(),this.sprite=new PIXI.Sprite,this.sprite.anchor.set(.5),PIXI.Assets.load(this.image).then(i=>{this.sprite.texture=i,this.update(0)})}update(e){if(this.life-=e,this.life<=0){this.dispose();return}let i=1-this.life/this._duration,r=Rb(this.config.scale,i),n=Rb(this.config.alpha,i);this.pos.add(this.vel.multiply(e,!0)),this.rot+=this.vr*e,this.sprite.position.set(this.pos.x,this.pos.y),this.sprite.rotation=this.rot,this.sprite.scale.set(r),this.sprite.alpha=n}dispose(){this.sprite.destroy(),super.dispose()}},ip=class extends Is{constructor(e){super();this.config=e;this.burstCount=1;this.freq=0;this.delay=0;this.wave=-1;this._canFire=!0;op.bind(this)(e),this.delay?this.$delay(this.delay*1e3,()=>this.enableUpdate()):this.enableUpdate()}update(e){!this._canFire||(this.fire(),this._canFire=!1,this.$delay(this.freq*1e3,()=>this._canFire=!0),this.wave>0&&(this.wave-=1,this.wave<=0&&this.ev.emit("stop")))}fire(){console.log("\u53D1\u5C04\u7C92\u5B50");for(let e=0;e<this.burstCount;e++)this.ev.emit("fire")}},rp=class extends Is{constructor(e){super();this.config=e;this.gravity=qd;this.holeHole=qd;this.dumpLinear=.995;this.dumpAngle=.995;this.particles=[];op.bind(this)(e),this.enableUpdate()}update(e){this.particles.forEach(i=>{i.vel.add(this.gravity.multiply(e,!0))})}createItem(e){let i=new sp(this.config);e.addChild(i.sprite),this.particles.push(i),i.ev.on("dispose",()=>{this.particles=this.particles.filter(r=>r!=i),this.particles.length==0&&this.ev.emit("empty")})}dispose(){[...this.particles].forEach(e=>e.dispose()),super.dispose()}},np=class extends Is{constructor(e,i){super();this.root=e;this.config=i;this.emitter=new ip(i),Object.getOwnPropertyNames(this.emitter).forEach(r=>{i[r]&&(this.emitter[r]=i[r])}),this.environement=new rp(i),Object.getOwnPropertyNames(this.environement).forEach(r=>{i[r]&&(this.environement[r]=i[r])}),this.emitter.ev.on("fire",()=>this.environement.createItem(e)),this.emitter.ev.on("stop",()=>{this.emitter.dispose(),this.emitter=null}),this.environement.ev.on("empty",()=>this.dispose())}dispose(){var e;(e=this.emitter)==null||e.dispose(),this.environement.dispose(),super.dispose()}},zc=class extends Vt{constructor(){super(...arguments);this.particles=[]}createParticle(e,i){let r=new np(e,i);return this.particles.push(r),r.ev.on("dispose",()=>Bm(this.particles,r)),r}removeParticle(e){e.disposed||e.dispose(),Bm(this.particles,e)}};var Zd=class extends Vt{constructor(){super(...arguments);this.mode="rush"}start(){this.loadData()}loadData(){let e=localStorage.getItem(Fm);e?this.data=JSON.parse(e):(this.newData(),this.saveData());let i=Date.now()-this.data.createTime}newData(){this.data={bgm:!0,fx:!0,vibrate:!0,createTime:Date.now(),lastTime:Date.now(),level:0,level_unlock:null,level_unlock_progress:0,skinUnlocked:["male1","female1"],skin_male:"male1",skin_female:"female1",skin_toilet:null,sp_level:0}}saveData(){this.data.lastTime=Date.now(),localStorage.setItem(Fm,JSON.stringify(this.data))}getSkinConfig(e){switch(e){case"male":return Oo[this.data.skin_male];case"female":return Oo[this.data.skin_female];case"toilet":return Oo[this.data.skin_toilet]}}getSkinConfigByID(e){return Oo[e]}setSkin(e,i){switch(e){case"male":this.data.skin_male=i;break;case"female":this.data.skin_female=i;break;case"toilet":this.data.skin_toilet=i;break}this.data.skinUnlocked.includes(i)||this.data.skinUnlocked.push(i),this.saveData()}getSkinUnlock(){if(!this.data.level_unlock){let e=Object.keys(Oo);for(let i=0;i<e.length;i++){let r=e[i];if(!this.data.skinUnlocked.includes(r)){this.data.level_unlock=r,this.data.level_unlock_progress=0,this.saveData();break}}}return{skin:this.data.level_unlock,progress:this.data.level_unlock_progress}}skinUnlockTo(e=.2){this.data.level_unlock_progress+=e,this.saveData()}nextLevel(){this.mode=="link"?this.data.sp_level+=1:this.data.level+=1,this.saveData()}getLevel(){return Kd[this.data.level]?Kd[this.data.level].level:qr(Kd).level}getSPLevel(){return ap[this.data.sp_level]?ap[this.data.sp_level].level:qr(ap).level}},Kd=[];for(let s=1;s<51;s++)Kd.push(s<10?"level_0"+s:"level_"+s);var ap=[{level:"link_01"},{level:"link_02"}],Oo={male1:{id:"male1",type:"male",skin:"char1",skin_win:"char_win1",order:1},male2:{id:"male2",type:"male",skin:"char2",skin_win:"char_win2",order:2},male3:{id:"male3",type:"male",skin:"char3",skin_win:"char_win3",order:3},male4:{id:"male4",type:"male",skin:"char4",skin_win:"char_win4",order:4},male5:{id:"male5",type:"male",skin:"char5",skin_win:"char_win5",order:5},male6:{id:"male6",type:"male",skin:"char6",skin_win:"char_win6",order:6},male7:{id:"male7",type:"male",skin:"char7",skin_win:"char_win7",order:7},male8:{id:"male8",type:"male",skin:"char8",skin_win:"char_win8",order:8},male9:{id:"male9",type:"male",skin:"char9",skin_win:"char_win9",order:9},male10:{id:"male10",type:"male",skin:"char10",skin_win:"char_win10",order:10},male11:{id:"male11",type:"male",skin:"char11",skin_win:"char_win11",order:11},female1:{id:"female1",type:"female",skin:"lady1",skin_win:"lady_win1",order:1.5},female2:{id:"female2",type:"female",skin:"lady2",skin_win:"lady_win2",order:2.5},female3:{id:"female3",type:"female",skin:"lady3",skin_win:"lady_win3",order:3.5},female4:{id:"female4",type:"female",skin:"lady4",skin_win:"lady_win4",order:4.5},female5:{id:"female5",type:"female",skin:"lady5",skin_win:"lady_win5",order:5.5},female6:{id:"female6",type:"female",skin:"lady6",skin_win:"lady_win6",order:6.5},female7:{id:"female7",type:"female",skin:"lady7",skin_win:"lady_win7",order:7.5},female8:{id:"female8",type:"female",skin:"lady8",skin_win:"lady_win8",order:8.5},toilet0:{id:"toilet0",type:"toilet",skin:"skin1",order:.7},toilet1:{id:"toilet1",type:"toilet",skin:"skin2",order:1.7},toilet2:{id:"toilet2",type:"toilet",skin:"skin3",order:2.7},toilet3:{id:"toilet3",type:"toilet",skin:"skin4",order:3.7},toilet4:{id:"toilet4",type:"toilet",skin:"skin5",order:4.7},toilet5:{id:"toilet5",type:"toilet",skin:"skin6",order:5.7},toilet6:{id:"toilet6",type:"toilet",skin:"skin7",order:6.7}};var Kc=class extends Vt{constructor(){super(...arguments);this.canvas=globalThis._ui||document.getElementById("ui");this.ev=new zi(this);this.evInput=new zi(this)}init(){PIXI.settings.RENDER_OPTIONS.hello=!1;let e=new PIXI.Application({view:this.canvas,clearBeforeRender:!1,backgroundColor:16777215,backgroundAlpha:0,antialias:!1,autoStart:!1,resolution:1,width:window.innerWidth,height:window.innerHeight});this.app=e,this.renderer=this.app.renderer,this.scene=new PIXI.Container,this.app.stage.addChild(this.scene),this.game.ev.on("render",i=>{this.doRender(i)}),this.setupInputBoundary(),this.game.ev.on("resize",this.doResize.bind(this)),this.doResize()}setupInputBoundary(){this.boundary=new PIXI.EventBoundary(this.scene)}doRender(e){this.renderer.render(this.scene),this.ev.emit("render",this.renderer)}doResize(e=window.innerWidth,i=window.innerHeight){if(this.game.render2d.app.renderer.resize(e,i),this.scene){let r=e<i?e/Hr.width:i/Hr.height;this.scene.scale.set(r)}}};var cr=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","DialogStoryBoxP")}onConstruct(){this.m_content=this.getChildAt(1),this.m_btnClose=this.getChildAt(4),this.m_fx_flash=this.getTransitionAt(0)}};cr.URL="ui://j8b2cwkbqrgt12";var ur=class extends fgui.Window{constructor(e){super();this.ev=new zi(this);this.viewCls=e}get view(){return this.contentPane}onInit(){this.contentPane=this.viewCls.createInstance(),super.onInit(),this.ev.emit("init")}onShown(){super.center(),super.onShown(),this.ev.emit("blur")}onHide(){super.onHide(),this.ev.emit("hide")}static _create(){let e=this.windowCache.get(this);return e||(e=new this,this.windowCache.set(this,e)),e}static hide(){this._create().hide()}static show(e={modal:!0,extra:null,title:null}){let i=this._create();i.modal=e.modal,i.extra=e.extra,i.style=e.style,i.show();let r=()=>{i.view||setTimeout(()=>{r()},100),e.title&&(console.log("\u8BBE\u7F6E\u6807\u9898\u540D\u79F0",e.title),i.view.m_frame.title=e.title)};return r(),i}setAsFullScreen(){this.width=fgui.GRoot.inst.width,this.height=fgui.GRoot.inst.height}};ur.windowCache=new Map;var No=class extends ur{constructor(){super(cr)}onShown(){this.view.element&&this.view.element.parentElement&&(this.view.element.parentElement.style.pointerEvents="none"),super.onShown()}};var dr=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","DialogStoryChoices")}onConstruct(){this.m_list=this.getChildAt(0)}};dr.URL="ui://j8b2cwkbv44ro";var Qd=class extends ur{constructor(){super(dr);this.items=[]}onInit(){super.onInit(),this.view.m_list.itemRenderer=(e,i)=>{i.data=e,i.text=this.items[e]},this.view.m_list.on("click_item",e=>{this.waitResolve&&this.waitResolve(e.data.data),this.waitResolve=null,this.hide()})}waitClickItem(){return new Promise(e=>{this.waitResolve=e})}onShown(){super.onShown(),this.modal=!0,this.items=this.extra,this.view.m_list.numItems=this.items.length}};var fr=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","DialogToastP")}onConstruct(){this.m_pos_state=this.getControllerAt(0),this.m_toast=this.getChildAt(0),this.m_fx_flash=this.getTransitionAt(0)}};fr.URL="ui://j8b2cwkbqrgt11";var Zc=class extends ur{constructor(){super(fr)}onShown(){this.view.element&&this.view.element.parentElement&&(this.view.element.parentElement.style.pointerEvents="none"),super.onShown(),this.view.m_toast.m_txt.text=this.extra.text,this.view.m_pos_state.selectedIndex=this.extra.pos}};var Jd=class extends Vt{constructor(){super(...arguments);this.waitNext=[];this.toastCount=0}init(){this.storyBox=No._create(),this.storyBox.ev.on("init",()=>{this.storyBox.view.m_btnClose.onClick(()=>{if(!this._curTellTypingEffect){for(let e of this.waitNext)e(null);this.waitNext.length=0}})})}choices(e){return $(this,null,function*(){return yield Qd.show({modal:!1,extra:e}).waitClickItem()})}tell(e,i=.05){return No.show({modal:!1,extra:null,title:null}),this.storyBox.view.m_content.text=e,new Promise(r=>{this.waitNext.push(r)})}toast(e,i=1e3,r=0){return Zc.show({modal:!1,extra:{pos:r,text:e,duration:i}}),new Promise(n=>{i<10?n(null):(this.toastCount+=1,this.game.task.delay(i,()=>{this.toastCount-=1,this.toastCount===0&&Zc.hide(),n(null)}))})}hide(){No.hide()}show(){No.show()}};var Ub=Io(Lb()),ef=class{constructor(t){this.heap=new Ub.MinHeap,this.getCurrentTime=t}callAfter(t,e){this.heap.insert(this.getCurrentTime()+t,e)}callAt(t,e){this.heap.insert(t,e)}update(t){let e=this.heap.root;for(;e&&this.getCurrentTime()>=e.key;){let i=e.value;if(!i.cancelled)try{i.execute()}catch(r){console.error(r)}this.heap.remove(0),e=this.heap.root}}};var Qc,sf=class{constructor(){Nl(this,Qc,-1);this.root=new Fo(-1,null),this.root.next=this.root,this.root.prev=this.root}get expiration(){return Ye(this,Qc)}set expiration(t){Sc(this,Qc,t)}*[Symbol.iterator](){let t=this.root.next;for(;t!==this.root;){let e=t.next;t.cancelled||(yield t),t=e}}add(t){let e=!1;for(;!e;)if(t.remove(),t.list==null){let i=this.root.prev;t.next=this.root,t.prev=i,t.list=this,i.next=t,this.root.prev=t,e=!0}}remove(t){t.list===this&&(t.next.prev=t.prev,t.prev.next=t.next,t.next=null,t.prev=null,t.list=null)}flush(t){let e=this.root.next;for(;e!==this.root;){let i=e.next;if(this.remove(e),!e.cancelled&&!t.add(e)&&(e.execute&&e.execute(),t&&e.intervalDuration!==null)){let r=e;r.expirationMs+=r.intervalDuration,t.add(r)}e=i}this.expiration=-1}};Qc=new WeakMap;var Fo=class{constructor(t,e,i=null){this.list=null;this.next=null;this.prev=null;this.cancelled=!1;this.execute=e,this.expirationMs=t,this.intervalDuration=i}get key(){return this.expirationMs}remove(){var t=this.list;t!=null&&t.remove(this)}};var th=class{constructor(t=10,e=20,i=0,r=null,n=null){this.overflowWheel=null;this.tickMs=t,this.wheelSize=e,this.interval=t*e,this.buckets=[...Array(e)].map(l=>new sf),this.currentTime=i-i%t,this.dq=r,this.root=n===null?this:n}addOverflowWheel(){this.overflowWheel||(this.overflowWheel=new th(this.interval,this.wheelSize,this.currentTime,this.dq,this.root))}add(t){let e=t.expirationMs;if(t.cancelled)return!1;if(e<this.currentTime+this.tickMs)return!1;if(e<this.currentTime+this.interval){let i=Math.floor(e/this.tickMs),r=this.buckets[i%this.wheelSize];r.add(t);let n=i*this.tickMs;return r.expiration!==n&&(r.expiration=n,this.dq.callAt(r.expiration,{cancelled:!1,execute:()=>{this.root.advanceClock(r.expiration),r.flush(this.root)}})),!0}else return this.overflowWheel==null&&this.addOverflowWheel(),this.overflowWheel.add(t)}advanceClock(t){t>=this.currentTime+this.tickMs&&(this.currentTime=t-t%this.tickMs,this.overflowWheel!=null&&this.overflowWheel.advanceClock(this.currentTime))}};var ki,Bo,eh,rf=class extends Vt{constructor(){super();Nl(this,ki,void 0);Nl(this,Bo,void 0);Nl(this,eh,new Map)}getDelayQueue(){return Ye(this,Bo)}init(){Sc(this,Bo,new ef(()=>this.game.time.logicTime)),Sc(this,ki,new th(10,20,this.game.time.logicTime,Ye(this,Bo)))}cancel(e){if(e instanceof Fo){if(!e.cancelled)return e.cancelled=!0,e.remove(),!0}else{let i=Ye(this,eh).get(e);if(i)return i.cancelled=!0,!0}return!1}interval(e,i=null){if(e<Ye(this,ki).tickMs)throw new Error(`\u95F4\u9694\u65F6\u95F4\u7C92\u5EA6 ${e} \u5C0F\u4E8E\u6700\u5C0F\u5141\u8BB8\u65F6\u95F4 ${Ye(this,ki).tickMs}`);let r=new Fo(this.game.time.logicTime+e,i,e);return Ye(this,ki).add(r),r}delay(e,i=null){if(e<Ye(this,ki).tickMs)throw new Error(`\u95F4\u9694\u65F6\u95F4\u7C92\u5EA6 ${e} \u5C0F\u4E8E\u6700\u5C0F\u5141\u8BB8\u65F6\u95F4 ${Ye(this,ki).tickMs}`);let r=new Fo(this.game.time.logicTime+e,null),n=new Promise((l,a)=>{let o=()=>{Ye(this,eh).delete(n),i&&i(),l(null)};r.execute=o,Ye(this,ki).add(r)});return Ye(this,eh).set(n,r),n}update(e){Ye(this,Bo).update(e)}};ki=new WeakMap,Bo=new WeakMap,eh=new WeakMap;var nf=class extends Vt{constructor(){super(...arguments);this.logicTime=0;this.startTime=0;this.realityTime=0}updateFixed(e){let i=e*1e3;this.startTime+=i,this.realityTime+=i}update(e){let i=e*1e3;this.logicTime+=i}};var mr=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("loading","loading")}onConstruct(){this.m_loadingCircle=this.getChildAt(1),this.m_loadingBar=this.getChildAt(2),this.m_role_slot=this.getChildAt(3)}};mr.URL="ui://kq97nyc0kmld87";var Jc=class{static bindAll(){fgui.UIObjectFactory.setPackageItemExtension(mr.URL,mr)}};var Lo=class extends fgui.GButton{static createInstance(){return fgui.UIPackage.createObject("main","IconButton")}onConstruct(){this.m_bg_state=this.getControllerAt(1)}};Lo.URL="ui://j8b2cwkb7n7qe";var Uo=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","DialogConfirm")}onConstruct(){this.m_frame=this.getChildAt(0),this.m_btnYes=this.getChildAt(1),this.m_btnNo=this.getChildAt(2),this.m_text=this.getChildAt(3)}};Uo.URL="ui://j8b2cwkb7oxo5";var Do=class extends fgui.GButton{static createInstance(){return fgui.UIPackage.createObject("main","Button")}onConstruct(){this.m_color_state=this.getControllerAt(1)}};Do.URL="ui://j8b2cwkbaemq6";var Vo=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","clipItem")}onConstruct(){this.m_bg=this.getChildAt(0)}};Vo.URL="ui://j8b2cwkbbwrs8s";var Go=class extends fgui.GLabel{static createInstance(){return fgui.UIPackage.createObject("main","DialogSetting")}onConstruct(){this.m_frame=this.getChildAt(0),this.m_text=this.getChildAt(1),this.m_btnYes=this.getChildAt(2),this.m_btnNo=this.getChildAt(3)}};Go.URL="ui://j8b2cwkbcx8uf";var Xo=class extends fgui.GButton{static createInstance(){return fgui.UIPackage.createObject("main","_Frame")}onConstruct(){this.m_dragArea=this.getChildAt(1),this.m_closeButton=this.getChildAt(2),this.m_contentArea=this.getChildAt(4)}};Xo.URL="ui://j8b2cwkbcx8ui";var Yo=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_01")}onConstruct(){this.m_ctrl=this.getChildAt(0),this.m_t_hand=this.getChildAt(5),this.m_tutorial=this.getTransitionAt(0)}};Yo.URL="ui://j8b2cwkbk8ns9l";var jo=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_02")}onConstruct(){this.m_ctrl=this.getChildAt(0),this.m_t_hand=this.getChildAt(5),this.m_tutorial=this.getTransitionAt(0)}};jo.URL="ui://j8b2cwkbk8ns9m";var Wo=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_03")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};Wo.URL="ui://j8b2cwkbk8ns9n";var $o=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_04")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};$o.URL="ui://j8b2cwkbk8ns9o";var Ho=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_05")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};Ho.URL="ui://j8b2cwkbk8ns9p";var qo=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_06")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};qo.URL="ui://j8b2cwkbk8ns9q";var zo=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_07")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};zo.URL="ui://j8b2cwkbk8ns9r";var Ko=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_08")}onConstruct(){this.m_ctrl=this.getChildAt(0),this.m_t0=this.getTransitionAt(0)}};Ko.URL="ui://j8b2cwkbk8ns9s";var Zo=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_09")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};Zo.URL="ui://j8b2cwkbk8ns9t";var Qo=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_10")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};Qo.URL="ui://j8b2cwkbk8ns9u";var Jo=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_11")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};Jo.URL="ui://j8b2cwkbk8ns9v";var ta=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_12")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};ta.URL="ui://j8b2cwkbk8ns9w";var ea=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_13")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};ea.URL="ui://j8b2cwkbk8ns9x";var sa=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_16")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};sa.URL="ui://j8b2cwkbk8nsa0";var ia=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_18")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};ia.URL="ui://j8b2cwkbk8nsa2";var ra=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_19")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};ra.URL="ui://j8b2cwkbk8nsa3";var na=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_20")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};na.URL="ui://j8b2cwkbk8nsa4";var oa=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_21")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};oa.URL="ui://j8b2cwkbk8nsa5";var aa=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_22")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};aa.URL="ui://j8b2cwkbk8nsa6";var la=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_23")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};la.URL="ui://j8b2cwkbk8nsa7";var ha=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_24")}onConstruct(){this.m_ctrl=this.getChildAt(0),this.m_t0=this.getTransitionAt(0)}};ha.URL="ui://j8b2cwkbk8nsa8";var ca=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_25")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};ca.URL="ui://j8b2cwkbk8nsa9";var ua=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_26")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};ua.URL="ui://j8b2cwkbk8nsaa";var da=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_27")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};da.URL="ui://j8b2cwkbk8nsab";var fa=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_29")}onConstruct(){this.m_ctrl=this.getChildAt(0),this.m_t0=this.getTransitionAt(0)}};fa.URL="ui://j8b2cwkbk8nsad";var ma=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_30")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};ma.URL="ui://j8b2cwkbk8nsae";var pa=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_31")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};pa.URL="ui://j8b2cwkbk8nsaf";var ga=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_32")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};ga.URL="ui://j8b2cwkbk8nsah";var xa=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_33")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};xa.URL="ui://j8b2cwkbk8nsai";var ba=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_34")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};ba.URL="ui://j8b2cwkbk8nsaj";var _a=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_35")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};_a.URL="ui://j8b2cwkbk8nsak";var ya=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_37")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};ya.URL="ui://j8b2cwkbk8nsam";var va=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_38")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};va.URL="ui://j8b2cwkbk8nsan";var wa=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_39")}onConstruct(){this.m_ctrl=this.getChildAt(0),this.m_t0=this.getTransitionAt(0)}};wa.URL="ui://j8b2cwkbk8nsao";var Ea=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_40")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};Ea.URL="ui://j8b2cwkbk8nsap";var Aa=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_41")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};Aa.URL="ui://j8b2cwkbk8nsaq";var Ia=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_42")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};Ia.URL="ui://j8b2cwkbk8nsar";var Ta=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_43")}onConstruct(){this.m_ctrl=this.getChildAt(0),this.m_t0=this.getTransitionAt(0)}};Ta.URL="ui://j8b2cwkbk8nsas";var Sa=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_44")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};Sa.URL="ui://j8b2cwkbk8nsat";var Ca=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_45")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};Ca.URL="ui://j8b2cwkbk8nsau";var Ra=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_46")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};Ra.URL="ui://j8b2cwkbk8nsav";var Ma=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_47")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};Ma.URL="ui://j8b2cwkbk8nsaw";var ka=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_48")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};ka.URL="ui://j8b2cwkbk8nsax";var Pa=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_49")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};Pa.URL="ui://j8b2cwkbk8nsay";var Oa=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_50")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};Oa.URL="ui://j8b2cwkbk8nsaz";var Na=class extends fgui.GButton{static createInstance(){return fgui.UIPackage.createObject("main","scaleBtn")}onConstruct(){this.m_with_ad=this.getControllerAt(1),this.m_with_lock=this.getControllerAt(2)}};Na.URL="ui://j8b2cwkbkmld83";var pr=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","setting")}onConstruct(){this.m_panel=this.getChildAt(1)}};pr.URL="ui://j8b2cwkbkmld84";var Fa=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","settingPanel")}onConstruct(){this.m_btn_close=this.getChildAt(1),this.m_title=this.getChildAt(2),this.m_btn_fx=this.getChildAt(9),this.m_btn_bgm=this.getChildAt(10),this.m_btn_vibrate=this.getChildAt(11)}};Fa.URL="ui://j8b2cwkbkmld86";var gr=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","stage")}onConstruct(){this.m_stage=this.getChildAt(0),this.m_level=this.getChildAt(1),this.m_btn_back=this.getChildAt(2),this.m_btn_restart=this.getChildAt(3),this.m_btn_tip=this.getChildAt(4),this.m_btn_skip=this.getChildAt(5)}};gr.URL="ui://j8b2cwkbkmld88";var Ba=class extends fgui.GLabel{static createInstance(){return fgui.UIPackage.createObject("main","titleLabel")}onConstruct(){this.m_gray=this.getControllerAt(0)}};Ba.URL="ui://j8b2cwkbkmld8a";var La=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","level_17")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};La.URL="ui://j8b2cwkbkmld8d";var xr=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","win")}onConstruct(){this.m_type=this.getControllerAt(0),this.m_title=this.getChildAt(6),this.m_unlock_progress=this.getChildAt(7),this.m_unlock=this.getChildAt(8),this.m_btn_retry=this.getChildAt(9),this.m_btn_skip=this.getChildAt(10)}};xr.URL="ui://j8b2cwkbkmld8e";var br=class extends fgui.GButton{static createInstance(){return fgui.UIPackage.createObject("main","iconItem")}onConstruct(){this.m_with_ad=this.getControllerAt(1),this.m_with_lock=this.getControllerAt(2)}};br.URL="ui://j8b2cwkbkmld8f";var _r=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","lose")}onConstruct(){this.m_type=this.getControllerAt(0),this.m_title=this.getChildAt(0),this.m_icon=this.getChildAt(2),this.m_btn_retry=this.getChildAt(7),this.m_btn_skip=this.getChildAt(8)}};_r.URL="ui://j8b2cwkbkmld8g";var yr=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","shop")}onConstruct(){this.m_title=this.getChildAt(0),this.m_back=this.getChildAt(1),this.m_list=this.getChildAt(2)}};yr.URL="ui://j8b2cwkbkmld8h";var vr=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","shopItem")}onConstruct(){this.m_color=this.getControllerAt(0),this.m_bg=this.getChildAt(0),this.m_icon=this.getChildAt(1),this.m_select=this.getChildAt(2)}};vr.URL="ui://j8b2cwkbkmld8i";var wr=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","title")}onConstruct(){this.m_startBtn=this.getChildAt(0),this.m_setting=this.getChildAt(1),this.m_title=this.getChildAt(2),this.m_level=this.getChildAt(3),this.m_skin=this.getChildAt(4),this.m_roleSlot=this.getChildAt(6),this.m_btn_sp=this.getChildAt(7),this.m_reset=this.getChildAt(8),this.m_next=this.getChildAt(9)}};wr.URL="ui://j8b2cwkbkmld8j";var Ua=class extends fgui.GButton{static createInstance(){return fgui.UIPackage.createObject("main","ViewDetailButton")}onConstruct(){this.m_bg=this.getChildAt(0)}};Ua.URL="ui://j8b2cwkbkywt2c";var Da=class extends fgui.GButton{static createInstance(){return fgui.UIPackage.createObject("main","MuteButton")}onConstruct(){this.m_state=this.getControllerAt(1)}};Da.URL="ui://j8b2cwkbkywt2s";var Va=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","link_01")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};Va.URL="ui://j8b2cwkblcub8y";var Ga=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","link_02")}onConstruct(){this.m_ctrl=this.getChildAt(0)}};Ga.URL="ui://j8b2cwkblcub9i";var Er=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","new")}onConstruct(){this.m_title=this.getChildAt(1),this.m_ok=this.getChildAt(2),this.m_bg=this.getChildAt(3),this.m_icon=this.getChildAt(4)}};Er.URL="ui://j8b2cwkblcub9j";var Xa=class extends fgui.GLabel{static createInstance(){return fgui.UIPackage.createObject("main","DialogIframe")}onConstruct(){this.m_frame=this.getChildAt(0),this.m_anchor=this.getChildAt(1)}};Xa.URL="ui://j8b2cwkbqrgt13";var Ya=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","DialogToast")}onConstruct(){this.m_pos_state=this.getControllerAt(0),this.m_toast=this.getChildAt(0),this.m_fx_flash=this.getTransitionAt(0)}};Ya.URL="ui://j8b2cwkbv44rn";var ja=class extends fgui.GButton{static createInstance(){return fgui.UIPackage.createObject("main","StoryChoicesItem")}onConstruct(){this.m_bg=this.getChildAt(0)}};ja.URL="ui://j8b2cwkbv44rp";var Wa=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","Toast")}onConstruct(){this.m_txt=this.getChildAt(1)}};Wa.URL="ui://j8b2cwkbv44rr";var $a=class extends fgui.GComponent{static createInstance(){return fgui.UIPackage.createObject("main","DialogStoryBox")}onConstruct(){this.m_content=this.getChildAt(1),this.m_btnClose=this.getChildAt(4),this.m_fx_flash=this.getTransitionAt(0)}};$a.URL="ui://j8b2cwkbv44rs";var tu=class{static bindAll(){fgui.UIObjectFactory.setPackageItemExtension(Lo.URL,Lo),fgui.UIObjectFactory.setPackageItemExtension(Uo.URL,Uo),fgui.UIObjectFactory.setPackageItemExtension(sr.URL,sr),fgui.UIObjectFactory.setPackageItemExtension(Ki.URL,Ki),fgui.UIObjectFactory.setPackageItemExtension(Do.URL,Do),fgui.UIObjectFactory.setPackageItemExtension(Vo.URL,Vo),fgui.UIObjectFactory.setPackageItemExtension(Go.URL,Go),fgui.UIObjectFactory.setPackageItemExtension(Xo.URL,Xo),fgui.UIObjectFactory.setPackageItemExtension(Yo.URL,Yo),fgui.UIObjectFactory.setPackageItemExtension(jo.URL,jo),fgui.UIObjectFactory.setPackageItemExtension(Wo.URL,Wo),fgui.UIObjectFactory.setPackageItemExtension($o.URL,$o),fgui.UIObjectFactory.setPackageItemExtension(Ho.URL,Ho),fgui.UIObjectFactory.setPackageItemExtension(qo.URL,qo),fgui.UIObjectFactory.setPackageItemExtension(zo.URL,zo),fgui.UIObjectFactory.setPackageItemExtension(Ko.URL,Ko),fgui.UIObjectFactory.setPackageItemExtension(Zo.URL,Zo),fgui.UIObjectFactory.setPackageItemExtension(Qo.URL,Qo),fgui.UIObjectFactory.setPackageItemExtension(Jo.URL,Jo),fgui.UIObjectFactory.setPackageItemExtension(ta.URL,ta),fgui.UIObjectFactory.setPackageItemExtension(ea.URL,ea),fgui.UIObjectFactory.setPackageItemExtension(sa.URL,sa),fgui.UIObjectFactory.setPackageItemExtension(ia.URL,ia),fgui.UIObjectFactory.setPackageItemExtension(ra.URL,ra),fgui.UIObjectFactory.setPackageItemExtension(na.URL,na),fgui.UIObjectFactory.setPackageItemExtension(oa.URL,oa),fgui.UIObjectFactory.setPackageItemExtension(aa.URL,aa),fgui.UIObjectFactory.setPackageItemExtension(la.URL,la),fgui.UIObjectFactory.setPackageItemExtension(ha.URL,ha),fgui.UIObjectFactory.setPackageItemExtension(ca.URL,ca),fgui.UIObjectFactory.setPackageItemExtension(ua.URL,ua),fgui.UIObjectFactory.setPackageItemExtension(da.URL,da),fgui.UIObjectFactory.setPackageItemExtension(fa.URL,fa),fgui.UIObjectFactory.setPackageItemExtension(ma.URL,ma),fgui.UIObjectFactory.setPackageItemExtension(pa.URL,pa),fgui.UIObjectFactory.setPackageItemExtension(ga.URL,ga),fgui.UIObjectFactory.setPackageItemExtension(xa.URL,xa),fgui.UIObjectFactory.setPackageItemExtension(ba.URL,ba),fgui.UIObjectFactory.setPackageItemExtension(_a.URL,_a),fgui.UIObjectFactory.setPackageItemExtension(ya.URL,ya),fgui.UIObjectFactory.setPackageItemExtension(va.URL,va),fgui.UIObjectFactory.setPackageItemExtension(wa.URL,wa),fgui.UIObjectFactory.setPackageItemExtension(Ea.URL,Ea),fgui.UIObjectFactory.setPackageItemExtension(Aa.URL,Aa),fgui.UIObjectFactory.setPackageItemExtension(Ia.URL,Ia),fgui.UIObjectFactory.setPackageItemExtension(Ta.URL,Ta),fgui.UIObjectFactory.setPackageItemExtension(Sa.URL,Sa),fgui.UIObjectFactory.setPackageItemExtension(Ca.URL,Ca),fgui.UIObjectFactory.setPackageItemExtension(Ra.URL,Ra),fgui.UIObjectFactory.setPackageItemExtension(Ma.URL,Ma),fgui.UIObjectFactory.setPackageItemExtension(ka.URL,ka),fgui.UIObjectFactory.setPackageItemExtension(Pa.URL,Pa),fgui.UIObjectFactory.setPackageItemExtension(Oa.URL,Oa),fgui.UIObjectFactory.setPackageItemExtension(Na.URL,Na),fgui.UIObjectFactory.setPackageItemExtension(pr.URL,pr),fgui.UIObjectFactory.setPackageItemExtension(Fa.URL,Fa),fgui.UIObjectFactory.setPackageItemExtension(gr.URL,gr),fgui.UIObjectFactory.setPackageItemExtension(Ba.URL,Ba),fgui.UIObjectFactory.setPackageItemExtension(Qi.URL,Qi),fgui.UIObjectFactory.setPackageItemExtension(Ti.URL,Ti),fgui.UIObjectFactory.setPackageItemExtension(La.URL,La),fgui.UIObjectFactory.setPackageItemExtension(xr.URL,xr),fgui.UIObjectFactory.setPackageItemExtension(br.URL,br),fgui.UIObjectFactory.setPackageItemExtension(_r.URL,_r),fgui.UIObjectFactory.setPackageItemExtension(yr.URL,yr),fgui.UIObjectFactory.setPackageItemExtension(vr.URL,vr),fgui.UIObjectFactory.setPackageItemExtension(wr.URL,wr),fgui.UIObjectFactory.setPackageItemExtension(Ua.URL,Ua),fgui.UIObjectFactory.setPackageItemExtension(Da.URL,Da),fgui.UIObjectFactory.setPackageItemExtension(Zi.URL,Zi),fgui.UIObjectFactory.setPackageItemExtension(er.URL,er),fgui.UIObjectFactory.setPackageItemExtension(tr.URL,tr),fgui.UIObjectFactory.setPackageItemExtension(Va.URL,Va),fgui.UIObjectFactory.setPackageItemExtension(Ji.URL,Ji),fgui.UIObjectFactory.setPackageItemExtension(Ga.URL,Ga),fgui.UIObjectFactory.setPackageItemExtension(Er.URL,Er),fgui.UIObjectFactory.setPackageItemExtension(fr.URL,fr),fgui.UIObjectFactory.setPackageItemExtension(cr.URL,cr),fgui.UIObjectFactory.setPackageItemExtension(Xa.URL,Xa),fgui.UIObjectFactory.setPackageItemExtension(rr.URL,rr),fgui.UIObjectFactory.setPackageItemExtension(Ya.URL,Ya),fgui.UIObjectFactory.setPackageItemExtension(dr.URL,dr),fgui.UIObjectFactory.setPackageItemExtension(ja.URL,ja),fgui.UIObjectFactory.setPackageItemExtension(Wa.URL,Wa),fgui.UIObjectFactory.setPackageItemExtension($a.URL,$a)}};var sh=class extends mr{constructor(){super(...arguments);this.updateLoading=()=>{this.m_loadingCircle.rotation+=10,this.m_loadingBar.value+=1}}onConstruct(){super.onConstruct(),console.log("\u52A0\u8F7D\u8D44\u6E90\u4E2D\u3002\u3002\u3002"),this.loadAssets()}loadAssets(){return $(this,null,function*(){this.m_loadingBar.value=0,Y.inst.ev.on("update",this.updateLoading),yield Y.inst.ui.loadPackages("dynamic"),yield Y.inst.assets.loadSpine(),yield Y.inst.assets.loadSound(),yield Y.inst.ui.$wait(()=>this.m_loadingBar.value>=100),Y.inst.ev.off("update",this.updateLoading),Y.inst.ui.changePackageTo("main")})}};var eu=class extends pr{onConstruct(){super.onConstruct(),this.bindEvents()}bindEvents(){this.m_panel.m_btn_close.onClick(()=>{Y.inst.ui.view.changeStateTo("title")}),Y.inst.ui.ev.on("stateChanged",t=>{t=="setting"&&this.updateView()}),this.m_panel.m_btn_bgm.onClick(()=>this.updateSetting()),this.m_panel.m_btn_fx.onClick(()=>this.updateSetting()),this.m_panel.m_btn_vibrate.onClick(()=>this.updateSetting())}updateView(){let t=Y.inst.profile.data;this.m_panel.m_btn_bgm.selected=!t.bgm,this.m_panel.m_btn_fx.selected=!t.fx,this.m_panel.m_btn_vibrate.selected=!t.vibrate}updateSetting(){let t=Y.inst.profile.data;t.bgm=!this.m_panel.m_btn_bgm.selected,t.fx=!this.m_panel.m_btn_fx.selected,t.vibrate=!this.m_panel.m_btn_vibrate.selected,Y.inst.profile.saveData()}};var su=class extends yr{onConstruct(){super.onConstruct(),this.bindEvents()}bindEvents(){this.m_back.onClick(()=>{Y.inst.ui.view.changeStateTo("title")}),Y.inst.ui.ev.on("stateChanged",t=>{t=="shop"?(console.log("\u521B\u5EFA\u5217\u8868"),this.setupView(),this.updateView()):this.clearView()})}clearView(){this.m_list.removeChildren(0,this.m_list.numChildren-1,!0)}setupView(){let t=Y.inst.profile;Object.values(Oo).sort((i,r)=>i.order-r.order).forEach(i=>$(this,null,function*(){let r=vr.createInstance();r.userData=i,this.m_list.addChild(r);let n=yield Y.inst.ui.bindSpineToCom(i.type,r.m_icon.m_bg,.8);r.spine=n,n.state.setAnimation(0,"idle",!0),n.state.timeScale=0,n.skeleton.setSkinByName(i.skin),n.scale.set(.6),r.onClick(()=>{t.setSkin(i.type,i.id),this.updateView()})}))}updateView(){let t=Y.inst.profile.data;for(let e=0;e<this.m_list.numChildren;e++){let i=this.m_list.getChildAt(e),r=i.userData;r.id==t.skin_male||r.id==t.skin_female?(i.m_color.selectedPage="yellow",i.m_select.title="\u5DF2\u9009\u4E2D",i.m_select.m_with_ad.selectedIndex=0):t.skinUnlocked.includes(r.id)?(i.m_color.selectedPage="blue",i.m_select.title="\u5DF2\u89E3\u9501",i.m_select.m_with_ad.selectedIndex=0):(i.m_color.selectedPage="green",i.m_select.title="\u672A\u89E3\u9501",i.m_select.m_with_ad.selectedIndex=1)}}};var iu=class extends wr{onConstruct(){super.onConstruct(),this.bindEvents(),this.initView()}bindEvents(){this.m_setting.onClick(()=>{Y.inst.ui.view.changeStateTo("setting")}),this.m_skin.onClick(()=>{Y.inst.ui.view.changeStateTo("shop")}),this.m_startBtn.onClick(()=>{Y.inst.profile.mode="rush",Y.inst.ui.view.changeStateTo("game")}),Y.inst.ui.ev.on("stateChanged",e=>{e=="title"&&this.updateView()}),this.m_reset.onClick(()=>{Y.inst.profile.newData(),Y.inst.profile.saveData(),this.updateView()}),this.m_next.onClick(()=>{Y.inst.profile.nextLevel(),this.updateView()}),this.m_btn_sp.onClick(()=>{Y.inst.profile.mode="link",Y.inst.ui.view.changeStateTo("game")})}initView(){return $(this,null,function*(){let e=yield Y.inst.ui.bindSpineToCom(ee.names.male,this.m_roleSlot,1);e.state.setAnimation(0,ee.male.anims.stune,!0),this.anim=e,this.updateView()})}updateView(){Y.inst.sound.playBGM(kt.sound.Music1),this.m_level.title=`\u5173\u5361 ${Y.inst.profile.data.level+1}/50`,this.anim.skeleton.setSkinByName(Y.inst.profile.getSkinConfig("male").skin)}};var ru=class extends gr{onConstruct(){super.onConstruct(),this.bindEvents()}updateView(){Y.inst.sound.playBGM(kt.sound.Music2),Y.inst.profile.mode=="rush"?this.m_level.title=`\u7B2C${Y.inst.profile.data.level+1}\u5173`:this.m_level.title=`${Y.inst.gameplay.title}`}bindEvents(){Y.inst.ui.ev.on("stateChanged",t=>{t=="game"&&this.updateView()}),this.m_btn_back.onClick(()=>{Y.inst.ui.view.changeStateTo("title")}),this.m_btn_restart.onClick(()=>{Y.inst.gameplay.startGame()}),this.m_btn_skip.onClick(()=>{Y.inst.profile.nextLevel(),Y.inst.gameplay.startGame()}),this.m_btn_tip.onClick(()=>{Y.inst.profile.mode=="link"?Y.inst.gameplay.showPairLink():Y.inst.gameplay.changeToiletToMix()}),this.bindInputCtrl()}bindInputCtrl(){let t=!1,e=0,i=0,r=Id();this.on(fgui.InteractiveEvents.Move,n=>{if(t){let l=n.clientX/r,a=n.clientY/r,o=l-n.clientX,h=a-n.clientY;e=l,i=a,Y.inst.gameplay.ev.emit("move",l,a,o,h)}}),this.on(fgui.InteractiveEvents.Down,n=>{t=!0,e=n.clientX/r,i=n.clientY/r,Y.inst.gameplay.ev.emit("down",e,i)}),this.on(fgui.InteractiveEvents.Up,n=>{t=!1,e=n.clientX/r,i=n.clientY/r,Y.inst.gameplay.ev.emit("up",e,i)})}};var Ha=Io(wd());var nu=class extends xr{onConstruct(){super.onConstruct(),this.m_btn_retry.onClick(()=>{Y.inst.ui.view.changeStateTo("game")}),this.m_btn_skip.onClick(()=>{Y.inst.profile.nextLevel(),Y.inst.ui.view.changeStateTo("game")}),Y.inst.ui.ev.on("stateChanged",e=>{e=="win"&&this.updateView()})}updateView(){this.m_type.selectedPage="both";let e=Y.inst.profile,i=e.getSkinUnlock(),r=e.getSkinConfigByID(i.skin);e.skinUnlockTo(.2),this.addIconAnim(r),Y.inst.sound.play(kt.sound.PopPrize),this.m_unlock_progress.value=100*i.progress;let n=this.m_unlock_progress.value+20,l=new TWEEN.Tween(this.m_unlock_progress).to({value:n},1e3).onComplete(()=>{n>=100&&(console.log("\u5E94\u8BE5\u8F6C\u573A\u4E86"),this.unlockIcon.m_with_lock.selectedIndex=0,Y.inst.sound.play(kt.sound.Hint),Y.inst.ui.view.changeStateTo("new",r))}).start();Y.inst.gameplay.createParticle(this.displayObject,new Ha.default(0,this.height*.6),[new Ha.default(200,-1e3),new Ha.default(500,-2e3)],2),Y.inst.gameplay.createParticle(this.displayObject,new Ha.default(this.width,this.height*.6),[new Ha.default(-500,-1e3),new Ha.default(-200,-2e3)],2)}addIconAnim(e){return $(this,null,function*(){this.anim&&this.anim.destroy(),this.unlockIcon&&this.unlockIcon.dispose(),this.unlockIcon=br.createInstance(),this.addChild(this.unlockIcon),this.unlockIcon.x=this.m_unlock.x,this.unlockIcon.y=this.m_unlock.y,this.unlockIcon.m_with_lock.selectedIndex=0,this.anim=yield Y.inst.ui.bindSpineToCom(e.type,this.unlockIcon.getChildAt(1),.9),this.anim.scale.set(.4),this.anim.state.setAnimation(0,"idle",!0),this.anim.skeleton.setSkinByName(e.skin),this.anim.autoUpdate=!1,this.anim.update(0)})}};var ou=class extends _r{onConstruct(){super.onConstruct(),this.m_btn_retry.onClick(()=>{Y.inst.ui.view.changeStateTo("game")}),this.m_btn_skip.onClick(()=>{Y.inst.profile.data.level+=1,Y.inst.profile.saveData(),Y.inst.ui.view.changeStateTo("game")}),Y.inst.ui.ev.on("stateChanged",t=>{t=="lose"&&this.updateView()})}updateView(){}};var au=class extends Er{onConstruct(){super.onConstruct(),Y.inst.ui.ev.on("stateChanged",e=>{e=="new"&&this.updateView()}),this.m_ok.onClick(()=>{let e=Y.inst.profile,i=e.getSkinConfigByID(e.data.level_unlock);i&&(e.data.level_unlock=null,e.setSkin(i.type,i.id)),e.nextLevel(),Y.inst.ui.view.changeStateTo("game")})}updateView(){return $(this,null,function*(){this.anim&&this.anim.destroy();let e=Y.inst.profile,i=e.getSkinConfigByID(e.data.level_unlock),r=yield Y.inst.ui.bindSpineToCom(i.type,this.m_icon.m_bg,.8);this.anim=r,r.state.setAnimation(0,"idle",!0),r.state.timeScale=0,r.skeleton.setSkinByName(i.skin),r.scale.set(.6)})}};var lu=class extends Ad{constructor(){super(...arguments);this.binds=[sh,Gl,iu,eu,su,ru,nu,ou,au];this.config={designWidth:900,designHeight:1600,orientation:"auto",packages:[{name:"loading",cls:sh,binder:Jc,path:"./assets/gen/ui/loading.txt",res:[{name:"loading@atlas0",path:"./assets/gen/ui/loading@atlas0.png"}],mode:"entry"},{name:"main",cls:Gl,binder:tu,path:"./assets/gen/ui/main.txt",res:[{name:"main@atlas0",path:"./assets/gen/ui/main@atlas0.png"},{name:"main@atlas0_1",path:"./assets/gen/ui/main@atlas0_1.png"}],mode:"dynamic"}]}}get view(){return fgui.GRoot.inst.numChildren>0&&fgui.GRoot.inst.getChildAt(0)}bindSpineToCom(e,i,r=.5){return $(this,null,function*(){let n=yield Y.inst.assets.getSpine(e),l=new PIXI.spine.Spine(n.spineData);l.skeleton.setToSetupPose(),l.update(0),l.autoUpdate=!0,l.position.set(i.x+i.width*.5,i.y+i.height*r);let a=l.skeleton.data.animations[0];a&&l.state.setAnimation(0,a.name,!0);let o=l.skeleton.data.skins[0];return o&&l.skeleton.setSkinByName(o.name),i.displayObject.parent.addChildAt(l,i.displayObject.parent.getChildIndex(i.displayObject)),i.displayObject.alpha=0,l})}};var Db={time:new nf,task:new rf,profile:new Zd,inventory:new Po,story:new Jd,render2d:new Kc,ui:new lu,gameplay:new Nc,assets:new Rc,sound:new bd,particles:new zc},of=class extends Cc{constructor(){super(...arguments);this.config=new xd;this.modules={};this._nextTicks=[];this.$tickCount=0;this.frameTime=0;this.frameCount=0;this.everageFPS=60;this.enabled=!0;this.fpsLimit=60;this.timer=0}$nextTick(e){this._nextTicks.push({count:this.$tickCount+1,func:e})}quit(){}init(){console.log("\u6A21\u5757\u521D\u59CB\u5316\u5F00\u59CB");for(let i in Db)this.modules[i]=Db[i],this[i]=this.modules[i];let e=new Set;for(let i of Object.values(this.modules))!i||(i.init.bind(i)(),e.add(i));console.log("\u6A21\u5757\u521D\u59CB\u5316\u5B8C\u6210");for(let i of Object.values(this))i instanceof Vt&&i.start.bind(i)()}updateFixed(e){this.modules.time.updateFixed(e),this.modules.task.update(e),this.ev.emit("updateFixed",e)}update(e){this.modules.time.update(e);let i=[];for(let r of this._nextTicks)r.count===this.$tickCount?r.func(e):r.count>this.$tickCount&&i.push(r);this._nextTicks=i,this.ev.emit("update",e)}updatePrepare(e){this.ev.emit("updatePrepare",e)}updateLate(e){this.ev.emit("updateLate",e)}render(e){this.ev.emit("render",e)}tick(e){if(!this.enabled)return;let i=e/1e3;this.timer+=i,!(this.fpsLimit&&this.timer<1/this.fpsLimit)&&(i=this.timer,this.timer=0,this.$tickCount+=1,this.updateFixed(i),this.updatePrepare(i),this.update(i),this.updateLate(i),this.render(i))}calcEverage(){setTimeout(()=>{this.ev.on("update",e=>{e>.01&&e<.1&&(this.frameTime+=e,this.frameCount+=1,this.everageFPS=this.frameCount/this.frameTime)})},1e4)}};var Y=class extends of{constructor(){super(),Y._inst=this,globalThis.game=Y.inst,this.start(),console.log("\u521B\u5EFA\u6E38\u620F\u5B9E\u4F8B\uFF1F\uFF1F")}start(){this.bindWindowEvents(),this.init()}static get inst(){return Y._inst}init(){super.init(),console.log("\u542F\u52A8\u4E3B\u5FAA\u73AF"),this.bindLoop()}bindLoop(){if(this.modules.render3d)this.modules.render3d.engine.runRenderLoop(()=>{this.tick(this.modules.render3d.engine.getDeltaTime())});else{let t=Date.now();console.log("\u5E94\u8BE5\u7531\u81EA\u8EAB\u9A71\u52A8"),setInterval(()=>{let i=Date.now();this.tick(i-t),t=i},0)}this.calcEverage()}bindWindowEvents(){window.addEventListener("resize",()=>{this.ev.emit("resize",window.innerWidth,window.innerHeight,window.devicePixelRatio)},!1),window.addEventListener("blur",()=>{console.warn("\u5207\u5165\u540E\u53F0"),this.ev.emit("blur")}),window.addEventListener("focus",()=>{this.ev.emit("focus")}),window.windowHide=()=>{this.ev.emit("blur")},globalThis.windowHide=window.windowHide,window.windowShow=()=>{this.ev.emit("focus")},globalThis.windowShow=window.windowShow}};var Bg={};Tc(Bg,{AttachmentType:()=>tt,BinaryInput:()=>fi,Color:()=>G,DebugUtils:()=>qf,IntSet:()=>pn,Interpolation:()=>ju,MathUtils:()=>S,MixBlend:()=>I,MixDirection:()=>at,Pool:()=>Js,PositionMode:()=>It,Pow:()=>Wu,PowOut:()=>xn,RotateMode:()=>Pt,SkeletonBounds:()=>Ec,SkeletonBoundsBase:()=>ti,Spine:()=>fd,SpineBase:()=>ii,SpineDebugRenderer:()=>im,SpineMesh:()=>Qu,SpineSprite:()=>Zu,StringSet:()=>gn,TextureAtlas:()=>Mr,TextureAtlasPage:()=>Gh,TextureAtlasRegion:()=>Xh,TextureFilter:()=>Re,TextureRegion:()=>Rr,TextureWrap:()=>Fs,TimeKeeper:()=>zf,TransformMode:()=>it,Utils:()=>k,Vector2:()=>Bs,WindowedMean:()=>Kf,filterFromString:()=>Yu,settings:()=>jt,wrapFromString:()=>u0});var tt=(s=>(s[s.Region=0]="Region",s[s.BoundingBox=1]="BoundingBox",s[s.Mesh=2]="Mesh",s[s.LinkedMesh=3]="LinkedMesh",s[s.Path=4]="Path",s[s.Point=5]="Point",s[s.Clipping=6]="Clipping",s))(tt||{});var fi=class{constructor(t,e=new Array,i=0,r=new DataView(t.buffer)){this.strings=e,this.index=i,this.buffer=r}readByte(){return this.buffer.getInt8(this.index++)}readUnsignedByte(){return this.buffer.getUint8(this.index++)}readShort(){let t=this.buffer.getInt16(this.index);return this.index+=2,t}readInt32(){let t=this.buffer.getInt32(this.index);return this.index+=4,t}readInt(t){let e=this.readByte(),i=e&127;return(e&128)!=0&&(e=this.readByte(),i|=(e&127)<<7,(e&128)!=0&&(e=this.readByte(),i|=(e&127)<<14,(e&128)!=0&&(e=this.readByte(),i|=(e&127)<<21,(e&128)!=0&&(e=this.readByte(),i|=(e&127)<<28)))),t?i:i>>>1^-(i&1)}readStringRef(){let t=this.readInt(!0);return t==0?null:this.strings[t-1]}readString(){let t=this.readInt(!0);switch(t){case 0:return null;case 1:return""}t--;let e="";for(let i=0;i<t;){let r=this.readUnsignedByte();switch(r>>4){case 12:case 13:e+=String.fromCharCode((r&31)<<6|this.readByte()&63),i+=2;break;case 14:e+=String.fromCharCode((r&15)<<12|(this.readByte()&63)<<6|this.readByte()&63),i+=3;break;default:e+=String.fromCharCode(r),i++}}return e}readFloat(){let t=this.buffer.getFloat32(this.index);return this.index+=4,t}readBoolean(){return this.readByte()!=0}};var I=(s=>(s[s.setup=0]="setup",s[s.first=1]="first",s[s.replace=2]="replace",s[s.add=3]="add",s))(I||{}),at=(s=>(s[s.mixIn=0]="mixIn",s[s.mixOut=1]="mixOut",s))(at||{});var It=(s=>(s[s.Fixed=0]="Fixed",s[s.Percent=1]="Percent",s))(It||{}),Pt=(s=>(s[s.Tangent=0]="Tangent",s[s.Chain=1]="Chain",s[s.ChainScale=2]="ChainScale",s))(Pt||{});var it=(s=>(s[s.Normal=0]="Normal",s[s.OnlyTranslation=1]="OnlyTranslation",s[s.NoRotationOrReflection=2]="NoRotationOrReflection",s[s.NoScale=3]="NoScale",s[s.NoScaleOrReflection=4]="NoScaleOrReflection",s))(it||{});var Cs=(s=>(s[s.WEBGL_LEGACY=0]="WEBGL_LEGACY",s[s.WEBGL=1]="WEBGL",s[s.WEBGL2=2]="WEBGL2",s))(Cs||{});var af=(s=>(s[s.COLOR=16384]="COLOR",s[s.DEPTH=256]="DEPTH",s[s.STENCIL=1024]="STENCIL",s))(af||{}),Z=(s=>(s[s.NORMAL=0]="NORMAL",s[s.ADD=1]="ADD",s[s.MULTIPLY=2]="MULTIPLY",s[s.SCREEN=3]="SCREEN",s[s.OVERLAY=4]="OVERLAY",s[s.DARKEN=5]="DARKEN",s[s.LIGHTEN=6]="LIGHTEN",s[s.COLOR_DODGE=7]="COLOR_DODGE",s[s.COLOR_BURN=8]="COLOR_BURN",s[s.HARD_LIGHT=9]="HARD_LIGHT",s[s.SOFT_LIGHT=10]="SOFT_LIGHT",s[s.DIFFERENCE=11]="DIFFERENCE",s[s.EXCLUSION=12]="EXCLUSION",s[s.HUE=13]="HUE",s[s.SATURATION=14]="SATURATION",s[s.COLOR=15]="COLOR",s[s.LUMINOSITY=16]="LUMINOSITY",s[s.NORMAL_NPM=17]="NORMAL_NPM",s[s.ADD_NPM=18]="ADD_NPM",s[s.SCREEN_NPM=19]="SCREEN_NPM",s[s.NONE=20]="NONE",s[s.SRC_OVER=0]="SRC_OVER",s[s.SRC_IN=21]="SRC_IN",s[s.SRC_OUT=22]="SRC_OUT",s[s.SRC_ATOP=23]="SRC_ATOP",s[s.DST_OVER=24]="DST_OVER",s[s.DST_IN=25]="DST_IN",s[s.DST_OUT=26]="DST_OUT",s[s.DST_ATOP=27]="DST_ATOP",s[s.ERASE=26]="ERASE",s[s.SUBTRACT=28]="SUBTRACT",s[s.XOR=29]="XOR",s))(Z||{}),Be=(s=>(s[s.POINTS=0]="POINTS",s[s.LINES=1]="LINES",s[s.LINE_LOOP=2]="LINE_LOOP",s[s.LINE_STRIP=3]="LINE_STRIP",s[s.TRIANGLES=4]="TRIANGLES",s[s.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",s[s.TRIANGLE_FAN=6]="TRIANGLE_FAN",s))(Be||{}),J=(s=>(s[s.RGBA=6408]="RGBA",s[s.RGB=6407]="RGB",s[s.RG=33319]="RG",s[s.RED=6403]="RED",s[s.RGBA_INTEGER=36249]="RGBA_INTEGER",s[s.RGB_INTEGER=36248]="RGB_INTEGER",s[s.RG_INTEGER=33320]="RG_INTEGER",s[s.RED_INTEGER=36244]="RED_INTEGER",s[s.ALPHA=6406]="ALPHA",s[s.LUMINANCE=6409]="LUMINANCE",s[s.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",s[s.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",s[s.DEPTH_STENCIL=34041]="DEPTH_STENCIL",s))(J||{}),Ar=(s=>(s[s.TEXTURE_2D=3553]="TEXTURE_2D",s[s.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",s[s.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",s[s.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",s[s.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",s[s.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",s[s.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",s[s.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",s[s.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",s))(Ar||{}),ft=(s=>(s[s.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",s[s.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",s[s.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",s[s.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",s[s.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",s[s.UNSIGNED_INT=5125]="UNSIGNED_INT",s[s.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",s[s.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",s[s.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",s[s.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",s[s.BYTE=5120]="BYTE",s[s.SHORT=5122]="SHORT",s[s.INT=5124]="INT",s[s.FLOAT=5126]="FLOAT",s[s.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",s[s.HALF_FLOAT=36193]="HALF_FLOAT",s))(ft||{}),lf=(s=>(s[s.FLOAT=0]="FLOAT",s[s.INT=1]="INT",s[s.UINT=2]="UINT",s))(lf||{}),Se=(s=>(s[s.NEAREST=0]="NEAREST",s[s.LINEAR=1]="LINEAR",s))(Se||{}),Ir=(s=>(s[s.CLAMP=33071]="CLAMP",s[s.REPEAT=10497]="REPEAT",s[s.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",s))(Ir||{}),Rs=(s=>(s[s.OFF=0]="OFF",s[s.POW2=1]="POW2",s[s.ON=2]="ON",s[s.ON_MANUAL=3]="ON_MANUAL",s))(Rs||{}),Le=(s=>(s[s.NPM=0]="NPM",s[s.UNPACK=1]="UNPACK",s[s.PMA=2]="PMA",s[s.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",s[s.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",s[s.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",s))(Le||{}),sn=(s=>(s[s.NO=0]="NO",s[s.YES=1]="YES",s[s.AUTO=2]="AUTO",s[s.BLEND=0]="BLEND",s[s.CLEAR=1]="CLEAR",s[s.BLIT=2]="BLIT",s))(sn||{}),hf=(s=>(s[s.AUTO=0]="AUTO",s[s.MANUAL=1]="MANUAL",s))(hf||{}),je=(s=>(s.LOW="lowp",s.MEDIUM="mediump",s.HIGH="highp",s))(je||{}),se=(s=>(s[s.NONE=0]="NONE",s[s.SCISSOR=1]="SCISSOR",s[s.STENCIL=2]="STENCIL",s[s.SPRITE=3]="SPRITE",s[s.COLOR=4]="COLOR",s))(se||{});var Ft=(s=>(s[s.NONE=0]="NONE",s[s.LOW=2]="LOW",s[s.MEDIUM=4]="MEDIUM",s[s.HIGH=8]="HIGH",s))(Ft||{}),fs=(s=>(s[s.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",s[s.ARRAY_BUFFER=34962]="ARRAY_BUFFER",s[s.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",s))(fs||{});var fp={createCanvas:(s,t)=>{let e=document.createElement("canvas");return e.width=s,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>{var s;return(s=document.baseURI)!=null?s:window.location.href},getFontFaceSet:()=>document.fonts,fetch:(s,t)=>fetch(s,t),parseXML:s=>new DOMParser().parseFromString(s,"text/xml")};var z={ADAPTER:fp,RESOLUTION:1,RENDER_OPTIONS:{view:null,width:800,height:600,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,clearBeforeRender:!0,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,hello:!1},CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var mp=/iPhone/i,Vb=/iPod/i,Gb=/iPad/i,Xb=/\biOS-universal(?:.+)Mac\b/i,pp=/\bAndroid(?:.+)Mobile\b/i,Yb=/Android/i,ih=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,cf=/Silk/i,Tr=/Windows Phone/i,jb=/\bWindows(?:.+)ARM\b/i,Wb=/BlackBerry/i,$b=/BB10/i,Hb=/Opera Mini/i,qb=/\b(CriOS|Chrome)(?:.+)Mobile/i,zb=/Mobile(?:.+)Firefox\b/i,Kb=function(s){return typeof s!="undefined"&&s.platform==="MacIntel"&&typeof s.maxTouchPoints=="number"&&s.maxTouchPoints>1&&typeof MSStream=="undefined"};function mw(s){return function(t){return t.test(s)}}function gp(s){var t={userAgent:"",platform:"",maxTouchPoints:0};!s&&typeof navigator!="undefined"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof s=="string"?t.userAgent=s:s&&s.userAgent&&(t={userAgent:s.userAgent,platform:s.platform,maxTouchPoints:s.maxTouchPoints||0});var e=t.userAgent,i=e.split("[FBAN");typeof i[1]!="undefined"&&(e=i[0]),i=e.split("Twitter"),typeof i[1]!="undefined"&&(e=i[0]);var r=mw(e),n={apple:{phone:r(mp)&&!r(Tr),ipod:r(Vb),tablet:!r(mp)&&(r(Gb)||Kb(t))&&!r(Tr),universal:r(Xb),device:(r(mp)||r(Vb)||r(Gb)||r(Xb)||Kb(t))&&!r(Tr)},amazon:{phone:r(ih),tablet:!r(ih)&&r(cf),device:r(ih)||r(cf)},android:{phone:!r(Tr)&&r(ih)||!r(Tr)&&r(pp),tablet:!r(Tr)&&!r(ih)&&!r(pp)&&(r(cf)||r(Yb)),device:!r(Tr)&&(r(ih)||r(cf)||r(pp)||r(Yb))||r(/\bokhttp\b/i)},windows:{phone:r(Tr),tablet:r(jb),device:r(Tr)||r(jb)},other:{blackberry:r(Wb),blackberry10:r($b),opera:r(Hb),firefox:r(zb),chrome:r(qb),device:r(Wb)||r($b)||r(Hb)||r(zb)||r(qb)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}var zs=gp(globalThis.navigator);var et={};Tc(et,{BaseTextureCache:()=>$e,BoundingBox:()=>ch,CanvasRenderTarget:()=>Af,DATA_URI:()=>wf,EventEmitter:()=>on.default,ProgramCache:()=>yu,TextureCache:()=>ve,clearTextureCache:()=>R_,correctBlendMode:()=>v_,createIndicesForQuads:()=>A_,decomposeDataUri:()=>O_,deprecation:()=>xt,destroyTextureCache:()=>C_,determineCrossOrigin:()=>Sf,earcut:()=>N_.default,getBufferType:()=>rn,getCanvasBoundingBox:()=>If,getResolutionOfUrl:()=>vu,hex2rgb:()=>bf,hex2string:()=>_f,interleaveTypedArrays:()=>I_,isMobile:()=>zs,isPow2:()=>bu,isWebGLSupported:()=>xf,log2:()=>_u,nextPow2:()=>nn,path:()=>Ip,premultiplyBlendMode:()=>xu,premultiplyRgba:()=>w_,premultiplyTint:()=>vf,premultiplyTintToRgba:()=>E_,removeItems:()=>Ef,rgb2hex:()=>y_,sayHello:()=>b_,sign:()=>T_,skipHello:()=>x_,string2hex:()=>yf,trimCanvas:()=>P_,uid:()=>Oi,url:()=>gf});z.RETINA_PREFIX=/@([0-9\.]+)x/;z.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var on=Io(Qb(),1),N_=Io(i_(),1);var hh=Io(p_(),1),gf={parse:hh.parse,format:hh.format,resolve:hh.resolve};function mi(s){if(typeof s!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(s)}`)}function gu(s){return s.split("?")[0].split("#")[0]}function Ww(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function $w(s,t,e){return s.replace(new RegExp(Ww(t),"g"),e)}function Hw(s,t){let e="",i=0,r=-1,n=0,l=-1;for(let a=0;a<=s.length;++a){if(a<s.length)l=s.charCodeAt(a);else{if(l===47)break;l=47}if(l===47){if(!(r===a-1||n===1))if(r!==a-1&&n===2){if(e.length<2||i!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){let o=e.lastIndexOf("/");if(o!==e.length-1){o===-1?(e="",i=0):(e=e.slice(0,o),i=e.length-1-e.lastIndexOf("/")),r=a,n=0;continue}}else if(e.length===2||e.length===1){e="",i=0,r=a,n=0;continue}}t&&(e.length>0?e+="/..":e="..",i=2)}else e.length>0?e+=`/${s.slice(r+1,a)}`:e=s.slice(r+1,a),i=a-r-1;r=a,n=0}else l===46&&n!==-1?++n:n=-1}return e}var Ip={toPosix(s){return $w(s,"\\","/")},isUrl(s){return/^https?:/.test(this.toPosix(s))},isDataUrl(s){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(s)},hasProtocol(s){return/^[^/:]+:\//.test(this.toPosix(s))},getProtocol(s){mi(s),s=this.toPosix(s);let t="",e=/^file:\/\/\//.exec(s),i=/^[^/:]+:\/\//.exec(s),r=/^[^/:]+:\//.exec(s);if(e||i||r){let n=(e==null?void 0:e[0])||(i==null?void 0:i[0])||(r==null?void 0:r[0]);t=n,s=s.slice(n.length)}return t},toAbsolute(s,t,e){if(this.isDataUrl(s))return s;let i=gu(this.toPosix(t!=null?t:z.ADAPTER.getBaseUrl())),r=gu(this.toPosix(e!=null?e:this.rootname(i)));return mi(s),s=this.toPosix(s),s.startsWith("/")?Ip.join(r,s.slice(1)):this.isAbsolute(s)?s:this.join(i,s)},normalize(s){if(s=this.toPosix(s),mi(s),s.length===0)return".";let t="",e=s.startsWith("/");this.hasProtocol(s)&&(t=this.rootname(s),s=s.slice(t.length));let i=s.endsWith("/");return s=Hw(s,!1),s.length>0&&i&&(s+="/"),e?`/${s}`:t+s},isAbsolute(s){return mi(s),s=this.toPosix(s),this.hasProtocol(s)?!0:s.startsWith("/")},join(...s){var e;if(s.length===0)return".";let t;for(let i=0;i<s.length;++i){let r=s[i];if(mi(r),r.length>0)if(t===void 0)t=r;else{let n=(e=s[i-1])!=null?e:"";this.extname(n)?t+=`/../${r}`:t+=`/${r}`}}return t===void 0?".":this.normalize(t)},dirname(s){if(mi(s),s.length===0)return".";s=this.toPosix(s);let t=s.charCodeAt(0),e=t===47,i=-1,r=!0,n=this.getProtocol(s),l=s;s=s.slice(n.length);for(let a=s.length-1;a>=1;--a)if(t=s.charCodeAt(a),t===47){if(!r){i=a;break}}else r=!1;return i===-1?e?"/":this.isUrl(l)?n+s:n:e&&i===1?"//":n+s.slice(0,i)},rootname(s){mi(s),s=this.toPosix(s);let t="";if(s.startsWith("/")?t="/":t=this.getProtocol(s),this.isUrl(s)){let e=s.indexOf("/",t.length);e!==-1?t=s.slice(0,e):t=s,t.endsWith("/")||(t+="/")}return t},basename(s,t){mi(s),t&&mi(t),s=gu(this.toPosix(s));let e=0,i=-1,r=!0,n;if(t!==void 0&&t.length>0&&t.length<=s.length){if(t.length===s.length&&t===s)return"";let l=t.length-1,a=-1;for(n=s.length-1;n>=0;--n){let o=s.charCodeAt(n);if(o===47){if(!r){e=n+1;break}}else a===-1&&(r=!1,a=n+1),l>=0&&(o===t.charCodeAt(l)?--l===-1&&(i=n):(l=-1,i=a))}return e===i?i=a:i===-1&&(i=s.length),s.slice(e,i)}for(n=s.length-1;n>=0;--n)if(s.charCodeAt(n)===47){if(!r){e=n+1;break}}else i===-1&&(r=!1,i=n+1);return i===-1?"":s.slice(e,i)},extname(s){mi(s),s=gu(this.toPosix(s));let t=-1,e=0,i=-1,r=!0,n=0;for(let l=s.length-1;l>=0;--l){let a=s.charCodeAt(l);if(a===47){if(!r){e=l+1;break}continue}i===-1&&(r=!1,i=l+1),a===46?t===-1?t=l:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||i===-1||n===0||n===1&&t===i-1&&t===e+1?"":s.slice(t,i)},parse(s){mi(s);let t={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return t;s=gu(this.toPosix(s));let e=s.charCodeAt(0),i=this.isAbsolute(s),r,n="";t.root=this.rootname(s),i||this.hasProtocol(s)?r=1:r=0;let l=-1,a=0,o=-1,h=!0,c=s.length-1,u=0;for(;c>=r;--c){if(e=s.charCodeAt(c),e===47){if(!h){a=c+1;break}continue}o===-1&&(h=!1,o=c+1),e===46?l===-1?l=c:u!==1&&(u=1):l!==-1&&(u=-1)}return l===-1||o===-1||u===0||u===1&&l===o-1&&l===a+1?o!==-1&&(a===0&&i?t.base=t.name=s.slice(1,o):t.base=t.name=s.slice(a,o)):(a===0&&i?(t.name=s.slice(1,l),t.base=s.slice(1,o)):(t.name=s.slice(a,l),t.base=s.slice(a,o)),t.ext=s.slice(l,o)),t.dir=this.dirname(s),n&&(t.dir=n+t.dir),t},sep:"/",delimiter:":"};var g_={};function xt(s,t,e=3){if(g_[t])return;let i=new Error().stack;typeof i=="undefined"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${s}`):(i=i.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${s}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${s}`),console.warn(i))),g_[t]=!0}function x_(){xt("7.0.0","skipHello is deprecated, please use settings.RENDER_OPTIONS.hello")}function b_(){xt("7.0.0",`sayHello is deprecated, please use Renderer's "hello" option`)}var Tp;function xf(){return typeof Tp=="undefined"&&(Tp=function(){var e;let t={stencil:!0,failIfMajorPerformanceCaveat:z.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!z.ADAPTER.getWebGLRenderingContext())return!1;let i=z.ADAPTER.createCanvas(),r=i.getContext("webgl",t)||i.getContext("experimental-webgl",t),n=!!((e=r==null?void 0:r.getContextAttributes())!=null&&e.stencil);if(r){let l=r.getExtension("WEBGL_lose_context");l&&l.loseContext()}return r=null,n}catch(i){return!1}}()),Tp}var qw="#f0f8ff",zw="#faebd7",Kw="#00ffff",Zw="#7fffd4",Qw="#f0ffff",Jw="#f5f5dc",tE="#ffe4c4",eE="#000000",sE="#ffebcd",iE="#0000ff",rE="#8a2be2",nE="#a52a2a",oE="#deb887",aE="#5f9ea0",lE="#7fff00",hE="#d2691e",cE="#ff7f50",uE="#6495ed",dE="#fff8dc",fE="#dc143c",mE="#00ffff",pE="#00008b",gE="#008b8b",xE="#b8860b",bE="#a9a9a9",_E="#006400",yE="#a9a9a9",vE="#bdb76b",wE="#8b008b",EE="#556b2f",AE="#ff8c00",IE="#9932cc",TE="#8b0000",SE="#e9967a",CE="#8fbc8f",RE="#483d8b",ME="#2f4f4f",kE="#2f4f4f",PE="#00ced1",OE="#9400d3",NE="#ff1493",FE="#00bfff",BE="#696969",LE="#696969",UE="#1e90ff",DE="#b22222",VE="#fffaf0",GE="#228b22",XE="#ff00ff",YE="#dcdcdc",jE="#f8f8ff",WE="#daa520",$E="#ffd700",HE="#808080",qE="#008000",zE="#adff2f",KE="#808080",ZE="#f0fff0",QE="#ff69b4",JE="#cd5c5c",tA="#4b0082",eA="#fffff0",sA="#f0e68c",iA="#fff0f5",rA="#e6e6fa",nA="#7cfc00",oA="#fffacd",aA="#add8e6",lA="#f08080",hA="#e0ffff",cA="#fafad2",uA="#d3d3d3",dA="#90ee90",fA="#d3d3d3",mA="#ffb6c1",pA="#ffa07a",gA="#20b2aa",xA="#87cefa",bA="#778899",_A="#778899",yA="#b0c4de",vA="#ffffe0",wA="#00ff00",EA="#32cd32",AA="#faf0e6",IA="#ff00ff",TA="#800000",SA="#66cdaa",CA="#0000cd",RA="#ba55d3",MA="#9370db",kA="#3cb371",PA="#7b68ee",OA="#00fa9a",NA="#48d1cc",FA="#c71585",BA="#191970",LA="#f5fffa",UA="#ffe4e1",DA="#ffe4b5",VA="#ffdead",GA="#000080",XA="#fdf5e6",YA="#808000",jA="#6b8e23",WA="#ffa500",$A="#ff4500",HA="#da70d6",qA="#eee8aa",zA="#98fb98",KA="#afeeee",ZA="#db7093",QA="#ffefd5",JA="#ffdab9",t1="#cd853f",e1="#ffc0cb",s1="#dda0dd",i1="#b0e0e6",r1="#800080",n1="#663399",o1="#ff0000",a1="#bc8f8f",l1="#4169e1",h1="#8b4513",c1="#fa8072",u1="#f4a460",d1="#2e8b57",f1="#fff5ee",m1="#a0522d",p1="#c0c0c0",g1="#87ceeb",x1="#6a5acd",b1="#708090",_1="#708090",y1="#fffafa",v1="#00ff7f",w1="#4682b4",E1="#d2b48c",A1="#008080",I1="#d8bfd8",T1="#ff6347",S1="#40e0d0",C1="#ee82ee",R1="#f5deb3",M1="#ffffff",k1="#f5f5f5",P1="#ffff00",O1="#9acd32",__={aliceblue:qw,antiquewhite:zw,aqua:Kw,aquamarine:Zw,azure:Qw,beige:Jw,bisque:tE,black:eE,blanchedalmond:sE,blue:iE,blueviolet:rE,brown:nE,burlywood:oE,cadetblue:aE,chartreuse:lE,chocolate:hE,coral:cE,cornflowerblue:uE,cornsilk:dE,crimson:fE,cyan:mE,darkblue:pE,darkcyan:gE,darkgoldenrod:xE,darkgray:bE,darkgreen:_E,darkgrey:yE,darkkhaki:vE,darkmagenta:wE,darkolivegreen:EE,darkorange:AE,darkorchid:IE,darkred:TE,darksalmon:SE,darkseagreen:CE,darkslateblue:RE,darkslategray:ME,darkslategrey:kE,darkturquoise:PE,darkviolet:OE,deeppink:NE,deepskyblue:FE,dimgray:BE,dimgrey:LE,dodgerblue:UE,firebrick:DE,floralwhite:VE,forestgreen:GE,fuchsia:XE,gainsboro:YE,ghostwhite:jE,goldenrod:WE,gold:$E,gray:HE,green:qE,greenyellow:zE,grey:KE,honeydew:ZE,hotpink:QE,indianred:JE,indigo:tA,ivory:eA,khaki:sA,lavenderblush:iA,lavender:rA,lawngreen:nA,lemonchiffon:oA,lightblue:aA,lightcoral:lA,lightcyan:hA,lightgoldenrodyellow:cA,lightgray:uA,lightgreen:dA,lightgrey:fA,lightpink:mA,lightsalmon:pA,lightseagreen:gA,lightskyblue:xA,lightslategray:bA,lightslategrey:_A,lightsteelblue:yA,lightyellow:vA,lime:wA,limegreen:EA,linen:AA,magenta:IA,maroon:TA,mediumaquamarine:SA,mediumblue:CA,mediumorchid:RA,mediumpurple:MA,mediumseagreen:kA,mediumslateblue:PA,mediumspringgreen:OA,mediumturquoise:NA,mediumvioletred:FA,midnightblue:BA,mintcream:LA,mistyrose:UA,moccasin:DA,navajowhite:VA,navy:GA,oldlace:XA,olive:YA,olivedrab:jA,orange:WA,orangered:$A,orchid:HA,palegoldenrod:qA,palegreen:zA,paleturquoise:KA,palevioletred:ZA,papayawhip:QA,peachpuff:JA,peru:t1,pink:e1,plum:s1,powderblue:i1,purple:r1,rebeccapurple:n1,red:o1,rosybrown:a1,royalblue:l1,saddlebrown:h1,salmon:c1,sandybrown:u1,seagreen:d1,seashell:f1,sienna:m1,silver:p1,skyblue:g1,slateblue:x1,slategray:b1,slategrey:_1,snow:y1,springgreen:v1,steelblue:w1,tan:E1,teal:A1,thistle:I1,tomato:T1,turquoise:S1,violet:C1,wheat:R1,white:M1,whitesmoke:k1,yellow:P1,yellowgreen:O1};function bf(s,t=[]){return t[0]=(s>>16&255)/255,t[1]=(s>>8&255)/255,t[2]=(s&255)/255,t}function _f(s){let t=s.toString(16);return t="000000".substring(0,6-t.length)+t,`#${t}`}function yf(s){if(typeof s=="string"&&(s=__[s.toLowerCase()]||s,s[0]==="#"&&(s=s.slice(1)),s.length===3)){let[t,e,i]=s;s=t+t+e+e+i+i}return parseInt(s,16)}function y_(s){return(s[0]*255<<16)+(s[1]*255<<8)+(s[2]*255|0)}function N1(){let s=[],t=[];for(let i=0;i<32;i++)s[i]=i,t[i]=i;s[Z.NORMAL_NPM]=Z.NORMAL,s[Z.ADD_NPM]=Z.ADD,s[Z.SCREEN_NPM]=Z.SCREEN,t[Z.NORMAL]=Z.NORMAL_NPM,t[Z.ADD]=Z.ADD_NPM,t[Z.SCREEN]=Z.SCREEN_NPM;let e=[];return e.push(t),e.push(s),e}var xu=N1();function v_(s,t){return xu[t?1:0][s]}function w_(s,t,e,i){return e=e||new Float32Array(4),i||i===void 0?(e[0]=s[0]*t,e[1]=s[1]*t,e[2]=s[2]*t):(e[0]=s[0],e[1]=s[1],e[2]=s[2]),e[3]=t,e}function vf(s,t){if(t===1)return(t*255<<24)+s;if(t===0)return 0;let e=s>>16&255,i=s>>8&255,r=s&255;return e=e*t+.5|0,i=i*t+.5|0,r=r*t+.5|0,(t*255<<24)+(e<<16)+(i<<8)+r}function E_(s,t,e,i){return e=e||new Float32Array(4),e[0]=(s>>16&255)/255,e[1]=(s>>8&255)/255,e[2]=(s&255)/255,(i||i===void 0)&&(e[0]*=t,e[1]*=t,e[2]*=t),e[3]=t,e}var wf=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function A_(s,t=null){let e=s*6;if(t=t||new Uint16Array(e),t.length!==e)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${e}`);for(let i=0,r=0;i<e;i+=6,r+=4)t[i+0]=r+0,t[i+1]=r+1,t[i+2]=r+2,t[i+3]=r+0,t[i+4]=r+2,t[i+5]=r+3;return t}function rn(s){if(s.BYTES_PER_ELEMENT===4)return s instanceof Float32Array?"Float32Array":s instanceof Uint32Array?"Uint32Array":"Int32Array";if(s.BYTES_PER_ELEMENT===2){if(s instanceof Uint16Array)return"Uint16Array"}else if(s.BYTES_PER_ELEMENT===1&&s instanceof Uint8Array)return"Uint8Array";return null}var F1={Float32Array,Uint32Array,Int32Array,Uint8Array};function I_(s,t){let e=0,i=0,r={};for(let o=0;o<s.length;o++)i+=t[o],e+=s[o].length;let n=new ArrayBuffer(e*4),l=null,a=0;for(let o=0;o<s.length;o++){let h=t[o],c=s[o],u=rn(c);r[u]||(r[u]=new F1[u](n)),l=r[u];for(let d=0;d<c.length;d++){let f=(d/h|0)*i+a,m=d%h;l[f+m]=c[d]}a+=h}return new Float32Array(n)}function nn(s){return s+=s===0?1:0,--s,s|=s>>>1,s|=s>>>2,s|=s>>>4,s|=s>>>8,s|=s>>>16,s+1}function bu(s){return!(s&s-1)&&!!s}function _u(s){let t=(s>65535?1:0)<<4;s>>>=t;let e=(s>255?1:0)<<3;return s>>>=e,t|=e,e=(s>15?1:0)<<2,s>>>=e,t|=e,e=(s>3?1:0)<<1,s>>>=e,t|=e,t|s>>1}function Ef(s,t,e){let i=s.length,r;if(t>=i||e===0)return;e=t+e>i?i-t:e;let n=i-e;for(r=t;r<n;++r)s[r]=s[r+e];s.length=n}function T_(s){return s===0?0:s<0?-1:1}var B1=0;function Oi(){return++B1}var S_=class{constructor(s,t,e,i){this.left=s,this.top=t,this.right=e,this.bottom=i}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}},ch=S_;ch.EMPTY=new S_(0,0,0,0);var yu={},ve=Object.create(null),$e=Object.create(null);function C_(){let s;for(s in ve)ve[s].destroy();for(s in $e)$e[s].destroy()}function R_(){let s;for(s in ve)delete ve[s];for(s in $e)delete $e[s]}var Af=class{constructor(t,e,i){this._canvas=z.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=i||z.RESOLUTION,this.resize(t,e)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,e){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(e*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}};function M_(s,t,e){for(let i=0,r=4*e*t;i<t;++i,r+=4)if(s[r+3]!==0)return!1;return!0}function k_(s,t,e,i,r){let n=4*t;for(let l=i,a=i*n+4*e;l<=r;++l,a+=n)if(s[a+3]!==0)return!1;return!0}function If(s){let{width:t,height:e}=s,i=s.getContext("2d",{willReadFrequently:!0});if(i===null)throw new TypeError("Failed to get canvas 2D context");let n=i.getImageData(0,0,t,e).data,l=0,a=0,o=t-1,h=e-1;for(;a<e&&M_(n,t,a);)++a;if(a===e)return ch.EMPTY;for(;M_(n,t,h);)--h;for(;k_(n,t,l,a,h);)++l;for(;k_(n,t,o,a,h);)--o;return++o,++h,new ch(l,a,o,h)}function P_(s){let t=If(s),{width:e,height:i}=t,r=null;if(!t.isEmpty()){let n=s.getContext("2d");if(n===null)throw new TypeError("Failed to get canvas 2D context");r=n.getImageData(t.left,t.top,e,i)}return{width:e,height:i,data:r}}function O_(s){let t=wf.exec(s);if(t)return{mediaType:t[1]?t[1].toLowerCase():void 0,subType:t[2]?t[2].toLowerCase():void 0,charset:t[3]?t[3].toLowerCase():void 0,encoding:t[4]?t[4].toLowerCase():void 0,data:t[5]}}var Tf;function Sf(s,t=globalThis.location){if(s.startsWith("data:"))return"";t=t||globalThis.location,Tf||(Tf=document.createElement("a")),Tf.href=s;let e=gf.parse(Tf.href),i=!e.port&&t.port===""||e.port===t.port;return e.hostname!==t.hostname||!i||e.protocol!==t.protocol?"anonymous":""}function vu(s,t=1){var i;let e=(i=z.RETINA_PREFIX)==null?void 0:i.exec(s);return e?parseFloat(e[1]):t}var H=(s=>(s.Renderer="renderer",s.Application="application",s.RendererSystem="renderer-webgl-system",s.RendererPlugin="renderer-webgl-plugin",s.CanvasRendererSystem="renderer-canvas-system",s.CanvasRendererPlugin="renderer-canvas-plugin",s.Asset="asset",s.LoadParser="load-parser",s.ResolveParser="resolve-parser",s.CacheParser="cache-parser",s.DetectionParser="detection-parser",s))(H||{}),Sp=s=>{if(typeof s=="function"||typeof s=="object"&&s.extension){if(!s.extension)throw new Error("Extension class must have an extension object");let t=typeof s.extension!="object"?{type:s.extension}:s.extension;s=pd(li({},t),{ref:s})}if(typeof s=="object")s=li({},s);else throw new Error("Invalid extension type");return typeof s.type=="string"&&(s.type=[s.type]),s},F_=(s,t)=>{var e;return(e=Sp(s).priority)!=null?e:t},K={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...s){return s.map(Sp).forEach(t=>{t.type.forEach(e=>{var i,r;return(r=(i=this._removeHandlers)[e])==null?void 0:r.call(i,t)})}),this},add(...s){return s.map(Sp).forEach(t=>{t.type.forEach(e=>{let i=this._addHandlers,r=this._queue;i[e]?i[e](t):(r[e]=r[e]||[],r[e].push(t))})}),this},handle(s,t,e){let i=this._addHandlers,r=this._removeHandlers;if(i[s]||r[s])throw new Error(`Extension type ${s} already has a handler`);i[s]=t,r[s]=e;let n=this._queue;return n[s]&&(n[s].forEach(l=>t(l)),delete n[s]),this},handleByMap(s,t){return this.handle(s,e=>{t[e.name]=e.ref},e=>{delete t[e.name]})},handleByList(s,t,e=-1){return this.handle(s,i=>{t.includes(i.ref)||(t.push(i.ref),t.sort((r,n)=>F_(n,e)-F_(r,e)))},i=>{let r=t.indexOf(i.ref);r!==-1&&t.splice(r,1)})}};var wu=class{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}};var L1=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function U1(s){let t="";for(let e=0;e<s;++e)e>0&&(t+=`
else `),e<s-1&&(t+=`if(test == ${e}.0){}`);return t}function Cf(s,t){if(s===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");let e=t.createShader(t.FRAGMENT_SHADER);for(;;){let i=L1.replace(/%forloop%/gi,U1(s));if(t.shaderSource(e,i),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))s=s/2|0;else break}return s}var Cp=0,Rp=1,Mp=2,kp=3,Pp=4,Op=5,He=class{constructor(){this.data=0,this.blendMode=Z.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Cp)}set blend(t){!!(this.data&1<<Cp)!==t&&(this.data^=1<<Cp)}get offsets(){return!!(this.data&1<<Rp)}set offsets(t){!!(this.data&1<<Rp)!==t&&(this.data^=1<<Rp)}get culling(){return!!(this.data&1<<Mp)}set culling(t){!!(this.data&1<<Mp)!==t&&(this.data^=1<<Mp)}get depthTest(){return!!(this.data&1<<kp)}set depthTest(t){!!(this.data&1<<kp)!==t&&(this.data^=1<<kp)}get depthMask(){return!!(this.data&1<<Op)}set depthMask(t){!!(this.data&1<<Op)!==t&&(this.data^=1<<Op)}get clockwiseFrontFace(){return!!(this.data&1<<Pp)}set clockwiseFrontFace(t){!!(this.data&1<<Pp)!==t&&(this.data^=1<<Pp)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==Z.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){let t=new He;return t.depthTest=!1,t.blend=!0,t}};var uh=[];function dh(s,t){if(!s)return null;let e="";if(typeof s=="string"){let i=/\.(\w{3,4})(?:$|\?|#)/i.exec(s);i&&(e=i[1].toLowerCase())}for(let i=uh.length-1;i>=0;--i){let r=uh[i];if(r.test&&r.test(s,e))return new r(s,t)}throw new Error("Unrecognized source type to auto-detect Resource")}var ne=class{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,e,i,r,n,l,a,o){if(arguments.length>8)throw new Error("max arguments reached");let{name:h,items:c}=this;this._aliasCount++;for(let u=0,d=c.length;u<d;u++)c[u][h](t,e,i,r,n,l,a,o);return c===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){let e=this.items.indexOf(t);return e!==-1&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}};Object.defineProperties(ne.prototype,{dispatch:{value:ne.prototype.emit},run:{value:ne.prototype.emit}});var Ms=class{constructor(t=0,e=0){this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new ne("setRealSize"),this.onUpdate=new ne("update"),this.onError=new ne("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,e,i){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,e){return!1}};var Ni=class extends Ms{constructor(t,e){let{width:i,height:r}=e||{};if(!i||!r)throw new Error("BufferResource width or height invalid");super(i,r),this.data=t}upload(t,e,i){let r=t.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Le.UNPACK);let n=e.realWidth,l=e.realHeight;return i.width===n&&i.height===l?r.texSubImage2D(e.target,0,0,0,n,l,e.format,i.type,this.data):(i.width=n,i.height=l,r.texImage2D(e.target,0,i.internalFormat,n,l,0,e.format,i.type,this.data)),!0}dispose(){this.data=null}static test(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array}};var D1={scaleMode:Se.NEAREST,format:J.RGBA,alphaMode:Le.NPM},fh=class extends on.default{constructor(s=null,t=null){super(),t=Object.assign({},fh.defaultOptions,t);let{alphaMode:e,mipmap:i,anisotropicLevel:r,scaleMode:n,width:l,height:a,wrapMode:o,format:h,type:c,target:u,resolution:d,resourceOptions:f}=t;s&&!(s instanceof Ms)&&(s=dh(s,f),s.internal=!0),this.resolution=d||z.RESOLUTION,this.width=Math.round((l||0)*this.resolution)/this.resolution,this.height=Math.round((a||0)*this.resolution)/this.resolution,this._mipmap=i,this.anisotropicLevel=r,this._wrapMode=o,this._scaleMode=n,this.format=h,this.type=c,this.target=u,this.alphaMode=e,this.uid=Oi(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=l>0&&a>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(s)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(s){this._mipmap!==s&&(this._mipmap=s,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(s){this._scaleMode!==s&&(this._scaleMode=s,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(s){this._wrapMode!==s&&(this._wrapMode=s,this.dirtyStyleId++)}setStyle(s,t){let e;return s!==void 0&&s!==this.scaleMode&&(this.scaleMode=s,e=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,e=!0),e&&this.dirtyStyleId++,this}setSize(s,t,e){return e=e||this.resolution,this.setRealSize(s*e,t*e,e)}setRealSize(s,t,e){return this.resolution=e||this.resolution,this.width=Math.round(s)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=bu(this.realWidth)&&bu(this.realHeight)}setResolution(s){let t=this.resolution;return t===s?this:(this.resolution=s,this.valid&&(this.width=Math.round(this.width*t)/s,this.height=Math.round(this.height*t)/s,this.emit("update",this)),this._refreshPOT(),this)}setResource(s){if(this.resource===s)return this;if(this.resource)throw new Error("Resource can be set only once");return s.bind(this),this.resource=s,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(s){this.emit("error",this,s)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete $e[this.cacheId],delete ve[this.cacheId],this.cacheId=null),this.dispose(),fh.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(s,t,e=z.STRICT_TEXTURE_CACHE){let i=typeof s=="string",r=null;if(i)r=s;else{if(!s._pixiId){let l=(t==null?void 0:t.pixiIdPrefix)||"pixiid";s._pixiId=`${l}_${Oi()}`}r=s._pixiId}let n=$e[r];if(i&&e&&!n)throw new Error(`The cacheId "${r}" does not exist in BaseTextureCache.`);return n||(n=new fh(s,t),n.cacheId=r,fh.addToCache(n,r)),n}static fromBuffer(s,t,e,i){s=s||new Float32Array(t*e*4);let r=new Ni(s,{width:t,height:e}),n=s instanceof Float32Array?ft.FLOAT:ft.UNSIGNED_BYTE;return new fh(r,Object.assign({},D1,i||{width:t,height:e,type:n}))}static addToCache(s,t){t&&(s.textureCacheIds.includes(t)||s.textureCacheIds.push(t),$e[t]&&$e[t]!==s&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),$e[t]=s)}static removeFromCache(s){if(typeof s=="string"){let t=$e[s];if(t){let e=t.textureCacheIds.indexOf(s);return e>-1&&t.textureCacheIds.splice(e,1),delete $e[s],t}}else if(s!=null&&s.textureCacheIds){for(let t=0;t<s.textureCacheIds.length;++t)delete $e[s.textureCacheIds[t]];return s.textureCacheIds.length=0,s}return null}},lt=fh;lt.defaultOptions={mipmap:Rs.POW2,anisotropicLevel:0,scaleMode:Se.LINEAR,wrapMode:Ir.CLAMP,alphaMode:Le.UNPACK,target:Ar.TEXTURE_2D,format:J.RGBA,type:ft.UNSIGNED_BYTE};lt._globalBatch=0;var an=class{constructor(){this.texArray=null,this.blend=0,this.type=Be.TRIANGLES,this.start=0,this.size=0,this.data=null}};var V1=0,Gt=class{constructor(t,e=!0,i=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=V1++,this.disposeRunner=new ne("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?fs.ELEMENT_ARRAY_BUFFER:fs.ARRAY_BUFFER}get index(){return this.type===fs.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new Gt(t)}};var ln=class{constructor(t,e=0,i=!1,r=ft.FLOAT,n,l,a,o=1){this.buffer=t,this.size=e,this.normalized=i,this.type=r,this.stride=n,this.start=l,this.instance=a,this.divisor=o}destroy(){this.buffer=null}static from(t,e,i,r,n){return new ln(t,e,i,r,n)}};var G1={Float32Array,Uint32Array,Int32Array,Uint8Array};function B_(s,t){let e=0,i=0,r={};for(let o=0;o<s.length;o++)i+=t[o],e+=s[o].length;let n=new ArrayBuffer(e*4),l=null,a=0;for(let o=0;o<s.length;o++){let h=t[o],c=s[o],u=rn(c);r[u]||(r[u]=new G1[u](n)),l=r[u];for(let d=0;d<c.length;d++){let f=(d/h|0)*i+a,m=d%h;l[f+m]=c[d]}a+=h}return new Float32Array(n)}var L_={5126:4,5123:2,5121:1},X1=0,Y1={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},ms=class{constructor(t=[],e={}){this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=X1++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new ne("disposeGeometry"),this.refCount=0}addAttribute(t,e,i=0,r=!1,n,l,a,o=!1){if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof Gt||(e instanceof Array&&(e=new Float32Array(e)),e=new Gt(e));let h=t.split("|");if(h.length>1){for(let u=0;u<h.length;u++)this.addAttribute(h[u],e,i,r,n);return this}let c=this.buffers.indexOf(e);return c===-1&&(this.buffers.push(e),c=this.buffers.length-1),this.attributes[t]=new ln(c,i,r,n,l,a,o),this.instanced=this.instanced||o,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof Gt||(t instanceof Array&&(t=new Uint16Array(t)),t=new Gt(t)),t.type=fs.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;let t=[],e=[],i=new Gt,r;for(r in this.attributes){let n=this.attributes[r],l=this.buffers[n.buffer];t.push(l.data),e.push(n.size*L_[n.type]/4),n.buffer=0}for(i.data=B_(t,e),r=0;r<this.buffers.length;r++)this.buffers[r]!==this.indexBuffer&&this.buffers[r].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(let t in this.attributes){let e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){let t=new ms;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new Gt(this.buffers[e].data.slice(0));for(let e in this.attributes){let i=this.attributes[e];t.attributes[e]=new ln(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=fs.ELEMENT_ARRAY_BUFFER),t}static merge(t){let e=new ms,i=[],r=[],n=[],l;for(let a=0;a<t.length;a++){l=t[a];for(let o=0;o<l.buffers.length;o++)r[o]=r[o]||0,r[o]+=l.buffers[o].data.length,n[o]=0}for(let a=0;a<l.buffers.length;a++)i[a]=new Y1[rn(l.buffers[a].data)](r[a]),e.buffers[a]=new Gt(i[a]);for(let a=0;a<t.length;a++){l=t[a];for(let o=0;o<l.buffers.length;o++)i[o].set(l.buffers[o].data,n[o]),n[o]+=l.buffers[o].data.length}if(e.attributes=l.attributes,l.indexBuffer){e.indexBuffer=e.buffers[l.buffers.indexOf(l.indexBuffer)],e.indexBuffer.type=fs.ELEMENT_ARRAY_BUFFER;let a=0,o=0,h=0,c=0;for(let u=0;u<l.buffers.length;u++)if(l.buffers[u]!==l.indexBuffer){c=u;break}for(let u in l.attributes){let d=l.attributes[u];(d.buffer|0)===c&&(o+=d.size*L_[d.type]/4)}for(let u=0;u<t.length;u++){let d=t[u].indexBuffer.data;for(let f=0;f<d.length;f++)e.indexBuffer.data[f+h]+=a;a+=t[u].buffers[c].data.length/o,h+=d.length}}return e}};var za=class extends ms{constructor(t=!1){super(),this._buffer=new Gt(null,t,!1),this._indexBuffer=new Gt(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,ft.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,ft.FLOAT).addAttribute("aColor",this._buffer,4,!0,ft.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,ft.FLOAT).addIndex(this._indexBuffer)}};var hn=Math.PI*2,Np=180/Math.PI,Fp=Math.PI/180,Ut=(s=>(s[s.POLY=0]="POLY",s[s.RECT=1]="RECT",s[s.CIRC=2]="CIRC",s[s.ELIP=3]="ELIP",s[s.RREC=4]="RREC",s))(Ut||{});var Rt=class{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new Rt(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}};var Rf=[new Rt,new Rt,new Rt,new Rt],ht=class{constructor(t=0,e=0,i=0,r=0){this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=Ut.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new ht(0,0,0,0)}clone(){return new ht(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){let A=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=A)return!1;let C=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>C}let i=this.left,r=this.right,n=this.top,l=this.bottom;if(r<=i||l<=n)return!1;let a=Rf[0].set(t.left,t.top),o=Rf[1].set(t.left,t.bottom),h=Rf[2].set(t.right,t.top),c=Rf[3].set(t.right,t.bottom);if(h.x<=a.x||o.y<=a.y)return!1;let u=Math.sign(e.a*e.d-e.b*e.c);if(u===0||(e.apply(a,a),e.apply(o,o),e.apply(h,h),e.apply(c,c),Math.max(a.x,o.x,h.x,c.x)<=i||Math.min(a.x,o.x,h.x,c.x)>=r||Math.max(a.y,o.y,h.y,c.y)<=n||Math.min(a.y,o.y,h.y,c.y)>=l))return!1;let d=u*(o.y-a.y),f=u*(a.x-o.x),m=d*i+f*n,p=d*r+f*n,g=d*i+f*l,y=d*r+f*l;if(Math.max(m,p,g,y)<=d*a.x+f*a.y||Math.min(m,p,g,y)>=d*c.x+f*c.y)return!1;let _=u*(a.y-h.y),b=u*(h.x-a.x),x=_*i+b*n,v=_*r+b*n,w=_*i+b*l,E=_*r+b*l;return!(Math.max(x,v,w,E)<=_*a.x+b*a.y||Math.min(x,v,w,E)>=_*c.x+b*c.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){let e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this}ceil(t=1,e=.001){let i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this}enlarge(t){let e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}};var Ka=class{constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.radius=i,this.type=Ut.CIRC}clone(){return new Ka(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;let i=this.radius*this.radius,r=this.x-t,n=this.y-e;return r*=r,n*=n,r+n<=i}getBounds(){return new ht(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}};var Za=class{constructor(t=0,e=0,i=0,r=0){this.x=t,this.y=e,this.width=i,this.height=r,this.type=Ut.ELIP}clone(){return new Za(this.x,this.y,this.width,this.height)}contains(t,e){if(this.width<=0||this.height<=0)return!1;let i=(t-this.x)/this.width,r=(e-this.y)/this.height;return i*=i,r*=r,i+r<=1}getBounds(){return new ht(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}};var ks=class{constructor(...t){let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){let i=[];for(let r=0,n=e.length;r<n;r++)i.push(e[r].x,e[r].y);e=i}this.points=e,this.type=Ut.POLY,this.closeStroke=!0}clone(){let t=this.points.slice(),e=new ks(t);return e.closeStroke=this.closeStroke,e}contains(t,e){let i=!1,r=this.points.length/2;for(let n=0,l=r-1;n<r;l=n++){let a=this.points[n*2],o=this.points[n*2+1],h=this.points[l*2],c=this.points[l*2+1];o>e!=c>e&&t<(h-a)*((e-o)/(c-o))+a&&(i=!i)}return i}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}};var Qa=class{constructor(t=0,e=0,i=0,r=0,n=20){this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=Ut.RREC}clone(){return new Qa(this.x,this.y,this.width,this.height,this.radius)}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){let i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+i&&e<=this.y+this.height-i||t>=this.x+i&&t<=this.x+this.width-i)return!0;let r=t-(this.x+i),n=e-(this.y+i),l=i*i;if(r*r+n*n<=l||(r=t-(this.x+this.width-i),r*r+n*n<=l)||(n=e-(this.y+this.height-i),r*r+n*n<=l)||(r=t-(this.x+i),r*r+n*n<=l))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}};var mt=class{constructor(t=1,e=0,i=0,r=1,n=0,l=0){this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=l}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,i,r,n,l){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=l,this}toArray(t,e){this.array||(this.array=new Float32Array(9));let i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(t,e){e=e||new Rt;let i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e}applyInverse(t,e){e=e||new Rt;let i=1/(this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){let e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,l=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=l*e-this.ty*i,this.ty=l*i+this.ty*e,this}append(t){let e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this}setTransform(t,e,i,r,n,l,a,o,h){return this.a=Math.cos(a+h)*n,this.b=Math.sin(a+h)*n,this.c=-Math.sin(a-o)*l,this.d=Math.cos(a-o)*l,this.tx=t-(i*this.a+r*this.c),this.ty=e-(i*this.b+r*this.d),this}prepend(t){let e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){let i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){let e=this.a,i=this.b,r=this.c,n=this.d,l=t.pivot,a=-Math.atan2(-r,n),o=Math.atan2(i,e),h=Math.abs(a+o);return h<1e-5||Math.abs(hn-h)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=o),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx+(l.x*e+l.y*r),t.position.y=this.ty+(l.x*i+l.y*n),t}invert(){let t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,l=t*r-e*i;return this.a=r/l,this.b=-e/l,this.c=-i/l,this.d=t/l,this.tx=(i*this.ty-r*n)/l,this.ty=-(t*this.ty-e*n)/l,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){let t=new mt;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new mt}static get TEMP_MATRIX(){return new mt}};var Ja=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],tl=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],el=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],sl=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Bp=[],U_=[],Mf=Math.sign;function j1(){for(let s=0;s<16;s++){let t=[];Bp.push(t);for(let e=0;e<16;e++){let i=Mf(Ja[s]*Ja[e]+el[s]*tl[e]),r=Mf(tl[s]*Ja[e]+sl[s]*tl[e]),n=Mf(Ja[s]*el[e]+el[s]*sl[e]),l=Mf(tl[s]*el[e]+sl[s]*sl[e]);for(let a=0;a<16;a++)if(Ja[a]===i&&tl[a]===r&&el[a]===n&&sl[a]===l){t.push(a);break}}}for(let s=0;s<16;s++){let t=new mt;t.set(Ja[s],tl[s],el[s],sl[s],0,0),U_.push(t)}}j1();var Yt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:s=>Ja[s],uY:s=>tl[s],vX:s=>el[s],vY:s=>sl[s],inv:s=>s&8?s&15:-s&7,add:(s,t)=>Bp[s][t],sub:(s,t)=>Bp[s][Yt.inv(t)],rotate180:s=>s^4,isVertical:s=>(s&3)===2,byDirection:(s,t)=>Math.abs(s)*2<=Math.abs(t)?t>=0?Yt.S:Yt.N:Math.abs(t)*2<=Math.abs(s)?s>0?Yt.E:Yt.W:t>0?s>0?Yt.SE:Yt.SW:s>0?Yt.NE:Yt.NW,matrixAppendRotationInv:(s,t,e=0,i=0)=>{let r=U_[Yt.inv(t)];r.tx=e,r.ty=i,s.append(r)}};var Zs=class{constructor(t,e,i=0,r=0){this._x=i,this._y=r,this.cb=t,this.scope=e}clone(t=this.cb,e=this.scope){return new Zs(t,e,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=${0} y=${0} scope=${this.scope}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}};var D_=class{constructor(){this.worldTransform=new mt,this.localTransform=new mt,this.position=new Zs(this.onChange,this,0,0),this.scale=new Zs(this.onChange,this,1,1),this.pivot=new Zs(this.onChange,this,0,0),this.skew=new Zs(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){let s=this.localTransform;this._localID!==this._currentLocalID&&(s.a=this._cx*this.scale.x,s.b=this._sx*this.scale.x,s.c=this._cy*this.scale.y,s.d=this._sy*this.scale.y,s.tx=this.position.x-(this.pivot.x*s.a+this.pivot.y*s.c),s.ty=this.position.y-(this.pivot.x*s.b+this.pivot.y*s.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(s){let t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==s._worldID){let e=s.worldTransform,i=this.worldTransform;i.a=t.a*e.a+t.b*e.c,i.b=t.a*e.b+t.b*e.d,i.c=t.c*e.a+t.d*e.c,i.d=t.c*e.b+t.d*e.d,i.tx=t.tx*e.a+t.ty*e.c+e.tx,i.ty=t.tx*e.b+t.ty*e.d+e.ty,this._parentID=s._worldID,this._worldID++}}setFromMatrix(s){s.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(s){this._rotation!==s&&(this._rotation=s,this.updateSkew())}},cn=D_;cn.IDENTITY=new D_;var V_=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`;var G_=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function kf(s,t,e){let i=s.createShader(t);return s.shaderSource(i,e),s.compileShader(i),i}function Lp(s){let t=new Array(s);for(let e=0;e<t.length;e++)t[e]=!1;return t}function Eu(s,t){switch(s){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return Lp(2*t);case"bvec3":return Lp(3*t);case"bvec4":return Lp(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var Fi=[{test:s=>s.type==="float"&&s.size===1&&!s.isArray,code:s=>`
            if(uv["${s}"] !== ud["${s}"].value)
            {
                ud["${s}"].value = uv["${s}"]
                gl.uniform1f(ud["${s}"].location, uv["${s}"])
            }
            `},{test:(s,t)=>(s.type==="sampler2D"||s.type==="samplerCube"||s.type==="sampler2DArray")&&s.size===1&&!s.isArray&&(t==null||t.castToBaseTexture!==void 0),code:s=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${s}"], t);

            if(ud["${s}"].value !== t)
            {
                ud["${s}"].value = t;
                gl.uniform1i(ud["${s}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(s,t)=>s.type==="mat3"&&s.size===1&&!s.isArray&&t.a!==void 0,code:s=>`
            gl.uniformMatrix3fv(ud["${s}"].location, false, uv["${s}"].toArray(true));
            `,codeUbo:s=>`
                var ${s}_matrix = uv.${s}.toArray(true);

                data[offset] = ${s}_matrix[0];
                data[offset+1] = ${s}_matrix[1];
                data[offset+2] = ${s}_matrix[2];
        
                data[offset + 4] = ${s}_matrix[3];
                data[offset + 5] = ${s}_matrix[4];
                data[offset + 6] = ${s}_matrix[5];
        
                data[offset + 8] = ${s}_matrix[6];
                data[offset + 9] = ${s}_matrix[7];
                data[offset + 10] = ${s}_matrix[8];
            `},{test:(s,t)=>s.type==="vec2"&&s.size===1&&!s.isArray&&t.x!==void 0,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${s}"].location, v.x, v.y);
                }`,codeUbo:s=>`
                v = uv.${s};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:s=>s.type==="vec2"&&s.size===1&&!s.isArray,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${s}"].location, v[0], v[1]);
                }
            `},{test:(s,t)=>s.type==="vec4"&&s.size===1&&!s.isArray&&t.width!==void 0,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${s}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:s=>`
                    v = uv.${s};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:s=>s.type==="vec4"&&s.size===1&&!s.isArray,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${s}"].location, v[0], v[1], v[2], v[3])
                }`}];var W1={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},$1={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function Up(s,t){var i;let e=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(let r in s.uniforms){let n=t[r];if(!n){(i=s.uniforms[r])!=null&&i.group&&(s.uniforms[r].ubo?e.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${r}, '${r}');
                    `):e.push(`
                        renderer.shader.syncUniformGroup(uv.${r}, syncData);
                    `));continue}let l=s.uniforms[r],a=!1;for(let o=0;o<Fi.length;o++)if(Fi[o].test(n,l)){e.push(Fi[o].code(r,l)),a=!0;break}if(!a){let h=(n.size===1&&!n.isArray?W1:$1)[n.type].replace("location",`ud["${r}"].location`);e.push(`
            cu = ud["${r}"];
            cv = cu.value;
            v = uv["${r}"];
            ${h};`)}}return new Function("ud","uv","renderer","syncData",e.join(`
`))}var X_={},mh=X_;function Pf(){if(mh===X_||(mh==null?void 0:mh.isContextLost())){let s=z.ADAPTER.createCanvas(),t;z.PREFER_ENV>=Cs.WEBGL2&&(t=s.getContext("webgl2",{})),t||(t=s.getContext("webgl",{})||s.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),mh=t}return mh}var Of;function Dp(){if(!Of){Of=je.MEDIUM;let s=Pf();s&&s.getShaderPrecisionFormat&&(Of=s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision?je.HIGH:je.MEDIUM)}return Of}function Y_(s,t){let e=s.getShaderSource(t).split(`
`).map((h,c)=>`${c}: ${h}`),i=s.getShaderInfoLog(t),r=i.split(`
`),n={},l=r.map(h=>parseFloat(h.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(h=>h&&!n[h]?(n[h]=!0,!0):!1),a=[""];l.forEach(h=>{e[h-1]=`%c${e[h-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});let o=e.join(`
`);a[0]=o,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function Vp(s,t,e,i){s.getProgramParameter(t,s.LINK_STATUS)||(s.getShaderParameter(e,s.COMPILE_STATUS)||Y_(s,e),s.getShaderParameter(i,s.COMPILE_STATUS)||Y_(s,i),console.error("PixiJS Error: Could not initialize shader."),s.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",s.getProgramInfoLog(t)))}var H1={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Au(s){return H1[s]}var Nf=null,j_={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Iu(s,t){if(!Nf){let e=Object.keys(j_);Nf={};for(let i=0;i<e.length;++i){let r=e[i];Nf[s[r]]=j_[r]}}return Nf[t]}function Ff(s,t,e){if(s.substring(0,9)!=="precision"){let i=t;return t===je.HIGH&&e!==je.HIGH&&(i=je.MEDIUM),`precision ${i} float;
${s}`}else if(e!==je.HIGH&&s.substring(0,15)==="precision highp")return s.replace("precision highp","precision mediump");return s}var Tu;function Bf(){if(typeof Tu=="boolean")return Tu;try{Tu=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch(s){Tu=!1}return Tu}var q1=0,Lf={},ph=class{constructor(s,t,e="pixi-shader",i={}){this.extra={},this.id=q1++,this.vertexSrc=s||ph.defaultVertexSrc,this.fragmentSrc=t||ph.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,this.vertexSrc.substring(0,8)!=="#version"&&(e=e.replace(/\s+/g,"-"),Lf[e]?(Lf[e]++,e+=`-${Lf[e]}`):Lf[e]=1,this.vertexSrc=`#define SHADER_NAME ${e}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${e}
${this.fragmentSrc}`,this.vertexSrc=Ff(this.vertexSrc,ph.defaultVertexPrecision,je.HIGH),this.fragmentSrc=Ff(this.fragmentSrc,ph.defaultFragmentPrecision,Dp())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return G_}static get defaultFragmentSrc(){return V_}static from(s,t,e){let i=s+t,r=yu[i];return r||(yu[i]=r=new ph(s,t,e)),r}},De=ph;De.defaultVertexPrecision=je.HIGH;De.defaultFragmentPrecision=zs.apple.device?je.HIGH:je.MEDIUM;var z1=0,ge=class{constructor(t,e,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=z1++,this.static=!!e,this.ubo=!!i,t instanceof Gt?(this.buffer=t,this.buffer.type=fs.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new Gt(new Float32Array(1)),this.buffer.type=fs.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,e,i){if(!this.ubo)this.uniforms[t]=new ge(e,i);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,e,i){return new ge(t,e,i)}static uboFrom(t,e){return new ge(t,e!=null?e:!0,!0)}};var Ps=class{constructor(t,e){this.uniformBindCount=0,this.program=t,e?e instanceof ge?this.uniformGroup=e:this.uniformGroup=new ge(e):this.uniformGroup=new ge({}),this.disposeRunner=new ne("disposeShader")}checkUniformExists(t,e){if(e.uniforms[t])return!0;for(let i in e.uniforms){let r=e.uniforms[i];if(r.group&&this.checkUniformExists(t,r))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,e,i){let r=De.from(t,e);return new Ps(r,i)}};var Su=class{constructor(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},!e.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!e.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){let i=new Int32Array(t);for(let n=0;n<t;n++)i[n]=n;this.defaultGroupCache[t]=ge.from({uSamplers:i},!0);let r=this.fragTemplate;r=r.replace(/%count%/gi,`${t}`),r=r.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new De(this.vertexSrc,r)}let e={tint:new Float32Array([1,1,1,1]),translationMatrix:new mt,default:this.defaultGroupCache[t]};return new Ps(this.programCache[t],e)}generateSampleSrc(t){let e="";e+=`
`,e+=`
`;for(let i=0;i<t;i++)i>0&&(e+=`
else `),i<t-1&&(e+=`if(vTextureId < ${i}.5)`),e+=`
{`,e+=`
	color = texture2D(uSamplers[${i}], vTextureCoord);`,e+=`
}`;return e+=`
`,e+=`
`,e}};var un=class{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}};function W_(){return!zs.apple.device}function $_(s){let t=!0,e=z.ADAPTER.getNavigator();if(zs.tablet||zs.phone){if(zs.apple.device){let i=e.userAgent.match(/OS (\d+)_(\d+)?/);i&&parseInt(i[1],10)<11&&(t=!1)}if(zs.android.device){let i=e.userAgent.match(/Android\s([0-9.]*)/);i&&parseInt(i[1],10)<7&&(t=!1)}}return t?s:4}var il=class{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}};var H_=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`;var q_=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;var pi=class extends il{constructor(s){super(s),this.setShaderGenerator(),this.geometryClass=za,this.vertexSize=6,this.state=He.for2d(),this.size=pi.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),s.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){var s;return this._defaultMaxTextures=(s=this._defaultMaxTextures)!=null?s:$_(32),this._defaultMaxTextures}static set defaultMaxTextures(s){this._defaultMaxTextures=s}static get canUploadSameBuffer(){var s;return this._canUploadSameBuffer=(s=this._canUploadSameBuffer)!=null?s:W_(),this._canUploadSameBuffer}static set canUploadSameBuffer(s){this._canUploadSameBuffer=s}get MAX_TEXTURES(){return xt("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return q_}static get defaultFragmentTemplate(){return H_}setShaderGenerator({vertex:s=pi.defaultVertexSrc,fragment:t=pi.defaultFragmentTemplate}={}){this.shaderGenerator=new Su(s,t)}contextChange(){let s=this.renderer.gl;z.PREFER_ENV===Cs.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),pi.defaultMaxTextures),this.maxTextures=Cf(this.maxTextures,s)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){let{_drawCallPool:s,_textureArrayPool:t}=pi,e=this.size/4,i=Math.floor(e/this.maxTextures)+1;for(;s.length<e;)s.push(new an);for(;t.length<i;)t.push(new un);for(let r=0;r<this.maxTextures;r++)this._tempBoundTextures[r]=null}onPrerender(){this._flushId=0}render(s){!s._texture.valid||(this._vertexCount+s.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=s.vertexData.length/2,this._indexCount+=s.indices.length,this._bufferedTextures[this._bufferSize]=s._texture.baseTexture,this._bufferedElements[this._bufferSize++]=s)}buildTexturesAndDrawCalls(){let{_bufferedTextures:s,maxTextures:t}=this,e=pi._textureArrayPool,i=this.renderer.batch,r=this._tempBoundTextures,n=this.renderer.textureGC.count,l=++lt._globalBatch,a=0,o=e[0],h=0;i.copyBoundTextures(r,t);for(let c=0;c<this._bufferSize;++c){let u=s[c];s[c]=null,u._batchEnabled!==l&&(o.count>=t&&(i.boundArray(o,r,l,t),this.buildDrawCalls(o,h,c),h=c,o=e[++a],++l),u._batchEnabled=l,u.touched=n,o.elements[o.count++]=u)}o.count>0&&(i.boundArray(o,r,l,t),this.buildDrawCalls(o,h,this._bufferSize),++a,++l);for(let c=0;c<r.length;c++)r[c]=null;lt._globalBatch=l}buildDrawCalls(s,t,e){let{_bufferedElements:i,_attributeBuffer:r,_indexBuffer:n,vertexSize:l}=this,a=pi._drawCallPool,o=this._dcIndex,h=this._aIndex,c=this._iIndex,u=a[o];u.start=this._iIndex,u.texArray=s;for(let d=t;d<e;++d){let f=i[d],m=f._texture.baseTexture,p=xu[m.alphaMode?1:0][f.blendMode];i[d]=null,t<d&&u.blend!==p&&(u.size=c-u.start,t=d,u=a[++o],u.texArray=s,u.start=c),this.packInterleavedGeometry(f,r,n,h,c),h+=f.vertexData.length/2*l,c+=f.indices.length,u.blend=p}t<e&&(u.size=c-u.start,++o),this._dcIndex=o,this._aIndex=h,this._iIndex=c}bindAndClearTexArray(s){let t=this.renderer.texture;for(let e=0;e<s.count;e++)t.bind(s.elements[e],s.ids[e]),s.elements[e]=null;s.count=0}updateGeometry(){let{_packedGeometries:s,_attributeBuffer:t,_indexBuffer:e}=this;pi.canUploadSameBuffer?(s[this._flushId]._buffer.update(t.rawBinaryData),s[this._flushId]._indexBuffer.update(e),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,s[this._flushId]=new this.geometryClass),s[this._flushId]._buffer.update(t.rawBinaryData),s[this._flushId]._indexBuffer.update(e),this.renderer.geometry.bind(s[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){let s=this._dcIndex,{gl:t,state:e}=this.renderer,i=pi._drawCallPool,r=null;for(let n=0;n<s;n++){let{texArray:l,type:a,size:o,start:h,blend:c}=i[n];r!==l&&(r=l,this.bindAndClearTexArray(l)),this.state.blendMode=c,e.set(this.state),t.drawElements(a,o,t.UNSIGNED_SHORT,h*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),pi.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let s=0;s<this._packedGeometryPoolSize;s++)this._packedGeometries[s]&&this._packedGeometries[s].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(s){let t=nn(Math.ceil(s/8)),e=_u(t),i=t*8;this._aBuffers.length<=e&&(this._iBuffers.length=e+1);let r=this._aBuffers[i];return r||(this._aBuffers[i]=r=new wu(i*this.vertexSize*4)),r}getIndexBuffer(s){let t=nn(Math.ceil(s/12)),e=_u(t),i=t*12;this._iBuffers.length<=e&&(this._iBuffers.length=e+1);let r=this._iBuffers[e];return r||(this._iBuffers[e]=r=new Uint16Array(i)),r}packInterleavedGeometry(s,t,e,i,r){let{uint32View:n,float32View:l}=t,a=i/this.vertexSize,o=s.uvs,h=s.indices,c=s.vertexData,u=s._texture.baseTexture._batchLocation,d=Math.min(s.worldAlpha,1),f=d<1&&s._texture.baseTexture.alphaMode?vf(s._tintRGB,d):s._tintRGB+(d*255<<24);for(let m=0;m<c.length;m+=2)l[i++]=c[m],l[i++]=c[m+1],l[i++]=o[m],l[i++]=o[m+1],n[i++]=f,l[i++]=u;for(let m=0;m<h.length;m++)e[r++]=a+h[m]}},Os=pi;Os.defaultBatchSize=4096;Os.extension={name:"batch",type:H.RendererPlugin};Os._drawCallPool=[];Os._textureArrayPool=[];K.add(Os);var z_=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`;var K_=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;var Cu=class extends Ps{constructor(s,t,e){let i=De.from(s||Cu.defaultVertexSrc,t||Cu.defaultFragmentSrc);super(i,e),this.padding=0,this.resolution=Cu.defaultResolution,this.multisample=Cu.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new He}apply(s,t,e,i,r){s.applyFilter(this,t,e,i)}get blendMode(){return this.state.blendMode}set blendMode(s){this.state.blendMode=s}get resolution(){return this._resolution}set resolution(s){this._resolution=s}static get defaultVertexSrc(){return K_}static get defaultFragmentSrc(){return z_}},Qs=Cu;Qs.defaultResolution=1;Qs.defaultMultisample=Ft.NONE;var gh=class{constructor(){this.clearBeforeRender=!0,this._backgroundColor=0,this._backgroundColorRgba=[0,0,0,1],this._backgroundColorString="#000000",this.color=this._backgroundColor,this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender,t.color&&(this.color=typeof t.color=="string"?yf(t.color):t.color),this.alpha=t.alpha}get color(){return this._backgroundColor}set color(t){this._backgroundColor=t,this._backgroundColorString=_f(t),bf(t,this._backgroundColorRgba)}get alpha(){return this._backgroundColorRgba[3]}set alpha(t){this._backgroundColorRgba[3]=t}get colorRgba(){return this._backgroundColorRgba}get colorString(){return this._backgroundColorString}destroy(){}};gh.extension={type:[H.RendererSystem,H.CanvasRendererSystem],name:"background"};K.add(gh);var xh=class{constructor(t){this.renderer=t,this.emptyRenderer=new il(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,e){let{boundTextures:i}=this.renderer.texture;for(let r=e-1;r>=0;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)}boundArray(t,e,i,r){let{elements:n,ids:l,count:a}=t,o=0;for(let h=0;h<a;h++){let c=n[h],u=c._batchLocation;if(u>=0&&u<r&&e[u]===c){l[h]=u;continue}for(;o<r;){let d=e[o];if(d&&d._batchEnabled===i&&d._batchLocation===o){o++;continue}l[h]=o,c._batchLocation=o,e[o]=c;break}}}destroy(){this.renderer=null}};xh.extension={type:H.RendererSystem,name:"batch"};K.add(xh);var Z_=0,bh=class{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Z_++}init(t){if(t.context)this.initFromContext(t.context);else{let e=this.renderer.background.alpha<1,i=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:e,premultipliedAlpha:i,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Z_++,this.renderer.runners.contextChange.emit(t);let e=this.renderer.view;e.addEventListener!==void 0&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){let e=this.createContext(this.renderer.view,t);this.initFromContext(e)}createContext(t,e){let i;if(z.PREFER_ENV>=Cs.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!i)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl}getExtensions(){let{gl:t}=this,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){let t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){let e=t.getContextAttributes(),i="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;i&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");let r=i||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=r,r||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}};bh.extension={type:H.RendererSystem,name:"context"};K.add(bh);var Uf=class extends Ni{upload(t,e,i){let r=t.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Le.UNPACK);let n=e.realWidth,l=e.realHeight;return i.width===n&&i.height===l?r.texSubImage2D(e.target,0,0,0,n,l,e.format,i.type,this.data):(i.width=n,i.height=l,r.texImage2D(e.target,0,i.internalFormat,n,l,0,e.format,i.type,this.data)),!0}};var dn=class{constructor(t,e){this.width=Math.round(t||100),this.height=Math.round(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new ne("disposeFramebuffer"),this.multisample=Ft.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,e){return this.colorTextures[t]=e||new lt(null,{scaleMode:Se.NEAREST,resolution:1,mipmap:Rs.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new lt(new Uf(null,{width:this.width,height:this.height}),{scaleMode:Se.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Rs.OFF,format:J.DEPTH_COMPONENT,type:ft.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,e){if(t=Math.round(t),e=Math.round(e),!(t===this.width&&e===this.height)){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(let i=0;i<this.colorTextures.length;i++){let r=this.colorTextures[i],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){let i=this.depthTexture.resolution;this.depthTexture.setSize(t/i,e/i)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}};var rl=class extends lt{constructor(t={}){var e;if(typeof t=="number"){let i=arguments[0],r=arguments[1],n=arguments[2],l=arguments[3];t={width:i,height:r,scaleMode:n,resolution:l}}t.width=t.width||100,t.height=t.height||100,(e=t.multisample)!=null||(t.multisample=Ft.NONE),super(null,t),this.mipmap=Rs.OFF,this.valid=!0,this.clearColor=[0,0,0,0],this.framebuffer=new dn(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}resize(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}};var Ce=class extends Ms{constructor(t){let e=t,i=e.naturalWidth||e.videoWidth||e.width,r=e.naturalHeight||e.videoHeight||e.height;super(i,r),this.source=t,this.noSubImage=!1}static crossOrigin(t,e,i){i===void 0&&!e.startsWith("data:")?t.crossOrigin=Sf(e):i!==!1&&(t.crossOrigin=typeof i=="string"?i:"anonymous")}upload(t,e,i,r){let n=t.gl,l=e.realWidth,a=e.realHeight;if(r=r||this.source,typeof HTMLImageElement!="undefined"&&r instanceof HTMLImageElement){if(!r.complete||r.naturalWidth===0)return!1}else if(typeof HTMLVideoElement!="undefined"&&r instanceof HTMLVideoElement&&r.readyState<=1&&r.buffered.length===0)return!1;return n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Le.UNPACK),!this.noSubImage&&e.target===n.TEXTURE_2D&&i.width===l&&i.height===a?n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,i.type,r):(i.width=l,i.height=a,n.texImage2D(e.target,0,i.internalFormat,e.format,i.type,r)),!0}update(){if(this.destroyed)return;let t=this.source,e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;this.resize(e,i),super.update()}dispose(){this.source=null}};var fn=class extends Ce{constructor(t,e){var i;if(e=e||{},typeof t=="string"){let r=new Image;Ce.crossOrigin(r,t,e.crossorigin),r.src=t,t=r}super(t),!t.complete&&!!this._width&&!!this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=((i=e.createBitmap)!=null?i:z.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.bitmap=null,this._load=null,e.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((e,i)=>{let r=this.source;this.url=r.src;let n=()=>{this.destroyed||(r.onload=null,r.onerror=null,this.resize(r.width,r.height),this._load=null,this.createBitmap?e(this.process()):e(this))};r.complete&&r.src?n():(r.onload=n,r.onerror=l=>{i(l),this.onError.emit(l)})}),this._load)}process(){let t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);let e=globalThis.createImageBitmap,i=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:i?"cors":"no-cors"}).then(r=>r.blob()).then(r=>e(r,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Le.UNPACK?"premultiply":"none"})).then(r=>this.destroyed?Promise.reject():(this.bitmap=r,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,e,i){if(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,e,i,this.bitmap),!this.preserveBitmap){let r=!0,n=e._glTextures;for(let l in n){let a=n[l];if(a!==i&&a.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement!="undefined"&&(typeof t=="string"||t instanceof HTMLImageElement)}};var _h=class{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,i){let r=e.width,n=e.height;if(i){let l=t.width/2/r,a=t.height/2/n,o=t.x/r+l,h=t.y/n+a;i=Yt.add(i,Yt.NW),this.x0=o+l*Yt.uX(i),this.y0=h+a*Yt.uY(i),i=Yt.add(i,2),this.x1=o+l*Yt.uX(i),this.y1=h+a*Yt.uY(i),i=Yt.add(i,2),this.x2=o+l*Yt.uX(i),this.y2=h+a*Yt.uY(i),i=Yt.add(i,2),this.x3=o+l*Yt.uX(i),this.y3=h+a*Yt.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}};var Q_=new _h;function Df(s){s.destroy=function(){},s.on=function(){},s.once=function(){},s.emit=function(){}}var rt=class extends on.default{constructor(t,e,i,r,n,l){if(super(),this.noFrame=!1,e||(this.noFrame=!0,e=new ht(0,0,1,1)),t instanceof rt&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this._uvs=Q_,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(n||0),n===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=l?new Rt(l.x,l.y):new Rt(0,0),this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){let{resource:e}=this.baseTexture;(e==null?void 0:e.url)&&ve[e.url]&&rt.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,rt.removeFromCache(this),this.textureCacheIds=null}clone(){var r;let t=this._frame.clone(),e=this._frame===this.orig?t:this.orig.clone(),i=new rt(this.baseTexture,!this.noFrame&&t,e,(r=this.trim)==null?void 0:r.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(i._frame=t),i}updateUvs(){this._uvs===Q_&&(this._uvs=new _h),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,e={},i=z.STRICT_TEXTURE_CACHE){let r=typeof t=="string",n=null;if(r)n=t;else if(t instanceof lt){if(!t.cacheId){let a=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t.cacheId=`${a}-${Oi()}`,lt.addToCache(t,t.cacheId)}n=t.cacheId}else{if(!t._pixiId){let a=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${a}_${Oi()}`}n=t._pixiId}let l=ve[n];if(r&&i&&!l)throw new Error(`The cacheId "${n}" does not exist in TextureCache.`);return!l&&!(t instanceof lt)?(e.resolution||(e.resolution=vu(t)),l=new rt(new lt(t,e)),l.baseTexture.cacheId=n,lt.addToCache(l.baseTexture,n),rt.addToCache(l,n)):!l&&t instanceof lt&&(l=new rt(t),rt.addToCache(l,n)),l}static fromURL(t,e){let i=Object.assign({autoLoad:!1},e==null?void 0:e.resourceOptions),r=rt.from(t,Object.assign({resourceOptions:i},e),!1),n=r.baseTexture.resource;return r.baseTexture.valid?Promise.resolve(r):n.load().then(()=>Promise.resolve(r))}static fromBuffer(t,e,i,r){return new rt(lt.fromBuffer(t,e,i,r))}static fromLoader(t,e,i,r){let n=new lt(t,Object.assign({scaleMode:lt.defaultOptions.scaleMode,resolution:vu(e)},r)),{resource:l}=n;l instanceof fn&&(l.url=e);let a=new rt(n);return i||(i=e),lt.addToCache(a.baseTexture,i),rt.addToCache(a,i),i!==e&&(lt.addToCache(a.baseTexture,e),rt.addToCache(a,e)),a.baseTexture.valid?Promise.resolve(a):new Promise(o=>{a.baseTexture.once("loaded",()=>o(a))})}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),ve[e]&&ve[e]!==t&&console.warn(`Texture added to the cache with an id [${e}] that already had an entry`),ve[e]=t)}static removeFromCache(t){if(typeof t=="string"){let e=ve[t];if(e){let i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete ve[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)ve[t.textureCacheIds[e]]===t&&delete ve[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;let{x:e,y:i,width:r,height:n}=t,l=e+r>this.baseTexture.width,a=i+n>this.baseTexture.height;if(l||a){let o=l&&a?"and":"or",h=`X: ${e} + ${r} = ${e+r} > ${this.baseTexture.width}`,c=`Y: ${i} + ${n} = ${i+n} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${h} ${o} ${c}`)}this.valid=r&&n&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return rt._EMPTY||(rt._EMPTY=new rt(new lt),Df(rt._EMPTY),Df(rt._EMPTY.baseTexture)),rt._EMPTY}static get WHITE(){if(!rt._WHITE){let t=z.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),rt._WHITE=new rt(lt.from(t)),Df(rt._WHITE),Df(rt._WHITE.baseTexture)}return rt._WHITE}};var Sr=class extends rt{constructor(t,e){super(t,e),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e,i=!0){let r=this.baseTexture.resolution,n=Math.round(t*r)/r,l=Math.round(e*r)/r;this.valid=n>0&&l>0,this._frame.width=this.orig.width=n,this._frame.height=this.orig.height=l,i&&this.baseTexture.resize(n,l),this.updateUvs()}setResolution(t){let{baseTexture:e}=this;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}static create(t){return new Sr(new rl(t))}};var yh=class{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,e,i=Ft.NONE){let r=new rl(Object.assign({width:t,height:e,resolution:1,multisample:i},this.textureOptions));return new Sr(r)}getOptimalTexture(t,e,i=1,r=Ft.NONE){let n;t=Math.ceil(t*i-1e-6),e=Math.ceil(e*i-1e-6),!this.enableFullScreen||t!==this._pixelsWidth||e!==this._pixelsHeight?(t=nn(t),e=nn(e),n=((t&65535)<<16|e&65535)>>>0,r>1&&(n+=r*4294967296)):n=r>1?-r:-1,this.texturePool[n]||(this.texturePool[n]=[]);let l=this.texturePool[n].pop();return l||(l=this.createTexture(t,e,r)),l.filterPoolKey=n,l.setResolution(i),l}getFilterTexture(t,e,i){let r=this.getOptimalTexture(t.width,t.height,e||t.resolution,i||Ft.NONE);return r.filterFrame=t.filterFrame,r}returnTexture(t){let e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(let e in this.texturePool){let i=this.texturePool[e];if(i)for(let r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(let e in this.texturePool){if(!(Number(e)<0))continue;let i=this.texturePool[e];if(i)for(let r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}};yh.SCREEN_KEY=-1;var Ru=class extends ms{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}};var Mu=class extends ms{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Gt(this.vertices),this.uvBuffer=new Gt(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,e){let i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}};var ku=class{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Ft.NONE,this.sourceFrame=new ht,this.destinationFrame=new ht,this.bindingSourceFrame=new ht,this.bindingDestinationFrame=new ht,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}};var Vf=[new Rt,new Rt,new Rt,new Rt],Gp=new mt,vh=class{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new yh,this.statePool=[],this.quad=new Ru,this.quadUv=new Mu,this.tempRect=new ht,this.activeState={},this.globalUniforms=new ge({outputFrame:new ht,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,e){var m,p;let i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new ku,l=this.renderer.renderTexture,a=e[0].resolution,o=e[0].multisample,h=e[0].padding,c=e[0].autoFit,u=(m=e[0].legacy)!=null?m:!0;for(let g=1;g<e.length;g++){let y=e[g];a=Math.min(a,y.resolution),o=Math.min(o,y.multisample),h=this.useMaxPadding?Math.max(h,y.padding):h+y.padding,c=c&&y.autoFit,u=u||((p=y.legacy)!=null?p:!0)}r.length===1&&(this.defaultFilterStack[0].renderTexture=l.current),r.push(n),n.resolution=a,n.multisample=o,n.legacy=u,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(h);let d=this.tempRect.copyFrom(l.sourceFrame);i.projection.transform&&this.transformAABB(Gp.copyFrom(i.projection.transform).invert(),d),c?(n.sourceFrame.fit(d),(n.sourceFrame.width<=0||n.sourceFrame.height<=0)&&(n.sourceFrame.width=0,n.sourceFrame.height=0)):n.sourceFrame.intersects(d)||(n.sourceFrame.width=0,n.sourceFrame.height=0),this.roundFrame(n.sourceFrame,l.current?l.current.resolution:i.resolution,l.sourceFrame,l.destinationFrame,i.projection.transform),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,a,o),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height;let f=this.tempRect;f.x=0,f.y=0,f.width=n.sourceFrame.width,f.height=n.sourceFrame.height,n.renderTexture.filterFrame=n.sourceFrame,n.bindingSourceFrame.copyFrom(l.sourceFrame),n.bindingDestinationFrame.copyFrom(l.destinationFrame),n.transform=i.projection.transform,i.projection.transform=null,l.bind(n.renderTexture,n.sourceFrame,f),i.framebuffer.clear(0,0,0,0)}pop(){let t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;let r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;let n=r.inputSize,l=r.inputPixel,a=r.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],l[0]=Math.round(n[0]*e.resolution),l[1]=Math.round(n[1]*e.resolution),l[2]=1/l[0],l[3]=1/l[1],a[0]=.5*l[2],a[1]=.5*l[3],a[2]=e.sourceFrame.width*n[2]-.5*l[2],a[3]=e.sourceFrame.height*n[3]-.5*l[3],e.legacy){let h=r.filterArea;h[0]=e.destinationFrame.width,h[1]=e.destinationFrame.height,h[2]=e.sourceFrame.x,h[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();let o=t[t.length-1];if(this.renderer.framebuffer.blit(),i.length===1)i[0].apply(this,e.renderTexture,o.renderTexture,sn.BLEND,e),this.returnFilterTexture(e.renderTexture);else{let h=e.renderTexture,c=this.getOptimalFilterTexture(h.width,h.height,e.resolution);c.filterFrame=h.filterFrame;let u=0;for(u=0;u<i.length-1;++u){u===1&&e.multisample>1&&(c=this.getOptimalFilterTexture(h.width,h.height,e.resolution),c.filterFrame=h.filterFrame),i[u].apply(this,h,c,sn.CLEAR,e);let d=h;h=c,c=d}i[u].apply(this,h,o.renderTexture,sn.BLEND,e),u>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(h),this.returnFilterTexture(c)}e.clear(),this.statePool.push(e)}bindAndClear(t,e=sn.CLEAR){let{renderTexture:i,state:r}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t!=null&&t.filterFrame){let l=this.tempRect;l.x=0,l.y=0,l.width=t.filterFrame.width,l.height=t.filterFrame.height,i.bind(t,t.filterFrame,l)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);let n=r.stateId&1||this.forceClear;(e===sn.CLEAR||e===sn.BLIT&&n)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,e,i,r){let n=this.renderer;n.state.set(t.state),this.bindAndClear(i,r),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(Be.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(Be.TRIANGLE_STRIP))}calculateSpriteMatrix(t,e){let{sourceFrame:i,destinationFrame:r}=this.activeState,{orig:n}=e._texture,l=t.set(r.width,0,0,r.height,i.x,i.y),a=e.worldTransform.copyTo(mt.TEMP_MATRIX);return a.invert(),l.prepend(a),l.scale(1/n.width,1/n.height),l.translate(e.anchor.x,e.anchor.y),l}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,e,i=1,r=Ft.NONE){return this.texturePool.getOptimalTexture(t,e,i,r)}getFilterTexture(t,e,i){if(typeof t=="number"){let n=t;t=e,e=n}t=t||this.activeState.renderTexture;let r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,i||Ft.NONE);return r.filterFrame=t.filterFrame,r}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,e){let i=Vf[0],r=Vf[1],n=Vf[2],l=Vf[3];i.set(e.left,e.top),r.set(e.left,e.bottom),n.set(e.right,e.top),l.set(e.right,e.bottom),t.apply(i,i),t.apply(r,r),t.apply(n,n),t.apply(l,l);let a=Math.min(i.x,r.x,n.x,l.x),o=Math.min(i.y,r.y,n.y,l.y),h=Math.max(i.x,r.x,n.x,l.x),c=Math.max(i.y,r.y,n.y,l.y);e.x=a,e.y=o,e.width=h-a,e.height=c-o}roundFrame(t,e,i,r,n){if(!(t.width<=0||t.height<=0||i.width<=0||i.height<=0)){if(n){let{a:l,b:a,c:o,d:h}=n;if((Math.abs(a)>1e-4||Math.abs(o)>1e-4)&&(Math.abs(l)>1e-4||Math.abs(h)>1e-4))return}n=n?Gp.copyFrom(n):Gp.identity(),n.translate(-i.x,-i.y).scale(r.width/i.width,r.height/i.height).translate(r.x,r.y),this.transformAABB(n,t),t.ceil(e),this.transformAABB(n.invert(),t)}}};vh.extension={type:H.RendererSystem,name:"filter"};K.add(vh);var Pu=class{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Ft.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}};var K1=new ht,wh=class{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new dn(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);let t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new ht,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;z.PREFER_ENV===Cs.WEBGL_LEGACY&&(e=null,i=null),e?t.drawBuffers=r=>e.drawBuffersWEBGL(r):(this.hasMRT=!1,t.drawBuffers=()=>{}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,e,i=0){let{gl:r}=this;if(t){let n=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,n.framebuffer)),n.mipLevel!==i&&(t.dirtyId++,t.dirtyFormat++,n.mipLevel=i),n.dirtyId!==t.dirtyId&&(n.dirtyId=t.dirtyId,n.dirtyFormat!==t.dirtyFormat?(n.dirtyFormat=t.dirtyFormat,n.dirtySize=t.dirtySize,this.updateFramebuffer(t,i)):n.dirtySize!==t.dirtySize&&(n.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let l=0;l<t.colorTextures.length;l++){let a=t.colorTextures[l];this.renderer.texture.unbind(a.parentTextureArray||a)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){let l=e.width>>i,a=e.height>>i,o=l/e.width;this.setViewport(e.x*o,e.y*o,l,a)}else{let l=t.width>>i,a=t.height>>i;this.setViewport(0,0,l,a)}}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,e,i,r){let n=this.viewport;t=Math.round(t),e=Math.round(e),i=Math.round(i),r=Math.round(r),(n.width!==i||n.height!==r||n.x!==t||n.y!==e)&&(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,e,i,r,n=af.COLOR|af.DEPTH){let{gl:l}=this;l.clearColor(t,e,i,r),l.clear(n)}initFramebuffer(t){let{gl:e}=this,i=new Pu(e.createFramebuffer());return i.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(t),t.disposeRunner.add(this),i}resizeFramebuffer(t){let{gl:e}=this,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),i.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,i.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));let r=t.colorTextures,n=r.length;e.drawBuffers||(n=Math.min(n,1));for(let l=0;l<n;l++){let a=r[l],o=a.parentTextureArray||a;this.renderer.texture.bind(o,0),l===0&&i.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,i.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,i.multisample,o._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,e){let{gl:i}=this,r=t.glFramebuffers[this.CONTEXT_UID],n=t.colorTextures,l=n.length;i.drawBuffers||(l=Math.min(l,1)),r.multisample>1&&this.canMultisampleFramebuffer(t)?r.msaaBuffer=r.msaaBuffer||i.createRenderbuffer():r.msaaBuffer&&(i.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&(r.blitFramebuffer.dispose(),r.blitFramebuffer=null));let a=[];for(let o=0;o<l;o++){let h=n[o],c=h.parentTextureArray||h;this.renderer.texture.bind(c,0),o===0&&r.msaaBuffer?(i.bindRenderbuffer(i.RENDERBUFFER,r.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,r.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,r.msaaBuffer)):(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+o,h.target,c._glTextures[this.CONTEXT_UID].texture,e),a.push(i.COLOR_ATTACHMENT0+o))}if(a.length>1&&i.drawBuffers(a),t.depthTexture&&this.writeDepthTexture){let h=t.depthTexture;this.renderer.texture.bind(h,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,h._glTextures[this.CONTEXT_UID].texture,e)}(t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)?(r.stencil=r.stencil||i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,r.stencil),r.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,r.multisample,i.DEPTH24_STENCIL8,t.width,t.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,r.stencil)):r.stencil&&(i.deleteRenderbuffer(r.stencil),r.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){let{msaaSamples:e}=this,i=Ft.NONE;if(t<=1||e===null)return i;for(let r=0;r<e.length;r++)if(e[r]<=t){i=e[r];break}return i===1&&(i=Ft.NONE),i}blit(t,e,i){let{current:r,renderer:n,gl:l,CONTEXT_UID:a}=this;if(n.context.webGLVersion!==2||!r)return;let o=r.glFramebuffers[a];if(!o)return;if(!t){if(!o.msaaBuffer)return;let c=r.colorTextures[0];if(!c)return;o.blitFramebuffer||(o.blitFramebuffer=new dn(r.width,r.height),o.blitFramebuffer.addColorTexture(0,c)),t=o.blitFramebuffer,t.colorTextures[0]!==c&&(t.colorTextures[0]=c,t.dirtyId++,t.dirtyFormat++),(t.width!==r.width||t.height!==r.height)&&(t.width=r.width,t.height=r.height,t.dirtyId++,t.dirtySize++)}e||(e=K1,e.width=r.width,e.height=r.height),i||(i=e);let h=e.width===i.width&&e.height===i.height;this.bind(t),l.bindFramebuffer(l.READ_FRAMEBUFFER,o.framebuffer),l.blitFramebuffer(e.left,e.top,e.right,e.bottom,i.left,i.top,i.right,i.bottom,l.COLOR_BUFFER_BIT,h?l.NEAREST:l.LINEAR)}disposeFramebuffer(t,e){let i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(!i)return;delete t.glFramebuffers[this.CONTEXT_UID];let n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&r.deleteRenderbuffer(i.msaaBuffer),i.stencil&&r.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&i.blitFramebuffer.dispose()}disposeAll(t){let e=this.managedFramebuffers;this.managedFramebuffers=[];for(let i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)}forceStencil(){let t=this.current;if(!t)return;let e=t.glFramebuffers[this.CONTEXT_UID];if(!e||e.stencil)return;t.stencil=!0;let i=t.width,r=t.height,n=this.gl,l=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,l),e.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,e.multisample,n.DEPTH24_STENCIL8,i,r):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,r),e.stencil=l,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,l)}reset(){this.current=this.unknownFramebuffer,this.viewport=new ht}destroy(){this.renderer=null}};wh.extension={type:H.RendererSystem,name:"framebuffer"};K.add(wh);var Xp={5126:4,5123:2,5121:1},Eh=class{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);let t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,e.webGLVersion!==2){let i=this.renderer.context.extensions.vertexArrayObject;z.PREFER_ENV===Cs.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=()=>i.createVertexArrayOES(),t.bindVertexArray=r=>i.bindVertexArrayOES(r),t.deleteVertexArray=r=>i.deleteVertexArrayOES(r)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(e.webGLVersion!==2){let i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=(r,n)=>i.vertexAttribDivisorANGLE(r,n),t.drawElementsInstanced=(r,n,l,a,o)=>i.drawElementsInstancedANGLE(r,n,l,a,o),t.drawArraysInstanced=(r,n,l,a)=>i.drawArraysInstancedANGLE(r,n,l,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=e.webGLVersion===2||!!e.extensions.uint32ElementIndex}bind(t,e){e=e||this.renderer.shader.shader;let{gl:i}=this,r=t.glVertexArrayObjects[this.CONTEXT_UID],n=!1;r||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={},n=!0);let l=r[e.program.id]||this.initGeometryVao(t,e,n);this._activeGeometry=t,this._activeVao!==l&&(this._activeVao=l,this.hasVao?i.bindVertexArray(l):this.activateVao(t,e.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){let t=this._activeGeometry,e=this.renderer.buffer;for(let i=0;i<t.buffers.length;i++){let r=t.buffers[i];e.update(r)}}checkCompatibility(t,e){let i=t.attributes,r=e.attributeData;for(let n in r)if(!i[n])throw new Error(`shader and geometry incompatible, geometry missing the "${n}" attribute`)}getSignature(t,e){let i=t.attributes,r=e.attributeData,n=["g",t.id];for(let l in i)r[l]&&n.push(l,r[l].location);return n.join("-")}initGeometryVao(t,e,i=!0){let r=this.gl,n=this.CONTEXT_UID,l=this.renderer.buffer,a=e.program;a.glPrograms[n]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,a);let o=this.getSignature(t,a),h=t.glVertexArrayObjects[this.CONTEXT_UID],c=h[o];if(c)return h[a.id]=c,c;let u=t.buffers,d=t.attributes,f={},m={};for(let p in u)f[p]=0,m[p]=0;for(let p in d)!d[p].size&&a.attributeData[p]?d[p].size=a.attributeData[p].size:d[p].size||console.warn(`PIXI Geometry attribute '${p}' size cannot be determined (likely the bound shader does not have the attribute)`),f[d[p].buffer]+=d[p].size*Xp[d[p].type];for(let p in d){let g=d[p],y=g.size;g.stride===void 0&&(f[g.buffer]===y*Xp[g.type]?g.stride=0:g.stride=f[g.buffer]),g.start===void 0&&(g.start=m[g.buffer],m[g.buffer]+=y*Xp[g.type])}c=r.createVertexArray(),r.bindVertexArray(c);for(let p=0;p<u.length;p++){let g=u[p];l.bind(g),i&&g._glBuffers[n].refCount++}return this.activateVao(t,a),h[a.id]=c,h[o]=c,r.bindVertexArray(null),l.unbind(fs.ARRAY_BUFFER),c}disposeGeometry(t,e){var a;if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];let i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers,l=(a=this.renderer)==null?void 0:a.buffer;if(t.disposeRunner.remove(this),!!i){if(l)for(let o=0;o<n.length;o++){let h=n[o]._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,h.refCount===0&&!e&&l.dispose(n[o],e))}if(!e){for(let o in i)if(o[0]==="g"){let h=i[o];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){let e=Object.keys(this.managedGeometries);for(let i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t)}activateVao(t,e){let i=this.gl,r=this.CONTEXT_UID,n=this.renderer.buffer,l=t.buffers,a=t.attributes;t.indexBuffer&&n.bind(t.indexBuffer);let o=null;for(let h in a){let c=a[h],u=l[c.buffer],d=u._glBuffers[r];if(e.attributeData[h]){o!==d&&(n.bind(u),o=d);let f=e.attributeData[h].location;if(i.enableVertexAttribArray(f),i.vertexAttribPointer(f,c.size,c.type||i.FLOAT,c.normalized,c.stride,c.start),c.instance)if(this.hasInstance)i.vertexAttribDivisor(f,c.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,e,i,r){let{gl:n}=this,l=this._activeGeometry;if(l.indexBuffer){let a=l.indexBuffer.data.BYTES_PER_ELEMENT,o=a===2?n.UNSIGNED_SHORT:n.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?l.instanced?n.drawElementsInstanced(t,e||l.indexBuffer.data.length,o,(i||0)*a,r||1):n.drawElements(t,e||l.indexBuffer.data.length,o,(i||0)*a):console.warn("unsupported index buffer type: uint32")}else l.instanced?n.drawArraysInstanced(t,i,e||l.getSize(),r||1):n.drawArrays(t,i,e||l.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}};Eh.extension={type:H.RendererSystem,name:"geometry"};K.add(Eh);var J_=new mt,nl=class{constructor(t,e){this._texture=t,this.mapCoord=new mt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e=="undefined"?.5:e,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,e){e===void 0&&(e=t);let i=this.mapCoord;for(let r=0;r<t.length;r+=2){let n=t[r],l=t[r+1];e[r]=n*i.a+l*i.c+i.tx,e[r+1]=n*i.b+l*i.d+i.ty}return e}update(t){let e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;let i=e._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);let r=e.orig,n=e.trim;n&&(J_.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(J_));let l=e.baseTexture,a=this.uClampFrame,o=this.clampMargin/l.resolution,h=this.clampOffset;return a[0]=(e._frame.x+o+h)/l.width,a[1]=(e._frame.y+o+h)/l.height,a[2]=(e._frame.x+e._frame.width-o+h)/l.width,a[3]=(e._frame.y+e._frame.height-o+h)/l.height,this.uClampOffset[0]=h/l.realWidth,this.uClampOffset[1]=h/l.realHeight,this.isSimple=e._frame.width===l.width&&e._frame.height===l.height&&e.rotate===0,!0}};var t0=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`;var e0=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;var Ou=class extends Qs{constructor(t,e,i){let r=null;typeof t!="string"&&e===void 0&&i===void 0&&(r=t,t=void 0,e=void 0,i=void 0),super(t||e0,e||t0,i),this.maskSprite=r,this.maskMatrix=new mt}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,e,i,r){let n=this._maskSprite,l=n._texture;!l.valid||(l.uvMatrix||(l.uvMatrix=new nl(l,0)),l.uvMatrix.update(),this.uniforms.npmAlpha=l.baseTexture.alphaMode?0:1,this.uniforms.mask=l,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(l.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=l.uvMatrix.uClampFrame,t.applyFilter(this,e,i,r))}};var Nu=class{constructor(t=null){this.type=se.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Qs.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=se.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}};var Ah=class{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,e){let i=e;if(!i.isMaskData){let n=this.maskDataPool.pop()||new Nu;n.pooled=!0,n.maskObject=e,i=n}let r=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(i.copyCountersOrReset(r),i._colorMask=r?r._colorMask:15,i.autoDetect&&this.detect(i),i._target=t,i.type!==se.SPRITE&&this.maskStack.push(i),i.enabled)switch(i.type){case se.SCISSOR:this.renderer.scissor.push(i);break;case se.STENCIL:this.renderer.stencil.push(i);break;case se.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i);break;case se.COLOR:this.pushColorMask(i);break;default:break}i.type===se.SPRITE&&this.maskStack.push(i)}pop(t){let e=this.maskStack.pop();if(!(!e||e._target!==t)){if(e.enabled)switch(e.type){case se.SCISSOR:this.renderer.scissor.pop(e);break;case se.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case se.SPRITE:this.popSpriteMask(e);break;case se.COLOR:this.popColorMask(e);break;default:break}if(e.reset(),e.pooled&&this.maskDataPool.push(e),this.maskStack.length!==0){let i=this.maskStack[this.maskStack.length-1];i.type===se.SPRITE&&i._filters&&(i._filters[0].maskSprite=i.maskObject)}}}detect(t){let e=t.maskObject;e?e.isSprite?t.type=se.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=se.SCISSOR:t.type=se.STENCIL:t.type=se.COLOR}pushSpriteMask(t){var c,u;let{maskObject:e}=t,i=t._target,r=t._filters;r||(r=this.alphaMaskPool[this.alphaMaskIndex],r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new Ou]));let n=this.renderer,l=n.renderTexture,a,o;if(l.current){let d=l.current;a=t.resolution||d.resolution,o=(c=t.multisample)!=null?c:d.multisample}else a=t.resolution||n.resolution,o=(u=t.multisample)!=null?u:n.multisample;r[0].resolution=a,r[0].multisample=o,r[0].maskSprite=e;let h=i.filterArea;i.filterArea=e.getBounds(!0),n.filter.push(i,r),i.filterArea=h,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){let e=t._colorMask,i=t._colorMask=e&t.colorMask;i!==e&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}popColorMask(t){let e=t._colorMask,i=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;i!==e&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}destroy(){this.renderer=null}};Ah.extension={type:H.RendererSystem,name:"mask"};K.add(Ah);var Ih=class{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){let{gl:e}=this.renderer,i=this.getStackLength();this.maskStack=t;let r=this.getStackLength();r!==i&&(r===0?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}};var s0=new mt,i0=[],Gf=class extends Ih{constructor(s){super(s),this.glConst=z.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){let s=this.maskStack[this.maskStack.length-1];return s?s._scissorCounter:0}calcScissorRect(s){var l;if(s._scissorRectLocal)return;let t=s._scissorRect,{maskObject:e}=s,{renderer:i}=this,r=i.renderTexture,n=e.getBounds(!0,(l=i0.pop())!=null?l:new ht);this.roundFrameToPixels(n,r.current?r.current.resolution:i.resolution,r.sourceFrame,r.destinationFrame,i.projection.transform),t&&n.fit(t),s._scissorRectLocal=n}static isMatrixRotated(s){if(!s)return!1;let{a:t,b:e,c:i,d:r}=s;return(Math.abs(e)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(r)>1e-4)}testScissor(s){let{maskObject:t}=s;if(!t.isFastRect||!t.isFastRect()||Gf.isMatrixRotated(t.worldTransform)||Gf.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(s);let e=s._scissorRectLocal;return e.width>0&&e.height>0}roundFrameToPixels(s,t,e,i,r){Gf.isMatrixRotated(r)||(r=r?s0.copyFrom(r):s0.identity(),r.translate(-e.x,-e.y).scale(i.width/e.width,i.height/e.height).translate(i.x,i.y),this.renderer.filter.transformAABB(r,s),s.fit(i),s.x=Math.round(s.x*t),s.y=Math.round(s.y*t),s.width=Math.round(s.width*t),s.height=Math.round(s.height*t))}push(s){s._scissorRectLocal||this.calcScissorRect(s);let{gl:t}=this.renderer;s._scissorRect||t.enable(t.SCISSOR_TEST),s._scissorCounter++,s._scissorRect=s._scissorRectLocal,this._useCurrent()}pop(s){let{gl:t}=this.renderer;s&&i0.push(s._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){let s=this.maskStack[this.maskStack.length-1]._scissorRect,t;this.renderer.renderTexture.current?t=s.y:t=this.renderer.height-s.height-s.y,this.renderer.gl.scissor(s.x,t,s.width,s.height)}},Xf=Gf;Xf.extension={type:H.RendererSystem,name:"scissor"};K.add(Xf);var Th=class extends Ih{constructor(t){super(t),this.glConst=z.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){let t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){let e=t.maskObject,{gl:i}=this.renderer,r=t._stencilCounter;r===0&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),t._stencilCounter++;let n=t._colorMask;n!==0&&(t._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,r,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,n!==0&&(t._colorMask=n,i.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}pop(t){let e=this.renderer.gl;if(this.getStackLength()===0)e.disable(e.STENCIL_TEST);else{let i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,r=i?i._colorMask:15;r!==0&&(i._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,r!==0&&(i._colorMask=r,e.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)),this._useCurrent()}}_useCurrent(){let t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}};Th.extension={type:H.RendererSystem,name:"stencil"};K.add(Th);var Sh=class{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return xt("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return xt("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return xt("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(t){for(let e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(let t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}};Sh.extension={type:[H.RendererSystem,H.CanvasRendererSystem],name:"_plugin"};K.add(Sh);var Ch=class{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new mt,this.transform=null}update(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);let n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)}calculateProjection(t,e,i,r){let n=this.projectionMatrix,l=r?-1:1;n.identity(),n.a=1/e.width*2,n.d=l*(1/e.height*2),n.tx=-1-e.x*n.a,n.ty=-l-e.y*n.d}setTransform(t){}destroy(){this.renderer=null}};Ch.extension={type:H.RendererSystem,name:"projection"};K.add(Ch);var Z1=new cn,Rh=class{constructor(t){this.renderer=t,this._tempMatrix=new mt}generateTexture(t,e){let o=e||{},{region:i}=o,r=Kg(o,["region"]),n=i||t.getLocalBounds(null,!0);n.width===0&&(n.width=1),n.height===0&&(n.height=1);let l=Sr.create(li({width:n.width,height:n.height},r));this._tempMatrix.tx=-n.x,this._tempMatrix.ty=-n.y;let a=t.transform;return t.transform=Z1,this.renderer.render(t,{renderTexture:l,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=a,l}destroy(){}};Rh.extension={type:[H.RendererSystem,H.CanvasRendererSystem],name:"textureGenerator"};K.add(Rh);var ol=new ht,Fu=new ht,Mh=class{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new ht,this.destinationFrame=new ht,this.viewportFrame=new ht}bind(t=null,e,i){let r=this.renderer;this.current=t;let n,l,a;t?(n=t.baseTexture,a=n.resolution,e||(ol.width=t.frame.width,ol.height=t.frame.height,e=ol),i||(Fu.x=t.frame.x,Fu.y=t.frame.y,Fu.width=e.width,Fu.height=e.height,i=Fu),l=n.framebuffer):(a=r.resolution,e||(ol.width=r._view.screen.width,ol.height=r._view.screen.height,e=ol),i||(i=ol,i.width=e.width,i.height=e.height));let o=this.viewportFrame;o.x=i.x*a,o.y=i.y*a,o.width=i.width*a,o.height=i.height*a,t||(o.y=r.view.height-(o.y+o.height)),o.ceil(),this.renderer.framebuffer.bind(l,o),this.renderer.projection.update(i,e,a,!l),t?this.renderer.mask.setMaskStack(n.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(i)}clear(t,e){this.current?t=t||this.current.baseTexture.clearColor:t=t||this.renderer.background.colorRgba;let i=this.destinationFrame,r=this.current?this.current.baseTexture:this.renderer._view.screen,n=i.width!==r.width||i.height!==r.height;if(n){let{x:l,y:a,width:o,height:h}=this.viewportFrame;l=Math.round(l),a=Math.round(a),o=Math.round(o),h=Math.round(h),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(l,a,o,h)}this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],e),n&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}};Mh.extension={type:H.RendererSystem,name:"renderTexture"};K.add(Mh);var Bu=class{constructor(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}};function r0(s,t){let e={},i=t.getProgramParameter(s,t.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){let n=t.getActiveAttrib(s,r);if(n.name.startsWith("gl_"))continue;let l=Iu(t,n.type),a={type:l,name:n.name,size:Au(l),location:t.getAttribLocation(s,n.name)};e[n.name]=a}return e}function n0(s,t){let e={},i=t.getProgramParameter(s,t.ACTIVE_UNIFORMS);for(let r=0;r<i;r++){let n=t.getActiveUniform(s,r),l=n.name.replace(/\[.*?\]$/,""),a=!!n.name.match(/\[.*?\]$/),o=Iu(t,n.type);e[l]={name:l,index:r,type:o,size:n.size,isArray:a,value:Eu(o,n.size)}}return e}function Yp(s,t){var o;let e=kf(s,s.VERTEX_SHADER,t.vertexSrc),i=kf(s,s.FRAGMENT_SHADER,t.fragmentSrc),r=s.createProgram();s.attachShader(r,e),s.attachShader(r,i);let n=(o=t.extra)==null?void 0:o.transformFeedbackVaryings;if(n&&(typeof s.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):s.transformFeedbackVaryings(r,n.names,n.bufferMode==="separate"?s.SEPARATE_ATTRIBS:s.INTERLEAVED_ATTRIBS)),s.linkProgram(r),s.getProgramParameter(r,s.LINK_STATUS)||Vp(s,r,e,i),t.attributeData=r0(r,s),t.uniformData=n0(r,s),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){let h=Object.keys(t.attributeData);h.sort((c,u)=>c>u?1:-1);for(let c=0;c<h.length;c++)t.attributeData[h[c]].location=c,s.bindAttribLocation(r,c,h[c]);s.linkProgram(r)}s.deleteShader(e),s.deleteShader(i);let l={};for(let h in t.uniformData){let c=t.uniformData[h];l[h]={location:s.getUniformLocation(r,h),value:Eu(c.type,c.size)}}return new Bu(r,l)}function Q1(s,t,e,i,r){e.buffer.update(r)}var J1={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},o0={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function a0(s){let t=s.map(n=>({data:n,offset:0,dataLen:0,dirty:0})),e=0,i=0,r=0;for(let n=0;n<t.length;n++){let l=t[n];if(e=o0[l.data.type],l.data.size>1&&(e=Math.max(e,16)*l.data.size),l.dataLen=e,i%e!==0&&i<16){let a=i%e%16;i+=a,r+=a}i+e>16?(r=Math.ceil(r/16)*16,l.offset=r,r+=e,i=e):(l.offset=r,i+=e,r+=e)}return r=Math.ceil(r/16)*16,{uboElements:t,size:r}}function l0(s,t){let e=[];for(let i in s)t[i]&&e.push(t[i]);return e.sort((i,r)=>i.index-r.index),e}function jp(s,t){if(!s.autoManage)return{size:0,syncFunc:Q1};let e=l0(s.uniforms,t),{uboElements:i,size:r}=a0(e),n=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let l=0;l<i.length;l++){let a=i[l],o=s.uniforms[a.data.name],h=a.data.name,c=!1;for(let u=0;u<Fi.length;u++){let d=Fi[u];if(d.codeUbo&&d.test(a.data,o)){n.push(`offset = ${a.offset/4};`,Fi[u].codeUbo(a.data.name,o)),c=!0;break}}if(!c)if(a.data.size>1){let u=Au(a.data.type),d=Math.max(o0[a.data.type]/16,1),f=u/d,m=(4-f%4)%4;n.push(`
                cv = ud.${h}.value;
                v = uv.${h};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*d}; i++)
                {
                    for(var j = 0; j < ${f}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${m};
                }

                `)}else{let u=J1[a.data.type];n.push(`
                cv = ud.${h}.value;
                v = uv.${h};
                offset = ${a.offset/4};
                ${u};
                `)}}return n.push(`
       renderer.buffer.update(buffer);
    `),{size:r,syncFunc:new Function("ud","uv","renderer","syncData","buffer",n.join(`
`))}}var tI=0,Yf={textureCount:0,uboCount:0},kh=class{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=tI++}systemCheck(){if(!Bf())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;let i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),e||(Yf.textureCount=0,Yf.uboCount=0,this.syncUniformGroup(t.uniformGroup,Yf)),r}setUniforms(t){let e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)}syncUniformGroup(t,e){let i=this.getGlProgram();(!t.static||t.dirtyId!==i.uniformDirtyGroups[t.id])&&(i.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,i,e))}syncUniforms(t,e,i){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,i)}createSyncGroups(t){let e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=Up(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,e){let i=this.getGlProgram();if(!t.static||t.dirtyId!==0||!i.uniformGroups[t.id]){t.dirtyId=0;let r=i.uniformGroups[t.id]||this.createSyncBufferGroup(t,i,e);t.buffer.update(),r(i.uniformData,t.uniforms,this.renderer,Yf,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,i.uniformBufferBindings[e])}createSyncBufferGroup(t,e,i){let{gl:r}=this.renderer;this.renderer.buffer.bind(t.buffer);let n=this.gl.getUniformBlockIndex(e.program,i);e.uniformBufferBindings[i]=this.shader.uniformBindCount,r.uniformBlockBinding(e.program,n,this.shader.uniformBindCount),this.shader.uniformBindCount++;let l=this.getSignature(t,this.shader.program.uniformData,"ubo"),a=this._uboCache[l];if(a||(a=this._uboCache[l]=jp(t,this.shader.program.uniformData)),t.autoManage){let o=new Float32Array(a.size/4);t.buffer.update(o)}return e.uniformGroups[t.id]=a.syncFunc,e.uniformGroups[t.id]}getSignature(t,e,i){let r=t.uniforms,n=[`${i}-`];for(let l in r)n.push(l),e[l]&&n.push(e[l].type);return n.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){let e=this.gl,i=t.program,r=Yp(e,i);return i.glPrograms[this.renderer.CONTEXT_UID]=r,r}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}};kh.extension={type:H.RendererSystem,name:"shader"};K.add(kh);var Ph=class{constructor(t){this.renderer=t}run(t){let e=this.renderer;e.emitWithCustomOptions(e.runners.init,t),t.hello&&console.log(`PixiJS 7.1.2 - ${e.rendererLogId} - https://pixijs.com`),e.resize(this.renderer.screen.width,this.renderer.screen.height)}destroy(){}};Ph.extension={type:[H.RendererSystem,H.CanvasRendererSystem],name:"startup"};K.add(Ph);function h0(s,t=[]){return t[Z.NORMAL]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.ADD]=[s.ONE,s.ONE],t[Z.MULTIPLY]=[s.DST_COLOR,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.SCREEN]=[s.ONE,s.ONE_MINUS_SRC_COLOR,s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.OVERLAY]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.DARKEN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.LIGHTEN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.COLOR_DODGE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.COLOR_BURN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.HARD_LIGHT]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.SOFT_LIGHT]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.DIFFERENCE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.EXCLUSION]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.HUE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.SATURATION]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.COLOR]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.LUMINOSITY]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.NONE]=[0,0],t[Z.NORMAL_NPM]=[s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.ADD_NPM]=[s.SRC_ALPHA,s.ONE,s.ONE,s.ONE],t[Z.SCREEN_NPM]=[s.SRC_ALPHA,s.ONE_MINUS_SRC_COLOR,s.ONE,s.ONE_MINUS_SRC_ALPHA],t[Z.SRC_IN]=[s.DST_ALPHA,s.ZERO],t[Z.SRC_OUT]=[s.ONE_MINUS_DST_ALPHA,s.ZERO],t[Z.SRC_ATOP]=[s.DST_ALPHA,s.ONE_MINUS_SRC_ALPHA],t[Z.DST_OVER]=[s.ONE_MINUS_DST_ALPHA,s.ONE],t[Z.DST_IN]=[s.ZERO,s.SRC_ALPHA],t[Z.DST_OUT]=[s.ZERO,s.ONE_MINUS_SRC_ALPHA],t[Z.DST_ATOP]=[s.ONE_MINUS_DST_ALPHA,s.SRC_ALPHA],t[Z.XOR]=[s.ONE_MINUS_DST_ALPHA,s.ONE_MINUS_SRC_ALPHA],t[Z.SUBTRACT]=[s.ONE,s.ONE,s.ONE,s.ONE,s.FUNC_REVERSE_SUBTRACT,s.FUNC_ADD],t}var eI=0,sI=1,iI=2,rI=3,nI=4,oI=5,Wp=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=Z.NONE,this._blendEq=!1,this.map=[],this.map[eI]=this.setBlend,this.map[sI]=this.setOffset,this.map[iI]=this.setCullFace,this.map[rI]=this.setDepthTest,this.map[nI]=this.setFrontFace,this.map[oI]=this.setDepthMask,this.checks=[],this.defaultState=new He,this.defaultState.blend=!0}contextChange(s){this.gl=s,this.blendModes=h0(s),this.set(this.defaultState),this.reset()}set(s){if(s=s||this.defaultState,this.stateId!==s.data){let t=this.stateId^s.data,e=0;for(;t;)t&1&&this.map[e].call(this,!!(s.data&1<<e)),t=t>>1,e++;this.stateId=s.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,s)}forceState(s){s=s||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(s.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,s);this.stateId=s.data}setBlend(s){this.updateCheck(Wp.checkBlendMode,s),this.gl[s?"enable":"disable"](this.gl.BLEND)}setOffset(s){this.updateCheck(Wp.checkPolygonOffset,s),this.gl[s?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(s){this.gl[s?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(s){this.gl.depthMask(s)}setCullFace(s){this.gl[s?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(s){this.gl.frontFace(this.gl[s?"CW":"CCW"])}setBlendMode(s){if(s===this.blendMode)return;this.blendMode=s;let t=this.blendModes[s],e=this.gl;t.length===2?e.blendFunc(t[0],t[1]):e.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,e.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD))}setPolygonOffset(s,t){this.gl.polygonOffset(s,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(s,t){let e=this.checks.indexOf(s);t&&e===-1?this.checks.push(s):!t&&e!==-1&&this.checks.splice(e,1)}static checkBlendMode(s,t){s.setBlendMode(t.blendMode)}static checkPolygonOffset(s,t){s.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}},jf=Wp;jf.extension={type:H.RendererSystem,name:"state"};K.add(jf);var Oh=class extends on.default{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){var r;this.addRunners(...t.runners);let e=((r=t.priority)!=null?r:[]).filter(n=>t.systems[n]),i=[...e,...Object.keys(t.systems).filter(n=>!e.includes(n))];for(let n of i)this.addSystem(t.systems[n],n)}addRunners(...t){t.forEach(e=>{this.runners[e]=new ne(e)})}addSystem(t,e){let i=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=i,this._systemsHash[e]=i;for(let r in this.runners)this.runners[r].add(i);return this}emitWithCustomOptions(t,e){let i=Object.keys(this._systemsHash);t.items.forEach(r=>{let n=i.find(l=>this._systemsHash[l]===r);r[t.name](e[n])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}};var Wf=class{constructor(s){this.renderer=s,this.count=0,this.checkCount=0,this.maxIdle=Wf.defaultMaxIdle,this.checkCountMax=Wf.defaultCheckCountMax,this.mode=Wf.defaultMode}postrender(){!this.renderer.objectRenderer.renderingToScreen||(this.count++,this.mode!==hf.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){let s=this.renderer.texture,t=s.managedTextures,e=!1;for(let i=0;i<t.length;i++){let r=t[i];!r.framebuffer&&this.count-r.touched>this.maxIdle&&(s.destroyTexture(r,!0),t[i]=null,e=!0)}if(e){let i=0;for(let r=0;r<t.length;r++)t[r]!==null&&(t[i++]=t[r]);t.length=i}}unload(s){let t=this.renderer.texture,e=s._texture;e&&!e.framebuffer&&t.destroyTexture(e);for(let i=s.children.length-1;i>=0;i--)this.unload(s.children[i])}destroy(){this.renderer=null}},ps=Wf;ps.defaultMode=hf.AUTO;ps.defaultMaxIdle=60*60;ps.defaultCheckCountMax=60*10;ps.extension={type:H.RendererSystem,name:"textureGC"};K.add(ps);var al=class{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=ft.UNSIGNED_BYTE,this.internalFormat=J.RGBA,this.samplerType=0}};function c0(s){let t;return"WebGL2RenderingContext"in globalThis&&s instanceof globalThis.WebGL2RenderingContext?t={[ft.UNSIGNED_BYTE]:{[J.RGBA]:s.RGBA8,[J.RGB]:s.RGB8,[J.RG]:s.RG8,[J.RED]:s.R8,[J.RGBA_INTEGER]:s.RGBA8UI,[J.RGB_INTEGER]:s.RGB8UI,[J.RG_INTEGER]:s.RG8UI,[J.RED_INTEGER]:s.R8UI,[J.ALPHA]:s.ALPHA,[J.LUMINANCE]:s.LUMINANCE,[J.LUMINANCE_ALPHA]:s.LUMINANCE_ALPHA},[ft.BYTE]:{[J.RGBA]:s.RGBA8_SNORM,[J.RGB]:s.RGB8_SNORM,[J.RG]:s.RG8_SNORM,[J.RED]:s.R8_SNORM,[J.RGBA_INTEGER]:s.RGBA8I,[J.RGB_INTEGER]:s.RGB8I,[J.RG_INTEGER]:s.RG8I,[J.RED_INTEGER]:s.R8I},[ft.UNSIGNED_SHORT]:{[J.RGBA_INTEGER]:s.RGBA16UI,[J.RGB_INTEGER]:s.RGB16UI,[J.RG_INTEGER]:s.RG16UI,[J.RED_INTEGER]:s.R16UI,[J.DEPTH_COMPONENT]:s.DEPTH_COMPONENT16},[ft.SHORT]:{[J.RGBA_INTEGER]:s.RGBA16I,[J.RGB_INTEGER]:s.RGB16I,[J.RG_INTEGER]:s.RG16I,[J.RED_INTEGER]:s.R16I},[ft.UNSIGNED_INT]:{[J.RGBA_INTEGER]:s.RGBA32UI,[J.RGB_INTEGER]:s.RGB32UI,[J.RG_INTEGER]:s.RG32UI,[J.RED_INTEGER]:s.R32UI,[J.DEPTH_COMPONENT]:s.DEPTH_COMPONENT24},[ft.INT]:{[J.RGBA_INTEGER]:s.RGBA32I,[J.RGB_INTEGER]:s.RGB32I,[J.RG_INTEGER]:s.RG32I,[J.RED_INTEGER]:s.R32I},[ft.FLOAT]:{[J.RGBA]:s.RGBA32F,[J.RGB]:s.RGB32F,[J.RG]:s.RG32F,[J.RED]:s.R32F,[J.DEPTH_COMPONENT]:s.DEPTH_COMPONENT32F},[ft.HALF_FLOAT]:{[J.RGBA]:s.RGBA16F,[J.RGB]:s.RGB16F,[J.RG]:s.RG16F,[J.RED]:s.R16F},[ft.UNSIGNED_SHORT_5_6_5]:{[J.RGB]:s.RGB565},[ft.UNSIGNED_SHORT_4_4_4_4]:{[J.RGBA]:s.RGBA4},[ft.UNSIGNED_SHORT_5_5_5_1]:{[J.RGBA]:s.RGB5_A1},[ft.UNSIGNED_INT_2_10_10_10_REV]:{[J.RGBA]:s.RGB10_A2,[J.RGBA_INTEGER]:s.RGB10_A2UI},[ft.UNSIGNED_INT_10F_11F_11F_REV]:{[J.RGB]:s.R11F_G11F_B10F},[ft.UNSIGNED_INT_5_9_9_9_REV]:{[J.RGB]:s.RGB9_E5},[ft.UNSIGNED_INT_24_8]:{[J.DEPTH_STENCIL]:s.DEPTH24_STENCIL8},[ft.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[J.DEPTH_STENCIL]:s.DEPTH32F_STENCIL8}}:t={[ft.UNSIGNED_BYTE]:{[J.RGBA]:s.RGBA,[J.RGB]:s.RGB,[J.ALPHA]:s.ALPHA,[J.LUMINANCE]:s.LUMINANCE,[J.LUMINANCE_ALPHA]:s.LUMINANCE_ALPHA},[ft.UNSIGNED_SHORT_5_6_5]:{[J.RGB]:s.RGB},[ft.UNSIGNED_SHORT_4_4_4_4]:{[J.RGBA]:s.RGBA},[ft.UNSIGNED_SHORT_5_5_5_1]:{[J.RGBA]:s.RGBA}},t}var Nh=class{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new lt,this.hasIntegerTextures=!1}contextChange(){let t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=c0(t);let e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(let r=0;r<e;r++)this.boundTextures[r]=null;this.emptyTextures={};let i=new al(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new al(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let r=0;r<6;r++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let r=0;r<this.boundTextures.length;r++)this.bind(null,r)}bind(t,e=0){let{gl:i}=this;if(t=t==null?void 0:t.castToBaseTexture(),(t==null?void 0:t.valid)&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;let r=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),this.updateTexture(t)):r.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){let{gl:e,boundTextures:i}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(let r=0;r<i.length;r++)i[r]===t&&(this.currentLocation!==r&&(e.activeTexture(e.TEXTURE0+r),this.currentLocation=r),e.bindTexture(t.target,this.emptyTextures[t.target].texture),i[r]=null)}ensureSamplerType(t){let{boundTextures:e,hasIntegerTextures:i,CONTEXT_UID:r}=this;if(!!i)for(let n=t-1;n>=0;--n){let l=e[n];l&&l._glTextures[r].samplerType!==lf.FLOAT&&this.renderer.texture.unbind(l)}}initTexture(t){let e=new al(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}initTextureType(t,e){var i,r;e.internalFormat=(r=(i=this.internalFormats[t.type])==null?void 0:i[t.format])!=null?r:t.format,this.webGLVersion===2&&t.type===ft.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}updateTexture(t){var r;let e=t._glTextures[this.CONTEXT_UID];if(!e)return;let i=this.renderer;if(this.initTextureType(t,e),(r=t.resource)!=null&&r.upload(i,t,e))e.samplerType!==lf.FLOAT&&(this.hasIntegerTextures=!0);else{let n=t.realWidth,l=t.realHeight,a=i.gl;(e.width!==n||e.height!==l||e.dirtyId<0)&&(e.width=n,e.height=l,a.texImage2D(t.target,0,e.internalFormat,n,l,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}destroyTexture(t,e){let{gl:i}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){let r=this.managedTextures.indexOf(t);r!==-1&&Ef(this.managedTextures,r,1)}}updateTextureStyle(t){var i;let e=t._glTextures[this.CONTEXT_UID];!e||((t.mipmap===Rs.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?e.mipmap=!1:e.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?e.wrapMode=Ir.CLAMP:e.wrapMode=t.wrapMode,(i=t.resource)!=null&&i.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)}setStyle(t,e){let i=this.gl;if(e.mipmap&&t.mipmap!==Rs.ON_MANUAL&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===Se.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);let r=this.renderer.context.extensions.anisotropicFiltering;if(r&&t.anisotropicLevel>0&&t.scaleMode===Se.LINEAR){let n=Math.min(t.anisotropicLevel,i.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===Se.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode===Se.LINEAR?i.LINEAR:i.NEAREST)}destroy(){this.renderer=null}};Nh.extension={type:H.RendererSystem,name:"texture"};K.add(Nh);var Fh=class{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){let{gl:e,CONTEXT_UID:i}=this,r=t._glTransformFeedbacks[i]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,r)}unbind(){let{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,e){let{gl:i,renderer:r}=this;e&&r.shader.bind(e),i.beginTransformFeedback(t)}endTransformFeedback(){let{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){let{gl:e,renderer:i,CONTEXT_UID:r}=this,n=e.createTransformFeedback();t._glTransformFeedbacks[r]=n,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,n);for(let l=0;l<t.buffers.length;l++){let a=t.buffers[l];!a||(i.buffer.update(a),a._glBuffers[r].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,l,a._glBuffers[r].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),n}disposeTransformFeedback(t,e){let i=t._glTransformFeedbacks[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this);let n=this.renderer.buffer;if(n)for(let l=0;l<t.buffers.length;l++){let a=t.buffers[l];if(!a)continue;let o=a._glBuffers[this.CONTEXT_UID];o&&(o.refCount--,o.refCount===0&&!e&&n.dispose(a,e))}!i||(e||r.deleteTransformFeedback(i),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}};Fh.extension={type:H.RendererSystem,name:"transformFeedback"};K.add(Fh);var Bh=class{constructor(t){this.renderer=t}init(t){this.screen=new ht(0,0,t.width,t.height),this.element=t.view||z.ADAPTER.createCanvas(),this.resolution=t.resolution||z.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);let i=this.element.width/this.resolution,r=this.element.height/this.resolution;this.screen.width=i,this.screen.height=r,this.autoDensity&&(this.element.style.width=`${i}px`,this.element.style.height=`${r}px`),this.renderer.emit("resize",i,r),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){var e;t&&((e=this.element.parentNode)==null||e.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}};Bh.extension={type:[H.RendererSystem,H.CanvasRendererSystem],name:"_view"};K.add(Bh);z.PREFER_ENV=Cs.WEBGL2;z.STRICT_TEXTURE_CACHE=!1;Object.defineProperties(z,{WRAP_MODE:{get(){return lt.defaultOptions.wrapMode},set(s){xt("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),lt.defaultOptions.wrapMode=s}},SCALE_MODE:{get(){return lt.defaultOptions.scaleMode},set(s){xt("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),lt.defaultOptions.scaleMode=s}},MIPMAP_TEXTURES:{get(){return lt.defaultOptions.mipmap},set(s){xt("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),lt.defaultOptions.mipmap=s}},ANISOTROPIC_LEVEL:{get(){return lt.defaultOptions.anisotropicLevel},set(s){xt("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),lt.defaultOptions.anisotropicLevel=s}},FILTER_RESOLUTION:{get(){return xt("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Qs.defaultResolution},set(s){Qs.defaultResolution=s}},FILTER_MULTISAMPLE:{get(){return xt("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Qs.defaultMultisample},set(s){Qs.defaultMultisample=s}},SPRITE_MAX_TEXTURES:{get(){return Os.defaultMaxTextures},set(s){xt("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),Os.defaultMaxTextures=s}},SPRITE_BATCH_SIZE:{get(){return Os.defaultBatchSize},set(s){xt("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),Os.defaultBatchSize=s}},CAN_UPLOAD_SAME_BUFFER:{get(){return Os.canUploadSameBuffer},set(s){xt("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),Os.canUploadSameBuffer=s}},GC_MODE:{get(){return ps.defaultMode},set(s){xt("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),ps.defaultMode=s}},GC_MAX_IDLE:{get(){return ps.defaultMaxIdle},set(s){xt("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),ps.defaultMaxIdle=s}},GC_MAX_CHECK_COUNT:{get(){return ps.defaultCheckCountMax},set(s){xt("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),ps.defaultCheckCountMax=s}},PRECISION_VERTEX:{get(){return De.defaultVertexPrecision},set(s){xt("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),De.defaultVertexPrecision=s}},PRECISION_FRAGMENT:{get(){return De.defaultFragmentPrecision},set(s){xt("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),De.defaultFragmentPrecision=s}}});var ll=(s=>(s[s.HIGH=25]="HIGH",s[s.NORMAL=0]="NORMAL",s[s.LOW=-25]="LOW",s[s.UTILITY=-50]="UTILITY",s))(ll||{});var Lh=class{constructor(t,e=null,i=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=i,this.once=r}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));let e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);let e=this.next;return this.next=t?null:e,this.previous=null,e}};var Ns=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Lh(null,null,1/0),this.deltaMS=1/Ns.targetFPMS,this.elapsedMS=1/Ns.targetFPMS,this._tick=s=>{this._requestId=null,this.started&&(this.update(s),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(s,t,e=ll.NORMAL){return this._addListener(new Lh(s,t,e))}addOnce(s,t,e=ll.NORMAL){return this._addListener(new Lh(s,t,e,!0))}_addListener(s){let t=this._head.next,e=this._head;if(!t)s.connect(e);else{for(;t;){if(s.priority>t.priority){s.connect(e);break}e=t,t=t.next}s.previous||s.connect(e)}return this._startIfPossible(),this}remove(s,t){let e=this._head.next;for(;e;)e.match(s,t)?e=e.destroy():e=e.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let s=0,t=this._head;for(;t=t.next;)s++;return s}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let s=this._head.next;for(;s;)s=s.destroy(!0);this._head.destroy(),this._head=null}}update(s=performance.now()){let t;if(s>this.lastTime){if(t=this.elapsedMS=s-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){let r=s-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=s-r%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*Ns.targetFPMS;let e=this._head,i=e.next;for(;i;)i=i.emit(this.deltaTime);e.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=s}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(s){let t=Math.min(this.maxFPS,s),e=Math.min(Math.max(0,t)/1e3,Ns.targetFPMS);this._maxElapsedMS=1/e}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(s){if(s===0)this._minElapsedMS=0;else{let t=Math.max(this.minFPS,s);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!Ns._shared){let s=Ns._shared=new Ns;s.autoStart=!0,s._protected=!0}return Ns._shared}static get system(){if(!Ns._system){let s=Ns._system=new Ns;s.autoStart=!0,s._protected=!0}return Ns._system}},oe=Ns;oe.targetFPMS=.06;Object.defineProperties(z,{TARGET_FPMS:{get(){return oe.targetFPMS},set(s){xt("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),oe.targetFPMS=s}}});var Lu=class{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,ll.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?oe.shared:new oe,t.autoStart&&this.start()}static destroy(){if(this._ticker){let t=this._ticker;this.ticker=null,t.destroy()}}};Lu.extension=H.Application;K.add(Lu);var aI=[];K.handleByList(H.Renderer,aI);var Uu=class{constructor(t){this.renderer=t}contextChange(t){let e;if(this.renderer.context.webGLVersion===1){let i=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,i)}else{let i=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,i)}e>=Ft.HIGH?this.multisample=Ft.HIGH:e>=Ft.MEDIUM?this.multisample=Ft.MEDIUM:e>=Ft.LOW?this.multisample=Ft.LOW:this.multisample=Ft.NONE}destroy(){}};Uu.extension={type:H.RendererSystem,name:"_multisample"};K.add(Uu);var $f=class{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}};var Du=class{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){let{gl:e,CONTEXT_UID:i}=this,r=t._glBuffers[i]||this.createGLBuffer(t);e.bindBuffer(t.type,r.buffer)}unbind(t){let{gl:e}=this;e.bindBuffer(t,null)}bindBufferBase(t,e){let{gl:i,CONTEXT_UID:r}=this;if(this.boundBufferBases[e]!==t){let n=t._glBuffers[r]||this.createGLBuffer(t);this.boundBufferBases[e]=t,i.bindBufferBase(i.UNIFORM_BUFFER,e,n.buffer)}}bindBufferRange(t,e,i){let{gl:r,CONTEXT_UID:n}=this;i=i||0;let l=t._glBuffers[n]||this.createGLBuffer(t);r.bindBufferRange(r.UNIFORM_BUFFER,e||0,l.buffer,i*256,256)}update(t){let{gl:e,CONTEXT_UID:i}=this,r=t._glBuffers[i]||this.createGLBuffer(t);if(t._updateID!==r.updateID)if(r.updateID=t._updateID,e.bindBuffer(t.type,r.buffer),r.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{let n=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;r.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,n)}}dispose(t,e){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];let i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){let e=Object.keys(this.managedBuffers);for(let i=0;i<e.length;i++)this.dispose(this.managedBuffers[e[i]],t)}createGLBuffer(t){let{CONTEXT_UID:e,gl:i}=this;return t._glBuffers[e]=new $f(i.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}};Du.extension={type:H.RendererSystem,name:"buffer"};K.add(Du);var Vu=class{constructor(t){this.renderer=t}render(t,e){let i=this.renderer,r,n,l,a;if(e&&(r=e.renderTexture,n=e.clear,l=e.transform,a=e.skipUpdateTransform),this.renderingToScreen=!r,i.runners.prerender.emit(),i.emit("prerender"),i.projection.transform=l,!i.context.isLost){if(r||(this.lastObjectRendered=t),!a){let o=t.enableTempParent();t.updateTransform(),t.disableTempParent(o)}i.renderTexture.bind(r),i.batch.currentRenderer.start(),(n!=null?n:i.background.clearBeforeRender)&&i.renderTexture.clear(),t.render(i),i.batch.currentRenderer.flush(),r&&(e.blit&&i.framebuffer.blit(),r.baseTexture.update()),i.runners.postrender.emit(),i.projection.transform=null,i.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}};Vu.extension={type:H.RendererSystem,name:"objectRenderer"};K.add(Vu);var $p=class extends Oh{constructor(s){var i;super(),s=Object.assign({},z.RENDER_OPTIONS,s),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new ge({projectionMatrix:new mt},!0);let t={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:$p.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(t),"useContextAlpha"in s&&(xt("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),s.premultipliedAlpha=s.useContextAlpha&&s.useContextAlpha!=="notMultiplied",s.backgroundAlpha=s.useContextAlpha===!1?1:s.backgroundAlpha);let e={hello:s.hello,_plugin:$p.__plugins,background:{alpha:s.backgroundAlpha,color:(i=s.background)!=null?i:s.backgroundColor,clearBeforeRender:s.clearBeforeRender},_view:{height:s.height,width:s.width,autoDensity:s.autoDensity,resolution:s.resolution,view:s.view},context:{antialias:s.antialias,context:s.context,powerPreference:s.powerPreference,premultipliedAlpha:s.premultipliedAlpha,preserveDrawingBuffer:s.preserveDrawingBuffer}};this.options=s,this.startup.run(e)}static test(s){return s!=null&&s.forceCanvas?!1:xf()}render(s,t){this.objectRenderer.render(s,t)}resize(s,t){this._view.resizeView(s,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(s=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:s}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(s){this._view.resolution=s,this.runners.resolutionChange.emit(s)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return xt("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return xt("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return xt("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return xt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(s){xt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=s}get backgroundAlpha(){return xt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.color}set backgroundAlpha(s){xt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=s}get powerPreference(){return xt("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(s,t){return this.textureGenerator.generateTexture(s,t)}},hl=$p;hl.extension={type:H.Renderer,priority:1};hl.__plugins={};hl.__systems={};K.handleByMap(H.RendererPlugin,hl.__plugins);K.handleByMap(H.RendererSystem,hl.__systems);K.add(hl);var mn=class extends Ms{constructor(t,e){let{width:i,height:r}=e||{};super(i,r),this.items=[],this.itemDirtyIds=[];for(let n=0;n<t;n++){let l=new lt;this.items.push(l),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,e){for(let i=0;i<this.length;i++)!t[i]||(t[i].castToBaseTexture?this.addBaseTextureAt(t[i].castToBaseTexture(),i):t[i]instanceof Ms?this.addResourceAt(t[i],i):this.addResourceAt(dh(t[i],e),i))}dispose(){for(let t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,e){if(!this.items[e])throw new Error(`Index ${e} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){if(this._load)return this._load;let e=this.items.map(i=>i.resource).filter(i=>i).map(i=>i.load());return this._load=Promise.all(e).then(()=>{let{realWidth:i,realHeight:r}=this.items[0];return this.resize(i,r),Promise.resolve(this)}),this._load}};var Uh=class extends mn{constructor(t,e){let{width:i,height:r}=e||{},n,l;Array.isArray(t)?(n=t,l=t.length):l=t,super(l,{width:i,height:r}),n&&this.initFromArray(n,e)}addBaseTextureAt(t,e){if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=Ar.TEXTURE_2D_ARRAY}upload(t,e,i){let{length:r,itemDirtyIds:n,items:l}=this,{gl:a}=t;i.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,r,0,e.format,i.type,null);for(let o=0;o<r;o++){let h=l[o];n[o]<h.dirtyId&&(n[o]=h.dirtyId,h.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,o,h.resource.width,h.resource.height,1,e.format,i.type,h.resource.source))}return!0}};var Dh=class extends Ce{constructor(t){super(t)}static test(t){let{OffscreenCanvas:e}=globalThis;return e&&t instanceof e?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}};var Gu=class extends mn{constructor(s,t){let{width:e,height:i,autoLoad:r,linkBaseTexture:n}=t||{};if(s&&s.length!==Gu.SIDES)throw new Error(`Invalid length. Got ${s.length}, expected 6`);super(6,{width:e,height:i});for(let l=0;l<Gu.SIDES;l++)this.items[l].target=Ar.TEXTURE_CUBE_MAP_POSITIVE_X+l;this.linkBaseTexture=n!==!1,s&&this.initFromArray(s,t),r!==!1&&this.load()}bind(s){super.bind(s),s.target=Ar.TEXTURE_CUBE_MAP}addBaseTextureAt(s,t,e){if(e===void 0&&(e=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||s.parentTextureArray||Object.keys(s._glTextures).length>0)if(s.resource)this.addResourceAt(s.resource,t);else throw new Error("CubeResource does not support copying of renderTexture.");else s.target=Ar.TEXTURE_CUBE_MAP_POSITIVE_X+t,s.parentTextureArray=this.baseTexture,this.items[t]=s;return s.valid&&!this.valid&&this.resize(s.realWidth,s.realHeight),this.items[t]=s,this}upload(s,t,e){let i=this.itemDirtyIds;for(let r=0;r<Gu.SIDES;r++){let n=this.items[r];(i[r]<n.dirtyId||e.dirtyId<t.dirtyId)&&(n.valid&&n.resource?(n.resource.upload(s,n,e),i[r]=n.dirtyId):i[r]<-1&&(s.gl.texImage2D(n.target,0,e.internalFormat,t.realWidth,t.realHeight,0,t.format,e.type,null),i[r]=-1))}return!0}static test(s){return Array.isArray(s)&&s.length===Gu.SIDES}},Xu=Gu;Xu.SIDES=6;var gi=class extends Ce{constructor(t,e){var n;e=e||{};let i,r;typeof t=="string"?(i=gi.EMPTY,r=t):(i=t,r=null),super(i),this.url=r,this.crossOrigin=(n=e.crossOrigin)!=null?n:!0,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise((t,e)=>$(this,null,function*(){if(this.url===null){t(this);return}try{let i=yield z.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;let r=yield i.blob();if(this.destroyed)return;let n=yield createImageBitmap(r,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Le.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=n,this.update(),t(this)}catch(i){if(this.destroyed)return;e(i),this.onError.emit(i)}})),this._load)}upload(t,e,i){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),super.upload(t,e,i)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap!="undefined"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){var t;return gi._EMPTY=(t=gi._EMPTY)!=null?t:z.ADAPTER.createCanvas(0,0),gi._EMPTY}};var Hf=class extends Ce{constructor(s,t){t=t||{},super(z.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=s,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(s=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),s(this)},Hf.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){let s=new Image;Ce.crossOrigin(s,this.svg,this._crossorigin),s.src=this.svg,s.onerror=t=>{!this._resolve||(s.onerror=null,this.onError.emit(t))},s.onload=()=>{if(!this._resolve)return;let t=s.width,e=s.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let i=t*this.scale,r=e*this.scale;(this._overrideWidth||this._overrideHeight)&&(i=this._overrideWidth||this._overrideHeight/e*t,r=this._overrideHeight||this._overrideWidth/t*e),i=Math.round(i),r=Math.round(r);let n=this.source;n.width=i,n.height=r,n._pixiId=`canvas_${Oi()}`,n.getContext("2d").drawImage(s,0,0,t,e,0,0,i,r),this._resolve(),this._resolve=null}}static getSize(s){let t=Hf.SVG_SIZE.exec(s),e={};return t&&(e[t[1]]=Math.round(parseFloat(t[3])),e[t[5]]=Math.round(parseFloat(t[7]))),e}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(s,t){return t==="svg"||typeof s=="string"&&s.startsWith("data:image/svg+xml")||typeof s=="string"&&Hf.SVG_XML.test(s)}},Cr=Hf;Cr.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m;Cr.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var Hp=class extends Ce{constructor(s,t){if(t=t||{},!(s instanceof HTMLVideoElement)){let e=document.createElement("video");e.setAttribute("preload","auto"),e.setAttribute("webkit-playsinline",""),e.setAttribute("playsinline",""),typeof s=="string"&&(s=[s]);let i=s[0].src||s[0];Ce.crossOrigin(e,i,t.crossorigin);for(let r=0;r<s.length;++r){let n=document.createElement("source"),{src:l,mime:a}=s[r];l=l||s[r];let o=l.split("?").shift().toLowerCase(),h=o.slice(o.lastIndexOf(".")+1);a=a||Hp.MIME_TYPES[h]||`video/${h}`,n.src=l,n.type=a,e.appendChild(n)}s=e}super(s),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),t.autoLoad!==!1&&this.load()}update(s=0){if(!this.destroyed){let t=oe.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;let s=this.source;return(s.readyState===s.HAVE_ENOUGH_DATA||s.readyState===s.HAVE_FUTURE_DATA)&&s.width&&s.height&&(s.complete=!0),s.addEventListener("play",this._onPlayStart.bind(this)),s.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(s.addEventListener("canplay",this._onCanPlay),s.addEventListener("canplaythrough",this._onCanPlay),s.addEventListener("error",this._onError,!0)),this._load=new Promise(t=>{this.valid?t(this):(this._resolve=t,s.load())}),this._load}_onError(s){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(s)}_isSourcePlaying(){let s=this.source;return!s.paused&&!s.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(oe.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(oe.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){let s=this.source;s.removeEventListener("canplay",this._onCanPlay),s.removeEventListener("canplaythrough",this._onCanPlay);let t=this.valid;this.resize(s.videoWidth,s.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&s.play()}dispose(){this._isConnectedToTicker&&(oe.shared.remove(this.update,this),this._isConnectedToTicker=!1);let s=this.source;s&&(s.removeEventListener("error",this._onError,!0),s.pause(),s.src="",s.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(s){s!==this._autoUpdate&&(this._autoUpdate=s,!this._autoUpdate&&this._isConnectedToTicker?(oe.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(oe.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(s){s!==this._updateFPS&&(this._updateFPS=s)}static test(s,t){return globalThis.HTMLVideoElement&&s instanceof HTMLVideoElement||Hp.TYPES.includes(t)}},Vh=Hp;Vh.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];Vh.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};uh.push(gi,fn,Dh,Vh,Cr,Ni,Xu,Uh);function Yu(s){switch(s.toLowerCase()){case"nearest":return Re.Nearest;case"linear":return Re.Linear;case"mipmap":return Re.MipMap;case"mipmapnearestnearest":return Re.MipMapNearestNearest;case"mipmaplinearnearest":return Re.MipMapLinearNearest;case"mipmapnearestlinear":return Re.MipMapNearestLinear;case"mipmaplinearlinear":return Re.MipMapLinearLinear;default:throw new Error(`Unknown texture filter ${s}`)}}function u0(s){switch(s.toLowerCase()){case"mirroredtepeat":return Fs.MirroredRepeat;case"clamptoedge":return Fs.ClampToEdge;case"repeat":return Fs.Repeat;default:throw new Error(`Unknown texture wrap ${s}`)}}var Re=(s=>(s[s.Nearest=9728]="Nearest",s[s.Linear=9729]="Linear",s[s.MipMap=9987]="MipMap",s[s.MipMapNearestNearest=9984]="MipMapNearestNearest",s[s.MipMapLinearNearest=9985]="MipMapLinearNearest",s[s.MipMapNearestLinear=9986]="MipMapNearestLinear",s[s.MipMapLinearLinear=9987]="MipMapLinearLinear",s))(Re||{}),Fs=(s=>(s[s.MirroredRepeat=33648]="MirroredRepeat",s[s.ClampToEdge=33071]="ClampToEdge",s[s.Repeat=10497]="Repeat",s))(Fs||{}),Rr=class{constructor(){this.size=null,this.names=null,this.values=null,this.renderObject=null}get width(){let t=this.texture;return t.trim?t.trim.width:t.orig.width}get height(){let t=this.texture;return t.trim?t.trim.height:t.orig.height}get u(){return this.texture._uvs.x0}get v(){return this.texture._uvs.y0}get u2(){return this.texture._uvs.x2}get v2(){return this.texture._uvs.y2}get offsetX(){let t=this.texture;return t.trim?t.trim.x:0}get offsetY(){return this.spineOffsetY}get pixiOffsetY(){let t=this.texture;return t.trim?t.trim.y:0}get spineOffsetY(){let t=this.texture;return this.originalHeight-this.height-(t.trim?t.trim.y:0)}get originalWidth(){return this.texture.orig.width}get originalHeight(){return this.texture.orig.height}get x(){return this.texture.frame.x}get y(){return this.texture.frame.y}get rotate(){return this.texture.rotate!==0}get degrees(){return(360-this.texture.rotate*45)%360}};var qp=class{constructor(){this.x=0,this.y=0,this.width=0,this.height=0,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0,this.rotate=0,this.index=0}},Mr=class{constructor(t,e,i){this.pages=new Array,this.regions=new Array,t&&this.addSpineAtlas(t,e,i)}addTexture(t,e){let i=this.pages,r=null;for(let l=0;l<i.length;l++)if(i[l].baseTexture===e.baseTexture){r=i[l];break}if(r===null){r=new Gh,r.name="texturePage";let l=e.baseTexture;r.width=l.realWidth,r.height=l.realHeight,r.baseTexture=l,r.minFilter=r.magFilter=Re.Nearest,r.uWrap=Fs.ClampToEdge,r.vWrap=Fs.ClampToEdge,i.push(r)}let n=new Xh;return n.name=t,n.page=r,n.texture=e,n.index=-1,this.regions.push(n),n}addTextureHash(t,e){for(let i in t)t.hasOwnProperty(i)&&this.addTexture(e&&i.indexOf(".")!==-1?i.substr(0,i.lastIndexOf(".")):i,t[i])}addSpineAtlas(t,e,i){return this.load(t,e,i)}load(t,e,i){if(e==null)throw new Error("textureLoader cannot be null.");let r=new zp(t),n=new Array(4),l=null,a={},o=null;a.size=()=>{l.width=parseInt(n[1]),l.height=parseInt(n[2])},a.format=()=>{},a.filter=()=>{l.minFilter=Yu(n[1]),l.magFilter=Yu(n[2])},a.repeat=()=>{n[1].indexOf("x")!=-1&&(l.uWrap=Fs.Repeat),n[1].indexOf("y")!=-1&&(l.vWrap=Fs.Repeat)},a.pma=()=>{l.pma=n[1]=="true"};let h={};h.xy=()=>{o.x=parseInt(n[1]),o.y=parseInt(n[2])},h.size=()=>{o.width=parseInt(n[1]),o.height=parseInt(n[2])},h.bounds=()=>{o.x=parseInt(n[1]),o.y=parseInt(n[2]),o.width=parseInt(n[3]),o.height=parseInt(n[4])},h.offset=()=>{o.offsetX=parseInt(n[1]),o.offsetY=parseInt(n[2])},h.orig=()=>{o.originalWidth=parseInt(n[1]),o.originalHeight=parseInt(n[2])},h.offsets=()=>{o.offsetX=parseInt(n[1]),o.offsetY=parseInt(n[2]),o.originalWidth=parseInt(n[3]),o.originalHeight=parseInt(n[4])},h.rotate=()=>{let d=n[1],f=0;d.toLocaleLowerCase()=="true"?f=6:d.toLocaleLowerCase()=="false"?f=0:f=(720-parseFloat(d))%360/45,o.rotate=f},h.index=()=>{o.index=parseInt(n[1])};let c=r.readLine();for(;c!=null&&c.trim().length==0;)c=r.readLine();for(;!(c==null||c.trim().length==0||r.readEntry(n,c)==0);)c=r.readLine();let u=()=>{for(;;){if(c==null)return i&&i(this);if(c.trim().length==0)l=null,c=r.readLine();else if(l===null){for(l=new Gh,l.name=c.trim();r.readEntry(n,c=r.readLine())!=0;){let d=a[n[0]];d&&d()}this.pages.push(l),e(l.name,d=>{if(d===null)return this.pages.splice(this.pages.indexOf(l),1),i&&i(null);l.baseTexture=d,l.pma&&(d.alphaMode=Le.PMA),d.valid||d.setSize(l.width,l.height),l.setFilters(),(!l.width||!l.height)&&(l.width=d.realWidth,l.height=d.realHeight,(!l.width||!l.height)&&console.log(`ERROR spine atlas page ${l.name}: meshes wont work if you dont specify size in atlas (http://www.html5gamedevs.com/topic/18888-pixi-spines-and-meshes/?p=107121)`)),u()});break}else{o=new qp;let d=new Xh;d.name=c,d.page=l;let f=null,m=null;for(;;){let x=r.readEntry(n,c=r.readLine());if(x==0)break;let v=h[n[0]];if(v)v();else{f==null&&(f=[],m=[]),f.push(n[0]);let w=[];for(let E=0;E<x;E++)w.push(parseInt(n[E+1]));m.push(w)}}o.originalWidth==0&&o.originalHeight==0&&(o.originalWidth=o.width,o.originalHeight=o.height);let p=l.baseTexture.resolution;o.x/=p,o.y/=p,o.width/=p,o.height/=p,o.originalWidth/=p,o.originalHeight/=p,o.offsetX/=p,o.offsetY/=p;let g=o.rotate%4!==0,y=new ht(o.x,o.y,g?o.height:o.width,g?o.width:o.height),_=new ht(0,0,o.originalWidth,o.originalHeight),b=new ht(o.offsetX,o.originalHeight-o.height-o.offsetY,o.width,o.height);d.texture=new rt(d.page.baseTexture,y,_,b,o.rotate),d.index=o.index,d.texture.updateUvs(),this.regions.push(d)}}};u()}findRegion(t){for(let e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return null}dispose(){for(let t=0;t<this.pages.length;t++)this.pages[t].baseTexture.dispose()}},zp=class{constructor(t){this.index=0,this.lines=t.split(/\r\n|\r|\n/)}readLine(){return this.index>=this.lines.length?null:this.lines[this.index++]}readEntry(t,e){if(e==null||(e=e.trim(),e.length==0))return 0;let i=e.indexOf(":");if(i==-1)return 0;t[0]=e.substr(0,i).trim();for(let r=1,n=i+1;;r++){let l=e.indexOf(",",n);if(l==-1)return t[r]=e.substr(n).trim(),r;if(t[r]=e.substr(n,l-n).trim(),n=l+1,r==4)return 4}}},Gh=class{constructor(){this.minFilter=Re.Nearest,this.magFilter=Re.Nearest,this.uWrap=Fs.ClampToEdge,this.vWrap=Fs.ClampToEdge}setFilters(){let t=this.baseTexture,e=this.minFilter;e==Re.Linear?t.scaleMode=Se.LINEAR:this.minFilter==Re.Nearest?t.scaleMode=Se.NEAREST:(t.mipmap=Rs.POW2,e==Re.MipMapNearestNearest?t.scaleMode=Se.NEAREST:t.scaleMode=Se.LINEAR)}},Xh=class extends Rr{};var pn=class{constructor(){this.array=new Array}add(t){let e=this.contains(t);return this.array[t|0]=t|0,!e}contains(t){return this.array[t|0]!=null}remove(t){this.array[t|0]=void 0}clear(){this.array.length=0}},gn=class{constructor(){this.entries={},this.size=0}add(t){let e=this.entries[t];return this.entries[t]=!0,e?!1:(this.size++,!0)}addAll(t){let e=this.size;for(let i=0,r=t.length;i<r;i++)this.add(t[i]);return e!=this.size}contains(t){return this.entries[t]}clear(){this.entries={},this.size=0}},cl=class{constructor(s=0,t=0,e=0,i=0){this.r=s,this.g=t,this.b=e,this.a=i}set(s,t,e,i){return this.r=s,this.g=t,this.b=e,this.a=i,this.clamp()}setFromColor(s){return this.r=s.r,this.g=s.g,this.b=s.b,this.a=s.a,this}setFromString(s){return s=s.charAt(0)=="#"?s.substr(1):s,this.r=parseInt(s.substr(0,2),16)/255,this.g=parseInt(s.substr(2,2),16)/255,this.b=parseInt(s.substr(4,2),16)/255,this.a=s.length!=8?1:parseInt(s.substr(6,2),16)/255,this}add(s,t,e,i){return this.r+=s,this.g+=t,this.b+=e,this.a+=i,this.clamp()}clamp(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}static rgba8888ToColor(s,t){s.r=((t&4278190080)>>>24)/255,s.g=((t&16711680)>>>16)/255,s.b=((t&65280)>>>8)/255,s.a=(t&255)/255}static rgb888ToColor(s,t){s.r=((t&16711680)>>>16)/255,s.g=((t&65280)>>>8)/255,s.b=(t&255)/255}static fromString(s){return new cl().setFromString(s)}},G=cl;G.WHITE=new cl(1,1,1,1);G.RED=new cl(1,0,0,1);G.GREEN=new cl(0,1,0,1);G.BLUE=new cl(0,0,1,1);G.MAGENTA=new cl(1,0,1,1);var kr=class{static clamp(s,t,e){return s<t?t:s>e?e:s}static cosDeg(s){return Math.cos(s*kr.degRad)}static sinDeg(s){return Math.sin(s*kr.degRad)}static signum(s){return Math.sign(s)}static toInt(s){return s>0?Math.floor(s):Math.ceil(s)}static cbrt(s){let t=Math.pow(Math.abs(s),.3333333333333333);return s<0?-t:t}static randomTriangular(s,t){return kr.randomTriangularWith(s,t,(s+t)*.5)}static randomTriangularWith(s,t,e){let i=Math.random(),r=t-s;return i<=(e-s)/r?s+Math.sqrt(i*r*(e-s)):t-Math.sqrt((1-i)*r*(t-e))}static isPowerOfTwo(s){return s&&(s&s-1)===0}},S=kr;S.PI=3.1415927;S.PI2=kr.PI*2;S.radiansToDegrees=180/kr.PI;S.radDeg=kr.radiansToDegrees;S.degreesToRadians=kr.PI/180;S.degRad=kr.degreesToRadians;var ju=class{apply(t,e,i){return t+(e-t)*this.applyInternal(i)}},Wu=class extends ju{constructor(t){super(),this.power=2,this.power=t}applyInternal(t){return t<=.5?Math.pow(t*2,this.power)/2:Math.pow((t-1)*2,this.power)/(this.power%2==0?-2:2)+1}},xn=class extends Wu{applyInternal(t){return Math.pow(t-1,this.power)*(this.power%2==0?-1:1)+1}},Yh=class{static arrayCopy(s,t,e,i,r){for(let n=t,l=i;n<t+r;n++,l++)e[l]=s[n]}static arrayFill(s,t,e,i){for(let r=t;r<e;r++)s[r]=i}static setArraySize(s,t,e=0){let i=s.length;if(i==t)return s;if(s.length=t,i<t)for(let r=i;r<t;r++)s[r]=e;return s}static ensureArrayCapacity(s,t,e=0){return s.length>=t?s:Yh.setArraySize(s,t,e)}static newArray(s,t){let e=new Array(s);for(let i=0;i<s;i++)e[i]=t;return e}static newFloatArray(s){if(Yh.SUPPORTS_TYPED_ARRAYS)return new Float32Array(s);let t=new Array(s);for(let e=0;e<t.length;e++)t[e]=0;return t}static newShortArray(s){if(Yh.SUPPORTS_TYPED_ARRAYS)return new Int16Array(s);let t=new Array(s);for(let e=0;e<t.length;e++)t[e]=0;return t}static toFloatArray(s){return Yh.SUPPORTS_TYPED_ARRAYS?new Float32Array(s):s}static toSinglePrecision(s){return Yh.SUPPORTS_TYPED_ARRAYS?Math.fround(s):s}static webkit602BugfixHelper(s,t){}static contains(s,t,e=!0){for(let i=0;i<s.length;i++)if(s[i]==t)return!0;return!1}static enumValue(s,t){return s[t[0].toUpperCase()+t.slice(1)]}},k=Yh;k.SUPPORTS_TYPED_ARRAYS=typeof Float32Array!="undefined";var qf=class{static logBones(t){for(let e=0;e<t.bones.length;e++){let i=t.bones[e],r=i.matrix;console.log(`${i.data.name}, ${r.a}, ${r.b}, ${r.c}, ${r.d}, ${r.tx}, ${r.ty}`)}}},Js=class{constructor(t){this.items=new Array,this.instantiator=t}obtain(){return this.items.length>0?this.items.pop():this.instantiator()}free(t){t.reset&&t.reset(),this.items.push(t)}freeAll(t){for(let e=0;e<t.length;e++)this.free(t[e])}clear(){this.items.length=0}},Bs=class{constructor(t=0,e=0){this.x=t,this.y=e}set(t,e){return this.x=t,this.y=e,this}length(){let t=this.x,e=this.y;return Math.sqrt(t*t+e*e)}normalize(){let t=this.length();return t!=0&&(this.x/=t,this.y/=t),this}},zf=class{constructor(){this.maxDelta=.064,this.framesPerSecond=0,this.delta=0,this.totalTime=0,this.lastTime=Date.now()/1e3,this.frameCount=0,this.frameTime=0}update(){let t=Date.now()/1e3;this.delta=t-this.lastTime,this.frameTime+=this.delta,this.totalTime+=this.delta,this.delta>this.maxDelta&&(this.delta=this.maxDelta),this.lastTime=t,this.frameCount++,this.frameTime>1&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameTime=0,this.frameCount=0)}},Kf=class{constructor(t=32){this.addedValues=0,this.lastValue=0,this.mean=0,this.dirty=!0,this.values=new Array(t)}hasEnoughData(){return this.addedValues>=this.values.length}addValue(t){this.addedValues<this.values.length&&this.addedValues++,this.values[this.lastValue++]=t,this.lastValue>this.values.length-1&&(this.lastValue=0),this.dirty=!0}getMean(){if(this.hasEnoughData()){if(this.dirty){let t=0;for(let e=0;e<this.values.length;e++)t+=this.values[e];this.mean=t/this.values.length,this.dirty=!1}return this.mean}return 0}};var ti=class{constructor(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.boundingBoxes=new Array,this.polygons=new Array,this.polygonPool=new Js(()=>k.newFloatArray(16))}update(t,e){if(!t)throw new Error("skeleton cannot be null.");let i=this.boundingBoxes,r=this.polygons,n=this.polygonPool,l=t.slots,a=l.length;i.length=0,n.freeAll(r),r.length=0;for(let o=0;o<a;o++){let h=l[o];if(!h.bone.active)continue;let c=h.getAttachment();if(c!=null&&c.type===tt.BoundingBox){let u=c;i.push(u);let d=n.obtain();d.length!=u.worldVerticesLength&&(d=k.newFloatArray(u.worldVerticesLength)),r.push(d),u.computeWorldVertices(h,0,u.worldVerticesLength,d,0,2)}}e?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)}aabbCompute(){let t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,r=Number.NEGATIVE_INFINITY,n=this.polygons;for(let l=0,a=n.length;l<a;l++){let o=n[l],h=o;for(let c=0,u=o.length;c<u;c+=2){let d=h[c],f=h[c+1];t=Math.min(t,d),e=Math.min(e,f),i=Math.max(i,d),r=Math.max(r,f)}}this.minX=t,this.minY=e,this.maxX=i,this.maxY=r}aabbContainsPoint(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY}aabbIntersectsSegment(t,e,i,r){let n=this.minX,l=this.minY,a=this.maxX,o=this.maxY;if(t<=n&&i<=n||e<=l&&r<=l||t>=a&&i>=a||e>=o&&r>=o)return!1;let h=(r-e)/(i-t),c=h*(n-t)+e;if(c>l&&c<o||(c=h*(a-t)+e,c>l&&c<o))return!0;let u=(l-e)/h+t;return u>n&&u<a||(u=(o-e)/h+t,u>n&&u<a)}aabbIntersectsSkeleton(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY}containsPoint(t,e){let i=this.polygons;for(let r=0,n=i.length;r<n;r++)if(this.containsPointPolygon(i[r],t,e))return this.boundingBoxes[r];return null}containsPointPolygon(t,e,i){let r=t,n=t.length,l=n-2,a=!1;for(let o=0;o<n;o+=2){let h=r[o+1],c=r[l+1];if(h<i&&c>=i||c<i&&h>=i){let u=r[o];u+(i-h)/(c-h)*(r[l]-u)<e&&(a=!a)}l=o}return a}intersectsSegment(t,e,i,r){let n=this.polygons;for(let l=0,a=n.length;l<a;l++)if(this.intersectsSegmentPolygon(n[l],t,e,i,r))return this.boundingBoxes[l];return null}intersectsSegmentPolygon(t,e,i,r,n){let l=t,a=t.length,o=e-r,h=i-n,c=e*n-i*r,u=l[a-2],d=l[a-1];for(let f=0;f<a;f+=2){let m=l[f],p=l[f+1],g=u*p-d*m,y=u-m,_=d-p,b=o*_-h*y,x=(c*y-o*g)/b;if((x>=u&&x<=m||x>=m&&x<=u)&&(x>=e&&x<=r||x>=r&&x<=e)){let v=(c*_-h*g)/b;if((v>=d&&v<=p||v>=p&&v<=d)&&(v>=i&&v<=n||v>=n&&v<=i))return!0}u=m,d=p}return!1}getPolygon(t){if(!t)throw new Error("boundingBox cannot be null.");let e=this.boundingBoxes.indexOf(t);return e==-1?null:this.polygons[e]}getWidth(){return this.maxX-this.minX}getHeight(){return this.maxY-this.minY}};var jt={yDown:!0,FAIL_ON_NON_EXISTING_SKIN:!1,GLOBAL_AUTO_UPDATE:!0,GLOBAL_DELAY_LIMIT:0};var Bi=class{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?ht.EMPTY:(t=t||new ht(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,e){let{a:i,b:r,c:n,d:l,tx:a,ty:o}=t,h=i*e.x+n*e.y+a,c=r*e.x+l*e.y+o;this.minX=Math.min(this.minX,h),this.maxX=Math.max(this.maxX,h),this.minY=Math.min(this.minY,c),this.maxY=Math.max(this.maxY,c)}addQuad(t){let e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,l=t[0],a=t[1];e=l<e?l:e,i=a<i?a:i,r=l>r?l:r,n=a>n?a:n,l=t[2],a=t[3],e=l<e?l:e,i=a<i?a:i,r=l>r?l:r,n=a>n?a:n,l=t[4],a=t[5],e=l<e?l:e,i=a<i?a:i,r=l>r?l:r,n=a>n?a:n,l=t[6],a=t[7],e=l<e?l:e,i=a<i?a:i,r=l>r?l:r,n=a>n?a:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n}addFrame(t,e,i,r,n){this.addFrameMatrix(t.worldTransform,e,i,r,n)}addFrameMatrix(t,e,i,r,n){let l=t.a,a=t.b,o=t.c,h=t.d,c=t.tx,u=t.ty,d=this.minX,f=this.minY,m=this.maxX,p=this.maxY,g=l*e+o*i+c,y=a*e+h*i+u;d=g<d?g:d,f=y<f?y:f,m=g>m?g:m,p=y>p?y:p,g=l*r+o*i+c,y=a*r+h*i+u,d=g<d?g:d,f=y<f?y:f,m=g>m?g:m,p=y>p?y:p,g=l*e+o*n+c,y=a*e+h*n+u,d=g<d?g:d,f=y<f?y:f,m=g>m?g:m,p=y>p?y:p,g=l*r+o*n+c,y=a*r+h*n+u,d=g<d?g:d,f=y<f?y:f,m=g>m?g:m,p=y>p?y:p,this.minX=d,this.minY=f,this.maxX=m,this.maxY=p}addVertexData(t,e,i){let r=this.minX,n=this.minY,l=this.maxX,a=this.maxY;for(let o=e;o<i;o+=2){let h=t[o],c=t[o+1];r=h<r?h:r,n=c<n?c:n,l=h>l?h:l,a=c>a?c:a}this.minX=r,this.minY=n,this.maxX=l,this.maxY=a}addVertices(t,e,i,r){this.addVerticesMatrix(t.worldTransform,e,i,r)}addVerticesMatrix(t,e,i,r,n=0,l=n){let a=t.a,o=t.b,h=t.c,c=t.d,u=t.tx,d=t.ty,f=this.minX,m=this.minY,p=this.maxX,g=this.maxY;for(let y=i;y<r;y+=2){let _=e[y],b=e[y+1],x=a*_+h*b+u,v=c*b+o*_+d;f=Math.min(f,x-n),p=Math.max(p,x+n),m=Math.min(m,v-l),g=Math.max(g,v+l)}this.minX=f,this.minY=m,this.maxX=p,this.maxY=g}addBounds(t){let e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n}addBoundsMask(t,e){let i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,l=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=l){let a=this.minX,o=this.minY,h=this.maxX,c=this.maxY;this.minX=i<a?i:a,this.minY=r<o?r:o,this.maxX=n>h?n:h,this.maxY=l>c?l:c}}addBoundsMatrix(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,e){let i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,l=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=l){let a=this.minX,o=this.minY,h=this.maxX,c=this.maxY;this.minX=i<a?i:a,this.minY=r<o?r:o,this.maxX=n>h?n:h,this.maxY=l>c?l:c}}pad(t=0,e=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)}addFramePad(t,e,i,r,n,l){t-=n,e-=l,i+=n,r+=l,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r}};var Li=class extends et.EventEmitter{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new cn,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Bi,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){let e=Object.keys(t);for(let i=0;i<e.length;++i){let r=e[i];Object.defineProperty(Li.prototype,r,Object.getOwnPropertyDescriptor(t,r))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new ht),e=this._boundsRect),this._bounds.getRectangle(e)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new ht),t=this._localBoundsRect),this._localBounds||(this._localBounds=new Bi);let e=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;let r=this._bounds,n=this._boundsID;this._bounds=this._localBounds;let l=this.getBounds(!1,t);return this.parent=i,this.transform=e,this._bounds=r,this._bounds.updateID+=this._boundsID-n,l}toGlobal(t,e,i=!1){return i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)}toLocal(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){var t;(t=this.parent)==null||t.removeChild(this)}setTransform(t=0,e=0,i=1,r=1,n=0,l=0,a=0,o=0,h=0){return this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=l,this.skew.y=a,this.pivot.x=o,this.pivot.y=h,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new Zf),this.tempDisplayObjectParent}enableTempParent(){let t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*Np}set angle(t){this.transform.rotation=t*Fp}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){let e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount--,e._maskRefCount===0&&(e.renderable=!0,e.isMask=!1))}if(this._mask=t,this._mask){let e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount===0&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}}}},Zf=class extends Li{constructor(){super(...arguments),this.sortDirty=null}};Li.prototype.displayObjectUpdateTransform=Li.prototype.updateTransform;var lI=new mt;function hI(s,t){return s.zIndex===t.zIndex?s._lastSortedIndex-t._lastSortedIndex:s.zIndex-t.zIndex}var Kp=class extends Li{constructor(){super(),this.children=[],this.sortableChildren=Kp.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(s){}addChild(...s){if(s.length>1)for(let t=0;t<s.length;t++)this.addChild(s[t]);else{let t=s[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return s[0]}addChildAt(s,t){if(t<0||t>this.children.length)throw new Error(`${s}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return s.parent&&s.parent.removeChild(s),s.parent=this,this.sortDirty=!0,s.transform._parentID=-1,this.children.splice(t,0,s),this._boundsID++,this.onChildrenChange(t),s.emit("added",this),this.emit("childAdded",s,this,t),s}swapChildren(s,t){if(s===t)return;let e=this.getChildIndex(s),i=this.getChildIndex(t);this.children[e]=t,this.children[i]=s,this.onChildrenChange(e<i?e:i)}getChildIndex(s){let t=this.children.indexOf(s);if(t===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(s,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);let e=this.getChildIndex(s);et.removeItems(this.children,e,1),this.children.splice(t,0,s),this.onChildrenChange(t)}getChildAt(s){if(s<0||s>=this.children.length)throw new Error(`getChildAt: Index (${s}) does not exist.`);return this.children[s]}removeChild(...s){if(s.length>1)for(let t=0;t<s.length;t++)this.removeChild(s[t]);else{let t=s[0],e=this.children.indexOf(t);if(e===-1)return null;t.parent=null,t.transform._parentID=-1,et.removeItems(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e)}return s[0]}removeChildAt(s){let t=this.getChildAt(s);return t.parent=null,t.transform._parentID=-1,et.removeItems(this.children,s,1),this._boundsID++,this.onChildrenChange(s),t.emit("removed",this),this.emit("childRemoved",t,this,s),t}removeChildren(s=0,t=this.children.length){let e=s,i=t,r=i-e,n;if(r>0&&r<=i){n=this.children.splice(e,r);for(let l=0;l<n.length;++l)n[l].parent=null,n[l].transform&&(n[l].transform._parentID=-1);this._boundsID++,this.onChildrenChange(s);for(let l=0;l<n.length;++l)n[l].emit("removed",this),this.emit("childRemoved",n[l],this,l);return n}else if(r===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let s=!1;for(let t=0,e=this.children.length;t<e;++t){let i=this.children[t];i._lastSortedIndex=t,!s&&i.zIndex!==0&&(s=!0)}s&&this.children.length>1&&this.children.sort(hI),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let s=0,t=this.children.length;s<t;++s){let e=this.children[s];e.visible&&e.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let s=0;s<this.children.length;s++){let t=this.children[s];if(!(!t.visible||!t.renderable))if(t.calculateBounds(),t._mask){let e=t._mask.isMaskData?t._mask.maskObject:t._mask;e?(e.calculateBounds(),this._bounds.addBoundsMask(t._bounds,e._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(s,t=!1){let e=super.getLocalBounds(s);if(!t)for(let i=0,r=this.children.length;i<r;++i){let n=this.children[i];n.visible&&n.updateTransform()}return e}_calculateBounds(){}_renderWithCulling(s){let t=s.renderTexture.sourceFrame;if(!(t.width>0&&t.height>0))return;let e,i;this.cullArea?(e=this.cullArea,i=this.worldTransform):this._render!==Kp.prototype._render&&(e=this.getBounds(!0));let r=s.projection.transform;if(r&&(i?(i=lI.copyFrom(i),i.prepend(r)):i=r),e&&t.intersects(e,i))this._render(s);else if(this.cullArea)return;for(let n=0,l=this.children.length;n<l;++n){let a=this.children[n],o=a.cullable;a.cullable=o||!this.cullArea,a.render(s),a.cullable=o}}render(s){var t;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||((t=this.filters)==null?void 0:t.length))this.renderAdvanced(s);else if(this.cullable)this._renderWithCulling(s);else{this._render(s);for(let e=0,i=this.children.length;e<i;++e)this.children[e].render(s)}}renderAdvanced(s){var r,n,l;let t=this.filters,e=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let a=0;a<t.length;a++)t[a].enabled&&this._enabledFilters.push(t[a])}let i=t&&((r=this._enabledFilters)==null?void 0:r.length)||e&&(!e.isMaskData||e.enabled&&(e.autoDetect||e.type!==se.NONE));if(i&&s.batch.flush(),t&&((n=this._enabledFilters)==null?void 0:n.length)&&s.filter.push(this,this._enabledFilters),e&&s.mask.push(this,this._mask),this.cullable)this._renderWithCulling(s);else{this._render(s);for(let a=0,o=this.children.length;a<o;++a)this.children[a].render(s)}i&&s.batch.flush(),e&&s.mask.pop(this),t&&((l=this._enabledFilters)==null?void 0:l.length)&&s.filter.pop()}_render(s){}destroy(s){super.destroy(),this.sortDirty=!1;let t=typeof s=="boolean"?s:s==null?void 0:s.children,e=this.removeChildren(0,this.children.length);if(t)for(let i=0;i<e.length;++i)e[i].destroy(s)}get width(){return this.scale.x*this.getLocalBounds().width}set width(s){let t=this.getLocalBounds().width;t!==0?this.scale.x=s/t:this.scale.x=1,this._width=s}get height(){return this.scale.y*this.getLocalBounds().height}set height(s){let t=this.getLocalBounds().height;t!==0?this.scale.y=s/t:this.scale.y=1,this._height=s}},ae=Kp;ae.defaultSortableChildren=!1;ae.prototype.containerUpdateTransform=ae.prototype.updateTransform;Object.defineProperties(z,{SORTABLE_CHILDREN:{get(){return ae.defaultSortableChildren},set(s){et.deprecation("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),ae.defaultSortableChildren=s}}});var $u=new Rt,cI=new Uint16Array([0,1,2,0,2,3]),ul=class extends ae{constructor(t){super(),this._anchor=new Zs(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tint=null,this._tintRGB=null,this.tint=16777215,this.blendMode=Z.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||rt.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=cI,this.pluginName="batch",this.isSprite=!0,this._roundPixels=z.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=et.sign(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=et.sign(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){let t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;let e=this.transform.worldTransform,i=e.a,r=e.b,n=e.c,l=e.d,a=e.tx,o=e.ty,h=this.vertexData,c=t.trim,u=t.orig,d=this._anchor,f=0,m=0,p=0,g=0;if(c?(m=c.x-d._x*u.width,f=m+c.width,g=c.y-d._y*u.height,p=g+c.height):(m=-d._x*u.width,f=m+u.width,g=-d._y*u.height,p=g+u.height),h[0]=i*m+n*g+a,h[1]=l*g+r*m+o,h[2]=i*f+n*g+a,h[3]=l*g+r*f+o,h[4]=i*f+n*p+a,h[5]=l*p+r*f+o,h[6]=i*m+n*p+a,h[7]=l*p+r*m+o,this._roundPixels){let y=z.RESOLUTION;for(let _=0;_<h.length;++_)h[_]=Math.round(h[_]*y)/y}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;let t=this._texture,e=this.vertexTrimmedData,i=t.orig,r=this._anchor,n=this.transform.worldTransform,l=n.a,a=n.b,o=n.c,h=n.d,c=n.tx,u=n.ty,d=-r._x*i.width,f=d+i.width,m=-r._y*i.height,p=m+i.height;e[0]=l*d+o*m+c,e[1]=h*m+a*d+u,e[2]=l*f+o*m+c,e[3]=h*m+a*f+u,e[4]=l*f+o*p+c,e[5]=h*p+a*f+u,e[6]=l*d+o*p+c,e[7]=h*p+a*d+u}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){let t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new Bi),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new ht),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,$u);let e=this._texture.orig.width,i=this._texture.orig.height,r=-e*this.anchor.x,n=0;return $u.x>=r&&$u.x<r+e&&(n=-i*this.anchor.y,$u.y>=n&&$u.y<n+i)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t==null?void 0:t.texture){let i=typeof t=="boolean"?t:t==null?void 0:t.baseTexture;this._texture.destroy(!!i)}this._texture=null}static from(t,e){let i=t instanceof rt?t:rt.from(t,e);return new ul(i)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){let e=et.sign(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){let e=et.sign(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tint}set tint(t){this._tint=t,this._tintRGB=(t>>16)+(t&65280)+((t&255)<<16)}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||rt.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}};var Hu=class{constructor(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;let e=this.uvBuffer.data;(!this.data||this.data.length!==e.length)&&(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}};var Zp=new Rt,d0=new ks,f0=class extends ae{constructor(s,t,e,i=Be.TRIANGLES){super(),this.geometry=s,this.shader=t,this.state=e||He.for2d(),this.drawMode=i,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=z.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(s){this._geometry!==s&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=s,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(s){this.shader=s}get material(){return this.shader}set blendMode(s){this.state.blendMode=s}get blendMode(){return this.state.blendMode}set roundPixels(s){this._roundPixels!==s&&(this._transformID=-1),this._roundPixels=s}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(s){this.shader.tint=s}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(s){this.shader.texture=s}_render(s){let t=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Be.TRIANGLES&&t.length<f0.BATCHABLE_SIZE*2?this._renderToBatch(s):this._renderDefault(s)}_renderDefault(s){let t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),s.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),s.shader.bind(t),s.state.set(this.state),s.geometry.bind(this.geometry,t),s.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(s){let t=this.geometry,e=this.shader;e.uvMatrix&&(e.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=e._tintRGB,this._texture=e.texture;let i=this.material.pluginName;s.batch.setObjectRenderer(s.plugins[i]),s.plugins[i].render(this)}calculateVertices(){let t=this.geometry.buffers[0],e=t.data,i=t._updateID;if(i===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));let r=this.transform.worldTransform,n=r.a,l=r.b,a=r.c,o=r.d,h=r.tx,c=r.ty,u=this.vertexData;for(let d=0;d<u.length/2;d++){let f=e[d*2],m=e[d*2+1];u[d*2]=n*f+a*m+h,u[d*2+1]=l*f+o*m+c}if(this._roundPixels){let d=z.RESOLUTION;for(let f=0;f<u.length;++f)u[f]=Math.round(u[f]*d)/d}this.vertexDirty=i}calculateUvs(){let s=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=s.data:(this.batchUvs||(this.batchUvs=new Hu(s,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(s){if(!this.getBounds().contains(s.x,s.y))return!1;this.worldTransform.applyInverse(s,Zp);let t=this.geometry.getBuffer("aVertexPosition").data,e=d0.points,i=this.geometry.getIndex().data,r=i.length,n=this.drawMode===4?3:1;for(let l=0;l+2<r;l+=n){let a=i[l]*2,o=i[l+1]*2,h=i[l+2]*2;if(e[0]=t[a],e[1]=t[a+1],e[2]=t[o],e[3]=t[o+1],e[4]=t[h],e[5]=t[h+1],d0.contains(Zp.x,Zp.y))return!0}return!1}destroy(s){super.destroy(s),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}},jh=f0;jh.BATCHABLE_SIZE=100;var dl=class extends ms{constructor(t,e,i){super();let r=new Gt(t),n=new Gt(e,!0),l=new Gt(i,!0,!0);this.addAttribute("aVertexPosition",r,2,!1,ft.FLOAT).addAttribute("aTextureCoord",n,2,!1,ft.FLOAT).addIndex(l),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}};var m0=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`;var p0=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;var fl=class extends Ps{constructor(t,e){let i={uSampler:t,alpha:1,uTextureMatrix:mt.IDENTITY,uColor:new Float32Array([1,1,1,1])};e=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},e),e.uniforms&&Object.assign(i,e.uniforms),super(e.program||De.from(p0,m0),i),this._colorDirty=!1,this.uvMatrix=new nl(t),this.batchable=e.program===void 0,this.pluginName=e.pluginName,this.tint=e.tint,this.alpha=e.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(t&65280)+((t&255)<<16),this._colorDirty=!0)}get tint(){return this._tint}update(){if(this._colorDirty){this._colorDirty=!1;let t=this.texture.baseTexture;et.premultiplyTintToRgba(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}};var qu=class extends jh{constructor(t=rt.EMPTY,e,i,r,n){let l=new dl(e,i,r);l.getBuffer("aVertexPosition").static=!1;let a=new fl(t);super(l,a,null,n),this.autoUpdate=!0}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(t){this.geometry.getBuffer("aVertexPosition").data=t}_render(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),super._render(t)}};var bn={build(s){let t=s.points,e,i,r,n,l,a;if(s.type===Ut.CIRC){let m=s.shape;e=m.x,i=m.y,l=a=m.radius,r=n=0}else if(s.type===Ut.ELIP){let m=s.shape;e=m.x,i=m.y,l=m.width,a=m.height,r=n=0}else{let m=s.shape,p=m.width/2,g=m.height/2;e=m.x+p,i=m.y+g,l=a=Math.max(0,Math.min(m.radius,Math.min(p,g))),r=p-l,n=g-a}if(!(l>=0&&a>=0&&r>=0&&n>=0)){t.length=0;return}let o=Math.ceil(2.3*Math.sqrt(l+a)),h=o*8+(r?4:0)+(n?4:0);if(t.length=h,h===0)return;if(o===0){t.length=8,t[0]=t[6]=e+r,t[1]=t[3]=i+n,t[2]=t[4]=e-r,t[5]=t[7]=i-n;return}let c=0,u=o*4+(r?2:0)+2,d=u,f=h;{let m=r+l,p=n,g=e+m,y=e-m,_=i+p;if(t[c++]=g,t[c++]=_,t[--u]=_,t[--u]=y,n){let b=i-p;t[d++]=y,t[d++]=b,t[--f]=b,t[--f]=g}}for(let m=1;m<o;m++){let p=Math.PI/2*(m/o),g=r+Math.cos(p)*l,y=n+Math.sin(p)*a,_=e+g,b=e-g,x=i+y,v=i-y;t[c++]=_,t[c++]=x,t[--u]=x,t[--u]=b,t[d++]=b,t[d++]=v,t[--f]=v,t[--f]=_}{let m=r,p=n+a,g=e+m,y=e-m,_=i+p,b=i-p;t[c++]=g,t[c++]=_,t[--f]=b,t[--f]=g,r&&(t[c++]=y,t[c++]=_,t[--f]=b,t[--f]=y)}},triangulate(s,t){let e=s.points,i=t.points,r=t.indices;if(e.length===0)return;let n=i.length/2,l=n,a,o;if(s.type!==Ut.RREC){let c=s.shape;a=c.x,o=c.y}else{let c=s.shape;a=c.x+c.width/2,o=c.y+c.height/2}let h=s.matrix;i.push(s.matrix?h.a*a+h.c*o+h.tx:a,s.matrix?h.b*a+h.d*o+h.ty:o),n++,i.push(e[0],e[1]);for(let c=2;c<e.length;c+=2)i.push(e[c],e[c+1]),r.push(n++,l,n);r.push(l+1,l,n)}};function g0(s,t=!1){let e=s.length;if(e<6)return;let i=0;for(let r=0,n=s[e-2],l=s[e-1];r<e;r+=2){let a=s[r],o=s[r+1];i+=(a-n)*(o+l),n=a,l=o}if(!t&&i>0||t&&i<=0){let r=e/2;for(let n=r+r%2;n<e;n+=2){let l=e-n-2,a=e-n-1,o=n,h=n+1;[s[l],s[o]]=[s[o],s[l]],[s[a],s[h]]=[s[h],s[a]]}}}var Wh={build(s){s.points=s.shape.points.slice()},triangulate(s,t){let e=s.points,i=s.holes,r=t.points,n=t.indices;if(e.length>=6){g0(e,!1);let l=[];for(let h=0;h<i.length;h++){let c=i[h];g0(c.points,!0),l.push(e.length/2),e=e.concat(c.points)}let a=et.earcut(e,l,2);if(!a)return;let o=r.length/2;for(let h=0;h<a.length;h+=3)n.push(a[h]+o),n.push(a[h+1]+o),n.push(a[h+2]+o);for(let h=0;h<e.length;h++)r.push(e[h])}}};var Qf={build(s){let t=s.shape,e=t.x,i=t.y,r=t.width,n=t.height,l=s.points;l.length=0,r>=0&&n>=0&&l.push(e,i,e+r,i,e+r,i+n,e,i+n)},triangulate(s,t){let e=s.points,i=t.points;if(e.length===0)return;let r=i.length/2;i.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),t.indices.push(r,r+1,r+2,r+1,r+2,r+3)}};var Jf={build(s){bn.build(s)},triangulate(s,t){bn.triangulate(s,t)}};var ei=(s=>(s.MITER="miter",s.BEVEL="bevel",s.ROUND="round",s))(ei||{}),xi=(s=>(s.BUTT="butt",s.ROUND="round",s.SQUARE="square",s))(xi||{}),si={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(s,t=20){if(!this.adaptive||!s||isNaN(s))return t;let e=Math.ceil(s/this.maxLength);return e<this.minSegments?e=this.minSegments:e>this.maxSegments&&(e=this.maxSegments),e}};var ml=class{static curveTo(t,e,i,r,n,l){let a=l[l.length-2],h=l[l.length-1]-e,c=a-t,u=r-e,d=i-t,f=Math.abs(h*d-c*u);if(f<1e-8||n===0)return(l[l.length-2]!==t||l[l.length-1]!==e)&&l.push(t,e),null;let m=h*h+c*c,p=u*u+d*d,g=h*u+c*d,y=n*Math.sqrt(m)/f,_=n*Math.sqrt(p)/f,b=y*g/m,x=_*g/p,v=y*d+_*c,w=y*u+_*h,E=c*(_+b),A=h*(_+b),T=d*(y+x),C=u*(y+x),R=Math.atan2(A-w,E-v),N=Math.atan2(C-w,T-v);return{cx:v+t,cy:w+e,radius:n,startAngle:R,endAngle:N,anticlockwise:c*u>d*h}}static arc(t,e,i,r,n,l,a,o,h){let c=a-l,u=si._segmentsCount(Math.abs(c)*n,Math.ceil(Math.abs(c)/hn)*40),d=c/(u*2),f=d*2,m=Math.cos(d),p=Math.sin(d),g=u-1,y=g%1/g;for(let _=0;_<=g;++_){let b=_+y*_,x=d+l+f*b,v=Math.cos(x),w=-Math.sin(x);h.push((m*v+p*w)*n+i,(m*-w+p*v)*n+r)}}};var $h=class{constructor(){this.reset()}begin(t,e,i){this.reset(),this.style=t,this.start=e,this.attribStart=i}end(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}};var _n=class{static curveLength(t,e,i,r,n,l,a,o){let c=0,u=0,d=0,f=0,m=0,p=0,g=0,y=0,_=0,b=0,x=0,v=t,w=e;for(let E=1;E<=10;++E)u=E/10,d=u*u,f=d*u,m=1-u,p=m*m,g=p*m,y=g*t+3*p*u*i+3*m*d*n+f*a,_=g*e+3*p*u*r+3*m*d*l+f*o,b=v-y,x=w-_,v=y,w=_,c+=Math.sqrt(b*b+x*x);return c}static curveTo(t,e,i,r,n,l,a){let o=a[a.length-2],h=a[a.length-1];a.length-=2;let c=si._segmentsCount(_n.curveLength(o,h,t,e,i,r,n,l)),u=0,d=0,f=0,m=0,p=0;a.push(o,h);for(let g=1,y=0;g<=c;++g)y=g/c,u=1-y,d=u*u,f=d*u,m=y*y,p=m*y,a.push(f*o+3*d*y*t+3*u*m*i+p*n,f*h+3*d*y*e+3*u*m*r+p*l)}};function x0(s,t,e,i,r,n,l,a){let o=s-e*r,h=t-i*r,c=s+e*n,u=t+i*n,d,f;l?(d=i,f=-e):(d=-i,f=e);let m=o+d,p=h+f,g=c+d,y=u+f;return a.push(m,p),a.push(g,y),2}function pl(s,t,e,i,r,n,l,a){let o=e-s,h=i-t,c=Math.atan2(o,h),u=Math.atan2(r-s,n-t);a&&c<u?c+=Math.PI*2:!a&&c>u&&(u+=Math.PI*2);let d=c,f=u-c,m=Math.abs(f),p=Math.sqrt(o*o+h*h),g=(15*m*Math.sqrt(p)/Math.PI>>0)+1,y=f/g;if(d+=y,a){l.push(s,t),l.push(e,i);for(let _=1,b=d;_<g;_++,b+=y)l.push(s,t),l.push(s+Math.sin(b)*p,t+Math.cos(b)*p);l.push(s,t),l.push(r,n)}else{l.push(e,i),l.push(s,t);for(let _=1,b=d;_<g;_++,b+=y)l.push(s+Math.sin(b)*p,t+Math.cos(b)*p),l.push(s,t);l.push(r,n),l.push(s,t)}return g*2}function mI(s,t){let e=s.shape,i=s.points||e.points.slice(),r=t.closePointEps;if(i.length===0)return;let n=s.lineStyle,l=new Rt(i[0],i[1]),a=new Rt(i[i.length-2],i[i.length-1]),o=e.type!==Ut.POLY||e.closeStroke,h=Math.abs(l.x-a.x)<r&&Math.abs(l.y-a.y)<r;if(o){i=i.slice(),h&&(i.pop(),i.pop(),a.set(i[i.length-2],i[i.length-1]));let X=(l.x+a.x)*.5,O=(a.y+l.y)*.5;i.unshift(X,O),i.push(X,O)}let c=t.points,u=i.length/2,d=i.length,f=c.length/2,m=n.width/2,p=m*m,g=n.miterLimit*n.miterLimit,y=i[0],_=i[1],b=i[2],x=i[3],v=0,w=0,E=-(_-x),A=y-b,T=0,C=0,R=Math.sqrt(E*E+A*A);E/=R,A/=R,E*=m,A*=m;let N=n.alignment,P=(1-N)*2,M=N*2;o||(n.cap===xi.ROUND?d+=pl(y-E*(P-M)*.5,_-A*(P-M)*.5,y-E*P,_-A*P,y+E*M,_+A*M,c,!0)+2:n.cap===xi.SQUARE&&(d+=x0(y,_,E,A,P,M,!0,c))),c.push(y-E*P,_-A*P),c.push(y+E*M,_+A*M);for(let X=1;X<u-1;++X){y=i[(X-1)*2],_=i[(X-1)*2+1],b=i[X*2],x=i[X*2+1],v=i[(X+1)*2],w=i[(X+1)*2+1],E=-(_-x),A=y-b,R=Math.sqrt(E*E+A*A),E/=R,A/=R,E*=m,A*=m,T=-(x-w),C=b-v,R=Math.sqrt(T*T+C*C),T/=R,C/=R,T*=m,C*=m;let O=b-y,L=_-x,B=b-v,W=w-x,j=O*B+L*W,V=L*B-W*O,U=V<0;if(Math.abs(V)<.001*Math.abs(j)){c.push(b-E*P,x-A*P),c.push(b+E*M,x+A*M),j>=0&&(n.join===ei.ROUND?d+=pl(b,x,b-E*P,x-A*P,b-T*P,x-C*P,c,!1)+4:d+=2,c.push(b-T*M,x-C*M),c.push(b+T*P,x+C*P));continue}let st=(-E+y)*(-A+x)-(-E+b)*(-A+_),nt=(-T+v)*(-C+x)-(-T+b)*(-C+w),pt=(O*nt-B*st)/V,At=(W*st-L*nt)/V,ot=(pt-b)*(pt-b)+(At-x)*(At-x),gt=b+(pt-b)*P,yt=x+(At-x)*P,Nt=b-(pt-b)*M,Lt=x-(At-x)*M,Xe=Math.min(O*O+L*L,B*B+W*W),ws=U?P:M,Es=Xe+ws*ws*p;ot<=Es?n.join===ei.BEVEL||ot/p>g?(U?(c.push(gt,yt),c.push(b+E*M,x+A*M),c.push(gt,yt),c.push(b+T*M,x+C*M)):(c.push(b-E*P,x-A*P),c.push(Nt,Lt),c.push(b-T*P,x-C*P),c.push(Nt,Lt)),d+=2):n.join===ei.ROUND?U?(c.push(gt,yt),c.push(b+E*M,x+A*M),d+=pl(b,x,b+E*M,x+A*M,b+T*M,x+C*M,c,!0)+4,c.push(gt,yt),c.push(b+T*M,x+C*M)):(c.push(b-E*P,x-A*P),c.push(Nt,Lt),d+=pl(b,x,b-E*P,x-A*P,b-T*P,x-C*P,c,!1)+4,c.push(b-T*P,x-C*P),c.push(Nt,Lt)):(c.push(gt,yt),c.push(Nt,Lt)):(c.push(b-E*P,x-A*P),c.push(b+E*M,x+A*M),n.join===ei.ROUND?U?d+=pl(b,x,b+E*M,x+A*M,b+T*M,x+C*M,c,!0)+2:d+=pl(b,x,b-E*P,x-A*P,b-T*P,x-C*P,c,!1)+2:n.join===ei.MITER&&ot/p<=g&&(U?(c.push(Nt,Lt),c.push(Nt,Lt)):(c.push(gt,yt),c.push(gt,yt)),d+=2),c.push(b-T*P,x-C*P),c.push(b+T*M,x+C*M),d+=2)}y=i[(u-2)*2],_=i[(u-2)*2+1],b=i[(u-1)*2],x=i[(u-1)*2+1],E=-(_-x),A=y-b,R=Math.sqrt(E*E+A*A),E/=R,A/=R,E*=m,A*=m,c.push(b-E*P,x-A*P),c.push(b+E*M,x+A*M),o||(n.cap===xi.ROUND?d+=pl(b-E*(P-M)*.5,x-A*(P-M)*.5,b-E*P,x-A*P,b+E*M,x+A*M,c,!1)+2:n.cap===xi.SQUARE&&(d+=x0(b,x,E,A,P,M,!1,c)));let D=t.indices,q=si.epsilon*si.epsilon;for(let X=f;X<d+f-2;++X)y=c[X*2],_=c[X*2+1],b=c[(X+1)*2],x=c[(X+1)*2+1],v=c[(X+2)*2],w=c[(X+2)*2+1],!(Math.abs(y*(x-w)+b*(w-_)+v*(_-x))<q)&&D.push(X,X+1,X+2)}function pI(s,t){let e=0,i=s.shape,r=s.points||i.points,n=i.type!==Ut.POLY||i.closeStroke;if(r.length===0)return;let l=t.points,a=t.indices,o=r.length/2,h=l.length/2,c=h;for(l.push(r[0],r[1]),e=1;e<o;e++)l.push(r[e*2],r[e*2+1]),a.push(c,c+1),c++;n&&a.push(c,h)}function zu(s,t){s.lineStyle.native?pI(s,t):mI(s,t)}var yn=class{static curveLength(t,e,i,r,n,l){let a=t-2*i+n,o=e-2*r+l,h=2*i-2*t,c=2*r-2*e,u=4*(a*a+o*o),d=4*(a*h+o*c),f=h*h+c*c,m=2*Math.sqrt(u+d+f),p=Math.sqrt(u),g=2*u*p,y=2*Math.sqrt(f),_=d/p;return(g*m+p*d*(m-y)+(4*f*u-d*d)*Math.log((2*p+_+m)/(_+y)))/(4*g)}static curveTo(t,e,i,r,n){let l=n[n.length-2],a=n[n.length-1],o=si._segmentsCount(yn.curveLength(l,a,t,e,i,r)),h=0,c=0;for(let u=1;u<=o;++u){let d=u/o;h=l+(t-l)*d,c=a+(e-a)*d,n.push(h+(t+(i-t)*d-h)*d,c+(e+(r-e)*d-c)*d)}}};var Ku={[Ut.POLY]:Wh,[Ut.CIRC]:bn,[Ut.ELIP]:bn,[Ut.RECT]:Qf,[Ut.RREC]:Jf},tm=[],Hh=[];var vn=class{constructor(t,e=null,i=null,r=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=i,this.fillStyle=e,this.matrix=r,this.type=t.type}clone(){return new vn(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}};var qh=new Rt,b0=class extends za{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Bi,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let s=0;s<this.drawCalls.length;s++)this.drawCalls[s].texArray.clear(),Hh.push(this.drawCalls[s]);this.drawCalls.length=0;for(let s=0;s<this.batches.length;s++){let t=this.batches[s];t.reset(),tm.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(s,t=null,e=null,i=null){let r=new vn(s,t,e,i);return this.graphicsData.push(r),this.dirty++,this}drawHole(s,t=null){if(!this.graphicsData.length)return null;let e=new vn(s,null,null,t),i=this.graphicsData[this.graphicsData.length-1];return e.lineStyle=i.lineStyle,i.holes.push(e),this.dirty++,this}destroy(){super.destroy();for(let s=0;s<this.graphicsData.length;++s)this.graphicsData[s].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(s){let t=this.graphicsData;for(let e=0;e<t.length;++e){let i=t[e];if(!!i.fillStyle.visible&&i.shape&&(i.matrix?i.matrix.applyInverse(s,qh):qh.copyFrom(s),i.shape.contains(qh.x,qh.y))){let r=!1;if(i.holes){for(let n=0;n<i.holes.length;n++)if(i.holes[n].shape.contains(qh.x,qh.y)){r=!0;break}}if(!r)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;let s=this.uvs,t=this.graphicsData,e=null,i=null;this.batches.length>0&&(e=this.batches[this.batches.length-1],i=e.style);for(let a=this.shapeIndex;a<t.length;a++){this.shapeIndex++;let o=t[a],h=o.fillStyle,c=o.lineStyle;Ku[o.type].build(o),o.matrix&&this.transformPoints(o.points,o.matrix),(h.visible||c.visible)&&this.processHoles(o.holes);for(let d=0;d<2;d++){let f=d===0?h:c;if(!f.visible)continue;let m=f.texture.baseTexture,p=this.indices.length,g=this.points.length/2;m.wrapMode=Ir.REPEAT,d===0?this.processFill(o):this.processLine(o);let y=this.points.length/2-g;y!==0&&(e&&!this._compareStyles(i,f)&&(e.end(p,g),e=null),e||(e=tm.pop()||new $h,e.begin(f,p,g),this.batches.push(e),i=f),this.addUvs(this.points,s,f.texture,g,y,f.matrix))}}let r=this.indices.length,n=this.points.length/2;if(e&&e.end(r,n),this.batches.length===0){this.batchable=!0;return}let l=n>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&l===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=l?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(s,t){return!(!s||!t||s.texture.baseTexture!==t.texture.baseTexture||s.color+s.alpha!==t.color+t.alpha||!!s.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let s=0,t=this.graphicsData.length;s<t;s++){let e=this.graphicsData[s],i=e.fillStyle,r=e.lineStyle;if(i&&!i.texture.baseTexture.valid||r&&!r.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);let s=this.batches;for(let t=0,e=s.length;t<e;t++){let i=s[t];for(let r=0;r<i.size;r++){let n=i.start+r;this.indicesUint16[n]=this.indicesUint16[n]-i.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;let s=this.batches;for(let t=0;t<s.length;t++)if(s[t].style.native)return!1;return this.points.length<b0.BATCHABLE_SIZE*2}buildDrawCalls(){let s=++lt._globalBatch;for(let c=0;c<this.drawCalls.length;c++)this.drawCalls[c].texArray.clear(),Hh.push(this.drawCalls[c]);this.drawCalls.length=0;let t=this.colors,e=this.textureIds,i=Hh.pop();i||(i=new an,i.texArray=new un),i.texArray.count=0,i.start=0,i.size=0,i.type=Be.TRIANGLES;let r=0,n=null,l=0,a=!1,o=Be.TRIANGLES,h=0;this.drawCalls.push(i);for(let c=0;c<this.batches.length;c++){let u=this.batches[c],d=8,f=u.style,m=f.texture.baseTexture;a!==!!f.native&&(a=!!f.native,o=a?Be.LINES:Be.TRIANGLES,n=null,r=d,s++),n!==m&&(n=m,m._batchEnabled!==s&&(r===d&&(s++,r=0,i.size>0&&(i=Hh.pop(),i||(i=new an,i.texArray=new un),this.drawCalls.push(i)),i.start=h,i.size=0,i.texArray.count=0,i.type=o),m.touched=1,m._batchEnabled=s,m._batchLocation=r,m.wrapMode=Ir.REPEAT,i.texArray.elements[i.texArray.count++]=m,r++)),i.size+=u.size,h+=u.size,l=m._batchLocation,this.addColors(t,f.color,f.alpha,u.attribSize,u.attribStart),this.addTextureIds(e,l,u.attribSize,u.attribStart)}lt._globalBatch=s,this.packAttributes()}packAttributes(){let s=this.points,t=this.uvs,e=this.colors,i=this.textureIds,r=new ArrayBuffer(s.length*3*4),n=new Float32Array(r),l=new Uint32Array(r),a=0;for(let o=0;o<s.length/2;o++)n[a++]=s[o*2],n[a++]=s[o*2+1],n[a++]=t[o*2],n[a++]=t[o*2+1],l[a++]=e[o],n[a++]=i[o];this._buffer.update(r),this._indexBuffer.update(this.indicesUint16)}processFill(s){s.holes.length?Wh.triangulate(s,this):Ku[s.type].triangulate(s,this)}processLine(s){zu(s,this);for(let t=0;t<s.holes.length;t++)zu(s.holes[t],this)}processHoles(s){for(let t=0;t<s.length;t++){let e=s[t];Ku[e.type].build(e),e.matrix&&this.transformPoints(e.points,e.matrix)}}calculateBounds(){let s=this._bounds;s.clear(),s.addVertexData(this.points,0,this.points.length),s.pad(this.boundsPadding,this.boundsPadding)}transformPoints(s,t){for(let e=0;e<s.length/2;e++){let i=s[e*2],r=s[e*2+1];s[e*2]=t.a*i+t.c*r+t.tx,s[e*2+1]=t.b*i+t.d*r+t.ty}}addColors(s,t,e,i,r=0){let n=(t>>16)+(t&65280)+((t&255)<<16),l=et.premultiplyTint(n,e);s.length=Math.max(s.length,r+i);for(let a=0;a<i;a++)s[r+a]=l}addTextureIds(s,t,e,i=0){s.length=Math.max(s.length,i+e);for(let r=0;r<e;r++)s[i+r]=t}addUvs(s,t,e,i,r,n=null){let l=0,a=t.length,o=e.frame;for(;l<r;){let c=s[(i+l)*2],u=s[(i+l)*2+1];if(n){let d=n.a*c+n.c*u+n.tx;u=n.b*c+n.d*u+n.ty,c=d}l++,t.push(c/o.width,u/o.height)}let h=e.baseTexture;(o.width<h.width||o.height<h.height)&&this.adjustUvs(t,e,a,r)}adjustUvs(s,t,e,i){let r=t.baseTexture,n=1e-6,l=e+i*2,a=t.frame,o=a.width/r.width,h=a.height/r.height,c=a.x/a.width,u=a.y/a.height,d=Math.floor(s[e]+n),f=Math.floor(s[e+1]+n);for(let m=e+2;m<l;m+=2)d=Math.min(d,Math.floor(s[m]+n)),f=Math.min(f,Math.floor(s[m+1]+n));c-=d,u-=f;for(let m=e;m<l;m+=2)s[m]=(s[m]+c)*o,s[m+1]=(s[m+1]+u)*h}},em=b0;em.BATCHABLE_SIZE=100;var Pr=class{constructor(){this.color=16777215,this.alpha=1,this.texture=rt.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){let t=new Pr;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=rt.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}};var gl=class extends Pr{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=xi.BUTT,this.join=ei.MITER,this.miterLimit=10}clone(){let t=new gl;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}};var gI=new Float32Array(3),Qp={},sm=class extends ae{constructor(s=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new Pr,this._lineStyle=new gl,this._matrix=null,this._holeMode=!1,this.state=He.for2d(),this._geometry=s||new em,this._geometry.refCount++,this._transformID=-1,this.tint=16777215,this.blendMode=Z.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new sm(this._geometry)}set blendMode(s){this.state.blendMode=s}get blendMode(){return this.state.blendMode}get tint(){return this._tint}set tint(s){this._tint=s}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(s=null,t=0,e=1,i=.5,r=!1){return typeof s=="number"&&(s={width:s,color:t,alpha:e,alignment:i,native:r}),this.lineTextureStyle(s)}lineTextureStyle(s){s=Object.assign({width:0,texture:rt.WHITE,color:s!=null&&s.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:xi.BUTT,join:ei.MITER,miterLimit:10},s),this.currentPath&&this.startPoly();let t=s.width>0&&s.alpha>0;return t?(s.matrix&&(s.matrix=s.matrix.clone(),s.matrix.invert()),Object.assign(this._lineStyle,{visible:t},s)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){let s=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new ks,this.currentPath.closeStroke=!1,this.currentPath.points.push(s[t-2],s[t-1]))}else this.currentPath=new ks,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(s,t){return this.startPoly(),this.currentPath.points[0]=s,this.currentPath.points[1]=t,this}lineTo(s,t){this.currentPath||this.moveTo(0,0);let e=this.currentPath.points,i=e[e.length-2],r=e[e.length-1];return(i!==s||r!==t)&&e.push(s,t),this}_initCurve(s=0,t=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[s,t]):this.moveTo(s,t)}quadraticCurveTo(s,t,e,i){this._initCurve();let r=this.currentPath.points;return r.length===0&&this.moveTo(0,0),yn.curveTo(s,t,e,i,r),this}bezierCurveTo(s,t,e,i,r,n){return this._initCurve(),_n.curveTo(s,t,e,i,r,n,this.currentPath.points),this}arcTo(s,t,e,i,r){this._initCurve(s,t);let n=this.currentPath.points,l=ml.curveTo(s,t,e,i,r,n);if(l){let{cx:a,cy:o,radius:h,startAngle:c,endAngle:u,anticlockwise:d}=l;this.arc(a,o,h,c,u,d)}return this}arc(s,t,e,i,r,n=!1){if(i===r)return this;if(!n&&r<=i?r+=hn:n&&i<=r&&(i+=hn),r-i===0)return this;let a=s+Math.cos(i)*e,o=t+Math.sin(i)*e,h=this._geometry.closePointEps,c=this.currentPath?this.currentPath.points:null;if(c){let u=Math.abs(c[c.length-2]-a),d=Math.abs(c[c.length-1]-o);u<h&&d<h||c.push(a,o)}else this.moveTo(a,o),c=this.currentPath.points;return ml.arc(a,o,s,t,e,i,r,n,c),this}beginFill(s=0,t=1){return this.beginTextureFill({texture:rt.WHITE,color:s,alpha:t})}beginTextureFill(s){s=Object.assign({texture:rt.WHITE,color:16777215,alpha:1,matrix:null},s),this.currentPath&&this.startPoly();let t=s.alpha>0;return t?(s.matrix&&(s.matrix=s.matrix.clone(),s.matrix.invert()),Object.assign(this._fillStyle,{visible:t},s)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(s,t,e,i){return this.drawShape(new ht(s,t,e,i))}drawRoundedRect(s,t,e,i,r){return this.drawShape(new Qa(s,t,e,i,r))}drawCircle(s,t,e){return this.drawShape(new Ka(s,t,e))}drawEllipse(s,t,e,i){return this.drawShape(new Za(s,t,e,i))}drawPolygon(...s){let t,e=!0,i=s[0];i.points?(e=i.closeStroke,t=i.points):Array.isArray(s[0])?t=s[0]:t=s;let r=new ks(t);return r.closeStroke=e,this.drawShape(r),this}drawShape(s){return this._holeMode?this._geometry.drawHole(s,this._matrix):this._geometry.drawShape(s,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){let s=this._geometry.graphicsData;return s.length===1&&s[0].shape.type===Ut.RECT&&!s[0].matrix&&!s[0].holes.length&&!(s[0].lineStyle.visible&&s[0].lineStyle.width)}_render(s){this.finishPoly();let t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(s)):(s.batch.flush(),this._renderDirect(s))}_populateBatches(){let s=this._geometry,t=this.blendMode,e=s.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=s.batchDirty,this.batches.length=e,this.vertexData=new Float32Array(s.points);for(let i=0;i<e;i++){let r=s.batches[i],n=r.style.color,l=new Float32Array(this.vertexData.buffer,r.attribStart*4*2,r.attribSize*2),a=new Float32Array(s.uvsFloat32.buffer,r.attribStart*4*2,r.attribSize*2),o=new Uint16Array(s.indicesUint16.buffer,r.start*2,r.size),h={vertexData:l,blendMode:t,indices:o,uvs:a,_batchRGB:et.hex2rgb(n),_tintRGB:n,_texture:r.style.texture,alpha:r.style.alpha,worldAlpha:1};this.batches[i]=h}}_renderBatched(s){if(!!this.batches.length){s.batch.setObjectRenderer(s.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,e=this.batches.length;t<e;t++){let i=this.batches[t];i.worldAlpha=this.worldAlpha*i.alpha,s.plugins[this.pluginName].render(i)}}}_renderDirect(s){let t=this._resolveDirectShader(s),e=this._geometry,i=this.tint,r=this.worldAlpha,n=t.uniforms,l=e.drawCalls;n.translationMatrix=this.transform.worldTransform,n.tint[0]=(i>>16&255)/255*r,n.tint[1]=(i>>8&255)/255*r,n.tint[2]=(i&255)/255*r,n.tint[3]=r,s.shader.bind(t),s.geometry.bind(e,t),s.state.set(this.state);for(let a=0,o=l.length;a<o;a++)this._renderDrawCallDirect(s,e.drawCalls[a])}_renderDrawCallDirect(s,t){let{texArray:e,type:i,size:r,start:n}=t,l=e.count;for(let a=0;a<l;a++)s.texture.bind(e.elements[a],a);s.geometry.draw(i,r,n)}_resolveDirectShader(s){let t=this.shader,e=this.pluginName;if(!t){if(!Qp[e]){let{maxTextures:i}=s.plugins[e],r=new Int32Array(i);for(let a=0;a<i;a++)r[a]=a;let n={tint:new Float32Array([1,1,1,1]),translationMatrix:new mt,default:ge.from({uSamplers:r},!0)},l=s.plugins[e]._shader.program;Qp[e]=new Ps(l,n)}t=Qp[e]}return t}_calculateBounds(){this.finishPoly();let s=this._geometry;if(!s.graphicsData.length)return;let{minX:t,minY:e,maxX:i,maxY:r}=s.bounds;this._bounds.addFrame(this.transform,t,e,i,r)}containsPoint(s){return this.worldTransform.applyInverse(s,sm._TEMP_POINT),this._geometry.containsPoint(sm._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this.tint;let s=et.hex2rgb(this.tint,gI);for(let t=0;t<this.batches.length;t++){let e=this.batches[t],i=e._batchRGB,r=s[0]*i[0]*255,n=s[1]*i[1]*255,l=s[2]*i[2]*255,a=(r<<16)+(n<<8)+(l|0);e._tintRGB=(a>>16)+(a&65280)+((a&255)<<16)}}}calculateVertices(){let s=this.transform._worldID;if(this._transformID===s)return;this._transformID=s;let t=this.transform.worldTransform,e=t.a,i=t.b,r=t.c,n=t.d,l=t.tx,a=t.ty,o=this._geometry.points,h=this.vertexData,c=0;for(let u=0;u<o.length;u+=2){let d=o[u],f=o[u+1];h[c++]=e*d+r*f+l,h[c++]=n*f+i*d+a}}closePath(){let s=this.currentPath;return s&&(s.closeStroke=!0,this.finishPoly()),this}setMatrix(s){return this._matrix=s,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(s){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(s)}},Me=sm;Me.curves=si;Me._TEMP_POINT=new Rt;var wn=[0,0,0],Zu=class extends ul{constructor(){super(...arguments),this.region=null,this.attachment=null}},Qu=class extends qu{constructor(t,e,i,r,n){super(t,e,i,r,n),this.region=null,this.attachment=null}},_0=class extends ae{constructor(s){if(super(),!s)throw new Error("The spineData param is required.");if(typeof s=="string")throw new Error('spineData param cant be string. Please use spine.Spine.fromAtlas("YOUR_RESOURCE_NAME") from now on.');this.spineData=s,this.createSkeleton(s),this.slotContainers=[],this.tempClipContainers=[];for(let t=0,e=this.skeleton.slots.length;t<e;t++){let i=this.skeleton.slots[t],r=i.getAttachment(),n=this.newContainer();if(this.slotContainers.push(n),this.addChild(n),this.tempClipContainers.push(null),!!r)if(r.type===tt.Region){let l=r.name,a=this.createSprite(i,r,l);i.currentSprite=a,i.currentSpriteName=l,n.addChild(a)}else if(r.type===tt.Mesh){let l=this.createMesh(i,r);i.currentMesh=l,i.currentMeshId=r.id,i.currentMeshName=r.name,n.addChild(l)}else r.type===tt.Clipping&&(this.createGraphics(i,r),n.addChild(i.clippingContainer),n.addChild(i.currentGraphics))}this.tintRgb=new Float32Array([1,1,1]),this.autoUpdate=!0,this.visible=!0}get debug(){return this._debug}set debug(s){var t;s!=this._debug&&((t=this._debug)==null||t.unregisterSpine(this),s==null||s.registerSpine(this),this._debug=s)}get autoUpdate(){return this._autoUpdate}set autoUpdate(s){s!==this._autoUpdate&&(this._autoUpdate=s,this.updateTransform=s?_0.prototype.autoUpdateTransform:ae.prototype.updateTransform)}get tint(){return et.rgb2hex(this.tintRgb)}set tint(s){this.tintRgb=et.hex2rgb(s,this.tintRgb)}get delayLimit(){return(typeof this.localDelayLimit!="undefined"?this.localDelayLimit:jt.GLOBAL_DELAY_LIMIT)||Number.MAX_VALUE}update(s){var h;let t=this.delayLimit;if(s>t&&(s=t),this.state.update(s),this.state.apply(this.skeleton),!this.skeleton)return;this.skeleton.updateWorldTransform();let e=this.skeleton.slots,i=this.color,r=null,n=null;i?(r=i.light,n=i.dark):r=this.tintRgb;for(let c=0,u=e.length;c<u;c++){let d=e[c],f=d.getAttachment(),m=this.slotContainers[c];if(!f){m.visible=!1;continue}let p=null;f.sequence&&f.sequence.apply(d,f);let g=f.region,y=f.color;switch(f!=null&&f.type){case tt.Region:if(m.transform.setFromMatrix(d.bone.matrix),g=f.region,d.currentMesh&&(d.currentMesh.visible=!1,d.currentMesh=null,d.currentMeshId=void 0,d.currentMeshName=void 0),!g){d.currentSprite&&(d.currentSprite.renderable=!1);break}if(!d.currentSpriteName||d.currentSpriteName!==f.name){let x=f.name;if(d.currentSprite&&(d.currentSprite.visible=!1),d.sprites=d.sprites||{},d.sprites[x]!==void 0)d.sprites[x].visible=!0;else{let v=this.createSprite(d,f,x);m.addChild(v)}d.currentSprite=d.sprites[x],d.currentSpriteName=x}d.currentSprite.renderable=!0,d.hackRegion||this.setSpriteRegion(f,d.currentSprite,g),d.currentSprite.color?p=d.currentSprite.color:(wn[0]=r[0]*d.color.r*y.r,wn[1]=r[1]*d.color.g*y.g,wn[2]=r[2]*d.color.b*y.b,d.currentSprite.tint=et.rgb2hex(wn)),d.currentSprite.blendMode=d.blendMode;break;case tt.Mesh:if(d.currentSprite){d.currentSprite.visible=!1,d.currentSprite=null,d.currentSpriteName=void 0;let x=new cn;x._parentID=-1,x._worldID=m.transform._worldID,m.transform=x}if(!g){d.currentMesh&&(d.currentMesh.renderable=!1);break}let b=f.id;if(d.currentMeshId===void 0||d.currentMeshId!==b){let x=b;if(d.currentMesh&&(d.currentMesh.visible=!1),d.meshes=d.meshes||{},d.meshes[x]!==void 0)d.meshes[x].visible=!0;else{let v=this.createMesh(d,f);m.addChild(v)}d.currentMesh=d.meshes[x],d.currentMeshName=f.name,d.currentMeshId=x}d.currentMesh.renderable=!0,f.computeWorldVerticesOld(d,d.currentMesh.vertices),d.currentMesh.color?p=d.currentMesh.color:(wn[0]=r[0]*d.color.r*y.r,wn[1]=r[1]*d.color.g*y.g,wn[2]=r[2]*d.color.b*y.b,d.currentMesh.tint=et.rgb2hex(wn)),d.currentMesh.blendMode=d.blendMode,d.hackRegion||this.setMeshRegion(f,d.currentMesh,g);break;case tt.Clipping:d.currentGraphics||(this.createGraphics(d,f),m.addChild(d.clippingContainer),m.addChild(d.currentGraphics)),this.updateGraphics(d,f),m.alpha=1,m.visible=!0;continue;default:m.visible=!1;continue}if(m.visible=!0,p){let _=d.color.r*y.r,b=d.color.g*y.g,x=d.color.b*y.b;p.setLight(r[0]*_+n[0]*(1-_),r[1]*b+n[1]*(1-b),r[2]*x+n[2]*(1-x)),d.darkColor?(_=d.darkColor.r,b=d.darkColor.g,x=d.darkColor.b):(_=0,b=0,x=0),p.setDark(r[0]*_+n[0]*(1-_),r[1]*b+n[1]*(1-b),r[2]*x+n[2]*(1-x))}m.alpha=d.color.a}let l=this.skeleton.drawOrder,a=null,o=null;for(let c=0,u=l.length;c<u;c++){let d=e[l[c].data.index],f=this.slotContainers[l[c].data.index];if(o||f.parent!==null&&f.parent!==this&&(f.parent.removeChild(f),f.parent=this),d.currentGraphics&&d.getAttachment())o=d.clippingContainer,a=d.getAttachment(),o.children.length=0,this.children[c]=f,a.endSlot===d.data&&(a.endSlot=null);else if(o){let m=this.tempClipContainers[c];m||(m=this.tempClipContainers[c]=this.newContainer(),m.visible=!1),this.children[c]=m,f.parent=null,o.addChild(f),a.endSlot==d.data&&(o.renderable=!0,o=null,a=null)}else this.children[c]=f}(h=this._debug)==null||h.renderDebug(this)}setSpriteRegion(s,t,e){t.attachment===s&&t.region===e||(t.region=e,t.attachment=s,t.texture=e.texture,t.rotation=s.rotation*S.degRad,t.position.x=s.x,t.position.y=s.y,t.alpha=s.color.a,e.size?(t.scale.x=e.size.width/e.originalWidth,t.scale.y=-e.size.height/e.originalHeight):(t.scale.x=s.scaleX*s.width/e.originalWidth,t.scale.y=-s.scaleY*s.height/e.originalHeight))}setMeshRegion(s,t,e){t.attachment===s&&t.region===e||(t.region=e,t.attachment=s,t.texture=e.texture,e.texture.updateUvs(),t.uvBuffer.update(s.regionUVs))}autoUpdateTransform(){if(jt.GLOBAL_AUTO_UPDATE){this.lastTime=this.lastTime||Date.now();let s=(Date.now()-this.lastTime)*.001;this.lastTime=Date.now(),this.update(s)}else this.lastTime=0;ae.prototype.updateTransform.call(this)}createSprite(s,t,e){let i=t.region;s.hackAttachment===t&&(i=s.hackRegion);let r=i?i.texture:null,n=this.newSprite(r);return n.anchor.set(.5),i&&this.setSpriteRegion(t,n,t.region),s.sprites=s.sprites||{},s.sprites[e]=n,n}createMesh(s,t){let e=t.region;s.hackAttachment===t&&(e=s.hackRegion,s.hackAttachment=null,s.hackRegion=null);let i=this.newMesh(e?e.texture:null,new Float32Array(t.regionUVs.length),t.regionUVs,new Uint16Array(t.triangles),Be.TRIANGLES);return typeof i._canvasPadding!="undefined"&&(i._canvasPadding=1.5),i.alpha=t.color.a,i.region=t.region,e&&this.setMeshRegion(t,i,e),s.meshes=s.meshes||{},s.meshes[t.id]=i,i}createGraphics(s,t){let e=this.newGraphics(),i=new ks([]);return e.clear(),e.beginFill(16777215,1),e.drawPolygon(i),e.renderable=!1,s.currentGraphics=e,s.clippingContainer=this.newContainer(),s.clippingContainer.mask=s.currentGraphics,e}updateGraphics(s,t){let e=s.currentGraphics.geometry,i=e.graphicsData[0].shape.points,r=t.worldVerticesLength;i.length=r,t.computeWorldVertices(s,0,r,i,0,2),e.invalidate()}hackTextureBySlotIndex(s,t=null,e=null){let i=this.skeleton.slots[s];if(!i)return!1;let r=i.getAttachment(),n=r.region;return t?(n=new Rr,n.texture=t,n.size=e,i.hackRegion=n,i.hackAttachment=r):(i.hackRegion=null,i.hackAttachment=null),i.currentSprite?this.setSpriteRegion(r,i.currentSprite,n):i.currentMesh&&this.setMeshRegion(r,i.currentMesh,n),!0}hackTextureBySlotName(s,t=null,e=null){let i=this.skeleton.findSlotIndex(s);return i==-1?!1:this.hackTextureBySlotIndex(i,t,e)}hackTextureAttachment(s,t,e,i=null){let r=this.skeleton.findSlotIndex(s),n=this.skeleton.getAttachmentByName(s,t);n.region.texture=e;let l=this.skeleton.slots[r];if(!l)return!1;let a=l.getAttachment();if(t===a.name){let o=n.region;return e?(o=new Rr,o.texture=e,o.size=i,l.hackRegion=o,l.hackAttachment=a):(l.hackRegion=null,l.hackAttachment=null),l.currentSprite&&l.currentSprite.region!=o?(this.setSpriteRegion(a,l.currentSprite,o),l.currentSprite.region=o):l.currentMesh&&l.currentMesh.region!=o&&this.setMeshRegion(a,l.currentMesh,o),!0}return!1}newContainer(){return new ae}newSprite(s){return new Zu(s)}newGraphics(){return new Me}newMesh(s,t,e,i,r){return new Qu(s,t,e,i,r)}transformHack(){return 1}hackAttachmentGroups(s,t,e){if(!s)return;let i=[],r=[];for(let n=0,l=this.skeleton.slots.length;n<l;n++){let a=this.skeleton.slots[n],o=a.currentSpriteName||a.currentMeshName||"",h=a.currentSprite||a.currentMesh;o.endsWith(s)?(h.parentGroup=t,r.push(h)):e&&h&&(h.parentGroup=e,i.push(h))}return[i,r]}destroy(s){this.debug=null;for(let t=0,e=this.skeleton.slots.length;t<e;t++){let i=this.skeleton.slots[t];for(let r in i.meshes)i.meshes[r].destroy(s);i.meshes=null;for(let r in i.sprites)i.sprites[r].destroy(s);i.sprites=null}for(let t=0,e=this.slotContainers.length;t<e;t++)this.slotContainers[t].destroy(s);this.spineData=null,this.skeleton=null,this.slotContainers=null,this.stateData=null,this.state=null,this.tempClipContainers=null,super.destroy(s)}},ii=_0;ii.clippingPolygon=[];Object.defineProperty(ii.prototype,"visible",{get(){return this._visible},set(s){s!==this._visible&&(this._visible=s,s&&(this.lastTime=0))}});var im=class{constructor(){this.registeredSpines=new Map,this.drawDebug=!0,this.drawMeshHull=!0,this.drawMeshTriangles=!0,this.drawBones=!0,this.drawPaths=!0,this.drawBoundingBoxes=!0,this.drawClipping=!0,this.drawRegionAttachments=!0,this.lineWidth=1,this.regionAttachmentsColor=30975,this.meshHullColor=30975,this.meshTrianglesColor=16763904,this.clippingPolygonColor=16711935,this.boundingBoxesRectColor=65280,this.boundingBoxesPolygonColor=65280,this.boundingBoxesCircleColor=65280,this.pathsCurveColor=16711680,this.pathsLineColor=16711935,this.skeletonXYColor=16711680,this.bonesColor=61132}registerSpine(t){this.registeredSpines.has(t)&&console.warn("SpineDebugRenderer.registerSpine() - this spine is already registered!",t);let e={parentDebugContainer:new ae,bones:new ae,skeletonXY:new Me,regionAttachmentsShape:new Me,meshTrianglesLine:new Me,meshHullLine:new Me,clippingPolygon:new Me,boundingBoxesRect:new Me,boundingBoxesCircle:new Me,boundingBoxesPolygon:new Me,pathsCurve:new Me,pathsLine:new Me};e.parentDebugContainer.addChild(e.bones),e.parentDebugContainer.addChild(e.skeletonXY),e.parentDebugContainer.addChild(e.regionAttachmentsShape),e.parentDebugContainer.addChild(e.meshTrianglesLine),e.parentDebugContainer.addChild(e.meshHullLine),e.parentDebugContainer.addChild(e.clippingPolygon),e.parentDebugContainer.addChild(e.boundingBoxesRect),e.parentDebugContainer.addChild(e.boundingBoxesCircle),e.parentDebugContainer.addChild(e.boundingBoxesPolygon),e.parentDebugContainer.addChild(e.pathsCurve),e.parentDebugContainer.addChild(e.pathsLine),t.addChild(e.parentDebugContainer),this.registeredSpines.set(t,e)}renderDebug(t){this.registeredSpines.has(t)||this.registerSpine(t);let e=this.registeredSpines.get(t);e.skeletonXY.clear(),e.regionAttachmentsShape.clear(),e.meshTrianglesLine.clear(),e.meshHullLine.clear(),e.clippingPolygon.clear(),e.boundingBoxesRect.clear(),e.boundingBoxesCircle.clear(),e.boundingBoxesPolygon.clear(),e.pathsCurve.clear(),e.pathsLine.clear();for(let n=e.bones.children.length;n>0;n--)e.bones.children[n-1].destroy({children:!0,texture:!0,baseTexture:!0});let i=t.scale.x||t.scale.y||1,r=this.lineWidth/i;this.drawBones&&this.drawBonesFunc(t,e,r,i),this.drawPaths&&this.drawPathsFunc(t,e,r),this.drawBoundingBoxes&&this.drawBoundingBoxesFunc(t,e,r),this.drawClipping&&this.drawClippingFunc(t,e,r),(this.drawMeshHull||this.drawMeshTriangles)&&this.drawMeshHullAndMeshTriangles(t,e,r),this.drawRegionAttachments&&this.drawRegionAttachmentsFunc(t,e,r)}drawBonesFunc(t,e,i,r){let n=t.skeleton,l=n.x,a=n.y,o=n.bones;e.skeletonXY.lineStyle(i,this.skeletonXYColor,1);for(let c=0,u=o.length;c<u;c++){let d=o[c],f=d.data.length,m=l+d.matrix.tx,p=a+d.matrix.ty,g=l+f*d.matrix.a+d.matrix.tx,y=a+f*d.matrix.b+d.matrix.ty;if(d.data.name==="root"||d.data.parent===null)continue;let _=Math.abs(m-g),b=Math.abs(p-y),x=Math.pow(_,2),v=b,w=Math.pow(b,2),E=Math.sqrt(x+w),A=Math.pow(E,2),T=Math.PI/180,C=Math.acos((A+w-x)/(2*v*E))||0;if(E===0)continue;let R=new Me;e.bones.addChild(R);let N=E/50/r;R.beginFill(this.bonesColor,1),R.drawPolygon(0,0,0-N,E-N*3,0,E-N,0+N,E-N*3),R.endFill(),R.x=m,R.y=p,R.pivot.y=E;let P=0;m<g&&p<y?P=-C+180*T:m>g&&p<y?P=180*T+C:m>g&&p>y?P=-C:m<g&&p>y?P=C:p===y&&m<g?P=90*T:p===y&&m>g?P=-90*T:m===g&&p<y?P=180*T:m===g&&p>y&&(P=0),R.rotation=P,R.lineStyle(i+N/2.4,this.bonesColor,1),R.beginFill(0,.6),R.drawCircle(0,E,N*1.2),R.endFill()}let h=i*3;e.skeletonXY.moveTo(l-h,a-h),e.skeletonXY.lineTo(l+h,a+h),e.skeletonXY.moveTo(l+h,a-h),e.skeletonXY.lineTo(l-h,a+h)}drawRegionAttachmentsFunc(t,e,i){let n=t.skeleton.slots;e.regionAttachmentsShape.lineStyle(i,this.regionAttachmentsColor,1);for(let l=0,a=n.length;l<a;l++){let o=n[l],h=o.getAttachment();if(h==null||h.type!==tt.Region)continue;let c=h,u=new Float32Array(8);c.updateOffset&&c.updateOffset(),c.computeWorldVertices(o,u,0,2),e.regionAttachmentsShape.drawPolygon(Array.from(u.slice(0,8)))}}drawMeshHullAndMeshTriangles(t,e,i){let n=t.skeleton.slots;e.meshHullLine.lineStyle(i,this.meshHullColor,1),e.meshTrianglesLine.lineStyle(i,this.meshTrianglesColor,1);for(let l=0,a=n.length;l<a;l++){let o=n[l];if(!o.bone.active)continue;let h=o.getAttachment();if(h==null||h.type!==tt.Mesh)continue;let c=h,u=new Float32Array(c.worldVerticesLength),d=c.triangles,f=c.hullLength;if(c.computeWorldVertices(o,0,c.worldVerticesLength,u,0,2),this.drawMeshTriangles)for(let m=0,p=d.length;m<p;m+=3){let g=d[m]*2,y=d[m+1]*2,_=d[m+2]*2;e.meshTrianglesLine.moveTo(u[g],u[g+1]),e.meshTrianglesLine.lineTo(u[y],u[y+1]),e.meshTrianglesLine.lineTo(u[_],u[_+1])}if(this.drawMeshHull&&f>0){f=(f>>1)*2;let m=u[f-2],p=u[f-1];for(let g=0,y=f;g<y;g+=2){let _=u[g],b=u[g+1];e.meshHullLine.moveTo(_,b),e.meshHullLine.lineTo(m,p),m=_,p=b}}}}drawClippingFunc(t,e,i){let n=t.skeleton.slots;e.clippingPolygon.lineStyle(i,this.clippingPolygonColor,1);for(let l=0,a=n.length;l<a;l++){let o=n[l];if(!o.bone.active)continue;let h=o.getAttachment();if(h==null||h.type!==tt.Clipping)continue;let c=h,u=c.worldVerticesLength,d=new Float32Array(u);c.computeWorldVertices(o,0,u,d,0,2),e.clippingPolygon.drawPolygon(Array.from(d))}}drawBoundingBoxesFunc(t,e,i){e.boundingBoxesRect.lineStyle(i,this.boundingBoxesRectColor,5);let r=new ti;r.update(t.skeleton,!0),e.boundingBoxesRect.drawRect(r.minX,r.minY,r.getWidth(),r.getHeight());let n=r.polygons,l=(a,o,h)=>{if(e.boundingBoxesPolygon.lineStyle(i,this.boundingBoxesPolygonColor,1),e.boundingBoxesPolygon.beginFill(this.boundingBoxesPolygonColor,.1),h<3)throw new Error("Polygon must contain at least 3 vertices");let c=[],u=i*2;for(let d=0,f=a.length;d<f;d+=2){let m=a[d],p=a[d+1];e.boundingBoxesCircle.lineStyle(0),e.boundingBoxesCircle.beginFill(this.boundingBoxesCircleColor),e.boundingBoxesCircle.drawCircle(m,p,u),e.boundingBoxesCircle.endFill(),c.push(m,p)}e.boundingBoxesPolygon.drawPolygon(c),e.boundingBoxesPolygon.endFill()};for(let a=0,o=n.length;a<o;a++){let h=n[a];l(h,0,h.length)}}drawPathsFunc(t,e,i){let n=t.skeleton.slots;e.pathsCurve.lineStyle(i,this.pathsCurveColor,1),e.pathsLine.lineStyle(i,this.pathsLineColor,1);for(let l=0,a=n.length;l<a;l++){let o=n[l];if(!o.bone.active)continue;let h=o.getAttachment();if(h==null||h.type!==tt.Path)continue;let c=h,u=c.worldVerticesLength,d=new Float32Array(u);c.computeWorldVertices(o,0,u,d,0,2);let f=d[2],m=d[3],p=0,g=0;if(c.closed){let y=d[0],_=d[1],b=d[u-2],x=d[u-1];p=d[u-4],g=d[u-3],e.pathsCurve.moveTo(f,m),e.pathsCurve.bezierCurveTo(y,_,b,x,p,g),e.pathsLine.moveTo(f,m),e.pathsLine.lineTo(y,_),e.pathsLine.moveTo(p,g),e.pathsLine.lineTo(b,x)}u-=4;for(let y=4;y<u;y+=6){let _=d[y],b=d[y+1],x=d[y+2],v=d[y+3];p=d[y+4],g=d[y+5],e.pathsCurve.moveTo(f,m),e.pathsCurve.bezierCurveTo(_,b,x,v,p,g),e.pathsLine.moveTo(f,m),e.pathsLine.lineTo(_,b),e.pathsLine.moveTo(p,g),e.pathsLine.lineTo(x,v),f=p,m=g}}}unregisterSpine(t){this.registeredSpines.has(t)||console.warn("SpineDebugRenderer.unregisterSpine() - spine is not registered, can't unregister!",t),this.registeredSpines.get(t).parentDebugContainer.destroy({baseTexture:!0,children:!0,texture:!0}),this.registeredSpines.delete(t)}};var y0={loader:H.LoadParser,resolver:H.ResolveParser,cache:H.CacheParser,detection:H.DetectionParser};K.handle(H.Asset,s=>{let t=s.ref;Object.entries(y0).filter(([e])=>!!t[e]).forEach(([e,i])=>{var r;return K.add(Object.assign(t[e],{extension:(r=t[e].extension)!=null?r:i}))})},s=>{let t=s.ref;Object.keys(y0).filter(e=>!!t[e]).forEach(e=>K.remove(t[e]))});var rm=class{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}_next(){return $(this,null,function*(){if(this._assetList.length&&this._isActive){this._isLoading=!0;let t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<e;i++)t.push(this._assetList.pop());yield this._loader.load(t),this._isLoading=!1,this._next()}})}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}};function zh(s,t){if(Array.isArray(t)){for(let e of t)if(s.startsWith(`data:${e}`))return!0;return!1}return s.startsWith(`data:${t}`)}function gs(s,t){let e=s.split("?")[0],i=et.path.extname(e).toLowerCase();return Array.isArray(t)?t.includes(i):i===t}var qe=(s,t)=>(Array.isArray(s)||(s=[s]),t?s.map(e=>typeof e=="string"?t(e):e):s);function v0(s,t,e,i,r){let n=t[e];for(let l=0;l<n.length;l++){let a=n[l];e<t.length-1?v0(s.replace(i[e],a),t,e+1,i,r):r.push(s.replace(i[e],a))}}function nm(s){let t=/\{(.*?)\}/g,e=s.match(t),i=[];if(e){let r=[];e.forEach(n=>{let l=n.substring(1,n.length-1).split(",");r.push(l)}),v0(s,r,0,e,i)}else i.push(s);return i}var Or=s=>!Array.isArray(s);var Jp=class{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){let e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){let i=qe(t),r;for(let a=0;a<this.parsers.length;a++){let o=this.parsers[a];if(o.test(e)){r=o.getCacheableAssets(i,e);break}}r||(r={},i.forEach(a=>{r[a]=e}));let n=Object.keys(r),l={cacheKeys:n,keys:i};if(i.forEach(a=>{this._cacheMap.set(a,l)}),n.forEach(a=>{this._cache.has(a)&&this._cache.get(a)!==e&&console.warn("[Cache] already has key:",a),this._cache.set(a,r[a])}),e instanceof rt){let a=e;i.forEach(o=>{a.baseTexture!==rt.EMPTY.baseTexture&&lt.addToCache(a.baseTexture,o),rt.addToCache(a,o)})}}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}let e=this._cacheMap.get(t);e.cacheKeys.forEach(r=>{this._cache.delete(r)}),e.keys.forEach(r=>{this._cacheMap.delete(r)})}get parsers(){return this._parsers}},En=new Jp;var om=class{constructor(){this._parsers=[],this.promiseCache={}}reset(){this.promiseCache={}}_getLoadPromiseAndParser(t,e){let i={promise:null,parser:null};return i.promise=(()=>$(this,null,function*(){var n,l;let r=null;for(let a=0;a<this.parsers.length;a++){let o=this.parsers[a];if(o.load&&((n=o.test)==null?void 0:n.call(o,t,e,this))){r=yield o.load(t,e,this),i.parser=o;break}}if(!i.parser)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has being added`),null;for(let a=0;a<this.parsers.length;a++){let o=this.parsers[a];o.parse&&o.parse&&(yield(l=o.testParse)==null?void 0:l.call(o,r,e,this))&&(r=(yield o.parse(r,e,this))||r,i.parser=o)}return r}))(),i}load(t,e){return $(this,null,function*(){let i=0,r={},n=Or(t),l=qe(t,h=>({src:h})),a=l.length,o=l.map(h=>$(this,null,function*(){let c=et.path.toAbsolute(h.src);if(!r[h.src])try{this.promiseCache[c]||(this.promiseCache[c]=this._getLoadPromiseAndParser(c,h)),r[h.src]=yield this.promiseCache[c].promise,e&&e(++i/a)}catch(u){throw delete this.promiseCache[c],delete r[h.src],new Error(`[Loader.load] Failed to load ${c}.
${u}`)}}));return yield Promise.all(o),n?r[l[0].src]:r})}unload(t){return $(this,null,function*(){let i=qe(t,r=>({src:r})).map(r=>$(this,null,function*(){var a,o;let n=et.path.toAbsolute(r.src),l=this.promiseCache[n];if(l){let h=yield l.promise;(o=(a=l.parser)==null?void 0:a.unload)==null||o.call(a,h,r,this),delete this.promiseCache[n]}}));yield Promise.all(i)})}get parsers(){return this._parsers}};var xe=(s=>(s[s.Low=0]="Low",s[s.Normal=1]="Normal",s[s.High=2]="High",s))(xe||{});var tg={extension:{type:H.LoadParser,priority:xe.Low},test(s){return et.path.extname(s).toLowerCase()===".json"},load(s){return $(this,null,function*(){return yield(yield z.ADAPTER.fetch(s)).json()})}};K.add(tg);var eg={extension:{type:H.LoadParser,priority:xe.Low},test(s){return et.path.extname(s).toLowerCase()===".txt"},load(s){return $(this,null,function*(){return yield(yield z.ADAPTER.fetch(s)).text()})}};K.add(eg);var bI=["normal","bold","100","200","300","400","500","600","700","800","900"],_I=[".ttf",".otf",".woff",".woff2"],yI=["font/ttf","font/otf","font/woff","font/woff2"];function sg(s){let t=et.path.extname(s);return et.path.basename(s,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" ")}var ig={extension:{type:H.LoadParser,priority:xe.Low},test(s){return zh(s,yI)||gs(s,_I)},load(s,t){return $(this,null,function*(){var i,r,n,l,a,o;let e=z.ADAPTER.getFontFaceSet();if(e){let h=[],c=(r=(i=t.data)==null?void 0:i.family)!=null?r:sg(s),u=(a=(l=(n=t.data)==null?void 0:n.weights)==null?void 0:l.filter(f=>bI.includes(f)))!=null?a:["normal"],d=(o=t.data)!=null?o:{};for(let f=0;f<u.length;f++){let m=u[f],p=new FontFace(c,`url(${encodeURI(s)})`,pd(li({},d),{weight:m}));yield p.load(),e.add(p),h.push(p)}return h.length===1?h[0]:h}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null})},unload(s){(Array.isArray(s)?s:[s]).forEach(t=>z.ADAPTER.getFontFaceSet().delete(t))}};K.add(ig);var w0=0,rg,vI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",wI={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${vI}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},EI={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`},ng,og=class{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{let e=URL.createObjectURL(new Blob([wI.code],{type:"application/javascript"})),i=new Worker(e);i.addEventListener("message",r=>{i.terminate(),URL.revokeObjectURL(e),t(r.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}_initWorkers(){return $(this,null,function*(){this._initialized||(this._initialized=!0)})}getWorker(){rg===void 0&&(rg=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<rg&&(ng||(ng=URL.createObjectURL(new Blob([EI.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(ng),t.addEventListener("message",e=>{this.complete(e.data),this.returnWorker(e.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}_run(t,e){return $(this,null,function*(){yield this._initWorkers();let i=new Promise((r,n)=>{this.queue.push({id:t,arguments:e,resolve:r,reject:n})});return this.next(),i})}next(){if(!this.queue.length)return;let t=this.getWorker();if(!t)return;let e=this.queue.pop(),i=e.id;this.resolveHash[w0]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:w0++,id:i})}},ag=new og;function Kh(s,t,e){let i=new rt(s);return i.baseTexture.on("dispose",()=>{delete t.promiseCache[e]}),i}var AI=[".jpeg",".jpg",".png",".webp",".avif"],II=["image/jpeg","image/png","image/webp","image/avif"];function lg(s){return $(this,null,function*(){let t=yield z.ADAPTER.fetch(s);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${s}: ${t.status} ${t.statusText}`);let e=yield t.blob();return yield createImageBitmap(e)})}var Ui={extension:{type:H.LoadParser,priority:xe.High},config:{preferWorkers:!0},test(s){return zh(s,II)||gs(s,AI)},load(s,t,e){return $(this,null,function*(){let i=null;globalThis.createImageBitmap?this.config.preferWorkers&&(yield ag.isImageBitmapSupported())?i=yield ag.loadImageBitmap(s):i=yield lg(s):i=yield new Promise(n=>{i=new Image,i.crossOrigin="anonymous",i.src=s,i.complete?n(i):i.onload=()=>{n(i)}});let r=new lt(i,li({resolution:et.getResolutionOfUrl(s)},t.data));return r.resource.src=s,Kh(r,e,s)})},unload(s){s.destroy(!0)}};K.add(Ui);var hg={extension:{type:H.LoadParser,priority:xe.High},test(s){return et.path.extname(s).toLowerCase()===".svg"},testParse(s){return $(this,null,function*(){return Cr.test(s)})},parse(s,t,e){return $(this,null,function*(){var l,a,o;let i=new Cr(s,(l=t==null?void 0:t.data)==null?void 0:l.resourceOptions),r=new lt(i,li({resolution:et.getResolutionOfUrl(s)},t==null?void 0:t.data));r.resource.src=s;let n=Kh(r,e,s);return(o=(a=t==null?void 0:t.data)==null?void 0:a.resourceOptions)!=null&&o.autoLoad||(yield i.load()),n})},load(s,t){return $(this,null,function*(){return(yield z.ADAPTER.fetch(s)).text()})},unload:Ui.unload};K.add(hg);var am=class{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){var e,i,r;if(this._bundleIdConnector=(e=t.connector)!=null?e:this._bundleIdConnector,this._createBundleAssetId=(i=t.createBundleAssetId)!=null?i:this._createBundleAssetId,this._extractAssetIdFromBundle=(r=t.extractAssetIdFromBundle)!=null?r:this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{let e=t;this._defaultSearchParams=Object.keys(e).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(e[i])}`).join("&")}}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){let i=[];Array.isArray(e)?e.forEach(r=>{if(typeof r.name=="string"){let n=this._createBundleAssetId(t,r.name);i.push(n),this.add([r.name,n],r.srcs,r.data)}else{let n=r.name.map(l=>this._createBundleAssetId(t,l));n.forEach(l=>{i.push(l)}),this.add([...r.name,...n],r.srcs)}}):Object.keys(e).forEach(r=>{i.push(this._createBundleAssetId(t,r)),this.add([r,this._createBundleAssetId(t,r)],e[r])}),this._bundles[t]=i}add(t,e,i){let r=qe(t);r.forEach(l=>{this.hasKey(l)&&console.warn(`[Resolver] already has key: ${l} overwriting`)}),Array.isArray(e)||(typeof e=="string"?e=nm(e):e=[e]);let n=e.map(l=>{var o;let a=l;if(typeof l=="string"){let h=!1;for(let c=0;c<this._parsers.length;c++){let u=this._parsers[c];if(u.test(l)){a=u.parse(l),h=!0;break}}h||(a={src:l})}return a.format||(a.format=a.src.split(".").pop()),a.alias||(a.alias=r),(this._basePath||this._rootPath)&&(a.src=et.path.toAbsolute(a.src,this._basePath,this._rootPath)),a.src=this._appendDefaultSearchParams(a.src),a.data=(o=a.data)!=null?o:i,a});r.forEach(l=>{this._assetMap[l]=n})}resolveBundle(t){let e=Or(t);t=qe(t);let i={};return t.forEach(r=>{let n=this._bundles[r];if(n){let l=this.resolve(n),a={};for(let o in l){let h=l[o];a[this._extractAssetIdFromBundle(r,o)]=h}i[r]=a}}),e?i[t[0]]:i}resolveUrl(t){let e=this.resolve(t);if(typeof t!="string"){let i={};for(let r in e)i[r]=e[r].src;return i}return e.src}resolve(t){let e=Or(t);t=qe(t);let i={};return t.forEach(r=>{var n;if(!this._resolverHash[r])if(this._assetMap[r]){let l=this._assetMap[r],a=this._getPreferredOrder(l),o=l[0];a==null||a.priority.forEach(h=>{a.params[h].forEach(c=>{let u=l.filter(d=>d[h]?d[h]===c:!1);u.length&&(l=u)})}),this._resolverHash[r]=(n=l[0])!=null?n:o}else{let l=r;(this._basePath||this._rootPath)&&(l=et.path.toAbsolute(l,this._basePath,this._rootPath)),l=this._appendDefaultSearchParams(l),this._resolverHash[r]={src:l}}i[r]=this._resolverHash[r]}),e?i[t[0]]:i}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){let i=t[0],r=this._preferredOrder.find(n=>n.params.format.includes(i.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;let e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}};var lm=class{constructor(){this._detections=[],this._initialized=!1,this.resolver=new am,this.loader=new om,this.cache=En,this._backgroundLoader=new rm(this.loader),this._backgroundLoader.active=!0,this.reset()}init(){return $(this,arguments,function*(t={}){var n,l,a,o;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let h=t.manifest;typeof h=="string"&&(h=yield this.load(h)),this.resolver.addManifest(h)}let e=(l=(n=t.texturePreference)==null?void 0:n.resolution)!=null?l:1,i=typeof e=="number"?[e]:e,r=[];if((a=t.texturePreference)!=null&&a.format){let h=(o=t.texturePreference)==null?void 0:o.format;r=typeof h=="string"?[h]:h;for(let c of this._detections)(yield c.test())||(r=yield c.remove(r))}else for(let h of this._detections)(yield h.test())&&(r=yield h.add(r));this.resolver.prefer({params:{format:r,resolution:i}})})}add(t,e,i){this.resolver.add(t,e,i)}load(t,e){return $(this,null,function*(){this._initialized||(yield this.init());let i=Or(t),r=qe(t).map(a=>typeof a!="string"?(this.resolver.add(a.src,a),a.src):(this.resolver.hasKey(a)||this.resolver.add(a,a),a)),n=this.resolver.resolve(r),l=yield this._mapLoadToResolve(n,e);return i?l[r[0]]:l})}addBundle(t,e){this.resolver.addBundle(t,e)}loadBundle(t,e){return $(this,null,function*(){this._initialized||(yield this.init());let i=!1;typeof t=="string"&&(i=!0,t=[t]);let r=this.resolver.resolveBundle(t),n={},l=Object.keys(r),a=0,o=0,h=()=>{e==null||e(++a/o)},c=l.map(u=>{let d=r[u];return o+=Object.keys(d).length,this._mapLoadToResolve(d,h).then(f=>{n[u]=f})});return yield Promise.all(c),i?n[t[0]]:n})}backgroundLoad(t){return $(this,null,function*(){this._initialized||(yield this.init()),typeof t=="string"&&(t=[t]);let e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))})}backgroundLoadBundle(t){return $(this,null,function*(){this._initialized||(yield this.init()),typeof t=="string"&&(t=[t]);let e=this.resolver.resolveBundle(t);Object.values(e).forEach(i=>{this._backgroundLoader.add(Object.values(i))})})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return En.get(t);let e={};for(let i=0;i<t.length;i++)e[i]=En.get(t[i]);return e}_mapLoadToResolve(t,e){return $(this,null,function*(){let i=Object.values(t),r=Object.keys(t);this._backgroundLoader.active=!1;let n=yield this.loader.load(i,e);this._backgroundLoader.active=!0;let l={};return i.forEach((a,o)=>{let h=n[a.src],c=[a.src];a.alias&&c.push(...a.alias),l[r[o]]=h,En.set(c,h)}),l})}unload(t){return $(this,null,function*(){this._initialized||(yield this.init());let e=qe(t).map(r=>typeof r!="string"?r.src:r),i=this.resolver.resolve(e);yield this._unloadFromResolved(i)})}unloadBundle(t){return $(this,null,function*(){this._initialized||(yield this.init()),t=qe(t);let e=this.resolver.resolveBundle(t),i=Object.keys(e).map(r=>this._unloadFromResolved(e[r]));yield Promise.all(i)})}_unloadFromResolved(t){return $(this,null,function*(){let e=Object.values(t);e.forEach(i=>{En.remove(i.src)}),yield this.loader.unload(e)})}get detections(){return this._detections}get preferWorkers(){return Ui.config.preferWorkers}set preferWorkers(t){Ui.config.preferWorkers=t}},Ju=new lm;K.handleByList(H.LoadParser,Ju.loader.parsers).handleByList(H.ResolveParser,Ju.resolver.parsers).handleByList(H.CacheParser,Ju.cache.parsers).handleByList(H.DetectionParser,Ju.detections);var cg={extension:H.CacheParser,test:s=>Array.isArray(s)&&s.every(t=>t instanceof rt),getCacheableAssets:(s,t)=>{let e={};return s.forEach(i=>{t.forEach((r,n)=>{e[i+(n===0?"":n+1)]=r})}),e}};K.add(cg);var ug={extension:{type:H.DetectionParser,priority:1},test:()=>$(void 0,null,function*(){if(!globalThis.createImageBitmap)return!1;let s="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",t=yield z.ADAPTER.fetch(s).then(e=>e.blob());return createImageBitmap(t).then(()=>!0,()=>!1)}),add:s=>$(void 0,null,function*(){return[...s,"avif"]}),remove:s=>$(void 0,null,function*(){return s.filter(t=>t!=="avif")})};K.add(ug);var dg={extension:{type:H.DetectionParser,priority:0},test:()=>$(void 0,null,function*(){if(!globalThis.createImageBitmap)return!1;let s="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",t=yield z.ADAPTER.fetch(s).then(e=>e.blob());return createImageBitmap(t).then(()=>!0,()=>!1)}),add:s=>$(void 0,null,function*(){return[...s,"webp"]}),remove:s=>$(void 0,null,function*(){return s.filter(t=>t!=="webp")})};K.add(dg);var E0=["png","jpg","jpeg"],fg={extension:{type:H.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:s=>$(void 0,null,function*(){return[...s,...E0]}),remove:s=>$(void 0,null,function*(){return s.filter(t=>!E0.includes(t))})};K.add(fg);var mg={extension:H.ResolveParser,test:Ui.test,parse:s=>{var t,e;return{resolution:parseFloat((e=(t=z.RETINA_PREFIX.exec(s))==null?void 0:t[1])!=null?e:"1"),format:s.split(".").pop(),src:s}}};K.add(mg);var TI={extension:H.Asset,loader:{extension:{type:H.LoadParser,priority:xe.Normal},test(s){return gs(s,".atlas")},load(s){return $(this,null,function*(){return yield(yield z.ADAPTER.fetch(s)).text()})},testParse(s,t){let e=gs(t.src,".atlas"),i=typeof s=="string";return Promise.resolve(e&&i)},parse(s,t,e){return $(this,null,function*(){let i=t.data,r=et.path.dirname(t.src);r&&r.lastIndexOf("/")!==r.length-1&&(r+="/");let n=null,l=null,a=new Promise((c,u)=>{n=c,l=u}),o,h=c=>{c||l(`Something went terribly wrong loading a spine .atlas file
Most likely your texture failed to load.`),n(o)};if(i.image||i.images){let c=Object.assign(i.image?{default:i.image}:{},i.images);o=new Mr(s,(u,d)=>{let f=c[u]||c.default;f&&f.baseTexture?d(f.baseTexture):d(f)},h)}else o=new Mr(s,hm(e,r,i.imageMetadata),h);return yield a})},unload(s){s.dispose()}}},hm=(s,t,e)=>(i,r)=>$(void 0,null,function*(){let n=et.path.join(...t.split(et.path.sep),i),l=yield s.load({src:n,data:e});r(l.baseTexture)});K.add(TI);function A0(s){return s.hasOwnProperty("bones")}function SI(s){return s instanceof ArrayBuffer}var td=class{constructor(){}installLoader(){let t=this,e={extension:H.Asset,loader:{extension:{type:H.LoadParser,priority:xe.Normal},test(r){return gs(r,".skel")},load(r){return $(this,null,function*(){return yield(yield z.ADAPTER.fetch(r)).arrayBuffer()})},testParse(r,n){var h;let l=gs(n.src,".json")&&A0(r),a=gs(n.src,".skel")&&SI(r),o=((h=n.data)==null?void 0:h.spineAtlas)===!1;return Promise.resolve(l&&!o||a)},parse(r,n,l){return $(this,null,function*(){var b;let a=et.path.extname(n.src).toLowerCase(),o=et.path.basename(n.src,a),h=et.path.dirname(n.src);h&&h.lastIndexOf("/")!==h.length-1&&(h+="/");let c=gs(n.src,".json")&&A0(r),u=null,d=r;c?u=t.createJsonParser():(u=t.createBinaryParser(),d=new Uint8Array(r));let f=n.data||{},m=(b=f==null?void 0:f.spineSkeletonScale)!=null?b:null;m&&(u.scale=m);let p=f.spineAtlas;if(p&&p.pages)return t.parseData(u,p,d);let g=f.atlasRawData;if(g){let x=null,v=null,w=new Promise((T,C)=>{x=T,v=C}),E=new Mr(g,hm(l,h,f.imageMetadata),T=>{T||v(`Something went terribly wrong loading a spine .atlas file
Most likely your texture failed to load.`),x(E)}),A=yield w;return t.parseData(u,A,d)}let y=f.spineAtlasFile;y||(y=`${h+o}.atlas`);let _=yield l.load({src:y,data:f,alias:f.spineAtlasAlias});return t.parseData(u,_,d)})}}};return K.add(e),e}};var pm={};Tc(pm,{Animation:()=>Dt,AnimationState:()=>ts,AnimationStateAdapter:()=>um,AnimationStateData:()=>sd,AtlasAttachmentLoader:()=>bl,Attachment:()=>xl,AttachmentTimeline:()=>Ds,Bone:()=>_l,BoneData:()=>Mn,BoundingBoxAttachment:()=>An,ClippingAttachment:()=>In,ColorTimeline:()=>Ee,ConstraintData:()=>Vi,CurveTimeline:()=>Qe,DeformTimeline:()=>Rn,DrawOrderTimeline:()=>ri,Event:()=>kn,EventData:()=>Pn,EventQueue:()=>dm,EventTimeline:()=>Di,EventType:()=>Je,IkConstraint:()=>Zh,IkConstraintData:()=>On,IkConstraintTimeline:()=>de,JitterEffect:()=>cm,MeshAttachment:()=>Ls,PathAttachment:()=>Us,PathConstraint:()=>Fn,PathConstraintData:()=>Nn,PathConstraintMixTimeline:()=>xs,PathConstraintPositionTimeline:()=>Vs,PathConstraintSpacingTimeline:()=>Ve,PointAttachment:()=>Tn,RegionAttachment:()=>ct,RotateTimeline:()=>he,ScaleTimeline:()=>be,ShearTimeline:()=>_e,Skeleton:()=>rd,SkeletonBinary:()=>Zt,SkeletonBounds:()=>fm,SkeletonData:()=>Bn,SkeletonJson:()=>ni,Skin:()=>Fr,SkinEntry:()=>Jh,Slot:()=>Sn,SlotData:()=>Ln,SpacingMode:()=>ie,Spine:()=>mm,SwirlEffect:()=>pg,TimelineType:()=>gg,TrackEntry:()=>ed,TransformConstraint:()=>Qh,TransformConstraintData:()=>Un,TransformConstraintTimeline:()=>Ae,TranslateTimeline:()=>Ge,TwoColorTimeline:()=>Wt,VertexAttachment:()=>ze});var xl=class{constructor(t){if(t==null)throw new Error("name cannot be null.");this.name=t}},I0=class extends xl{constructor(s){super(s),this.id=(I0.nextID++&65535)<<11,this.worldVerticesLength=0,this.deformAttachment=this}computeWorldVerticesOld(s,t){this.computeWorldVertices(s,0,this.worldVerticesLength,t,0,2)}computeWorldVertices(s,t,e,i,r,n){e=r+(e>>1)*n;let l=s.bone.skeleton,a=s.deform,o=this.vertices,h=this.bones;if(h==null){a.length>0&&(o=a);let f=s.bone.matrix,m=f.tx,p=f.ty,g=f.a,y=f.c,_=f.b,b=f.d;for(let x=t,v=r;v<e;x+=2,v+=n){let w=o[x],E=o[x+1];i[v]=w*g+E*y+m,i[v+1]=w*_+E*b+p}return}let c=0,u=0;for(let f=0;f<t;f+=2){let m=h[c];c+=m+1,u+=m}let d=l.bones;if(a.length==0)for(let f=r,m=u*3;f<e;f+=n){let p=0,g=0,y=h[c++];for(y+=c;c<y;c++,m+=3){let _=d[h[c]].matrix,b=o[m],x=o[m+1],v=o[m+2];p+=(b*_.a+x*_.c+_.tx)*v,g+=(b*_.b+x*_.d+_.ty)*v}i[f]=p,i[f+1]=g}else{let f=a;for(let m=r,p=u*3,g=u<<1;m<e;m+=n){let y=0,_=0,b=h[c++];for(b+=c;c<b;c++,p+=3,g+=2){let x=d[h[c]].matrix,v=o[p]+f[g],w=o[p+1]+f[g+1],E=o[p+2];y+=(v*x.a+w*x.c+x.tx)*E,_+=(v*x.b+w*x.d+x.ty)*E}i[m]=y,i[m+1]=_}}}copyTo(s){this.bones!=null?(s.bones=new Array(this.bones.length),k.arrayCopy(this.bones,0,s.bones,0,this.bones.length)):s.bones=null,this.vertices!=null?(s.vertices=k.newFloatArray(this.vertices.length),k.arrayCopy(this.vertices,0,s.vertices,0,this.vertices.length)):s.vertices=null,s.worldVerticesLength=this.worldVerticesLength,s.deformAttachment=this.deformAttachment}},ze=I0;ze.nextID=0;var An=class extends ze{constructor(t){super(t),this.type=tt.BoundingBox,this.color=new G(1,1,1,1)}copy(){let t=new An(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t}};var In=class extends ze{constructor(t){super(t),this.type=tt.Clipping,this.color=new G(.2275,.2275,.8078,1)}copy(){let t=new In(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t}};var Ls=class extends ze{constructor(t){super(t),this.type=tt.Mesh,this.color=new G(1,1,1,1),this.tempColor=new G(0,0,0,0)}getParentMesh(){return this.parentMesh}setParentMesh(t){this.parentMesh=t,t!=null&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}copy(){if(this.parentMesh!=null)return this.newLinkedMesh();let t=new Ls(this.name);return t.region=this.region,t.path=this.path,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Float32Array(this.regionUVs.length),k.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.triangles=new Array(this.triangles.length),k.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,this.edges!=null&&(t.edges=new Array(this.edges.length),k.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t}newLinkedMesh(){let t=new Ls(this.name);return t.region=this.region,t.path=this.path,t.color.setFromColor(this.color),t.deformAttachment=this.deformAttachment,t.setParentMesh(this.parentMesh!=null?this.parentMesh:this),t}};var Us=class extends ze{constructor(t){super(t),this.type=tt.Path,this.closed=!1,this.constantSpeed=!1,this.color=new G(1,1,1,1)}copy(){let t=new Us(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),k.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t}};var Tn=class extends ze{constructor(t){super(t),this.type=tt.Point,this.color=new G(.38,.94,0,1)}computeWorldPosition(t,e){let i=t.matrix;return e.x=this.x*i.a+this.y*i.c+t.worldX,e.y=this.x*i.b+this.y*i.d+t.worldY,e}computeWorldRotation(t){let e=t.matrix,i=S.cosDeg(this.rotation),r=S.sinDeg(this.rotation),n=i*e.a+r*e.c,l=i*e.b+r*e.d;return Math.atan2(l,n)*S.radDeg}copy(){let t=new Tn(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t}};var Sn=class{constructor(t,e){if(this.deform=new Array,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new G,this.darkColor=t.darkColor==null?null:new G,this.setToSetupPose(),this.blendMode=this.data.blendMode}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.deform.length=0)}setAttachmentTime(t){this.attachmentTime=this.bone.skeleton.time-t}getAttachmentTime(){return this.bone.skeleton.time-this.attachmentTime}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor!=null&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName==null?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))}};var we=class extends xl{constructor(s){super(s),this.type=tt.Region,this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new G(1,1,1,1),this.offset=k.newFloatArray(8),this.uvs=k.newFloatArray(8),this.tempColor=new G(1,1,1,1)}updateOffset(){let s=this.width/this.region.originalWidth*this.scaleX,t=this.height/this.region.originalHeight*this.scaleY,e=-this.width/2*this.scaleX+this.region.offsetX*s,i=-this.height/2*this.scaleY+this.region.offsetY*t,r=e+this.region.width*s,n=i+this.region.height*t,l=this.rotation*Math.PI/180,a=Math.cos(l),o=Math.sin(l),h=e*a+this.x,c=e*o,u=i*a+this.y,d=i*o,f=r*a+this.x,m=r*o,p=n*a+this.y,g=n*o,y=this.offset;y[we.OX1]=h-d,y[we.OY1]=u+c,y[we.OX2]=h-g,y[we.OY2]=p+c,y[we.OX3]=f-g,y[we.OY3]=p+m,y[we.OX4]=f-d,y[we.OY4]=u+m}setRegion(s){this.region=s;let t=this.uvs;s.rotate?(t[2]=s.u,t[3]=s.v2,t[4]=s.u,t[5]=s.v,t[6]=s.u2,t[7]=s.v,t[0]=s.u2,t[1]=s.v2):(t[0]=s.u,t[1]=s.v2,t[2]=s.u,t[3]=s.v,t[4]=s.u2,t[5]=s.v,t[6]=s.u2,t[7]=s.v2)}computeWorldVertices(s,t,e,i){let r=this.offset,n=s instanceof Sn?s.bone.matrix:s.matrix,l=n.tx,a=n.ty,o=n.a,h=n.c,c=n.b,u=n.d,d=0,f=0;d=r[we.OX1],f=r[we.OY1],t[e]=d*o+f*h+l,t[e+1]=d*c+f*u+a,e+=i,d=r[we.OX2],f=r[we.OY2],t[e]=d*o+f*h+l,t[e+1]=d*c+f*u+a,e+=i,d=r[we.OX3],f=r[we.OY3],t[e]=d*o+f*h+l,t[e+1]=d*c+f*u+a,e+=i,d=r[we.OX4],f=r[we.OY4],t[e]=d*o+f*h+l,t[e+1]=d*c+f*u+a}copy(){let s=new we(this.name);return s.region=this.region,s.rendererObject=this.rendererObject,s.path=this.path,s.x=this.x,s.y=this.y,s.scaleX=this.scaleX,s.scaleY=this.scaleY,s.rotation=this.rotation,s.width=this.width,s.height=this.height,k.arrayCopy(this.uvs,0,s.uvs,0,8),k.arrayCopy(this.offset,0,s.offset,0,8),s.color.setFromColor(this.color),s}},ct=we;ct.OX1=0;ct.OY1=1;ct.OX2=2;ct.OY2=3;ct.OX3=4;ct.OY3=5;ct.OX4=6;ct.OY4=7;ct.X1=0;ct.Y1=1;ct.C1R=2;ct.C1G=3;ct.C1B=4;ct.C1A=5;ct.U1=6;ct.V1=7;ct.X2=8;ct.Y2=9;ct.C2R=10;ct.C2G=11;ct.C2B=12;ct.C2A=13;ct.U2=14;ct.V2=15;ct.X3=16;ct.Y3=17;ct.C3R=18;ct.C3G=19;ct.C3B=20;ct.C3A=21;ct.U3=22;ct.V3=23;ct.X4=24;ct.Y4=25;ct.C4R=26;ct.C4G=27;ct.C4B=28;ct.C4A=29;ct.U4=30;ct.V4=31;var cm=class{constructor(t,e){this.jitterX=0,this.jitterY=0,this.jitterX=t,this.jitterY=e}begin(t){}transform(t,e,i,r){t.x+=S.randomTriangular(-this.jitterX,this.jitterY),t.y+=S.randomTriangular(-this.jitterX,this.jitterY)}end(){}};var T0=class{constructor(s){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=s}begin(s){this.worldX=s.x+this.centerX,this.worldY=s.y+this.centerY}transform(s,t,e,i){let r=this.angle*S.degreesToRadians,n=s.x-this.worldX,l=s.y-this.worldY,a=Math.sqrt(n*n+l*l);if(a<this.radius){let o=T0.interpolation.apply(0,r,(this.radius-a)/this.radius),h=Math.cos(o),c=Math.sin(o);s.x=h*n-c*l+this.worldX,s.y=c*n+h*l+this.worldY}}end(){}},pg=T0;pg.interpolation=new xn(2);var Dt=class{constructor(t,e,i){if(t==null)throw new Error("name cannot be null.");if(e==null)throw new Error("timelines cannot be null.");this.name=t,this.timelines=e,this.timelineIds=[];for(let r=0;r<e.length;r++)this.timelineIds[e[r].getPropertyId()]=!0;this.duration=i}hasTimeline(t){return this.timelineIds[t]==!0}apply(t,e,i,r,n,l,a,o){if(t==null)throw new Error("skeleton cannot be null.");r&&this.duration!=0&&(i%=this.duration,e>0&&(e%=this.duration));let h=this.timelines;for(let c=0,u=h.length;c<u;c++)h[c].apply(t,e,i,n,l,a,o)}static binarySearch(t,e,i=1){let r=0,n=t.length/i-2;if(n==0)return i;let l=n>>>1;for(;;){if(t[(l+1)*i]<=e?r=l+1:n=l,r==n)return(r+1)*i;l=r+n>>>1}}static linearSearch(t,e,i){for(let r=0,n=t.length-i;r<=n;r+=i)if(t[r]>e)return r;return-1}},gg=(s=>(s[s.rotate=0]="rotate",s[s.translate=1]="translate",s[s.scale=2]="scale",s[s.shear=3]="shear",s[s.attachment=4]="attachment",s[s.color=5]="color",s[s.deform=6]="deform",s[s.event=7]="event",s[s.drawOrder=8]="drawOrder",s[s.ikConstraint=9]="ikConstraint",s[s.transformConstraint=10]="transformConstraint",s[s.pathConstraintPosition=11]="pathConstraintPosition",s[s.pathConstraintSpacing=12]="pathConstraintSpacing",s[s.pathConstraintMix=13]="pathConstraintMix",s[s.twoColor=14]="twoColor",s))(gg||{}),le=class{constructor(s){if(s<=0)throw new Error(`frameCount must be > 0: ${s}`);this.curves=k.newFloatArray((s-1)*le.BEZIER_SIZE)}getFrameCount(){return this.curves.length/le.BEZIER_SIZE+1}setLinear(s){this.curves[s*le.BEZIER_SIZE]=le.LINEAR}setStepped(s){this.curves[s*le.BEZIER_SIZE]=le.STEPPED}getCurveType(s){let t=s*le.BEZIER_SIZE;if(t==this.curves.length)return le.LINEAR;let e=this.curves[t];return e==le.LINEAR?le.LINEAR:e==le.STEPPED?le.STEPPED:le.BEZIER}setCurve(s,t,e,i,r){let n=(-t*2+i)*.03,l=(-e*2+r)*.03,a=((t-i)*3+1)*.006,o=((e-r)*3+1)*.006,h=n*2+a,c=l*2+o,u=t*.3+n+a*.16666667,d=e*.3+l+o*.16666667,f=s*le.BEZIER_SIZE,m=this.curves;m[f++]=le.BEZIER;let p=u,g=d;for(let y=f+le.BEZIER_SIZE-1;f<y;f+=2)m[f]=p,m[f+1]=g,u+=h,d+=c,h+=a,c+=o,p+=u,g+=d}getCurvePercent(s,t){t=S.clamp(t,0,1);let e=this.curves,i=s*le.BEZIER_SIZE,r=e[i];if(r==le.LINEAR)return t;if(r==le.STEPPED)return 0;i++;let n=0;for(let a=i,o=i+le.BEZIER_SIZE-1;i<o;i+=2)if(n=e[i],n>=t){let h,c;return i==a?(h=0,c=0):(h=e[i-2],c=e[i-1]),c+(e[i+1]-c)*(t-h)/(n-h)}let l=e[i-1];return l+(1-l)*(t-n)/(1-n)}},Qe=le;Qe.LINEAR=0;Qe.STEPPED=1;Qe.BEZIER=2;Qe.BEZIER_SIZE=10*2-1;var Cn=class extends Qe{constructor(s){super(s),this.frames=k.newFloatArray(s<<1)}getPropertyId(){return(0<<24)+this.boneIndex}setFrame(s,t,e){s<<=1,this.frames[s]=t,this.frames[s+Cn.ROTATION]=e}apply(s,t,e,i,r,n,l){let a=this.frames,o=s.bones[this.boneIndex];if(!o.active)return;if(e<a[0]){switch(n){case I.setup:o.rotation=o.data.rotation;return;case I.first:let m=o.data.rotation-o.rotation;o.rotation+=(m-(16384-(16384.499999999996-m/360|0))*360)*r}return}if(e>=a[a.length-Cn.ENTRIES]){let m=a[a.length+Cn.PREV_ROTATION];switch(n){case I.setup:o.rotation=o.data.rotation+m*r;break;case I.first:case I.replace:m+=o.data.rotation-o.rotation,m-=(16384-(16384.499999999996-m/360|0))*360;case I.add:o.rotation+=m*r}return}let h=Dt.binarySearch(a,e,Cn.ENTRIES),c=a[h+Cn.PREV_ROTATION],u=a[h],d=this.getCurvePercent((h>>1)-1,1-(e-u)/(a[h+Cn.PREV_TIME]-u)),f=a[h+Cn.ROTATION]-c;switch(f=c+(f-(16384-(16384.499999999996-f/360|0))*360)*d,n){case I.setup:o.rotation=o.data.rotation+(f-(16384-(16384.499999999996-f/360|0))*360)*r;break;case I.first:case I.replace:f+=o.data.rotation-o.rotation;case I.add:o.rotation+=(f-(16384-(16384.499999999996-f/360|0))*360)*r}}},he=Cn;he.ENTRIES=2;he.PREV_TIME=-2;he.PREV_ROTATION=-1;he.ROTATION=1;var Ke=class extends Qe{constructor(s){super(s),this.frames=k.newFloatArray(s*Ke.ENTRIES)}getPropertyId(){return(1<<24)+this.boneIndex}setFrame(s,t,e,i){s*=Ke.ENTRIES,this.frames[s]=t,this.frames[s+Ke.X]=e,this.frames[s+Ke.Y]=i}apply(s,t,e,i,r,n,l){let a=this.frames,o=s.bones[this.boneIndex];if(!o.active)return;if(e<a[0]){switch(n){case I.setup:o.x=o.data.x,o.y=o.data.y;return;case I.first:o.x+=(o.data.x-o.x)*r,o.y+=(o.data.y-o.y)*r}return}let h=0,c=0;if(e>=a[a.length-Ke.ENTRIES])h=a[a.length+Ke.PREV_X],c=a[a.length+Ke.PREV_Y];else{let u=Dt.binarySearch(a,e,Ke.ENTRIES);h=a[u+Ke.PREV_X],c=a[u+Ke.PREV_Y];let d=a[u],f=this.getCurvePercent(u/Ke.ENTRIES-1,1-(e-d)/(a[u+Ke.PREV_TIME]-d));h+=(a[u+Ke.X]-h)*f,c+=(a[u+Ke.Y]-c)*f}switch(n){case I.setup:o.x=o.data.x+h*r,o.y=o.data.y+c*r;break;case I.first:case I.replace:o.x+=(o.data.x+h-o.x)*r,o.y+=(o.data.y+c-o.y)*r;break;case I.add:o.x+=h*r,o.y+=c*r}}},Ge=Ke;Ge.ENTRIES=3;Ge.PREV_TIME=-3;Ge.PREV_X=-2;Ge.PREV_Y=-1;Ge.X=1;Ge.Y=2;var be=class extends Ge{constructor(t){super(t)}getPropertyId(){return(2<<24)+this.boneIndex}apply(t,e,i,r,n,l,a){let o=this.frames,h=t.bones[this.boneIndex];if(!h.active)return;if(i<o[0]){switch(l){case I.setup:h.scaleX=h.data.scaleX,h.scaleY=h.data.scaleY;return;case I.first:h.scaleX+=(h.data.scaleX-h.scaleX)*n,h.scaleY+=(h.data.scaleY-h.scaleY)*n}return}let c=0,u=0;if(i>=o[o.length-be.ENTRIES])c=o[o.length+be.PREV_X]*h.data.scaleX,u=o[o.length+be.PREV_Y]*h.data.scaleY;else{let d=Dt.binarySearch(o,i,be.ENTRIES);c=o[d+be.PREV_X],u=o[d+be.PREV_Y];let f=o[d],m=this.getCurvePercent(d/be.ENTRIES-1,1-(i-f)/(o[d+be.PREV_TIME]-f));c=(c+(o[d+be.X]-c)*m)*h.data.scaleX,u=(u+(o[d+be.Y]-u)*m)*h.data.scaleY}if(n==1)l==I.add?(h.scaleX+=c-h.data.scaleX,h.scaleY+=u-h.data.scaleY):(h.scaleX=c,h.scaleY=u);else{let d=0,f=0;if(a==at.mixOut)switch(l){case I.setup:d=h.data.scaleX,f=h.data.scaleY,h.scaleX=d+(Math.abs(c)*S.signum(d)-d)*n,h.scaleY=f+(Math.abs(u)*S.signum(f)-f)*n;break;case I.first:case I.replace:d=h.scaleX,f=h.scaleY,h.scaleX=d+(Math.abs(c)*S.signum(d)-d)*n,h.scaleY=f+(Math.abs(u)*S.signum(f)-f)*n;break;case I.add:d=h.scaleX,f=h.scaleY,h.scaleX=d+(Math.abs(c)*S.signum(d)-h.data.scaleX)*n,h.scaleY=f+(Math.abs(u)*S.signum(f)-h.data.scaleY)*n}else switch(l){case I.setup:d=Math.abs(h.data.scaleX)*S.signum(c),f=Math.abs(h.data.scaleY)*S.signum(u),h.scaleX=d+(c-d)*n,h.scaleY=f+(u-f)*n;break;case I.first:case I.replace:d=Math.abs(h.scaleX)*S.signum(c),f=Math.abs(h.scaleY)*S.signum(u),h.scaleX=d+(c-d)*n,h.scaleY=f+(u-f)*n;break;case I.add:d=S.signum(c),f=S.signum(u),h.scaleX=Math.abs(h.scaleX)*d+(c-Math.abs(h.data.scaleX)*d)*n,h.scaleY=Math.abs(h.scaleY)*f+(u-Math.abs(h.data.scaleY)*f)*n}}}},_e=class extends Ge{constructor(t){super(t)}getPropertyId(){return(3<<24)+this.boneIndex}apply(t,e,i,r,n,l,a){let o=this.frames,h=t.bones[this.boneIndex];if(!h.active)return;if(i<o[0]){switch(l){case I.setup:h.shearX=h.data.shearX,h.shearY=h.data.shearY;return;case I.first:h.shearX+=(h.data.shearX-h.shearX)*n,h.shearY+=(h.data.shearY-h.shearY)*n}return}let c=0,u=0;if(i>=o[o.length-_e.ENTRIES])c=o[o.length+_e.PREV_X],u=o[o.length+_e.PREV_Y];else{let d=Dt.binarySearch(o,i,_e.ENTRIES);c=o[d+_e.PREV_X],u=o[d+_e.PREV_Y];let f=o[d],m=this.getCurvePercent(d/_e.ENTRIES-1,1-(i-f)/(o[d+_e.PREV_TIME]-f));c=c+(o[d+_e.X]-c)*m,u=u+(o[d+_e.Y]-u)*m}switch(l){case I.setup:h.shearX=h.data.shearX+c*n,h.shearY=h.data.shearY+u*n;break;case I.first:case I.replace:h.shearX+=(h.data.shearX+c-h.shearX)*n,h.shearY+=(h.data.shearY+u-h.shearY)*n;break;case I.add:h.shearX+=c*n,h.shearY+=u*n}}},qt=class extends Qe{constructor(s){super(s),this.frames=k.newFloatArray(s*qt.ENTRIES)}getPropertyId(){return(5<<24)+this.slotIndex}setFrame(s,t,e,i,r,n){s*=qt.ENTRIES,this.frames[s]=t,this.frames[s+qt.R]=e,this.frames[s+qt.G]=i,this.frames[s+qt.B]=r,this.frames[s+qt.A]=n}apply(s,t,e,i,r,n,l){let a=s.slots[this.slotIndex];if(!a.bone.active)return;let o=this.frames;if(e<o[0]){switch(n){case I.setup:a.color.setFromColor(a.data.color);return;case I.first:let f=a.color,m=a.data.color;f.add((m.r-f.r)*r,(m.g-f.g)*r,(m.b-f.b)*r,(m.a-f.a)*r)}return}let h=0,c=0,u=0,d=0;if(e>=o[o.length-qt.ENTRIES]){let f=o.length;h=o[f+qt.PREV_R],c=o[f+qt.PREV_G],u=o[f+qt.PREV_B],d=o[f+qt.PREV_A]}else{let f=Dt.binarySearch(o,e,qt.ENTRIES);h=o[f+qt.PREV_R],c=o[f+qt.PREV_G],u=o[f+qt.PREV_B],d=o[f+qt.PREV_A];let m=o[f],p=this.getCurvePercent(f/qt.ENTRIES-1,1-(e-m)/(o[f+qt.PREV_TIME]-m));h+=(o[f+qt.R]-h)*p,c+=(o[f+qt.G]-c)*p,u+=(o[f+qt.B]-u)*p,d+=(o[f+qt.A]-d)*p}if(r==1)a.color.set(h,c,u,d);else{let f=a.color;n==I.setup&&f.setFromColor(a.data.color),f.add((h-f.r)*r,(c-f.g)*r,(u-f.b)*r,(d-f.a)*r)}}},Ee=qt;Ee.ENTRIES=5;Ee.PREV_TIME=-5;Ee.PREV_R=-4;Ee.PREV_G=-3;Ee.PREV_B=-2;Ee.PREV_A=-1;Ee.R=1;Ee.G=2;Ee.B=3;Ee.A=4;var vt=class extends Qe{constructor(s){super(s),this.frames=k.newFloatArray(s*vt.ENTRIES)}getPropertyId(){return(14<<24)+this.slotIndex}setFrame(s,t,e,i,r,n,l,a,o){s*=vt.ENTRIES,this.frames[s]=t,this.frames[s+vt.R]=e,this.frames[s+vt.G]=i,this.frames[s+vt.B]=r,this.frames[s+vt.A]=n,this.frames[s+vt.R2]=l,this.frames[s+vt.G2]=a,this.frames[s+vt.B2]=o}apply(s,t,e,i,r,n,l){let a=s.slots[this.slotIndex];if(!a.bone.active)return;let o=this.frames;if(e<o[0]){switch(n){case I.setup:a.color.setFromColor(a.data.color),a.darkColor.setFromColor(a.data.darkColor);return;case I.first:let g=a.color,y=a.darkColor,_=a.data.color,b=a.data.darkColor;g.add((_.r-g.r)*r,(_.g-g.g)*r,(_.b-g.b)*r,(_.a-g.a)*r),y.add((b.r-y.r)*r,(b.g-y.g)*r,(b.b-y.b)*r,0)}return}let h=0,c=0,u=0,d=0,f=0,m=0,p=0;if(e>=o[o.length-vt.ENTRIES]){let g=o.length;h=o[g+vt.PREV_R],c=o[g+vt.PREV_G],u=o[g+vt.PREV_B],d=o[g+vt.PREV_A],f=o[g+vt.PREV_R2],m=o[g+vt.PREV_G2],p=o[g+vt.PREV_B2]}else{let g=Dt.binarySearch(o,e,vt.ENTRIES);h=o[g+vt.PREV_R],c=o[g+vt.PREV_G],u=o[g+vt.PREV_B],d=o[g+vt.PREV_A],f=o[g+vt.PREV_R2],m=o[g+vt.PREV_G2],p=o[g+vt.PREV_B2];let y=o[g],_=this.getCurvePercent(g/vt.ENTRIES-1,1-(e-y)/(o[g+vt.PREV_TIME]-y));h+=(o[g+vt.R]-h)*_,c+=(o[g+vt.G]-c)*_,u+=(o[g+vt.B]-u)*_,d+=(o[g+vt.A]-d)*_,f+=(o[g+vt.R2]-f)*_,m+=(o[g+vt.G2]-m)*_,p+=(o[g+vt.B2]-p)*_}if(r==1)a.color.set(h,c,u,d),a.darkColor.set(f,m,p,1);else{let g=a.color,y=a.darkColor;n==I.setup&&(g.setFromColor(a.data.color),y.setFromColor(a.data.darkColor)),g.add((h-g.r)*r,(c-g.g)*r,(u-g.b)*r,(d-g.a)*r),y.add((f-y.r)*r,(m-y.g)*r,(p-y.b)*r,0)}}},Wt=vt;Wt.ENTRIES=8;Wt.PREV_TIME=-8;Wt.PREV_R=-7;Wt.PREV_G=-6;Wt.PREV_B=-5;Wt.PREV_A=-4;Wt.PREV_R2=-3;Wt.PREV_G2=-2;Wt.PREV_B2=-1;Wt.R=1;Wt.G=2;Wt.B=3;Wt.A=4;Wt.R2=5;Wt.G2=6;Wt.B2=7;var Ds=class{constructor(t){this.frames=k.newFloatArray(t),this.attachmentNames=new Array(t)}getPropertyId(){return(4<<24)+this.slotIndex}getFrameCount(){return this.frames.length}setFrame(t,e,i){this.frames[t]=e,this.attachmentNames[t]=i}apply(t,e,i,r,n,l,a){let o=t.slots[this.slotIndex];if(!o.bone.active)return;if(a==at.mixOut){l==I.setup&&this.setAttachment(t,o,o.data.attachmentName);return}let h=this.frames;if(i<h[0]){(l==I.setup||l==I.first)&&this.setAttachment(t,o,o.data.attachmentName);return}let c=0;i>=h[h.length-1]?c=h.length-1:c=Dt.binarySearch(h,i,1)-1;let u=this.attachmentNames[c];t.slots[this.slotIndex].setAttachment(u==null?null:t.getAttachment(this.slotIndex,u))}setAttachment(t,e,i){e.setAttachment(i==null?null:t.getAttachment(this.slotIndex,i))}},S0=null,Rn=class extends Qe{constructor(t){super(t),this.frames=k.newFloatArray(t),this.frameVertices=new Array(t),S0==null&&(S0=k.newFloatArray(64))}getPropertyId(){return(6<<27)+Number(this.attachment.id)+this.slotIndex}setFrame(t,e,i){this.frames[t]=e,this.frameVertices[t]=i}apply(t,e,i,r,n,l,a){let o=t.slots[this.slotIndex];if(!o.bone.active)return;let h=o.getAttachment();if(!(h instanceof ze)||h.deformAttachment!=this.attachment)return;let c=o.deform;c.length==0&&(l=I.setup);let u=this.frameVertices,d=u[0].length,f=this.frames;if(i<f[0]){let x=h;switch(l){case I.setup:c.length=0;return;case I.first:if(n==1){c.length=0;break}let v=k.setArraySize(c,d);if(x.bones==null){let w=x.vertices;for(let E=0;E<d;E++)v[E]+=(w[E]-v[E])*n}else{n=1-n;for(let w=0;w<d;w++)v[w]*=n}}return}let m=k.setArraySize(c,d);if(i>=f[f.length-1]){let x=u[f.length-1];if(n==1)if(l==I.add){let v=h;if(v.bones==null){let w=v.vertices;for(let E=0;E<d;E++)m[E]+=x[E]-w[E]}else for(let w=0;w<d;w++)m[w]+=x[w]}else k.arrayCopy(x,0,m,0,d);else switch(l){case I.setup:{let w=h;if(w.bones==null){let E=w.vertices;for(let A=0;A<d;A++){let T=E[A];m[A]=T+(x[A]-T)*n}}else for(let E=0;E<d;E++)m[E]=x[E]*n;break}case I.first:case I.replace:for(let w=0;w<d;w++)m[w]+=(x[w]-m[w])*n;break;case I.add:let v=h;if(v.bones==null){let w=v.vertices;for(let E=0;E<d;E++)m[E]+=(x[E]-w[E])*n}else for(let w=0;w<d;w++)m[w]+=x[w]*n}return}let p=Dt.binarySearch(f,i),g=u[p-1],y=u[p],_=f[p],b=this.getCurvePercent(p-1,1-(i-_)/(f[p-1]-_));if(n==1)if(l==I.add){let x=h;if(x.bones==null){let v=x.vertices;for(let w=0;w<d;w++){let E=g[w];m[w]+=E+(y[w]-E)*b-v[w]}}else for(let v=0;v<d;v++){let w=g[v];m[v]+=w+(y[v]-w)*b}}else for(let x=0;x<d;x++){let v=g[x];m[x]=v+(y[x]-v)*b}else switch(l){case I.setup:{let v=h;if(v.bones==null){let w=v.vertices;for(let E=0;E<d;E++){let A=g[E],T=w[E];m[E]=T+(A+(y[E]-A)*b-T)*n}}else for(let w=0;w<d;w++){let E=g[w];m[w]=(E+(y[w]-E)*b)*n}break}case I.first:case I.replace:for(let v=0;v<d;v++){let w=g[v];m[v]+=(w+(y[v]-w)*b-m[v])*n}break;case I.add:let x=h;if(x.bones==null){let v=x.vertices;for(let w=0;w<d;w++){let E=g[w];m[w]+=(E+(y[w]-E)*b-v[w])*n}}else for(let v=0;v<d;v++){let w=g[v];m[v]+=(w+(y[v]-w)*b)*n}}}},Di=class{constructor(t){this.frames=k.newFloatArray(t),this.events=new Array(t)}getPropertyId(){return 7<<24}getFrameCount(){return this.frames.length}setFrame(t,e){this.frames[t]=e.time,this.events[t]=e}apply(t,e,i,r,n,l,a){if(r==null)return;let o=this.frames,h=this.frames.length;if(e>i)this.apply(t,e,Number.MAX_VALUE,r,n,l,a),e=-1;else if(e>=o[h-1])return;if(i<o[0])return;let c=0;if(e<o[0])c=0;else{c=Dt.binarySearch(o,e);let u=o[c];for(;c>0&&o[c-1]==u;)c--}for(;c<h&&i>=o[c];c++)r.push(this.events[c])}},ri=class{constructor(t){this.frames=k.newFloatArray(t),this.drawOrders=new Array(t)}getPropertyId(){return 8<<24}getFrameCount(){return this.frames.length}setFrame(t,e,i){this.frames[t]=e,this.drawOrders[t]=i}apply(t,e,i,r,n,l,a){let o=t.drawOrder,h=t.slots;if(a==at.mixOut&&l==I.setup){k.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}let c=this.frames;if(i<c[0]){(l==I.setup||l==I.first)&&k.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}let u=0;i>=c[c.length-1]?u=c.length-1:u=Dt.binarySearch(c,i)-1;let d=this.drawOrders[u];if(d==null)k.arrayCopy(h,0,o,0,h.length);else for(let f=0,m=d.length;f<m;f++)o[f]=h[d[f]]}},Tt=class extends Qe{constructor(s){super(s),this.frames=k.newFloatArray(s*Tt.ENTRIES)}getPropertyId(){return(9<<24)+this.ikConstraintIndex}setFrame(s,t,e,i,r,n,l){s*=Tt.ENTRIES,this.frames[s]=t,this.frames[s+Tt.MIX]=e,this.frames[s+Tt.SOFTNESS]=i,this.frames[s+Tt.BEND_DIRECTION]=r,this.frames[s+Tt.COMPRESS]=n?1:0,this.frames[s+Tt.STRETCH]=l?1:0}apply(s,t,e,i,r,n,l){let a=this.frames,o=s.ikConstraints[this.ikConstraintIndex];if(!o.active)return;if(e<a[0]){switch(n){case I.setup:o.mix=o.data.mix,o.softness=o.data.softness,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch;return;case I.first:o.mix+=(o.data.mix-o.mix)*r,o.softness+=(o.data.softness-o.softness)*r,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch}return}if(e>=a[a.length-Tt.ENTRIES]){n==I.setup?(o.mix=o.data.mix+(a[a.length+Tt.PREV_MIX]-o.data.mix)*r,o.softness=o.data.softness+(a[a.length+Tt.PREV_SOFTNESS]-o.data.softness)*r,l==at.mixOut?(o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch):(o.bendDirection=a[a.length+Tt.PREV_BEND_DIRECTION],o.compress=a[a.length+Tt.PREV_COMPRESS]!=0,o.stretch=a[a.length+Tt.PREV_STRETCH]!=0)):(o.mix+=(a[a.length+Tt.PREV_MIX]-o.mix)*r,o.softness+=(a[a.length+Tt.PREV_SOFTNESS]-o.softness)*r,l==at.mixIn&&(o.bendDirection=a[a.length+Tt.PREV_BEND_DIRECTION],o.compress=a[a.length+Tt.PREV_COMPRESS]!=0,o.stretch=a[a.length+Tt.PREV_STRETCH]!=0));return}let h=Dt.binarySearch(a,e,Tt.ENTRIES),c=a[h+Tt.PREV_MIX],u=a[h+Tt.PREV_SOFTNESS],d=a[h],f=this.getCurvePercent(h/Tt.ENTRIES-1,1-(e-d)/(a[h+Tt.PREV_TIME]-d));n==I.setup?(o.mix=o.data.mix+(c+(a[h+Tt.MIX]-c)*f-o.data.mix)*r,o.softness=o.data.softness+(u+(a[h+Tt.SOFTNESS]-u)*f-o.data.softness)*r,l==at.mixOut?(o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch):(o.bendDirection=a[h+Tt.PREV_BEND_DIRECTION],o.compress=a[h+Tt.PREV_COMPRESS]!=0,o.stretch=a[h+Tt.PREV_STRETCH]!=0)):(o.mix+=(c+(a[h+Tt.MIX]-c)*f-o.mix)*r,o.softness+=(u+(a[h+Tt.SOFTNESS]-u)*f-o.softness)*r,l==at.mixIn&&(o.bendDirection=a[h+Tt.PREV_BEND_DIRECTION],o.compress=a[h+Tt.PREV_COMPRESS]!=0,o.stretch=a[h+Tt.PREV_STRETCH]!=0))}},de=Tt;de.ENTRIES=6;de.PREV_TIME=-6;de.PREV_MIX=-5;de.PREV_SOFTNESS=-4;de.PREV_BEND_DIRECTION=-3;de.PREV_COMPRESS=-2;de.PREV_STRETCH=-1;de.MIX=1;de.SOFTNESS=2;de.BEND_DIRECTION=3;de.COMPRESS=4;de.STRETCH=5;var zt=class extends Qe{constructor(s){super(s),this.frames=k.newFloatArray(s*zt.ENTRIES)}getPropertyId(){return(10<<24)+this.transformConstraintIndex}setFrame(s,t,e,i,r,n){s*=zt.ENTRIES,this.frames[s]=t,this.frames[s+zt.ROTATE]=e,this.frames[s+zt.TRANSLATE]=i,this.frames[s+zt.SCALE]=r,this.frames[s+zt.SHEAR]=n}apply(s,t,e,i,r,n,l){let a=this.frames,o=s.transformConstraints[this.transformConstraintIndex];if(!o.active)return;if(e<a[0]){let f=o.data;switch(n){case I.setup:o.rotateMix=f.rotateMix,o.translateMix=f.translateMix,o.scaleMix=f.scaleMix,o.shearMix=f.shearMix;return;case I.first:o.rotateMix+=(f.rotateMix-o.rotateMix)*r,o.translateMix+=(f.translateMix-o.translateMix)*r,o.scaleMix+=(f.scaleMix-o.scaleMix)*r,o.shearMix+=(f.shearMix-o.shearMix)*r}return}let h=0,c=0,u=0,d=0;if(e>=a[a.length-zt.ENTRIES]){let f=a.length;h=a[f+zt.PREV_ROTATE],c=a[f+zt.PREV_TRANSLATE],u=a[f+zt.PREV_SCALE],d=a[f+zt.PREV_SHEAR]}else{let f=Dt.binarySearch(a,e,zt.ENTRIES);h=a[f+zt.PREV_ROTATE],c=a[f+zt.PREV_TRANSLATE],u=a[f+zt.PREV_SCALE],d=a[f+zt.PREV_SHEAR];let m=a[f],p=this.getCurvePercent(f/zt.ENTRIES-1,1-(e-m)/(a[f+zt.PREV_TIME]-m));h+=(a[f+zt.ROTATE]-h)*p,c+=(a[f+zt.TRANSLATE]-c)*p,u+=(a[f+zt.SCALE]-u)*p,d+=(a[f+zt.SHEAR]-d)*p}if(n==I.setup){let f=o.data;o.rotateMix=f.rotateMix+(h-f.rotateMix)*r,o.translateMix=f.translateMix+(c-f.translateMix)*r,o.scaleMix=f.scaleMix+(u-f.scaleMix)*r,o.shearMix=f.shearMix+(d-f.shearMix)*r}else o.rotateMix+=(h-o.rotateMix)*r,o.translateMix+=(c-o.translateMix)*r,o.scaleMix+=(u-o.scaleMix)*r,o.shearMix+=(d-o.shearMix)*r}},Ae=zt;Ae.ENTRIES=5;Ae.PREV_TIME=-5;Ae.PREV_ROTATE=-4;Ae.PREV_TRANSLATE=-3;Ae.PREV_SCALE=-2;Ae.PREV_SHEAR=-1;Ae.ROTATE=1;Ae.TRANSLATE=2;Ae.SCALE=3;Ae.SHEAR=4;var bi=class extends Qe{constructor(s){super(s),this.frames=k.newFloatArray(s*bi.ENTRIES)}getPropertyId(){return(11<<24)+this.pathConstraintIndex}setFrame(s,t,e){s*=bi.ENTRIES,this.frames[s]=t,this.frames[s+bi.VALUE]=e}apply(s,t,e,i,r,n,l){let a=this.frames,o=s.pathConstraints[this.pathConstraintIndex];if(!o.active)return;if(e<a[0]){switch(n){case I.setup:o.position=o.data.position;return;case I.first:o.position+=(o.data.position-o.position)*r}return}let h=0;if(e>=a[a.length-bi.ENTRIES])h=a[a.length+bi.PREV_VALUE];else{let c=Dt.binarySearch(a,e,bi.ENTRIES);h=a[c+bi.PREV_VALUE];let u=a[c],d=this.getCurvePercent(c/bi.ENTRIES-1,1-(e-u)/(a[c+bi.PREV_TIME]-u));h+=(a[c+bi.VALUE]-h)*d}n==I.setup?o.position=o.data.position+(h-o.data.position)*r:o.position+=(h-o.position)*r}},Vs=bi;Vs.ENTRIES=2;Vs.PREV_TIME=-2;Vs.PREV_VALUE=-1;Vs.VALUE=1;var Ve=class extends Vs{constructor(t){super(t)}getPropertyId(){return(12<<24)+this.pathConstraintIndex}apply(t,e,i,r,n,l,a){let o=this.frames,h=t.pathConstraints[this.pathConstraintIndex];if(!h.active)return;if(i<o[0]){switch(l){case I.setup:h.spacing=h.data.spacing;return;case I.first:h.spacing+=(h.data.spacing-h.spacing)*n}return}let c=0;if(i>=o[o.length-Ve.ENTRIES])c=o[o.length+Ve.PREV_VALUE];else{let u=Dt.binarySearch(o,i,Ve.ENTRIES);c=o[u+Ve.PREV_VALUE];let d=o[u],f=this.getCurvePercent(u/Ve.ENTRIES-1,1-(i-d)/(o[u+Ve.PREV_TIME]-d));c+=(o[u+Ve.VALUE]-c)*f}l==I.setup?h.spacing=h.data.spacing+(c-h.data.spacing)*n:h.spacing+=(c-h.spacing)*n}},Ze=class extends Qe{constructor(s){super(s),this.frames=k.newFloatArray(s*Ze.ENTRIES)}getPropertyId(){return(13<<24)+this.pathConstraintIndex}setFrame(s,t,e,i){s*=Ze.ENTRIES,this.frames[s]=t,this.frames[s+Ze.ROTATE]=e,this.frames[s+Ze.TRANSLATE]=i}apply(s,t,e,i,r,n,l){let a=this.frames,o=s.pathConstraints[this.pathConstraintIndex];if(!o.active)return;if(e<a[0]){switch(n){case I.setup:o.rotateMix=o.data.rotateMix,o.translateMix=o.data.translateMix;return;case I.first:o.rotateMix+=(o.data.rotateMix-o.rotateMix)*r,o.translateMix+=(o.data.translateMix-o.translateMix)*r}return}let h=0,c=0;if(e>=a[a.length-Ze.ENTRIES])h=a[a.length+Ze.PREV_ROTATE],c=a[a.length+Ze.PREV_TRANSLATE];else{let u=Dt.binarySearch(a,e,Ze.ENTRIES);h=a[u+Ze.PREV_ROTATE],c=a[u+Ze.PREV_TRANSLATE];let d=a[u],f=this.getCurvePercent(u/Ze.ENTRIES-1,1-(e-d)/(a[u+Ze.PREV_TIME]-d));h+=(a[u+Ze.ROTATE]-h)*f,c+=(a[u+Ze.TRANSLATE]-c)*f}n==I.setup?(o.rotateMix=o.data.rotateMix+(h-o.data.rotateMix)*r,o.translateMix=o.data.translateMix+(c-o.data.translateMix)*r):(o.rotateMix+=(h-o.rotateMix)*r,o.translateMix+=(c-o.translateMix)*r)}},xs=Ze;xs.ENTRIES=3;xs.PREV_TIME=-3;xs.PREV_ROTATE=-2;xs.PREV_TRANSLATE=-1;xs.ROTATE=1;xs.TRANSLATE=2;var Kt=class{constructor(s){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new dm(this),this.propertyIDs=new pn,this.animationsChanged=!1,this.trackEntryPool=new Js(()=>new ed),this.data=s}update(s){s*=this.timeScale;let t=this.tracks;for(let e=0,i=t.length;e<i;e++){let r=t[e];if(r==null)continue;r.animationLast=r.nextAnimationLast,r.trackLast=r.nextTrackLast;let n=s*r.timeScale;if(r.delay>0){if(r.delay-=n,r.delay>0)continue;n=-r.delay,r.delay=0}let l=r.next;if(l!=null){let a=r.trackLast-l.delay;if(a>=0){for(l.delay=0,l.trackTime+=r.timeScale==0?0:(a/r.timeScale+s)*l.timeScale,r.trackTime+=n,this.setCurrent(e,l,!0);l.mixingFrom!=null;)l.mixTime+=s,l=l.mixingFrom;continue}}else if(r.trackLast>=r.trackEnd&&r.mixingFrom==null){t[e]=null,this.queue.end(r),this.disposeNext(r);continue}if(r.mixingFrom!=null&&this.updateMixingFrom(r,s)){let a=r.mixingFrom;for(r.mixingFrom=null,a!=null&&(a.mixingTo=null);a!=null;)this.queue.end(a),a=a.mixingFrom}r.trackTime+=n}this.queue.drain()}updateMixingFrom(s,t){let e=s.mixingFrom;if(e==null)return!0;let i=this.updateMixingFrom(e,t);return e.animationLast=e.nextAnimationLast,e.trackLast=e.nextTrackLast,s.mixTime>0&&s.mixTime>=s.mixDuration?((e.totalAlpha==0||s.mixDuration==0)&&(s.mixingFrom=e.mixingFrom,e.mixingFrom!=null&&(e.mixingFrom.mixingTo=s),s.interruptAlpha=e.interruptAlpha,this.queue.end(e)),i):(e.trackTime+=t*e.timeScale,s.mixTime+=t,!1)}apply(s){if(s==null)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();let t=this.events,e=this.tracks,i=!1;for(let l=0,a=e.length;l<a;l++){let o=e[l];if(o==null||o.delay>0)continue;i=!0;let h=l==0?I.first:o.mixBlend,c=o.alpha;o.mixingFrom!=null?c*=this.applyMixingFrom(o,s,h):o.trackTime>=o.trackEnd&&o.next==null&&(c=0);let u=o.animationLast,d=o.getAnimationTime(),f=o.animation.timelines.length,m=o.animation.timelines;if(l==0&&c==1||h==I.add)for(let p=0;p<f;p++){k.webkit602BugfixHelper(c,h);let g=m[p];g instanceof Ds?this.applyAttachmentTimeline(g,s,d,h,!0):g.apply(s,u,d,t,c,h,at.mixIn)}else{let p=o.timelineMode,g=o.timelinesRotation.length==0;g&&k.setArraySize(o.timelinesRotation,f<<1,null);let y=o.timelinesRotation;for(let _=0;_<f;_++){let b=m[_],x=p[_]==Kt.SUBSEQUENT?h:I.setup;b instanceof he?this.applyRotateTimeline(b,s,d,c,x,y,_<<1,g):b instanceof Ds?this.applyAttachmentTimeline(b,s,d,h,!0):(k.webkit602BugfixHelper(c,h),b.apply(s,u,d,t,c,x,at.mixIn))}}this.queueEvents(o,d),t.length=0,o.nextAnimationLast=d,o.nextTrackLast=o.trackTime}let r=this.unkeyedState+Kt.SETUP,n=s.slots;for(let l=0,a=s.slots.length;l<a;l++){let o=n[l];if(o.attachmentState==r){let h=o.data.attachmentName;o.setAttachment(h==null?null:s.getAttachment(o.data.index,h))}}return this.unkeyedState+=2,this.queue.drain(),i}applyMixingFrom(s,t,e){let i=s.mixingFrom;i.mixingFrom!=null&&this.applyMixingFrom(i,t,e);let r=0;s.mixDuration==0?(r=1,e==I.first&&(e=I.setup)):(r=s.mixTime/s.mixDuration,r>1&&(r=1),e!=I.first&&(e=i.mixBlend));let n=r<i.eventThreshold?this.events:null,l=r<i.attachmentThreshold,a=r<i.drawOrderThreshold,o=i.animationLast,h=i.getAnimationTime(),c=i.animation.timelines.length,u=i.animation.timelines,d=i.alpha*s.interruptAlpha,f=d*(1-r);if(e==I.add)for(let m=0;m<c;m++)u[m].apply(t,o,h,n,f,e,at.mixOut);else{let m=i.timelineMode,p=i.timelineHoldMix,g=i.timelinesRotation.length==0;g&&k.setArraySize(i.timelinesRotation,c<<1,null);let y=i.timelinesRotation;i.totalAlpha=0;for(let _=0;_<c;_++){let b=u[_],x=at.mixOut,v,w=0;switch(m[_]){case Kt.SUBSEQUENT:if(!a&&b instanceof ri)continue;v=e,w=f;break;case Kt.FIRST:v=I.setup,w=f;break;case Kt.HOLD_SUBSEQUENT:v=e,w=d;break;case Kt.HOLD_FIRST:v=I.setup,w=d;break;default:v=I.setup;let E=p[_];w=d*Math.max(0,1-E.mixTime/E.mixDuration);break}i.totalAlpha+=w,b instanceof he?this.applyRotateTimeline(b,t,h,w,v,y,_<<1,g):b instanceof Ds?this.applyAttachmentTimeline(b,t,h,v,l):(k.webkit602BugfixHelper(w,e),a&&b instanceof ri&&v==I.setup&&(x=at.mixIn),b.apply(t,o,h,n,w,v,x))}}return s.mixDuration>0&&this.queueEvents(i,h),this.events.length=0,i.nextAnimationLast=h,i.nextTrackLast=i.trackTime,r}applyAttachmentTimeline(s,t,e,i,r){let n=t.slots[s.slotIndex];if(!n.bone.active)return;let l=s.frames;if(e<l[0])(i==I.setup||i==I.first)&&this.setAttachment(t,n,n.data.attachmentName,r);else{let a;e>=l[l.length-1]?a=l.length-1:a=Dt.binarySearch(l,e)-1,this.setAttachment(t,n,s.attachmentNames[a],r)}n.attachmentState<=this.unkeyedState&&(n.attachmentState=this.unkeyedState+Kt.SETUP)}setAttachment(s,t,e,i){t.setAttachment(e==null?null:s.getAttachment(t.data.index,e)),i&&(t.attachmentState=this.unkeyedState+Kt.CURRENT)}applyRotateTimeline(s,t,e,i,r,n,l,a){if(a&&(n[l]=0),i==1){s.apply(t,0,e,null,1,r,at.mixIn);return}let o=s,h=o.frames,c=t.bones[o.boneIndex];if(!c.active)return;let u=0,d=0;if(e<h[0])switch(r){case I.setup:c.rotation=c.data.rotation;default:return;case I.first:u=c.rotation,d=c.data.rotation}else if(u=r==I.setup?c.data.rotation:c.rotation,e>=h[h.length-he.ENTRIES])d=c.data.rotation+h[h.length+he.PREV_ROTATION];else{let p=Dt.binarySearch(h,e,he.ENTRIES),g=h[p+he.PREV_ROTATION],y=h[p],_=o.getCurvePercent((p>>1)-1,1-(e-y)/(h[p+he.PREV_TIME]-y));d=h[p+he.ROTATION]-g,d-=(16384-(16384.499999999996-d/360|0))*360,d=g+d*_+c.data.rotation,d-=(16384-(16384.499999999996-d/360|0))*360}let f=0,m=d-u;if(m-=(16384-(16384.499999999996-m/360|0))*360,m==0)f=n[l];else{let p=0,g=0;a?(p=0,g=m):(p=n[l],g=n[l+1]);let y=m>0,_=p>=0;S.signum(g)!=S.signum(m)&&Math.abs(g)<=90&&(Math.abs(p)>180&&(p+=360*S.signum(p)),_=y),f=m+p-p%360,_!=y&&(f+=360*S.signum(p)),n[l]=f}n[l+1]=m,u+=f*i,c.rotation=u-(16384-(16384.499999999996-u/360|0))*360}queueEvents(s,t){let e=s.animationStart,i=s.animationEnd,r=i-e,n=s.trackLast%r,l=this.events,a=0,o=l.length;for(;a<o;a++){let c=l[a];if(c.time<n)break;c.time>i||this.queue.event(s,c)}let h=!1;for(s.loop?h=r==0||n>s.trackTime%r:h=t>=i&&s.animationLast<i,h&&this.queue.complete(s);a<o;a++)l[a].time<e||this.queue.event(s,l[a])}clearTracks(){let s=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let t=0,e=this.tracks.length;t<e;t++)this.clearTrack(t);this.tracks.length=0,this.queue.drainDisabled=s,this.queue.drain()}clearTrack(s){if(s>=this.tracks.length)return;let t=this.tracks[s];if(t==null)return;this.queue.end(t),this.disposeNext(t);let e=t;for(;;){let i=e.mixingFrom;if(i==null)break;this.queue.end(i),e.mixingFrom=null,e.mixingTo=null,e=i}this.tracks[t.trackIndex]=null,this.queue.drain()}setCurrent(s,t,e){let i=this.expandToIndex(s);this.tracks[s]=t,i!=null&&(e&&this.queue.interrupt(i),t.mixingFrom=i,i.mixingTo=t,t.mixTime=0,i.mixingFrom!=null&&i.mixDuration>0&&(t.interruptAlpha*=Math.min(1,i.mixTime/i.mixDuration)),i.timelinesRotation.length=0),this.queue.start(t)}setAnimation(s,t,e){let i=this.data.skeletonData.findAnimation(t);if(i==null)throw new Error(`Animation not found: ${t}`);return this.setAnimationWith(s,i,e)}setAnimationWith(s,t,e){if(t==null)throw new Error("animation cannot be null.");let i=!0,r=this.expandToIndex(s);r!=null&&(r.nextTrackLast==-1?(this.tracks[s]=r.mixingFrom,this.queue.interrupt(r),this.queue.end(r),this.disposeNext(r),r=r.mixingFrom,i=!1):this.disposeNext(r));let n=this.trackEntry(s,t,e,r);return this.setCurrent(s,n,i),this.queue.drain(),n}addAnimation(s,t,e,i){let r=this.data.skeletonData.findAnimation(t);if(r==null)throw new Error(`Animation not found: ${t}`);return this.addAnimationWith(s,r,e,i)}addAnimationWith(s,t,e,i){if(t==null)throw new Error("animation cannot be null.");let r=this.expandToIndex(s);if(r!=null)for(;r.next!=null;)r=r.next;let n=this.trackEntry(s,t,e,r);if(r==null)this.setCurrent(s,n,!0),this.queue.drain();else if(r.next=n,i<=0){let l=r.animationEnd-r.animationStart;l!=0?(r.loop?i+=l*(1+(r.trackTime/l|0)):i+=Math.max(l,r.trackTime),i-=this.data.getMix(r.animation,t)):i=r.trackTime}return n.delay=i,n}setEmptyAnimation(s,t){let e=this.setAnimationWith(s,Kt.emptyAnimation,!1);return e.mixDuration=t,e.trackEnd=t,e}addEmptyAnimation(s,t,e){e<=0&&(e-=t);let i=this.addAnimationWith(s,Kt.emptyAnimation,!1,e);return i.mixDuration=t,i.trackEnd=t,i}setEmptyAnimations(s){let t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,i=this.tracks.length;e<i;e++){let r=this.tracks[e];r!=null&&this.setEmptyAnimation(r.trackIndex,s)}this.queue.drainDisabled=t,this.queue.drain()}expandToIndex(s){return s<this.tracks.length?this.tracks[s]:(k.ensureArrayCapacity(this.tracks,s+1,null),this.tracks.length=s+1,null)}trackEntry(s,t,e,i){let r=this.trackEntryPool.obtain();return r.trackIndex=s,r.animation=t,r.loop=e,r.holdPrevious=!1,r.eventThreshold=0,r.attachmentThreshold=0,r.drawOrderThreshold=0,r.animationStart=0,r.animationEnd=t.duration,r.animationLast=-1,r.nextAnimationLast=-1,r.delay=0,r.trackTime=0,r.trackLast=-1,r.nextTrackLast=-1,r.trackEnd=Number.MAX_VALUE,r.timeScale=1,r.alpha=1,r.interruptAlpha=1,r.mixTime=0,r.mixDuration=i==null?0:this.data.getMix(i.animation,t),r.mixBlend=I.replace,r}disposeNext(s){let t=s.next;for(;t!=null;)this.queue.dispose(t),t=t.next;s.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();for(let s=0,t=this.tracks.length;s<t;s++){let e=this.tracks[s];if(e!=null){for(;e.mixingFrom!=null;)e=e.mixingFrom;do(e.mixingFrom==null||e.mixBlend!=I.add)&&this.computeHold(e),e=e.mixingTo;while(e!=null)}}}computeHold(s){let t=s.mixingTo,e=s.animation.timelines,i=s.animation.timelines.length,r=k.setArraySize(s.timelineMode,i);s.timelineHoldMix.length=0;let n=k.setArraySize(s.timelineHoldMix,i),l=this.propertyIDs;if(t!=null&&t.holdPrevious){for(let a=0;a<i;a++)r[a]=l.add(e[a].getPropertyId())?Kt.HOLD_FIRST:Kt.HOLD_SUBSEQUENT;return}t:for(let a=0;a<i;a++){let o=e[a],h=o.getPropertyId();if(!l.add(h))r[a]=Kt.SUBSEQUENT;else if(t==null||o instanceof Ds||o instanceof ri||o instanceof Di||!t.animation.hasTimeline(h))r[a]=Kt.FIRST;else{for(let c=t.mixingTo;c!=null;c=c.mixingTo)if(!c.animation.hasTimeline(h)){if(s.mixDuration>0){r[a]=Kt.HOLD_MIX,n[a]=c;continue t}break}r[a]=Kt.HOLD_FIRST}}}getCurrent(s){return s>=this.tracks.length?null:this.tracks[s]}addListener(s){if(s==null)throw new Error("listener cannot be null.");this.listeners.push(s)}removeListener(s){let t=this.listeners.indexOf(s);t>=0&&this.listeners.splice(t,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}setAnimationByName(s,t,e){Kt.deprecatedWarning1||(Kt.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(s,t,e)}addAnimationByName(s,t,e,i){Kt.deprecatedWarning2||(Kt.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(s,t,e,i)}hasAnimation(s){return this.data.skeletonData.findAnimation(s)!==null}hasAnimationByName(s){return Kt.deprecatedWarning3||(Kt.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(s)}},ts=Kt;ts.emptyAnimation=new Dt("<empty>",[],0);ts.SUBSEQUENT=0;ts.FIRST=1;ts.HOLD_SUBSEQUENT=2;ts.HOLD_FIRST=3;ts.HOLD_MIX=4;ts.SETUP=1;ts.CURRENT=2;ts.deprecatedWarning1=!1;ts.deprecatedWarning2=!1;ts.deprecatedWarning3=!1;var Nr=class{constructor(){this.mixBlend=I.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}reset(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){let s=this.animationEnd-this.animationStart;return s==0?this.animationStart:this.trackTime%s+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(s){this.animationLast=s,this.nextAnimationLast=s}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}get time(){return Nr.deprecatedWarning1||(Nr.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime}set time(s){Nr.deprecatedWarning1||(Nr.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=s}get endTime(){return Nr.deprecatedWarning2||(Nr.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime}set endTime(s){Nr.deprecatedWarning2||(Nr.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=s}loopsCount(){return Math.floor(this.trackTime/this.trackEnd)}},ed=Nr;ed.deprecatedWarning1=!1;ed.deprecatedWarning2=!1;var xg=class{constructor(s){this.objects=[],this.drainDisabled=!1,this.animState=s}start(s){this.objects.push(Je.start),this.objects.push(s),this.animState.animationsChanged=!0}interrupt(s){this.objects.push(Je.interrupt),this.objects.push(s)}end(s){this.objects.push(Je.end),this.objects.push(s),this.animState.animationsChanged=!0}dispose(s){this.objects.push(Je.dispose),this.objects.push(s)}complete(s){this.objects.push(Je.complete),this.objects.push(s)}event(s,t){this.objects.push(Je.event),this.objects.push(s),this.objects.push(t)}deprecateStuff(){return xg.deprecatedWarning1||(xg.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: onComplete, onStart, onEnd, onEvent art deprecated, please use listeners from now on. 'state.addListener({ complete: function(track, event) { } })'")),!0}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;let s=this.objects,t=this.animState.listeners;for(let e=0;e<s.length;e+=2){let i=s[e],r=s[e+1];switch(i){case Je.start:r.listener!=null&&r.listener.start&&r.listener.start(r);for(let a=0;a<t.length;a++)t[a].start&&t[a].start(r);r.onStart&&this.deprecateStuff()&&r.onStart(r.trackIndex),this.animState.onStart&&this.deprecateStuff()&&this.deprecateStuff&&this.animState.onStart(r.trackIndex);break;case Je.interrupt:r.listener!=null&&r.listener.interrupt&&r.listener.interrupt(r);for(let a=0;a<t.length;a++)t[a].interrupt&&t[a].interrupt(r);break;case Je.end:r.listener!=null&&r.listener.end&&r.listener.end(r);for(let a=0;a<t.length;a++)t[a].end&&t[a].end(r);r.onEnd&&this.deprecateStuff()&&r.onEnd(r.trackIndex),this.animState.onEnd&&this.deprecateStuff()&&this.animState.onEnd(r.trackIndex);case Je.dispose:r.listener!=null&&r.listener.dispose&&r.listener.dispose(r);for(let a=0;a<t.length;a++)t[a].dispose&&t[a].dispose(r);this.animState.trackEntryPool.free(r);break;case Je.complete:r.listener!=null&&r.listener.complete&&r.listener.complete(r);for(let a=0;a<t.length;a++)t[a].complete&&t[a].complete(r);let n=S.toInt(r.loopsCount());r.onComplete&&this.deprecateStuff()&&r.onComplete(r.trackIndex,n),this.animState.onComplete&&this.deprecateStuff()&&this.animState.onComplete(r.trackIndex,n);break;case Je.event:let l=s[e+++2];r.listener!=null&&r.listener.event&&r.listener.event(r,l);for(let a=0;a<t.length;a++)t[a].event&&t[a].event(r,l);r.onEvent&&this.deprecateStuff()&&r.onEvent(r.trackIndex,l),this.animState.onEvent&&this.deprecateStuff()&&this.animState.onEvent(r.trackIndex,l);break}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}},dm=xg;dm.deprecatedWarning1=!1;var Je=(s=>(s[s.start=0]="start",s[s.interrupt=1]="interrupt",s[s.end=2]="end",s[s.dispose=3]="dispose",s[s.complete=4]="complete",s[s.event=5]="event",s))(Je||{}),um=class{start(t){}interrupt(t){}end(t){}dispose(t){}complete(t){}event(t,e){}};var bg=class{constructor(s){if(this.animationToMixTime={},this.defaultMix=0,s==null)throw new Error("skeletonData cannot be null.");this.skeletonData=s}setMix(s,t,e){let i=this.skeletonData.findAnimation(s);if(i==null)throw new Error(`Animation not found: ${s}`);let r=this.skeletonData.findAnimation(t);if(r==null)throw new Error(`Animation not found: ${t}`);this.setMixWith(i,r,e)}setMixByName(s,t,e){bg.deprecatedWarning1||(bg.deprecatedWarning1=!0,console.warn("Deprecation Warning: AnimationStateData.setMixByName is deprecated, please use setMix from now on.")),this.setMix(s,t,e)}setMixWith(s,t,e){if(s==null)throw new Error("from cannot be null.");if(t==null)throw new Error("to cannot be null.");let i=`${s.name}.${t.name}`;this.animationToMixTime[i]=e}getMix(s,t){let e=`${s.name}.${t.name}`,i=this.animationToMixTime[e];return i===void 0?this.defaultMix:i}},sd=bg;sd.deprecatedWarning1=!1;var bl=class{constructor(t){this.atlas=t}newRegionAttachment(t,e,i){let r=this.atlas.findRegion(i);if(r==null)throw new Error(`Region not found in atlas: ${i} (region attachment: ${e})`);let n=new ct(e);return n.region=r,n}newMeshAttachment(t,e,i){let r=this.atlas.findRegion(i);if(r==null)throw new Error(`Region not found in atlas: ${i} (mesh attachment: ${e})`);let n=new Ls(e);return n.region=r,n}newBoundingBoxAttachment(t,e){return new An(e)}newPathAttachment(t,e){return new Us(e)}newPointAttachment(t,e){return new Tn(e)}newClippingAttachment(t,e){return new In(e)}};var _l=class{constructor(t,e,i){if(this.matrix=new mt,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.sorted=!1,this.active=!1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=i,this.setToSetupPose()}get worldX(){return this.matrix.tx}get worldY(){return this.matrix.ty}isActive(){return this.active}update(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,e,i,r,n,l,a){this.ax=t,this.ay=e,this.arotation=i,this.ascaleX=r,this.ascaleY=n,this.ashearX=l,this.ashearY=a,this.appliedValid=!0;let o=this.parent,h=this.matrix,c=this.skeleton.scaleX,u=jt.yDown?-this.skeleton.scaleY:this.skeleton.scaleY;if(o==null){let g=this.skeleton,y=i+90+a;h.a=S.cosDeg(i+l)*r*c,h.c=S.cosDeg(y)*n*c,h.b=S.sinDeg(i+l)*r*u,h.d=S.sinDeg(y)*n*u,h.tx=t*c+g.x,h.ty=e*u+g.y;return}let d=o.matrix.a,f=o.matrix.c,m=o.matrix.b,p=o.matrix.d;switch(h.tx=d*t+f*e+o.matrix.tx,h.ty=m*t+p*e+o.matrix.ty,this.data.transformMode){case it.Normal:{let g=i+90+a,y=S.cosDeg(i+l)*r,_=S.cosDeg(g)*n,b=S.sinDeg(i+l)*r,x=S.sinDeg(g)*n;h.a=d*y+f*b,h.c=d*_+f*x,h.b=m*y+p*b,h.d=m*_+p*x;return}case it.OnlyTranslation:{let g=i+90+a;h.a=S.cosDeg(i+l)*r,h.c=S.cosDeg(g)*n,h.b=S.sinDeg(i+l)*r,h.d=S.sinDeg(g)*n;break}case it.NoRotationOrReflection:{let g=d*d+m*m,y=0;g>1e-4?(g=Math.abs(d*p-f*m)/g,d/=this.skeleton.scaleX,m/=this.skeleton.scaleY,f=m*g,p=d*g,y=Math.atan2(m,d)*S.radDeg):(d=0,m=0,y=90-Math.atan2(p,f)*S.radDeg);let _=i+l-y,b=i+a-y+90,x=S.cosDeg(_)*r,v=S.cosDeg(b)*n,w=S.sinDeg(_)*r,E=S.sinDeg(b)*n;h.a=d*x-f*w,h.c=d*v-f*E,h.b=m*x+p*w,h.d=m*v+p*E;break}case it.NoScale:case it.NoScaleOrReflection:{let g=S.cosDeg(i),y=S.sinDeg(i),_=(d*g+f*y)/c,b=(m*g+p*y)/u,x=Math.sqrt(_*_+b*b);x>1e-5&&(x=1/x),_*=x,b*=x,x=Math.sqrt(_*_+b*b),this.data.transformMode==it.NoScale&&d*p-f*m<0!=(jt.yDown?this.skeleton.scaleX<0!=this.skeleton.scaleY>0:this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(x=-x);let v=Math.PI/2+Math.atan2(b,_),w=Math.cos(v)*x,E=Math.sin(v)*x,A=S.cosDeg(l)*r,T=S.cosDeg(90+a)*n,C=S.sinDeg(l)*r,R=S.sinDeg(90+a)*n;h.a=_*A+w*C,h.c=_*T+w*R,h.b=b*A+E*C,h.d=b*T+E*R;break}}h.a*=c,h.c*=c,h.b*=u,h.d*=u}setToSetupPose(){let t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY}getWorldRotationX(){return Math.atan2(this.matrix.b,this.matrix.a)*S.radDeg}getWorldRotationY(){return Math.atan2(this.matrix.d,this.matrix.c)*S.radDeg}getWorldScaleX(){let t=this.matrix;return Math.sqrt(t.a*t.a+t.c*t.c)}getWorldScaleY(){let t=this.matrix;return Math.sqrt(t.b*t.b+t.d*t.d)}updateAppliedTransform(){this.appliedValid=!0;let t=this.parent,e=this.matrix;if(t==null){this.ax=e.tx,this.ay=e.ty,this.arotation=Math.atan2(e.b,e.a)*S.radDeg,this.ascaleX=Math.sqrt(e.a*e.a+e.b*e.b),this.ascaleY=Math.sqrt(e.c*e.c+e.d*e.d),this.ashearX=0,this.ashearY=Math.atan2(e.a*e.c+e.b*e.d,e.a*e.d-e.b*e.c)*S.radDeg;return}let i=t.matrix,r=1/(i.a*i.d-i.b*i.c),n=e.tx-i.tx,l=e.ty-i.ty;this.ax=n*i.d*r-l*i.c*r,this.ay=l*i.a*r-n*i.b*r;let a=r*i.d,o=r*i.a,h=r*i.c,c=r*i.b,u=a*e.a-h*e.b,d=a*e.c-h*e.d,f=o*e.b-c*e.a,m=o*e.d-c*e.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(u*u+f*f),this.ascaleX>1e-4){let p=u*m-d*f;this.ascaleY=p/this.ascaleX,this.ashearY=Math.atan2(u*d+f*m,p)*S.radDeg,this.arotation=Math.atan2(f,u)*S.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(d*d+m*m),this.ashearY=0,this.arotation=90-Math.atan2(m,d)*S.radDeg}worldToLocal(t){let e=this.matrix,i=e.a,r=e.c,n=e.b,l=e.d,a=1/(i*l-r*n),o=t.x-e.tx,h=t.y-e.ty;return t.x=o*l*a-h*r*a,t.y=h*i*a-o*n*a,t}localToWorld(t){let e=this.matrix,i=t.x,r=t.y;return t.x=i*e.a+r*e.c+e.tx,t.y=i*e.b+r*e.d+e.ty,t}worldToLocalRotation(t){let e=S.sinDeg(t),i=S.cosDeg(t),r=this.matrix;return Math.atan2(r.a*e-r.b*i,r.d*i-r.c*e)*S.radDeg}localToWorldRotation(t){let e=S.sinDeg(t),i=S.cosDeg(t),r=this.matrix;return Math.atan2(i*r.b+e*r.d,i*r.a+e*r.c)*S.radDeg}rotateWorld(t){let e=this.matrix,i=e.a,r=e.c,n=e.b,l=e.d,a=S.cosDeg(t),o=S.sinDeg(t);e.a=a*i-o*n,e.c=a*r-o*l,e.b=o*i+a*n,e.d=o*r+a*l,this.appliedValid=!1}};var Mn=class{constructor(t,e,i){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=it.Normal,this.skinRequired=!1,this.color=new G,t<0)throw new Error("index must be >= 0.");if(e==null)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=i}};var Vi=class{constructor(t,e,i){this.name=t,this.order=e,this.skinRequired=i}};var kn=class{constructor(t,e){if(e==null)throw new Error("data cannot be null.");this.time=t,this.data=e}};var Pn=class{constructor(t){this.name=t}};var Zh=class{constructor(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(let i=0;i<t.bones.length;i++)this.bones.push(e.findBone(t.bones[i].name));this.target=e.findBone(t.target.name)}isActive(){return this.active}apply(){this.update()}update(){let t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.softness,this.mix);break}}apply1(t,e,i,r,n,l,a){t.appliedValid||t.updateAppliedTransform();let o=t.parent.matrix,h=o.a,c=o.c,u=o.b,d=o.d,f=-t.ashearX-t.arotation,m=0,p=0;switch(t.data.transformMode){case it.OnlyTranslation:m=e-t.worldX,p=i-t.worldY;break;case it.NoRotationOrReflection:let _=Math.abs(h*d-c*u)/(h*h+u*u),b=h/t.skeleton.scaleX,x=u/t.skeleton.scaleY;c=-x*_*t.skeleton.scaleX,d=b*_*t.skeleton.scaleY,f+=Math.atan2(x,b)*S.radDeg;default:let v=e-o.tx,w=i-o.ty,E=h*d-c*u;m=(v*d-w*c)/E-t.ax,p=(w*h-v*u)/E-t.ay}f+=Math.atan2(p,m)*S.radDeg,t.ascaleX<0&&(f+=180),f>180?f-=360:f<-180&&(f+=360);let g=t.ascaleX,y=t.ascaleY;if(r||n){switch(t.data.transformMode){case it.NoScale:case it.NoScaleOrReflection:m=e-t.worldX,p=i-t.worldY}let _=t.data.length*g,b=Math.sqrt(m*m+p*p);if(r&&b<_||n&&b>_&&_>1e-4){let x=(b/_-1)*a+1;g*=x,l&&(y*=x)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+f*a,g,y,t.ashearX,t.ashearY)}apply2(t,e,i,r,n,l,a,o){if(o==0){e.updateWorldTransform();return}t.appliedValid||t.updateAppliedTransform(),e.appliedValid||e.updateAppliedTransform();let h=t.ax,c=t.ay,u=t.ascaleX,d=u,f=t.ascaleY,m=e.ascaleX,p=t.matrix,g=0,y=0,_=0;u<0?(u=-u,g=180,_=-1):(g=0,_=1),f<0&&(f=-f,_=-_),m<0?(m=-m,y=180):y=0;let b=e.ax,x=0,v=0,w=0,E=p.a,A=p.c,T=p.b,C=p.d,R=Math.abs(u-f)<=1e-4;R?(x=e.ay,v=E*b+A*x+p.tx,w=T*b+C*x+p.ty):(x=0,v=E*b+p.tx,w=T*b+p.ty);let N=t.parent.matrix;E=N.a,A=N.c,T=N.b,C=N.d;let P=1/(E*C-A*T),M=v-N.tx,D=w-N.ty,q=(M*C-D*A)*P-h,X=(D*E-M*T)*P-c,O=Math.sqrt(q*q+X*X),L=e.data.length*m,B,W;if(O<1e-4){this.apply1(t,i,r,!1,l,!1,o),e.updateWorldTransformWith(b,x,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);return}M=i-N.tx,D=r-N.ty;let j=(M*C-D*A)*P-h,V=(D*E-M*T)*P-c,U=j*j+V*V;if(a!=0){a*=u*(m+1)/2;let pt=Math.sqrt(U),At=pt-O-L*u+a;if(At>0){let ot=Math.min(1,At/(a*2))-1;ot=(At-a*(1-ot*ot))/pt,j-=ot*j,V-=ot*V,U=j*j+V*V}}t:if(R){L*=u;let pt=(U-O*O-L*L)/(2*O*L);pt<-1?pt=-1:pt>1&&(pt=1,l&&(d*=(Math.sqrt(U)/(O+L)-1)*o+1)),W=Math.acos(pt)*n,E=O+L*pt,A=L*Math.sin(W),B=Math.atan2(V*E-j*A,j*E+V*A)}else{E=u*L,A=f*L;let pt=E*E,At=A*A,ot=Math.atan2(V,j);T=At*O*O+pt*U-pt*At;let gt=-2*At*O,yt=At-pt;if(C=gt*gt-4*yt*T,C>=0){let As=Math.sqrt(C);gt<0&&(As=-As),As=-(gt+As)/2;let $r=As/yt,Ne=T/As,qi=Math.abs($r)<Math.abs(Ne)?$r:Ne;if(qi*qi<=U){D=Math.sqrt(U-qi*qi)*n,B=ot-Math.atan2(D,qi),W=Math.atan2(D/f,(qi-O)/u);break t}}let Nt=S.PI,Lt=O-E,Xe=Lt*Lt,ws=0,Es=0,$s=O+E,Hi=$s*$s,us=0;T=-E*O/(pt-At),T>=-1&&T<=1&&(T=Math.acos(T),M=E*Math.cos(T)+O,D=A*Math.sin(T),C=M*M+D*D,C<Xe&&(Nt=T,Xe=C,Lt=M,ws=D),C>Hi&&(Es=T,Hi=C,$s=M,us=D)),U<=(Xe+Hi)/2?(B=ot-Math.atan2(ws*n,Lt),W=Nt*n):(B=ot-Math.atan2(us*n,$s),W=Es*n)}let st=Math.atan2(x,b)*_,nt=t.arotation;B=(B-st)*S.radDeg+g-nt,B>180?B-=360:B<-180&&(B+=360),t.updateWorldTransformWith(h,c,nt+B*o,d,t.ascaleY,0,0),nt=e.arotation,W=((W+st)*S.radDeg-e.ashearX)*_+y-nt,W>180?W-=360:W<-180&&(W+=360),e.updateWorldTransformWith(b,x,nt+W*o,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}};var On=class extends Vi{constructor(t){super(t,0,!1),this.bones=new Array,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.softness=0}};var Nn=class extends Vi{constructor(t){super(t,0,!1),this.bones=new Array}},ie=(s=>(s[s.Length=0]="Length",s[s.Fixed=1]="Fixed",s[s.Percent=2]="Percent",s))(ie||{});var yl=class{constructor(s,t){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,s==null)throw new Error("data cannot be null.");if(t==null)throw new Error("skeleton cannot be null.");this.data=s,this.bones=new Array;for(let e=0,i=s.bones.length;e<i;e++)this.bones.push(t.findBone(s.bones[e].name));this.target=t.findSlot(s.target.name),this.position=s.position,this.spacing=s.spacing,this.rotateMix=s.rotateMix,this.translateMix=s.translateMix}isActive(){return this.active}apply(){this.update()}update(){let s=this.target.getAttachment();if(!(s instanceof Us))return;let t=this.rotateMix,e=this.translateMix,i=e>0,r=t>0;if(!i&&!r)return;let n=this.data,l=n.spacingMode,a=l==ie.Length,o=n.rotateMode,h=o==Pt.Tangent,c=o==Pt.ChainScale,u=this.bones.length,d=h?u:u+1,f=this.bones,m=k.setArraySize(this.spaces,d),p=null,g=this.spacing;if(c||a){c&&(p=k.setArraySize(this.lengths,u));for(let w=0,E=d-1;w<E;){let A=f[w],T=A.data.length;if(T<yl.epsilon)c&&(p[w]=0),m[++w]=0;else{let C=T*A.matrix.a,R=T*A.matrix.b,N=Math.sqrt(C*C+R*R);c&&(p[w]=N),m[++w]=(a?T+g:g)*N/T}}}else for(let w=1;w<d;w++)m[w]=g;let y=this.computeWorldPositions(s,d,h,n.positionMode==It.Percent,l==ie.Percent),_=y[0],b=y[1],x=n.offsetRotation,v=!1;if(x==0)v=o==Pt.Chain;else{v=!1;let w=this.target.bone.matrix;x*=w.a*w.d-w.b*w.c>0?S.degRad:-S.degRad}for(let w=0,E=3;w<u;w++,E+=3){let A=f[w],T=A.matrix;T.tx+=(_-T.tx)*e,T.ty+=(b-T.ty)*e;let C=y[E],R=y[E+1],N=C-_,P=R-b;if(c){let M=p[w];if(M!=0){let D=(Math.sqrt(N*N+P*P)/M-1)*t+1;T.a*=D,T.b*=D}}if(_=C,b=R,r){let M=T.a,D=T.c,q=T.b,X=T.d,O=0,L=0,B=0;if(h&&(h?O=y[E-1]:m[w+1]==0?O=y[E+2]:O=Math.atan2(P,N)),O-=Math.atan2(q,M),v){L=Math.cos(O),B=Math.sin(O);let W=A.data.length;_+=(W*(L*M-B*q)-N)*t,b+=(W*(B*M+L*q)-P)*t}else O+=x;O>S.PI?O-=S.PI2:O<-S.PI&&(O+=S.PI2),O*=t,L=Math.cos(O),B=Math.sin(O),T.a=L*M-B*q,T.c=L*D-B*X,T.b=B*M+L*q,T.d=B*D+L*X}A.appliedValid=!1}}computeWorldPositions(s,t,e,i,r){let n=this.target,l=this.position,a=this.spaces,o=k.setArraySize(this.positions,t*3+2),h=null,c=s.closed,u=s.worldVerticesLength,d=u/6,f=yl.NONE;if(!s.constantSpeed){let O=s.lengths;d-=c?1:2;let L=O[d];if(i&&(l*=L),r)for(let B=0;B<t;B++)a[B]*=L;h=k.setArraySize(this.world,8);for(let B=0,W=0,j=0;B<t;B++,W+=3){let V=a[B];l+=V;let U=l;if(c)U%=L,U<0&&(U+=L),j=0;else if(U<0){f!=yl.BEFORE&&(f=yl.BEFORE,s.computeWorldVertices(n,2,4,h,0,2)),this.addBeforePosition(U,h,0,o,W);continue}else if(U>L){f!=yl.AFTER&&(f=yl.AFTER,s.computeWorldVertices(n,u-6,4,h,0,2)),this.addAfterPosition(U-L,h,0,o,W);continue}for(;;j++){let st=O[j];if(!(U>st)){if(j==0)U/=st;else{let nt=O[j-1];U=(U-nt)/(st-nt)}break}}j!=f&&(f=j,c&&j==d?(s.computeWorldVertices(n,u-4,4,h,0,2),s.computeWorldVertices(n,0,4,h,4,2)):s.computeWorldVertices(n,j*6+2,8,h,0,2)),this.addCurvePosition(U,h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],o,W,e||B>0&&V==0)}return o}c?(u+=2,h=k.setArraySize(this.world,u),s.computeWorldVertices(n,2,u-4,h,0,2),s.computeWorldVertices(n,0,2,h,u-4,2),h[u-2]=h[0],h[u-1]=h[1]):(d--,u-=4,h=k.setArraySize(this.world,u),s.computeWorldVertices(n,2,u,h,0,2));let m=k.setArraySize(this.curves,d),p=0,g=h[0],y=h[1],_=0,b=0,x=0,v=0,w=0,E=0,A=0,T=0,C=0,R=0,N=0,P=0,M=0,D=0;for(let O=0,L=2;O<d;O++,L+=6)_=h[L],b=h[L+1],x=h[L+2],v=h[L+3],w=h[L+4],E=h[L+5],A=(g-_*2+x)*.1875,T=(y-b*2+v)*.1875,C=((_-x)*3-g+w)*.09375,R=((b-v)*3-y+E)*.09375,N=A*2+C,P=T*2+R,M=(_-g)*.75+A+C*.16666667,D=(b-y)*.75+T+R*.16666667,p+=Math.sqrt(M*M+D*D),M+=N,D+=P,N+=C,P+=R,p+=Math.sqrt(M*M+D*D),M+=N,D+=P,p+=Math.sqrt(M*M+D*D),M+=N+C,D+=P+R,p+=Math.sqrt(M*M+D*D),m[O]=p,g=w,y=E;if(i&&(l*=p),r)for(let O=0;O<t;O++)a[O]*=p;let q=this.segments,X=0;for(let O=0,L=0,B=0,W=0;O<t;O++,L+=3){let j=a[O];l+=j;let V=l;if(c)V%=p,V<0&&(V+=p),B=0;else if(V<0){this.addBeforePosition(V,h,0,o,L);continue}else if(V>p){this.addAfterPosition(V-p,h,u-4,o,L);continue}for(;;B++){let U=m[B];if(!(V>U)){if(B==0)V/=U;else{let st=m[B-1];V=(V-st)/(U-st)}break}}if(B!=f){f=B;let U=B*6;for(g=h[U],y=h[U+1],_=h[U+2],b=h[U+3],x=h[U+4],v=h[U+5],w=h[U+6],E=h[U+7],A=(g-_*2+x)*.03,T=(y-b*2+v)*.03,C=((_-x)*3-g+w)*.006,R=((b-v)*3-y+E)*.006,N=A*2+C,P=T*2+R,M=(_-g)*.3+A+C*.16666667,D=(b-y)*.3+T+R*.16666667,X=Math.sqrt(M*M+D*D),q[0]=X,U=1;U<8;U++)M+=N,D+=P,N+=C,P+=R,X+=Math.sqrt(M*M+D*D),q[U]=X;M+=N,D+=P,X+=Math.sqrt(M*M+D*D),q[8]=X,M+=N+C,D+=P+R,X+=Math.sqrt(M*M+D*D),q[9]=X,W=0}for(V*=X;;W++){let U=q[W];if(!(V>U)){if(W==0)V/=U;else{let st=q[W-1];V=W+(V-st)/(U-st)}break}}this.addCurvePosition(V*.1,g,y,_,b,x,v,w,E,o,L,e||O>0&&j==0)}return o}addBeforePosition(s,t,e,i,r){let n=t[e],l=t[e+1],a=t[e+2]-n,o=t[e+3]-l,h=Math.atan2(o,a);i[r]=n+s*Math.cos(h),i[r+1]=l+s*Math.sin(h),i[r+2]=h}addAfterPosition(s,t,e,i,r){let n=t[e+2],l=t[e+3],a=n-t[e],o=l-t[e+1],h=Math.atan2(o,a);i[r]=n+s*Math.cos(h),i[r+1]=l+s*Math.sin(h),i[r+2]=h}addCurvePosition(s,t,e,i,r,n,l,a,o,h,c,u){(s==0||isNaN(s))&&(s=1e-4);let d=s*s,f=d*s,m=1-s,p=m*m,g=p*m,y=m*s,_=y*3,b=m*_,x=_*s,v=t*g+i*b+n*x+a*f,w=e*g+r*b+l*x+o*f;h[c]=v,h[c+1]=w,u&&(h[c+2]=Math.atan2(w-(e*p+r*y*2+l*d),v-(t*p+i*y*2+n*d)))}},Fn=yl;Fn.NONE=-1;Fn.BEFORE=-2;Fn.AFTER=-3;Fn.epsilon=1e-5;var Qh=class{constructor(t,e){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new Bs,this.active=!1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix,this.scaleMix=t.scaleMix,this.shearMix=t.shearMix,this.bones=new Array;for(let i=0;i<t.bones.length;i++)this.bones.push(e.findBone(t.bones[i].name));this.target=e.findBone(t.target.name)}isActive(){return this.active}apply(){this.update()}update(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()}applyAbsoluteWorld(){let t=this.rotateMix,e=this.translateMix,i=this.scaleMix,r=this.shearMix,n=this.target,l=n.matrix,a=l.a,o=l.c,h=l.b,c=l.d,u=a*c-o*h>0?S.degRad:-S.degRad,d=this.data.offsetRotation*u,f=this.data.offsetShearY*u,m=this.bones;for(let p=0,g=m.length;p<g;p++){let y=m[p],_=!1,b=y.matrix;if(t!=0){let x=b.a,v=b.c,w=b.b,E=b.d,A=Math.atan2(h,a)-Math.atan2(w,x)+d;A>S.PI?A-=S.PI2:A<-S.PI&&(A+=S.PI2),A*=t;let T=Math.cos(A),C=Math.sin(A);b.a=T*x-C*w,b.c=T*v-C*E,b.b=C*x+T*w,b.d=C*v+T*E,_=!0}if(e!=0){let x=this.temp;n.localToWorld(x.set(this.data.offsetX,this.data.offsetY)),b.tx+=(x.x-b.tx)*e,b.ty+=(x.y-b.ty)*e,_=!0}if(i>0){let x=Math.sqrt(b.a*b.a+b.b*b.b),v=Math.sqrt(a*a+h*h);x>1e-5&&(x=(x+(v-x+this.data.offsetScaleX)*i)/x),b.a*=x,b.b*=x,x=Math.sqrt(b.c*b.c+b.d*b.d),v=Math.sqrt(o*o+c*c),x>1e-5&&(x=(x+(v-x+this.data.offsetScaleY)*i)/x),b.c*=x,b.d*=x,_=!0}if(r>0){let x=b.c,v=b.d,w=Math.atan2(v,x),E=Math.atan2(c,o)-Math.atan2(h,a)-(w-Math.atan2(b.b,b.a));E>S.PI?E-=S.PI2:E<-S.PI&&(E+=S.PI2),E=w+(E+f)*r;let A=Math.sqrt(x*x+v*v);b.c=Math.cos(E)*A,b.d=Math.sin(E)*A,_=!0}_&&(y.appliedValid=!1)}}applyRelativeWorld(){let t=this.rotateMix,e=this.translateMix,i=this.scaleMix,r=this.shearMix,n=this.target,l=n.matrix,a=l.a,o=l.c,h=l.b,c=l.d,u=a*c-o*h>0?S.degRad:-S.degRad,d=this.data.offsetRotation*u,f=this.data.offsetShearY*u,m=this.bones;for(let p=0,g=m.length;p<g;p++){let y=m[p],_=!1,b=y.matrix;if(t!=0){let x=b.a,v=b.c,w=b.b,E=b.d,A=Math.atan2(h,a)+d;A>S.PI?A-=S.PI2:A<-S.PI&&(A+=S.PI2),A*=t;let T=Math.cos(A),C=Math.sin(A);b.a=T*x-C*w,b.c=T*v-C*E,b.b=C*x+T*w,b.d=C*v+T*E,_=!0}if(e!=0){let x=this.temp;n.localToWorld(x.set(this.data.offsetX,this.data.offsetY)),b.tx+=x.x*e,b.ty+=x.y*e,_=!0}if(i>0){let x=(Math.sqrt(a*a+h*h)-1+this.data.offsetScaleX)*i+1;b.a*=x,b.b*=x,x=(Math.sqrt(o*o+c*c)-1+this.data.offsetScaleY)*i+1,b.c*=x,b.d*=x,_=!0}if(r>0){let x=Math.atan2(c,o)-Math.atan2(h,a);x>S.PI?x-=S.PI2:x<-S.PI&&(x+=S.PI2);let v=b.c,w=b.d;x=Math.atan2(w,v)+(x-S.PI/2+f)*r;let E=Math.sqrt(v*v+w*w);b.c=Math.cos(x)*E,b.d=Math.sin(x)*E,_=!0}_&&(y.appliedValid=!1)}}applyAbsoluteLocal(){let t=this.rotateMix,e=this.translateMix,i=this.scaleMix,r=this.shearMix,n=this.target;n.appliedValid||n.updateAppliedTransform();let l=this.bones;for(let a=0,o=l.length;a<o;a++){let h=l[a];h.appliedValid||h.updateAppliedTransform();let c=h.arotation;if(t!=0){let g=n.arotation-c+this.data.offsetRotation;g-=(16384-(16384.499999999996-g/360|0))*360,c+=g*t}let u=h.ax,d=h.ay;e!=0&&(u+=(n.ax-u+this.data.offsetX)*e,d+=(n.ay-d+this.data.offsetY)*e);let f=h.ascaleX,m=h.ascaleY;i>0&&(f>1e-5&&(f=(f+(n.ascaleX-f+this.data.offsetScaleX)*i)/f),m>1e-5&&(m=(m+(n.ascaleY-m+this.data.offsetScaleY)*i)/m));let p=h.ashearY;if(r>0){let g=n.ashearY-p+this.data.offsetShearY;g-=(16384-(16384.499999999996-g/360|0))*360,h.shearY+=g*r}h.updateWorldTransformWith(u,d,c,f,m,h.ashearX,p)}}applyRelativeLocal(){let t=this.rotateMix,e=this.translateMix,i=this.scaleMix,r=this.shearMix,n=this.target;n.appliedValid||n.updateAppliedTransform();let l=this.bones;for(let a=0,o=l.length;a<o;a++){let h=l[a];h.appliedValid||h.updateAppliedTransform();let c=h.arotation;t!=0&&(c+=(n.arotation+this.data.offsetRotation)*t);let u=h.ax,d=h.ay;e!=0&&(u+=(n.ax+this.data.offsetX)*e,d+=(n.ay+this.data.offsetY)*e);let f=h.ascaleX,m=h.ascaleY;i>0&&(f>1e-5&&(f*=(n.ascaleX-1+this.data.offsetScaleX)*i+1),m>1e-5&&(m*=(n.ascaleY-1+this.data.offsetScaleY)*i+1));let p=h.ashearY;r>0&&(p+=(n.ashearY+this.data.offsetShearY)*r),h.updateWorldTransformWith(u,d,c,f,m,h.ashearX,p)}}};var id=class{constructor(s){if(this._updateCache=new Array,this.updateCacheReset=new Array,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,s==null)throw new Error("data cannot be null.");this.data=s,this.bones=new Array;for(let t=0;t<s.bones.length;t++){let e=s.bones[t],i;if(e.parent==null)i=new _l(e,this,null);else{let r=this.bones[e.parent.index];i=new _l(e,this,r),r.children.push(i)}this.bones.push(i)}this.slots=new Array,this.drawOrder=new Array;for(let t=0;t<s.slots.length;t++){let e=s.slots[t],i=this.bones[e.boneData.index],r=new Sn(e,i);this.slots.push(r),this.drawOrder.push(r)}this.ikConstraints=new Array;for(let t=0;t<s.ikConstraints.length;t++){let e=s.ikConstraints[t];this.ikConstraints.push(new Zh(e,this))}this.transformConstraints=new Array;for(let t=0;t<s.transformConstraints.length;t++){let e=s.transformConstraints[t];this.transformConstraints.push(new Qh(e,this))}this.pathConstraints=new Array;for(let t=0;t<s.pathConstraints.length;t++){let e=s.pathConstraints[t];this.pathConstraints.push(new Fn(e,this))}this.color=new G(1,1,1,1),this.updateCache()}updateCache(){let s=this._updateCache;s.length=0,this.updateCacheReset.length=0;let t=this.bones;for(let h=0,c=t.length;h<c;h++){let u=t[h];u.sorted=u.data.skinRequired,u.active=!u.sorted}if(this.skin!=null){let h=this.skin.bones;for(let c=0,u=this.skin.bones.length;c<u;c++){let d=this.bones[h[c].index];do d.sorted=!1,d.active=!0,d=d.parent;while(d!=null)}}let e=this.ikConstraints,i=this.transformConstraints,r=this.pathConstraints,n=e.length,l=i.length,a=r.length,o=n+l+a;t:for(let h=0;h<o;h++){for(let c=0;c<n;c++){let u=e[c];if(u.data.order==h){this.sortIkConstraint(u);continue t}}for(let c=0;c<l;c++){let u=i[c];if(u.data.order==h){this.sortTransformConstraint(u);continue t}}for(let c=0;c<a;c++){let u=r[c];if(u.data.order==h){this.sortPathConstraint(u);continue t}}}for(let h=0,c=t.length;h<c;h++)this.sortBone(t[h])}sortIkConstraint(s){if(s.active=s.target.isActive()&&(!s.data.skinRequired||this.skin!=null&&k.contains(this.skin.constraints,s.data,!0)),!s.active)return;let t=s.target;this.sortBone(t);let e=s.bones,i=e[0];if(this.sortBone(i),e.length>1){let r=e[e.length-1];this._updateCache.indexOf(r)>-1||this.updateCacheReset.push(r)}this._updateCache.push(s),this.sortReset(i.children),e[e.length-1].sorted=!0}sortPathConstraint(s){if(s.active=s.target.bone.isActive()&&(!s.data.skinRequired||this.skin!=null&&k.contains(this.skin.constraints,s.data,!0)),!s.active)return;let t=s.target,e=t.data.index,i=t.bone;this.skin!=null&&this.sortPathConstraintAttachment(this.skin,e,i),this.data.defaultSkin!=null&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,e,i);for(let a=0,o=this.data.skins.length;a<o;a++)this.sortPathConstraintAttachment(this.data.skins[a],e,i);let r=t.getAttachment();r instanceof Us&&this.sortPathConstraintAttachmentWith(r,i);let n=s.bones,l=n.length;for(let a=0;a<l;a++)this.sortBone(n[a]);this._updateCache.push(s);for(let a=0;a<l;a++)this.sortReset(n[a].children);for(let a=0;a<l;a++)n[a].sorted=!0}sortTransformConstraint(s){if(s.active=s.target.isActive()&&(!s.data.skinRequired||this.skin!=null&&k.contains(this.skin.constraints,s.data,!0)),!s.active)return;this.sortBone(s.target);let t=s.bones,e=t.length;if(s.data.local)for(let i=0;i<e;i++){let r=t[i];this.sortBone(r.parent),this._updateCache.indexOf(r)>-1||this.updateCacheReset.push(r)}else for(let i=0;i<e;i++)this.sortBone(t[i]);this._updateCache.push(s);for(let i=0;i<e;i++)this.sortReset(t[i].children);for(let i=0;i<e;i++)t[i].sorted=!0}sortPathConstraintAttachment(s,t,e){let i=s.attachments[t];if(!!i)for(let r in i)this.sortPathConstraintAttachmentWith(i[r],e)}sortPathConstraintAttachmentWith(s,t){if(!(s instanceof Us))return;let e=s.bones;if(e==null)this.sortBone(t);else{let i=this.bones,r=0;for(;r<e.length;){let n=e[r++];for(let l=r+n;r<l;r++){let a=e[r];this.sortBone(i[a])}}}}sortBone(s){if(s.sorted)return;let t=s.parent;t!=null&&this.sortBone(t),s.sorted=!0,this._updateCache.push(s)}sortReset(s){for(let t=0,e=s.length;t<e;t++){let i=s[t];!i.active||(i.sorted&&this.sortReset(i.children),i.sorted=!1)}}updateWorldTransform(){let s=this.updateCacheReset;for(let e=0,i=s.length;e<i;e++){let r=s[e];r.ax=r.x,r.ay=r.y,r.arotation=r.rotation,r.ascaleX=r.scaleX,r.ascaleY=r.scaleY,r.ashearX=r.shearX,r.ashearY=r.shearY,r.appliedValid=!0}let t=this._updateCache;for(let e=0,i=t.length;e<i;e++)t[e].update()}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){let s=this.bones;for(let r=0,n=s.length;r<n;r++)s[r].setToSetupPose();let t=this.ikConstraints;for(let r=0,n=t.length;r<n;r++){let l=t[r];l.mix=l.data.mix,l.softness=l.data.softness,l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch}let e=this.transformConstraints;for(let r=0,n=e.length;r<n;r++){let l=e[r],a=l.data;l.rotateMix=a.rotateMix,l.translateMix=a.translateMix,l.scaleMix=a.scaleMix,l.shearMix=a.shearMix}let i=this.pathConstraints;for(let r=0,n=i.length;r<n;r++){let l=i[r],a=l.data;l.position=a.position,l.spacing=a.spacing,l.rotateMix=a.rotateMix,l.translateMix=a.translateMix}}setSlotsToSetupPose(){let s=this.slots;k.arrayCopy(s,0,this.drawOrder,0,s.length);for(let t=0,e=s.length;t<e;t++)s[t].setToSetupPose()}getRootBone(){return this.bones.length==0?null:this.bones[0]}findBone(s){if(s==null)throw new Error("boneName cannot be null.");let t=this.bones;for(let e=0,i=t.length;e<i;e++){let r=t[e];if(r.data.name==s)return r}return null}findBoneIndex(s){if(s==null)throw new Error("boneName cannot be null.");let t=this.bones;for(let e=0,i=t.length;e<i;e++)if(t[e].data.name==s)return e;return-1}findSlot(s){if(s==null)throw new Error("slotName cannot be null.");let t=this.slots;for(let e=0,i=t.length;e<i;e++){let r=t[e];if(r.data.name==s)return r}return null}findSlotIndex(s){if(s==null)throw new Error("slotName cannot be null.");let t=this.slots;for(let e=0,i=t.length;e<i;e++)if(t[e].data.name==s)return e;return-1}setSkinByName(s){let t=this.data.findSkin(s);if(t==null)throw new Error(`Skin not found: ${s}`);this.setSkin(t)}setSkin(s){if(s!=this.skin){if(s!=null)if(this.skin!=null)s.attachAll(this,this.skin);else{let t=this.slots;for(let e=0,i=t.length;e<i;e++){let r=t[e],n=r.data.attachmentName;if(n!=null){let l=s.getAttachment(e,n);l!=null&&r.setAttachment(l)}}}this.skin=s,this.updateCache()}}getAttachmentByName(s,t){return this.getAttachment(this.data.findSlotIndex(s),t)}getAttachment(s,t){if(t==null)throw new Error("attachmentName cannot be null.");if(this.skin!=null){let e=this.skin.getAttachment(s,t);if(e!=null)return e}return this.data.defaultSkin!=null?this.data.defaultSkin.getAttachment(s,t):null}setAttachment(s,t){if(s==null)throw new Error("slotName cannot be null.");let e=this.slots;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.data.name==s){let l=null;if(t!=null&&(l=this.getAttachment(i,t),l==null))throw new Error(`Attachment not found: ${t}, for slot: ${s}`);n.setAttachment(l);return}}throw new Error(`Slot not found: ${s}`)}findIkConstraint(s){if(s==null)throw new Error("constraintName cannot be null.");let t=this.ikConstraints;for(let e=0,i=t.length;e<i;e++){let r=t[e];if(r.data.name==s)return r}return null}findTransformConstraint(s){if(s==null)throw new Error("constraintName cannot be null.");let t=this.transformConstraints;for(let e=0,i=t.length;e<i;e++){let r=t[e];if(r.data.name==s)return r}return null}findPathConstraint(s){if(s==null)throw new Error("constraintName cannot be null.");let t=this.pathConstraints;for(let e=0,i=t.length;e<i;e++){let r=t[e];if(r.data.name==s)return r}return null}getBounds(s,t,e=new Array(2)){if(s==null)throw new Error("offset cannot be null.");if(t==null)throw new Error("size cannot be null.");let i=this.drawOrder,r=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY;for(let o=0,h=i.length;o<h;o++){let c=i[o];if(!c.bone.active)continue;let u=0,d=null,f=c.getAttachment();if(f instanceof ct)u=8,d=k.setArraySize(e,u,0),f.computeWorldVertices(c.bone,d,0,2);else if(f instanceof Ls){let m=f;u=m.worldVerticesLength,d=k.setArraySize(e,u,0),m.computeWorldVertices(c,0,u,d,0,2)}if(d!=null)for(let m=0,p=d.length;m<p;m+=2){let g=d[m],y=d[m+1];r=Math.min(r,g),n=Math.min(n,y),l=Math.max(l,g),a=Math.max(a,y)}}s.set(r,n),t.set(l-r,a-n)}update(s){this.time+=s}get flipX(){return this.scaleX==-1}set flipX(s){id.deprecatedWarning1||(id.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=s?1:-1}get flipY(){return this.scaleY==-1}set flipY(s){id.deprecatedWarning1||(id.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=s?1:-1}},rd=id;rd.deprecatedWarning1=!1;var Bn=class{constructor(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}findBone(t){if(t==null)throw new Error("boneName cannot be null.");let e=this.bones;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.name==t)return n}return null}findBoneIndex(t){if(t==null)throw new Error("boneName cannot be null.");let e=this.bones;for(let i=0,r=e.length;i<r;i++)if(e[i].name==t)return i;return-1}findSlot(t){if(t==null)throw new Error("slotName cannot be null.");let e=this.slots;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.name==t)return n}return null}findSlotIndex(t){if(t==null)throw new Error("slotName cannot be null.");let e=this.slots;for(let i=0,r=e.length;i<r;i++)if(e[i].name==t)return i;return-1}findSkin(t){if(t==null)throw new Error("skinName cannot be null.");let e=this.skins;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.name==t)return n}return null}findEvent(t){if(t==null)throw new Error("eventDataName cannot be null.");let e=this.events;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.name==t)return n}return null}findAnimation(t){if(t==null)throw new Error("animationName cannot be null.");let e=this.animations;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.name==t)return n}return null}findIkConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");let e=this.ikConstraints;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.name==t)return n}return null}findTransformConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");let e=this.transformConstraints;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.name==t)return n}return null}findPathConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");let e=this.pathConstraints;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.name==t)return n}return null}findPathConstraintIndex(t){if(t==null)throw new Error("pathConstraintName cannot be null.");let e=this.pathConstraints;for(let i=0,r=e.length;i<r;i++)if(e[i].name==t)return i;return-1}};var Ln=class{constructor(t,e,i){if(this.color=new G(1,1,1,1),t<0)throw new Error("index must be >= 0.");if(e==null)throw new Error("name cannot be null.");if(i==null)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=i}};var Un=class extends Vi{constructor(t){super(t,0,!1),this.bones=new Array,this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1}};var Jh=class{constructor(t,e,i){this.slotIndex=t,this.name=e,this.attachment=i}},Fr=class{constructor(t){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,t==null)throw new Error("name cannot be null.");this.name=t}setAttachment(t,e,i){if(i==null)throw new Error("attachment cannot be null.");let r=this.attachments;t>=r.length&&(r.length=t+1),r[t]||(r[t]={}),r[t][e]=i}addSkin(t){for(let i=0;i<t.bones.length;i++){let r=t.bones[i],n=!1;for(let l=0;l<this.bones.length;l++)if(this.bones[l]==r){n=!0;break}n||this.bones.push(r)}for(let i=0;i<t.constraints.length;i++){let r=t.constraints[i],n=!1;for(let l=0;l<this.constraints.length;l++)if(this.constraints[l]==r){n=!0;break}n||this.constraints.push(r)}let e=t.getAttachments();for(let i=0;i<e.length;i++){let r=e[i];this.setAttachment(r.slotIndex,r.name,r.attachment)}}copySkin(t){for(let i=0;i<t.bones.length;i++){let r=t.bones[i],n=!1;for(let l=0;l<this.bones.length;l++)if(this.bones[l]==r){n=!0;break}n||this.bones.push(r)}for(let i=0;i<t.constraints.length;i++){let r=t.constraints[i],n=!1;for(let l=0;l<this.constraints.length;l++)if(this.constraints[l]==r){n=!0;break}n||this.constraints.push(r)}let e=t.getAttachments();for(let i=0;i<e.length;i++){let r=e[i];r.attachment!=null&&(r.attachment instanceof Ls?(r.attachment=r.attachment.newLinkedMesh(),this.setAttachment(r.slotIndex,r.name,r.attachment)):(r.attachment=r.attachment.copy(),this.setAttachment(r.slotIndex,r.name,r.attachment)))}}getAttachment(t,e){let i=this.attachments[t];return i?i[e]:null}removeAttachment(t,e){let i=this.attachments[t];i&&(i[e]=null)}getAttachments(){let t=new Array;for(let e=0;e<this.attachments.length;e++){let i=this.attachments[e];if(i)for(let r in i){let n=i[r];n&&t.push(new Jh(e,r,n))}}return t}getAttachmentsForSlot(t,e){let i=this.attachments[t];if(i)for(let r in i){let n=i[r];n&&e.push(new Jh(t,r,n))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(t,e){let i=0;for(let r=0;r<t.slots.length;r++){let n=t.slots[r],l=n.getAttachment();if(l&&i<e.attachments.length){let a=e.attachments[i];for(let o in a){let h=a[o];if(l==h){let c=this.getAttachment(i,o);c!=null&&n.setAttachment(c);break}}}i++}}};var re=class{constructor(s){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=s}readSkeletonData(s){let t=this.scale,e=new Bn;e.name="";let i=new fi(s);e.hash=i.readString(),e.version=i.readString(),e.version==="3.8.75"&&console.error("Unsupported skeleton data, 3.8.75 is deprecated, please export with a newer version of Spine."),e.x=i.readFloat(),e.y=i.readFloat(),e.width=i.readFloat(),e.height=i.readFloat();let r=i.readBoolean();r&&(e.fps=i.readFloat(),e.imagesPath=i.readString(),e.audioPath=i.readString());let n=0;n=i.readInt(!0);for(let a=0;a<n;a++)i.strings.push(i.readString());n=i.readInt(!0);for(let a=0;a<n;a++){let o=i.readString(),h=a==0?null:e.bones[i.readInt(!0)],c=new Mn(a,o,h);c.rotation=i.readFloat(),c.x=i.readFloat()*t,c.y=i.readFloat()*t,c.scaleX=i.readFloat(),c.scaleY=i.readFloat(),c.shearX=i.readFloat(),c.shearY=i.readFloat(),c.length=i.readFloat()*t,c.transformMode=re.TransformModeValues[i.readInt(!0)],c.skinRequired=i.readBoolean(),r&&G.rgba8888ToColor(c.color,i.readInt32()),e.bones.push(c)}n=i.readInt(!0);for(let a=0;a<n;a++){let o=i.readString(),h=e.bones[i.readInt(!0)],c=new Ln(a,o,h);G.rgba8888ToColor(c.color,i.readInt32());let u=i.readInt32();u!=-1&&G.rgb888ToColor(c.darkColor=new G,u),c.attachmentName=i.readStringRef(),c.blendMode=re.BlendModeValues[i.readInt(!0)],e.slots.push(c)}n=i.readInt(!0);for(let a=0,o;a<n;a++){let h=new On(i.readString());h.order=i.readInt(!0),h.skinRequired=i.readBoolean(),o=i.readInt(!0);for(let c=0;c<o;c++)h.bones.push(e.bones[i.readInt(!0)]);h.target=e.bones[i.readInt(!0)],h.mix=i.readFloat(),h.softness=i.readFloat()*t,h.bendDirection=i.readByte(),h.compress=i.readBoolean(),h.stretch=i.readBoolean(),h.uniform=i.readBoolean(),e.ikConstraints.push(h)}n=i.readInt(!0);for(let a=0,o;a<n;a++){let h=new Un(i.readString());h.order=i.readInt(!0),h.skinRequired=i.readBoolean(),o=i.readInt(!0);for(let c=0;c<o;c++)h.bones.push(e.bones[i.readInt(!0)]);h.target=e.bones[i.readInt(!0)],h.local=i.readBoolean(),h.relative=i.readBoolean(),h.offsetRotation=i.readFloat(),h.offsetX=i.readFloat()*t,h.offsetY=i.readFloat()*t,h.offsetScaleX=i.readFloat(),h.offsetScaleY=i.readFloat(),h.offsetShearY=i.readFloat(),h.rotateMix=i.readFloat(),h.translateMix=i.readFloat(),h.scaleMix=i.readFloat(),h.shearMix=i.readFloat(),e.transformConstraints.push(h)}n=i.readInt(!0);for(let a=0,o;a<n;a++){let h=new Nn(i.readString());h.order=i.readInt(!0),h.skinRequired=i.readBoolean(),o=i.readInt(!0);for(let c=0;c<o;c++)h.bones.push(e.bones[i.readInt(!0)]);h.target=e.slots[i.readInt(!0)],h.positionMode=re.PositionModeValues[i.readInt(!0)],h.spacingMode=re.SpacingModeValues[i.readInt(!0)],h.rotateMode=re.RotateModeValues[i.readInt(!0)],h.offsetRotation=i.readFloat(),h.position=i.readFloat(),h.positionMode==It.Fixed&&(h.position*=t),h.spacing=i.readFloat(),(h.spacingMode==ie.Length||h.spacingMode==ie.Fixed)&&(h.spacing*=t),h.rotateMix=i.readFloat(),h.translateMix=i.readFloat(),e.pathConstraints.push(h)}let l=this.readSkin(i,e,!0,r);l!=null&&(e.defaultSkin=l,e.skins.push(l));{let a=e.skins.length;for(k.setArraySize(e.skins,n=a+i.readInt(!0));a<n;a++)e.skins[a]=this.readSkin(i,e,!1,r)}n=this.linkedMeshes.length;for(let a=0;a<n;a++){let o=this.linkedMeshes[a],h=o.skin==null?e.defaultSkin:e.findSkin(o.skin);if(h==null)throw new Error(`Skin not found: ${o.skin}`);let c=h.getAttachment(o.slotIndex,o.parent);if(c==null)throw new Error(`Parent mesh not found: ${o.parent}`);o.mesh.deformAttachment=o.inheritDeform?c:o.mesh,o.mesh.setParentMesh(c)}this.linkedMeshes.length=0,n=i.readInt(!0);for(let a=0;a<n;a++){let o=new Pn(i.readStringRef());o.intValue=i.readInt(!1),o.floatValue=i.readFloat(),o.stringValue=i.readString(),o.audioPath=i.readString(),o.audioPath!=null&&(o.volume=i.readFloat(),o.balance=i.readFloat()),e.events.push(o)}n=i.readInt(!0);for(let a=0;a<n;a++)e.animations.push(this.readAnimation(i,i.readString(),e));return e}readSkin(s,t,e,i){let r=null,n=0;if(e){if(n=s.readInt(!0),n==0)return null;r=new Fr("default")}else{r=new Fr(s.readStringRef()),r.bones.length=s.readInt(!0);for(let l=0,a=r.bones.length;l<a;l++)r.bones[l]=t.bones[s.readInt(!0)];for(let l=0,a=s.readInt(!0);l<a;l++)r.constraints.push(t.ikConstraints[s.readInt(!0)]);for(let l=0,a=s.readInt(!0);l<a;l++)r.constraints.push(t.transformConstraints[s.readInt(!0)]);for(let l=0,a=s.readInt(!0);l<a;l++)r.constraints.push(t.pathConstraints[s.readInt(!0)]);n=s.readInt(!0)}for(let l=0;l<n;l++){let a=s.readInt(!0);for(let o=0,h=s.readInt(!0);o<h;o++){let c=s.readStringRef(),u=this.readAttachment(s,t,r,a,c,i);u!=null&&r.setAttachment(a,c,u)}}return r}readAttachment(s,t,e,i,r,n){let l=this.scale,a=s.readStringRef();a==null&&(a=r);let o=s.readByte();switch(re.AttachmentTypeValues[o]){case tt.Region:{let c=s.readStringRef(),u=s.readFloat(),d=s.readFloat(),f=s.readFloat(),m=s.readFloat(),p=s.readFloat(),g=s.readFloat(),y=s.readFloat(),_=s.readInt32();c==null&&(c=a);let b=this.attachmentLoader.newRegionAttachment(e,a,c);return b==null?null:(b.path=c,b.x=d*l,b.y=f*l,b.scaleX=m,b.scaleY=p,b.rotation=u,b.width=g*l,b.height=y*l,G.rgba8888ToColor(b.color,_),b)}case tt.BoundingBox:{let c=s.readInt(!0),u=this.readVertices(s,c),d=n?s.readInt32():0,f=this.attachmentLoader.newBoundingBoxAttachment(e,a);return f==null?null:(f.worldVerticesLength=c<<1,f.vertices=u.vertices,f.bones=u.bones,n&&G.rgba8888ToColor(f.color,d),f)}case tt.Mesh:{let c=s.readStringRef(),u=s.readInt32(),d=s.readInt(!0),f=this.readFloatArray(s,d<<1,1),m=this.readShortArray(s),p=this.readVertices(s,d),g=s.readInt(!0),y=null,_=0,b=0;n&&(y=this.readShortArray(s),_=s.readFloat(),b=s.readFloat()),c==null&&(c=a);let x=this.attachmentLoader.newMeshAttachment(e,a,c);return x==null?null:(x.path=c,G.rgba8888ToColor(x.color,u),x.bones=p.bones,x.vertices=p.vertices,x.worldVerticesLength=d<<1,x.triangles=m,x.regionUVs=new Float32Array(f),x.hullLength=g<<1,n&&(x.edges=y,x.width=_*l,x.height=b*l),x)}case tt.LinkedMesh:{let c=s.readStringRef(),u=s.readInt32(),d=s.readStringRef(),f=s.readStringRef(),m=s.readBoolean(),p=0,g=0;n&&(p=s.readFloat(),g=s.readFloat()),c==null&&(c=a);let y=this.attachmentLoader.newMeshAttachment(e,a,c);return y==null?null:(y.path=c,G.rgba8888ToColor(y.color,u),n&&(y.width=p*l,y.height=g*l),this.linkedMeshes.push(new _g(y,d,i,f,m)),y)}case tt.Path:{let c=s.readBoolean(),u=s.readBoolean(),d=s.readInt(!0),f=this.readVertices(s,d),m=k.newArray(d/3,0);for(let y=0,_=m.length;y<_;y++)m[y]=s.readFloat()*l;let p=n?s.readInt32():0,g=this.attachmentLoader.newPathAttachment(e,a);return g==null?null:(g.closed=c,g.constantSpeed=u,g.worldVerticesLength=d<<1,g.vertices=f.vertices,g.bones=f.bones,g.lengths=m,n&&G.rgba8888ToColor(g.color,p),g)}case tt.Point:{let c=s.readFloat(),u=s.readFloat(),d=s.readFloat(),f=n?s.readInt32():0,m=this.attachmentLoader.newPointAttachment(e,a);return m==null?null:(m.x=u*l,m.y=d*l,m.rotation=c,n&&G.rgba8888ToColor(m.color,f),m)}case tt.Clipping:{let c=s.readInt(!0),u=s.readInt(!0),d=this.readVertices(s,u),f=n?s.readInt32():0,m=this.attachmentLoader.newClippingAttachment(e,a);return m==null?null:(m.endSlot=t.slots[c],m.worldVerticesLength=u<<1,m.vertices=d.vertices,m.bones=d.bones,n&&G.rgba8888ToColor(m.color,f),m)}}return null}readVertices(s,t){let e=t<<1,i=new yg,r=this.scale;if(!s.readBoolean())return i.vertices=this.readFloatArray(s,e,r),i;let n=new Array,l=new Array;for(let a=0;a<t;a++){let o=s.readInt(!0);l.push(o);for(let h=0;h<o;h++)l.push(s.readInt(!0)),n.push(s.readFloat()*r),n.push(s.readFloat()*r),n.push(s.readFloat())}return i.vertices=k.toFloatArray(n),i.bones=l,i}readFloatArray(s,t,e){let i=new Array(t);if(e==1)for(let r=0;r<t;r++)i[r]=s.readFloat();else for(let r=0;r<t;r++)i[r]=s.readFloat()*e;return i}readShortArray(s){let t=s.readInt(!0),e=new Array(t);for(let i=0;i<t;i++)e[i]=s.readShort();return e}readAnimation(s,t,e){let i=new Array,r=this.scale,n=0,l=new G,a=new G;for(let c=0,u=s.readInt(!0);c<u;c++){let d=s.readInt(!0);for(let f=0,m=s.readInt(!0);f<m;f++){let p=s.readByte(),g=s.readInt(!0);switch(p){case re.SLOT_ATTACHMENT:{let y=new Ds(g);y.slotIndex=d;for(let _=0;_<g;_++)y.setFrame(_,s.readFloat(),s.readStringRef());i.push(y),n=Math.max(n,y.frames[g-1]);break}case re.SLOT_COLOR:{let y=new Ee(g);y.slotIndex=d;for(let _=0;_<g;_++){let b=s.readFloat();G.rgba8888ToColor(l,s.readInt32()),y.setFrame(_,b,l.r,l.g,l.b,l.a),_<g-1&&this.readCurve(s,_,y)}i.push(y),n=Math.max(n,y.frames[(g-1)*Ee.ENTRIES]);break}case re.SLOT_TWO_COLOR:{let y=new Wt(g);y.slotIndex=d;for(let _=0;_<g;_++){let b=s.readFloat();G.rgba8888ToColor(l,s.readInt32()),G.rgb888ToColor(a,s.readInt32()),y.setFrame(_,b,l.r,l.g,l.b,l.a,a.r,a.g,a.b),_<g-1&&this.readCurve(s,_,y)}i.push(y),n=Math.max(n,y.frames[(g-1)*Wt.ENTRIES]);break}}}}for(let c=0,u=s.readInt(!0);c<u;c++){let d=s.readInt(!0);for(let f=0,m=s.readInt(!0);f<m;f++){let p=s.readByte(),g=s.readInt(!0);switch(p){case re.BONE_ROTATE:{let y=new he(g);y.boneIndex=d;for(let _=0;_<g;_++)y.setFrame(_,s.readFloat(),s.readFloat()),_<g-1&&this.readCurve(s,_,y);i.push(y),n=Math.max(n,y.frames[(g-1)*he.ENTRIES]);break}case re.BONE_TRANSLATE:case re.BONE_SCALE:case re.BONE_SHEAR:{let y,_=1;p==re.BONE_SCALE?y=new be(g):p==re.BONE_SHEAR?y=new _e(g):(y=new Ge(g),_=r),y.boneIndex=d;for(let b=0;b<g;b++)y.setFrame(b,s.readFloat(),s.readFloat()*_,s.readFloat()*_),b<g-1&&this.readCurve(s,b,y);i.push(y),n=Math.max(n,y.frames[(g-1)*Ge.ENTRIES]);break}}}}for(let c=0,u=s.readInt(!0);c<u;c++){let d=s.readInt(!0),f=s.readInt(!0),m=new de(f);m.ikConstraintIndex=d;for(let p=0;p<f;p++)m.setFrame(p,s.readFloat(),s.readFloat(),s.readFloat()*r,s.readByte(),s.readBoolean(),s.readBoolean()),p<f-1&&this.readCurve(s,p,m);i.push(m),n=Math.max(n,m.frames[(f-1)*de.ENTRIES])}for(let c=0,u=s.readInt(!0);c<u;c++){let d=s.readInt(!0),f=s.readInt(!0),m=new Ae(f);m.transformConstraintIndex=d;for(let p=0;p<f;p++)m.setFrame(p,s.readFloat(),s.readFloat(),s.readFloat(),s.readFloat(),s.readFloat()),p<f-1&&this.readCurve(s,p,m);i.push(m),n=Math.max(n,m.frames[(f-1)*Ae.ENTRIES])}for(let c=0,u=s.readInt(!0);c<u;c++){let d=s.readInt(!0),f=e.pathConstraints[d];for(let m=0,p=s.readInt(!0);m<p;m++){let g=s.readByte(),y=s.readInt(!0);switch(g){case re.PATH_POSITION:case re.PATH_SPACING:{let _,b=1;g==re.PATH_SPACING?(_=new Ve(y),(f.spacingMode==ie.Length||f.spacingMode==ie.Fixed)&&(b=r)):(_=new Vs(y),f.positionMode==It.Fixed&&(b=r)),_.pathConstraintIndex=d;for(let x=0;x<y;x++)_.setFrame(x,s.readFloat(),s.readFloat()*b),x<y-1&&this.readCurve(s,x,_);i.push(_),n=Math.max(n,_.frames[(y-1)*Vs.ENTRIES]);break}case re.PATH_MIX:{let _=new xs(y);_.pathConstraintIndex=d;for(let b=0;b<y;b++)_.setFrame(b,s.readFloat(),s.readFloat(),s.readFloat()),b<y-1&&this.readCurve(s,b,_);i.push(_),n=Math.max(n,_.frames[(y-1)*xs.ENTRIES]);break}}}}for(let c=0,u=s.readInt(!0);c<u;c++){let d=e.skins[s.readInt(!0)];for(let f=0,m=s.readInt(!0);f<m;f++){let p=s.readInt(!0);for(let g=0,y=s.readInt(!0);g<y;g++){let _=d.getAttachment(p,s.readStringRef()),b=_.bones!=null,x=_.vertices,v=b?x.length/3*2:x.length,w=s.readInt(!0),E=new Rn(w);E.slotIndex=p,E.attachment=_;for(let A=0;A<w;A++){let T=s.readFloat(),C,R=s.readInt(!0);if(R==0)C=b?k.newFloatArray(v):x;else{C=k.newFloatArray(v);let N=s.readInt(!0);if(R+=N,r==1)for(let P=N;P<R;P++)C[P]=s.readFloat();else for(let P=N;P<R;P++)C[P]=s.readFloat()*r;if(!b)for(let P=0,M=C.length;P<M;P++)C[P]+=x[P]}E.setFrame(A,T,C),A<w-1&&this.readCurve(s,A,E)}i.push(E),n=Math.max(n,E.frames[w-1])}}}let o=s.readInt(!0);if(o>0){let c=new ri(o),u=e.slots.length;for(let d=0;d<o;d++){let f=s.readFloat(),m=s.readInt(!0),p=k.newArray(u,0);for(let b=u-1;b>=0;b--)p[b]=-1;let g=k.newArray(u-m,0),y=0,_=0;for(let b=0;b<m;b++){let x=s.readInt(!0);for(;y!=x;)g[_++]=y++;p[y+s.readInt(!0)]=y++}for(;y<u;)g[_++]=y++;for(let b=u-1;b>=0;b--)p[b]==-1&&(p[b]=g[--_]);c.setFrame(d,f,p)}i.push(c),n=Math.max(n,c.frames[o-1])}let h=s.readInt(!0);if(h>0){let c=new Di(h);for(let u=0;u<h;u++){let d=s.readFloat(),f=e.events[s.readInt(!0)],m=new kn(d,f);m.intValue=s.readInt(!1),m.floatValue=s.readFloat(),m.stringValue=s.readBoolean()?s.readString():f.stringValue,m.data.audioPath!=null&&(m.volume=s.readFloat(),m.balance=s.readFloat()),c.setFrame(u,m)}i.push(c),n=Math.max(n,c.frames[h-1])}return new Dt(t,i,n)}readCurve(s,t,e){switch(s.readByte()){case re.CURVE_STEPPED:e.setStepped(t);break;case re.CURVE_BEZIER:this.setCurve(e,t,s.readFloat(),s.readFloat(),s.readFloat(),s.readFloat());break}}setCurve(s,t,e,i,r,n){s.setCurve(t,e,i,r,n)}},Zt=re;Zt.AttachmentTypeValues=[0,1,2,3,4,5,6];Zt.TransformModeValues=[it.Normal,it.OnlyTranslation,it.NoRotationOrReflection,it.NoScale,it.NoScaleOrReflection];Zt.PositionModeValues=[It.Fixed,It.Percent];Zt.SpacingModeValues=[ie.Length,ie.Fixed,ie.Percent];Zt.RotateModeValues=[Pt.Tangent,Pt.Chain,Pt.ChainScale];Zt.BlendModeValues=[Z.NORMAL,Z.ADD,Z.MULTIPLY,Z.SCREEN];Zt.BONE_ROTATE=0;Zt.BONE_TRANSLATE=1;Zt.BONE_SCALE=2;Zt.BONE_SHEAR=3;Zt.SLOT_ATTACHMENT=0;Zt.SLOT_COLOR=1;Zt.SLOT_TWO_COLOR=2;Zt.PATH_POSITION=0;Zt.PATH_SPACING=1;Zt.PATH_MIX=2;Zt.CURVE_LINEAR=0;Zt.CURVE_STEPPED=1;Zt.CURVE_BEZIER=2;var _g=class{constructor(t,e,i,r,n){this.mesh=t,this.skin=e,this.slotIndex=i,this.parent=r,this.inheritDeform=n}},yg=class{constructor(t=null,e=null){this.bones=t,this.vertices=e}};var fm=class extends ti{};var ni=class{constructor(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){let e=this.scale,i=new Bn,r=typeof t=="string"?JSON.parse(t):t,n=r.skeleton;if(n!=null){if(i.hash=n.hash,i.version=n.spine,i.version.substr(0,3)!=="3.8"){let l=`Spine 3.8 loader cant load version ${n.spine}. Please configure your pixi-spine bundle`;console.error(l)}i.version==="3.8.75"&&console.error("Unsupported skeleton data, 3.8.75 is deprecated, please export with a newer version of Spine."),i.x=n.x,i.y=n.y,i.width=n.width,i.height=n.height,i.fps=n.fps,i.imagesPath=n.images}if(r.bones)for(let l=0;l<r.bones.length;l++){let a=r.bones[l],o=null,h=this.getValue(a,"parent",null);if(h!=null&&(o=i.findBone(h),o==null))throw new Error(`Parent bone not found: ${h}`);let c=new Mn(i.bones.length,a.name,o);c.length=this.getValue(a,"length",0)*e,c.x=this.getValue(a,"x",0)*e,c.y=this.getValue(a,"y",0)*e,c.rotation=this.getValue(a,"rotation",0),c.scaleX=this.getValue(a,"scaleX",1),c.scaleY=this.getValue(a,"scaleY",1),c.shearX=this.getValue(a,"shearX",0),c.shearY=this.getValue(a,"shearY",0),c.transformMode=ni.transformModeFromString(this.getValue(a,"transform","normal")),c.skinRequired=this.getValue(a,"skin",!1),i.bones.push(c)}if(r.slots)for(let l=0;l<r.slots.length;l++){let a=r.slots[l],o=a.name,h=a.bone,c=i.findBone(h);if(c==null)throw new Error(`Slot bone not found: ${h}`);let u=new Ln(i.slots.length,o,c),d=this.getValue(a,"color",null);d!=null&&u.color.setFromString(d);let f=this.getValue(a,"dark",null);f!=null&&(u.darkColor=new G(1,1,1,1),u.darkColor.setFromString(f)),u.attachmentName=this.getValue(a,"attachment",null),u.blendMode=ni.blendModeFromString(this.getValue(a,"blend","normal")),i.slots.push(u)}if(r.ik)for(let l=0;l<r.ik.length;l++){let a=r.ik[l],o=new On(a.name);o.order=this.getValue(a,"order",0),o.skinRequired=this.getValue(a,"skin",!1);for(let c=0;c<a.bones.length;c++){let u=a.bones[c],d=i.findBone(u);if(d==null)throw new Error(`IK bone not found: ${u}`);o.bones.push(d)}let h=a.target;if(o.target=i.findBone(h),o.target==null)throw new Error(`IK target bone not found: ${h}`);o.mix=this.getValue(a,"mix",1),o.softness=this.getValue(a,"softness",0)*e,o.bendDirection=this.getValue(a,"bendPositive",!0)?1:-1,o.compress=this.getValue(a,"compress",!1),o.stretch=this.getValue(a,"stretch",!1),o.uniform=this.getValue(a,"uniform",!1),i.ikConstraints.push(o)}if(r.transform)for(let l=0;l<r.transform.length;l++){let a=r.transform[l],o=new Un(a.name);o.order=this.getValue(a,"order",0),o.skinRequired=this.getValue(a,"skin",!1);for(let c=0;c<a.bones.length;c++){let u=a.bones[c],d=i.findBone(u);if(d==null)throw new Error(`Transform constraint bone not found: ${u}`);o.bones.push(d)}let h=a.target;if(o.target=i.findBone(h),o.target==null)throw new Error(`Transform constraint target bone not found: ${h}`);o.local=this.getValue(a,"local",!1),o.relative=this.getValue(a,"relative",!1),o.offsetRotation=this.getValue(a,"rotation",0),o.offsetX=this.getValue(a,"x",0)*e,o.offsetY=this.getValue(a,"y",0)*e,o.offsetScaleX=this.getValue(a,"scaleX",0),o.offsetScaleY=this.getValue(a,"scaleY",0),o.offsetShearY=this.getValue(a,"shearY",0),o.rotateMix=this.getValue(a,"rotateMix",1),o.translateMix=this.getValue(a,"translateMix",1),o.scaleMix=this.getValue(a,"scaleMix",1),o.shearMix=this.getValue(a,"shearMix",1),i.transformConstraints.push(o)}if(r.path)for(let l=0;l<r.path.length;l++){let a=r.path[l],o=new Nn(a.name);o.order=this.getValue(a,"order",0),o.skinRequired=this.getValue(a,"skin",!1);for(let c=0;c<a.bones.length;c++){let u=a.bones[c],d=i.findBone(u);if(d==null)throw new Error(`Transform constraint bone not found: ${u}`);o.bones.push(d)}let h=a.target;if(o.target=i.findSlot(h),o.target==null)throw new Error(`Path target slot not found: ${h}`);o.positionMode=ni.positionModeFromString(this.getValue(a,"positionMode","percent")),o.spacingMode=ni.spacingModeFromString(this.getValue(a,"spacingMode","length")),o.rotateMode=ni.rotateModeFromString(this.getValue(a,"rotateMode","tangent")),o.offsetRotation=this.getValue(a,"rotation",0),o.position=this.getValue(a,"position",0),o.positionMode==It.Fixed&&(o.position*=e),o.spacing=this.getValue(a,"spacing",0),(o.spacingMode==ie.Length||o.spacingMode==ie.Fixed)&&(o.spacing*=e),o.rotateMix=this.getValue(a,"rotateMix",1),o.translateMix=this.getValue(a,"translateMix",1),i.pathConstraints.push(o)}if(r.skins)for(let l=0;l<r.skins.length;l++){let a=r.skins[l],o=new Fr(a.name);if(a.bones)for(let h=0;h<a.bones.length;h++){let c=i.findBone(a.bones[h]);if(c==null)throw new Error(`Skin bone not found: ${a.bones[l]}`);o.bones.push(c)}if(a.ik)for(let h=0;h<a.ik.length;h++){let c=i.findIkConstraint(a.ik[h]);if(c==null)throw new Error(`Skin IK constraint not found: ${a.ik[l]}`);o.constraints.push(c)}if(a.transform)for(let h=0;h<a.transform.length;h++){let c=i.findTransformConstraint(a.transform[h]);if(c==null)throw new Error(`Skin transform constraint not found: ${a.transform[l]}`);o.constraints.push(c)}if(a.path)for(let h=0;h<a.path.length;h++){let c=i.findPathConstraint(a.path[h]);if(c==null)throw new Error(`Skin path constraint not found: ${a.path[l]}`);o.constraints.push(c)}for(let h in a.attachments){let c=i.findSlot(h);if(c==null)throw new Error(`Slot not found: ${h}`);let u=a.attachments[h];for(let d in u){let f=this.readAttachment(u[d],o,c.index,d,i);f!=null&&o.setAttachment(c.index,d,f)}}i.skins.push(o),o.name=="default"&&(i.defaultSkin=o)}for(let l=0,a=this.linkedMeshes.length;l<a;l++){let o=this.linkedMeshes[l],h=o.skin==null?i.defaultSkin:i.findSkin(o.skin);if(h==null)throw new Error(`Skin not found: ${o.skin}`);let c=h.getAttachment(o.slotIndex,o.parent);if(c==null)throw new Error(`Parent mesh not found: ${o.parent}`);o.mesh.deformAttachment=o.inheritDeform?c:o.mesh,o.mesh.setParentMesh(c)}if(this.linkedMeshes.length=0,r.events)for(let l in r.events){let a=r.events[l],o=new Pn(l);o.intValue=this.getValue(a,"int",0),o.floatValue=this.getValue(a,"float",0),o.stringValue=this.getValue(a,"string",""),o.audioPath=this.getValue(a,"audio",null),o.audioPath!=null&&(o.volume=this.getValue(a,"volume",1),o.balance=this.getValue(a,"balance",0)),i.events.push(o)}if(r.animations)for(let l in r.animations){let a=r.animations[l];this.readAnimation(a,l,i)}return i}readAttachment(t,e,i,r,n){let l=this.scale;switch(r=this.getValue(t,"name",r),this.getValue(t,"type","region")){case"region":{let o=this.getValue(t,"path",r),h=this.attachmentLoader.newRegionAttachment(e,r,o);if(h==null)return null;h.path=o,h.x=this.getValue(t,"x",0)*l,h.y=this.getValue(t,"y",0)*l,h.scaleX=this.getValue(t,"scaleX",1),h.scaleY=this.getValue(t,"scaleY",1),h.rotation=this.getValue(t,"rotation",0),h.width=t.width*l,h.height=t.height*l;let c=this.getValue(t,"color",null);return c!=null&&h.color.setFromString(c),h}case"boundingbox":{let o=this.attachmentLoader.newBoundingBoxAttachment(e,r);if(o==null)return null;this.readVertices(t,o,t.vertexCount<<1);let h=this.getValue(t,"color",null);return h!=null&&o.color.setFromString(h),o}case"mesh":case"linkedmesh":{let o=this.getValue(t,"path",r),h=this.attachmentLoader.newMeshAttachment(e,r,o);if(h==null)return null;h.path=o;let c=this.getValue(t,"color",null);c!=null&&h.color.setFromString(c),h.width=this.getValue(t,"width",0)*l,h.height=this.getValue(t,"height",0)*l;let u=this.getValue(t,"parent",null);if(u!=null)return this.linkedMeshes.push(new vg(h,this.getValue(t,"skin",null),i,u,this.getValue(t,"deform",!0))),h;let d=t.uvs;return this.readVertices(t,h,d.length),h.triangles=t.triangles,h.regionUVs=new Float32Array(d),h.edges=this.getValue(t,"edges",null),h.hullLength=this.getValue(t,"hull",0)*2,h}case"path":{let o=this.attachmentLoader.newPathAttachment(e,r);if(o==null)return null;o.closed=this.getValue(t,"closed",!1),o.constantSpeed=this.getValue(t,"constantSpeed",!0);let h=t.vertexCount;this.readVertices(t,o,h<<1);let c=k.newArray(h/3,0);for(let d=0;d<t.lengths.length;d++)c[d]=t.lengths[d]*l;o.lengths=c;let u=this.getValue(t,"color",null);return u!=null&&o.color.setFromString(u),o}case"point":{let o=this.attachmentLoader.newPointAttachment(e,r);if(o==null)return null;o.x=this.getValue(t,"x",0)*l,o.y=this.getValue(t,"y",0)*l,o.rotation=this.getValue(t,"rotation",0);let h=this.getValue(t,"color",null);return h!=null&&o.color.setFromString(h),o}case"clipping":{let o=this.attachmentLoader.newClippingAttachment(e,r);if(o==null)return null;let h=this.getValue(t,"end",null);if(h!=null){let d=n.findSlot(h);if(d==null)throw new Error(`Clipping end slot not found: ${h}`);o.endSlot=d}let c=t.vertexCount;this.readVertices(t,o,c<<1);let u=this.getValue(t,"color",null);return u!=null&&o.color.setFromString(u),o}}return null}readVertices(t,e,i){let r=this.scale;e.worldVerticesLength=i;let n=t.vertices;if(i==n.length){let o=k.toFloatArray(n);if(r!=1)for(let h=0,c=n.length;h<c;h++)o[h]*=r;e.vertices=o;return}let l=new Array,a=new Array;for(let o=0,h=n.length;o<h;){let c=n[o++];a.push(c);for(let u=o+c*4;o<u;o+=4)a.push(n[o]),l.push(n[o+1]*r),l.push(n[o+2]*r),l.push(n[o+3])}e.bones=a,e.vertices=k.toFloatArray(l)}readAnimation(t,e,i){let r=this.scale,n=new Array,l=0;if(t.slots)for(let o in t.slots){let h=t.slots[o],c=i.findSlotIndex(o);if(c==-1)throw new Error(`Slot not found: ${o}`);for(let u in h){let d=h[u];if(u=="attachment"){let f=new Ds(d.length);f.slotIndex=c;let m=0;for(let p=0;p<d.length;p++){let g=d[p];f.setFrame(m++,this.getValue(g,"time",0),g.name)}n.push(f),l=Math.max(l,f.frames[f.getFrameCount()-1])}else if(u=="color"){let f=new Ee(d.length);f.slotIndex=c;let m=0;for(let p=0;p<d.length;p++){let g=d[p],y=new G;y.setFromString(g.color||"ffffffff"),f.setFrame(m,this.getValue(g,"time",0),y.r,y.g,y.b,y.a),this.readCurve(g,f,m),m++}n.push(f),l=Math.max(l,f.frames[(f.getFrameCount()-1)*Ee.ENTRIES])}else if(u=="twoColor"){let f=new Wt(d.length);f.slotIndex=c;let m=0;for(let p=0;p<d.length;p++){let g=d[p],y=new G,_=new G;y.setFromString(g.light),_.setFromString(g.dark),f.setFrame(m,this.getValue(g,"time",0),y.r,y.g,y.b,y.a,_.r,_.g,_.b),this.readCurve(g,f,m),m++}n.push(f),l=Math.max(l,f.frames[(f.getFrameCount()-1)*Wt.ENTRIES])}else throw new Error(`Invalid timeline type for a slot: ${u} (${o})`)}}if(t.bones)for(let o in t.bones){let h=t.bones[o],c=i.findBoneIndex(o);if(c==-1)throw new Error(`Bone not found: ${o}`);for(let u in h){let d=h[u];if(u==="rotate"){let f=new he(d.length);f.boneIndex=c;let m=0;for(let p=0;p<d.length;p++){let g=d[p];f.setFrame(m,this.getValue(g,"time",0),this.getValue(g,"angle",0)),this.readCurve(g,f,m),m++}n.push(f),l=Math.max(l,f.frames[(f.getFrameCount()-1)*he.ENTRIES])}else if(u==="translate"||u==="scale"||u==="shear"){let f=null,m=1,p=0;u==="scale"?(f=new be(d.length),p=1):u==="shear"?f=new _e(d.length):(f=new Ge(d.length),m=r),f.boneIndex=c;let g=0;for(let y=0;y<d.length;y++){let _=d[y],b=this.getValue(_,"x",p),x=this.getValue(_,"y",p);f.setFrame(g,this.getValue(_,"time",0),b*m,x*m),this.readCurve(_,f,g),g++}n.push(f),l=Math.max(l,f.frames[(f.getFrameCount()-1)*Ge.ENTRIES])}else throw new Error(`Invalid timeline type for a bone: ${u} (${o})`)}}if(t.ik)for(let o in t.ik){let h=t.ik[o],c=i.findIkConstraint(o),u=new de(h.length);u.ikConstraintIndex=i.ikConstraints.indexOf(c);let d=0;for(let f=0;f<h.length;f++){let m=h[f];u.setFrame(d,this.getValue(m,"time",0),this.getValue(m,"mix",1),this.getValue(m,"softness",0)*r,this.getValue(m,"bendPositive",!0)?1:-1,this.getValue(m,"compress",!1),this.getValue(m,"stretch",!1)),this.readCurve(m,u,d),d++}n.push(u),l=Math.max(l,u.frames[(u.getFrameCount()-1)*de.ENTRIES])}if(t.transform)for(let o in t.transform){let h=t.transform[o],c=i.findTransformConstraint(o),u=new Ae(h.length);u.transformConstraintIndex=i.transformConstraints.indexOf(c);let d=0;for(let f=0;f<h.length;f++){let m=h[f];u.setFrame(d,this.getValue(m,"time",0),this.getValue(m,"rotateMix",1),this.getValue(m,"translateMix",1),this.getValue(m,"scaleMix",1),this.getValue(m,"shearMix",1)),this.readCurve(m,u,d),d++}n.push(u),l=Math.max(l,u.frames[(u.getFrameCount()-1)*Ae.ENTRIES])}if(t.path)for(let o in t.path){let h=t.path[o],c=i.findPathConstraintIndex(o);if(c==-1)throw new Error(`Path constraint not found: ${o}`);let u=i.pathConstraints[c];for(let d in h){let f=h[d];if(d==="position"||d==="spacing"){let m=null,p=1;d==="spacing"?(m=new Ve(f.length),(u.spacingMode==ie.Length||u.spacingMode==ie.Fixed)&&(p=r)):(m=new Vs(f.length),u.positionMode==It.Fixed&&(p=r)),m.pathConstraintIndex=c;let g=0;for(let y=0;y<f.length;y++){let _=f[y];m.setFrame(g,this.getValue(_,"time",0),this.getValue(_,d,0)*p),this.readCurve(_,m,g),g++}n.push(m),l=Math.max(l,m.frames[(m.getFrameCount()-1)*Vs.ENTRIES])}else if(d==="mix"){let m=new xs(f.length);m.pathConstraintIndex=c;let p=0;for(let g=0;g<f.length;g++){let y=f[g];m.setFrame(p,this.getValue(y,"time",0),this.getValue(y,"rotateMix",1),this.getValue(y,"translateMix",1)),this.readCurve(y,m,p),p++}n.push(m),l=Math.max(l,m.frames[(m.getFrameCount()-1)*xs.ENTRIES])}}}if(t.deform)for(let o in t.deform){let h=t.deform[o],c=i.findSkin(o);if(c==null){if(jt.FAIL_ON_NON_EXISTING_SKIN)throw new Error(`Skin not found: ${o}`);continue}for(let u in h){let d=h[u],f=i.findSlotIndex(u);if(f==-1)throw new Error(`Slot not found: ${d.name}`);for(let m in d){let p=d[m],g=c.getAttachment(f,m);if(g==null)throw new Error(`Deform attachment not found: ${p.name}`);let y=g.bones!=null,_=g.vertices,b=y?_.length/3*2:_.length,x=new Rn(p.length);x.slotIndex=f,x.attachment=g;let v=0;for(let w=0;w<p.length;w++){let E=p[w],A,T=this.getValue(E,"vertices",null);if(T==null)A=y?k.newFloatArray(b):_;else{A=k.newFloatArray(b);let C=this.getValue(E,"offset",0);if(k.arrayCopy(T,0,A,C,T.length),r!=1)for(let R=C,N=R+T.length;R<N;R++)A[R]*=r;if(!y)for(let R=0;R<b;R++)A[R]+=_[R]}x.setFrame(v,this.getValue(E,"time",0),A),this.readCurve(E,x,v),v++}n.push(x),l=Math.max(l,x.frames[x.getFrameCount()-1])}}}let a=t.drawOrder;if(a==null&&(a=t.draworder),a!=null){let o=new ri(a.length),h=i.slots.length,c=0;for(let u=0;u<a.length;u++){let d=a[u],f=null,m=this.getValue(d,"offsets",null);if(m!=null){f=k.newArray(h,-1);let p=k.newArray(h-m.length,0),g=0,y=0;for(let _=0;_<m.length;_++){let b=m[_],x=i.findSlotIndex(b.slot);if(x==-1)throw new Error(`Slot not found: ${b.slot}`);for(;g!=x;)p[y++]=g++;f[g+b.offset]=g++}for(;g<h;)p[y++]=g++;for(let _=h-1;_>=0;_--)f[_]==-1&&(f[_]=p[--y])}o.setFrame(c++,this.getValue(d,"time",0),f)}n.push(o),l=Math.max(l,o.frames[o.getFrameCount()-1])}if(t.events){let o=new Di(t.events.length),h=0;for(let c=0;c<t.events.length;c++){let u=t.events[c],d=i.findEvent(u.name);if(d==null)throw new Error(`Event not found: ${u.name}`);let f=new kn(k.toSinglePrecision(this.getValue(u,"time",0)),d);f.intValue=this.getValue(u,"int",d.intValue),f.floatValue=this.getValue(u,"float",d.floatValue),f.stringValue=this.getValue(u,"string",d.stringValue),f.data.audioPath!=null&&(f.volume=this.getValue(u,"volume",1),f.balance=this.getValue(u,"balance",0)),o.setFrame(h++,f)}n.push(o),l=Math.max(l,o.frames[o.getFrameCount()-1])}if(isNaN(l))throw new Error("Error while parsing animation, duration is NaN");i.animations.push(new Dt(e,n,l))}readCurve(t,e,i){if(!!t.hasOwnProperty("curve"))if(t.curve==="stepped")e.setStepped(i);else{let r=t.curve;e.setCurve(i,r,this.getValue(t,"c2",0),this.getValue(t,"c3",1),this.getValue(t,"c4",1))}}getValue(t,e,i){return t[e]!==void 0?t[e]:i}static blendModeFromString(t){if(t=t.toLowerCase(),t=="normal")return Z.NORMAL;if(t=="additive")return Z.ADD;if(t=="multiply")return Z.MULTIPLY;if(t=="screen")return Z.SCREEN;throw new Error(`Unknown blend mode: ${t}`)}static positionModeFromString(t){if(t=t.toLowerCase(),t=="fixed")return It.Fixed;if(t=="percent")return It.Percent;throw new Error(`Unknown position mode: ${t}`)}static spacingModeFromString(t){if(t=t.toLowerCase(),t=="length")return ie.Length;if(t=="fixed")return ie.Fixed;if(t=="percent")return ie.Percent;throw new Error(`Unknown position mode: ${t}`)}static rotateModeFromString(t){if(t=t.toLowerCase(),t=="tangent")return Pt.Tangent;if(t=="chain")return Pt.Chain;if(t=="chainscale")return Pt.ChainScale;throw new Error(`Unknown rotate mode: ${t}`)}static transformModeFromString(t){if(t=t.toLowerCase(),t=="normal")return it.Normal;if(t=="onlytranslation")return it.OnlyTranslation;if(t=="norotationorreflection")return it.NoRotationOrReflection;if(t=="noscale")return it.NoScale;if(t=="noscaleorreflection")return it.NoScaleOrReflection;throw new Error(`Unknown transform mode: ${t}`)}},vg=class{constructor(t,e,i,r,n){this.mesh=t,this.skin=e,this.slotIndex=i,this.parent=r,this.inheritDeform=n}};var mm=class extends ii{createSkeleton(t){this.skeleton=new rd(t),this.skeleton.updateWorldTransform(),this.stateData=new sd(t),this.state=new ts(this.stateData)}};var vm={};Tc(vm,{Animation:()=>$t,AnimationState:()=>oi,AnimationStateAdapter2:()=>xm,AnimationStateData:()=>od,AtlasAttachmentLoader:()=>nc,Attachment:()=>vl,AttachmentTimeline:()=>Br,Bone:()=>wl,BoneData:()=>oc,BoundingBoxAttachment:()=>tc,ClippingAttachment:()=>ec,ColorTimeline:()=>ns,CurveTimeline:()=>rs,DeformTimeline:()=>ic,DrawOrderTimeline:()=>Lr,Event:()=>ac,EventData:()=>lc,EventQueue:()=>bm,EventTimeline:()=>rc,EventType:()=>ls,IkConstraint:()=>hc,IkConstraintData:()=>cc,IkConstraintTimeline:()=>os,JitterEffect:()=>gm,MeshAttachment:()=>Dn,PathAttachment:()=>_i,PathConstraint:()=>Xn,PathConstraintData:()=>uc,PathConstraintMixTimeline:()=>vi,PathConstraintPositionTimeline:()=>Gi,PathConstraintSpacingTimeline:()=>bs,PointAttachment:()=>sc,RegionAttachment:()=>ut,RotateTimeline:()=>Ie,ScaleTimeline:()=>Pe,ShearTimeline:()=>Oe,Skeleton:()=>ld,SkeletonBounds:()=>_m,SkeletonData:()=>fc,SkeletonJson:()=>ai,Skin:()=>gc,Slot:()=>Vn,SlotData:()=>mc,SpacingMode:()=>_s,Spine:()=>ym,SwirlEffect:()=>wg,TimelineType:()=>Eg,TrackEntry:()=>nd,TransformConstraint:()=>dc,TransformConstraintData:()=>pc,TransformConstraintTimeline:()=>as,TranslateTimeline:()=>Gs,TwoColorTimeline:()=>ue,VertexAttachment:()=>es});var vl=class{constructor(t){if(t==null)throw new Error("name cannot be null.");this.name=t}},C0=class extends vl{constructor(s){super(s),this.id=(C0.nextID++&65535)<<11,this.worldVerticesLength=0}computeWorldVerticesOld(s,t){this.computeWorldVertices(s,0,this.worldVerticesLength,t,0,2)}computeWorldVertices(s,t,e,i,r,n){e=r+(e>>1)*n;let l=s.bone.skeleton,a=s.attachmentVertices,o=this.vertices,h=this.bones;if(h==null){a.length>0&&(o=a);let f=s.bone.matrix,m=f.tx,p=f.ty,g=f.a,y=f.c,_=f.b,b=f.d;for(let x=t,v=r;v<e;x+=2,v+=n){let w=o[x],E=o[x+1];i[v]=w*g+E*y+m,i[v+1]=w*_+E*b+p}return}let c=0,u=0;for(let f=0;f<t;f+=2){let m=h[c];c+=m+1,u+=m}let d=l.bones;if(a.length==0)for(let f=r,m=u*3;f<e;f+=n){let p=0,g=0,y=h[c++];for(y+=c;c<y;c++,m+=3){let _=d[h[c]].matrix,b=o[m],x=o[m+1],v=o[m+2];p+=(b*_.a+x*_.c+_.tx)*v,g+=(b*_.b+x*_.d+_.ty)*v}i[f]=p,i[f+1]=g}else{let f=a;for(let m=r,p=u*3,g=u<<1;m<e;m+=n){let y=0,_=0,b=h[c++];for(b+=c;c<b;c++,p+=3,g+=2){let x=d[h[c]].matrix,v=o[p]+f[g],w=o[p+1]+f[g+1],E=o[p+2];y+=(v*x.a+w*x.c+x.tx)*E,_+=(v*x.b+w*x.d+x.ty)*E}i[m]=y,i[m+1]=_}}}applyDeform(s){return this==s}},es=C0;es.nextID=0;var tc=class extends es{constructor(t){super(t),this.type=tt.BoundingBox,this.color=new G(1,1,1,1)}};var ec=class extends es{constructor(t){super(t),this.type=tt.Clipping,this.color=new G(.2275,.2275,.8078,1)}};var Dn=class extends es{constructor(t){super(t),this.type=tt.Mesh,this.color=new G(1,1,1,1),this.inheritDeform=!1,this.tempColor=new G(0,0,0,0)}applyDeform(t){return this==t||this.inheritDeform&&this.parentMesh==t}getParentMesh(){return this.parentMesh}setParentMesh(t){this.parentMesh=t,t!=null&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}};var _i=class extends es{constructor(t){super(t),this.type=tt.Path,this.closed=!1,this.constantSpeed=!1,this.color=new G(1,1,1,1)}};var sc=class extends es{constructor(t){super(t),this.type=tt.Point,this.color=new G(.38,.94,0,1)}computeWorldPosition(t,e){let i=t.matrix;return e.x=this.x*i.a+this.y*i.c+t.worldX,e.y=this.x*i.b+this.y*i.d+t.worldY,e}computeWorldRotation(t){let e=t.matrix,i=S.cosDeg(this.rotation),r=S.sinDeg(this.rotation),n=i*e.a+r*e.c,l=i*e.b+r*e.d;return Math.atan2(l,n)*S.radDeg}};var Vn=class{constructor(t,e){if(this.attachmentVertices=new Array,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new G,this.darkColor=t.darkColor==null?null:new G,this.setToSetupPose(),this.blendMode=this.data.blendMode}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.attachmentVertices.length=0)}setAttachmentTime(t){this.attachmentTime=this.bone.skeleton.time-t}getAttachmentTime(){return this.bone.skeleton.time-this.attachmentTime}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor!=null&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName==null?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))}};var ke=class extends vl{constructor(s){super(s),this.type=tt.Region,this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new G(1,1,1,1),this.offset=k.newFloatArray(8),this.uvs=k.newFloatArray(8),this.tempColor=new G(1,1,1,1)}updateOffset(){let s=this.width/this.region.originalWidth*this.scaleX,t=this.height/this.region.originalHeight*this.scaleY,e=-this.width/2*this.scaleX+this.region.offsetX*s,i=-this.height/2*this.scaleY+this.region.offsetY*t,r=e+this.region.width*s,n=i+this.region.height*t,l=this.rotation*Math.PI/180,a=Math.cos(l),o=Math.sin(l),h=e*a+this.x,c=e*o,u=i*a+this.y,d=i*o,f=r*a+this.x,m=r*o,p=n*a+this.y,g=n*o,y=this.offset;y[ke.OX1]=h-d,y[ke.OY1]=u+c,y[ke.OX2]=h-g,y[ke.OY2]=p+c,y[ke.OX3]=f-g,y[ke.OY3]=p+m,y[ke.OX4]=f-d,y[ke.OY4]=u+m}setRegion(s){this.region=s;let t=this.uvs;s.rotate?(t[2]=s.u,t[3]=s.v2,t[4]=s.u,t[5]=s.v,t[6]=s.u2,t[7]=s.v,t[0]=s.u2,t[1]=s.v2):(t[0]=s.u,t[1]=s.v2,t[2]=s.u,t[3]=s.v,t[4]=s.u2,t[5]=s.v,t[6]=s.u2,t[7]=s.v2)}computeWorldVertices(s,t,e,i){let r=this.offset,n=s instanceof Vn?s.bone.matrix:s.matrix,l=n.tx,a=n.ty,o=n.a,h=n.c,c=n.b,u=n.d,d=0,f=0;d=r[ke.OX1],f=r[ke.OY1],t[e]=d*o+f*h+l,t[e+1]=d*c+f*u+a,e+=i,d=r[ke.OX2],f=r[ke.OY2],t[e]=d*o+f*h+l,t[e+1]=d*c+f*u+a,e+=i,d=r[ke.OX3],f=r[ke.OY3],t[e]=d*o+f*h+l,t[e+1]=d*c+f*u+a,e+=i,d=r[ke.OX4],f=r[ke.OY4],t[e]=d*o+f*h+l,t[e+1]=d*c+f*u+a}},ut=ke;ut.OX1=0;ut.OY1=1;ut.OX2=2;ut.OY2=3;ut.OX3=4;ut.OY3=5;ut.OX4=6;ut.OY4=7;ut.X1=0;ut.Y1=1;ut.C1R=2;ut.C1G=3;ut.C1B=4;ut.C1A=5;ut.U1=6;ut.V1=7;ut.X2=8;ut.Y2=9;ut.C2R=10;ut.C2G=11;ut.C2B=12;ut.C2A=13;ut.U2=14;ut.V2=15;ut.X3=16;ut.Y3=17;ut.C3R=18;ut.C3G=19;ut.C3B=20;ut.C3A=21;ut.U3=22;ut.V3=23;ut.X4=24;ut.Y4=25;ut.C4R=26;ut.C4G=27;ut.C4B=28;ut.C4A=29;ut.U4=30;ut.V4=31;var gm=class{constructor(t,e){this.jitterX=0,this.jitterY=0,this.jitterX=t,this.jitterY=e}begin(t){}transform(t,e,i,r){t.x+=S.randomTriangular(-this.jitterX,this.jitterY),t.y+=S.randomTriangular(-this.jitterX,this.jitterY)}end(){}};var R0=class{constructor(s){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=s}begin(s){this.worldX=s.x+this.centerX,this.worldY=s.y+this.centerY}transform(s,t,e,i){let r=this.angle*S.degreesToRadians,n=s.x-this.worldX,l=s.y-this.worldY,a=Math.sqrt(n*n+l*l);if(a<this.radius){let o=R0.interpolation.apply(0,r,(this.radius-a)/this.radius),h=Math.cos(o),c=Math.sin(o);s.x=h*n-c*l+this.worldX,s.y=c*n+h*l+this.worldY}}end(){}},wg=R0;wg.interpolation=new xn(2);var $t=class{constructor(t,e,i){if(t==null)throw new Error("name cannot be null.");if(e==null)throw new Error("timelines cannot be null.");this.name=t,this.timelines=e,this.duration=i}apply(t,e,i,r,n,l,a,o){if(t==null)throw new Error("skeleton cannot be null.");r&&this.duration!=0&&(i%=this.duration,e>0&&(e%=this.duration));let h=this.timelines;for(let c=0,u=h.length;c<u;c++)h[c].apply(t,e,i,n,l,a,o)}static binarySearch(t,e,i=1){let r=0,n=t.length/i-2;if(n==0)return i;let l=n>>>1;for(;;){if(t[(l+1)*i]<=e?r=l+1:n=l,r==n)return(r+1)*i;l=r+n>>>1}}static linearSearch(t,e,i){for(let r=0,n=t.length-i;r<=n;r+=i)if(t[r]>e)return r;return-1}},Eg=(s=>(s[s.rotate=0]="rotate",s[s.translate=1]="translate",s[s.scale=2]="scale",s[s.shear=3]="shear",s[s.attachment=4]="attachment",s[s.color=5]="color",s[s.deform=6]="deform",s[s.event=7]="event",s[s.drawOrder=8]="drawOrder",s[s.ikConstraint=9]="ikConstraint",s[s.transformConstraint=10]="transformConstraint",s[s.pathConstraintPosition=11]="pathConstraintPosition",s[s.pathConstraintSpacing=12]="pathConstraintSpacing",s[s.pathConstraintMix=13]="pathConstraintMix",s[s.twoColor=14]="twoColor",s))(Eg||{}),ce=class{constructor(s){if(s<=0)throw new Error(`frameCount must be > 0: ${s}`);this.curves=k.newFloatArray((s-1)*ce.BEZIER_SIZE)}getFrameCount(){return this.curves.length/ce.BEZIER_SIZE+1}setLinear(s){this.curves[s*ce.BEZIER_SIZE]=ce.LINEAR}setStepped(s){this.curves[s*ce.BEZIER_SIZE]=ce.STEPPED}getCurveType(s){let t=s*ce.BEZIER_SIZE;if(t==this.curves.length)return ce.LINEAR;let e=this.curves[t];return e==ce.LINEAR?ce.LINEAR:e==ce.STEPPED?ce.STEPPED:ce.BEZIER}setCurve(s,t,e,i,r){let n=(-t*2+i)*.03,l=(-e*2+r)*.03,a=((t-i)*3+1)*.006,o=((e-r)*3+1)*.006,h=n*2+a,c=l*2+o,u=t*.3+n+a*.16666667,d=e*.3+l+o*.16666667,f=s*ce.BEZIER_SIZE,m=this.curves;m[f++]=ce.BEZIER;let p=u,g=d;for(let y=f+ce.BEZIER_SIZE-1;f<y;f+=2)m[f]=p,m[f+1]=g,u+=h,d+=c,h+=a,c+=o,p+=u,g+=d}getCurvePercent(s,t){t=S.clamp(t,0,1);let e=this.curves,i=s*ce.BEZIER_SIZE,r=e[i];if(r==ce.LINEAR)return t;if(r==ce.STEPPED)return 0;i++;let n=0;for(let a=i,o=i+ce.BEZIER_SIZE-1;i<o;i+=2)if(n=e[i],n>=t){let h,c;return i==a?(h=0,c=0):(h=e[i-2],c=e[i-1]),c+(e[i+1]-c)*(t-h)/(n-h)}let l=e[i-1];return l+(1-l)*(t-n)/(1-n)}},rs=ce;rs.LINEAR=0;rs.STEPPED=1;rs.BEZIER=2;rs.BEZIER_SIZE=10*2-1;var Gn=class extends rs{constructor(s){super(s),this.frames=k.newFloatArray(s<<1)}getPropertyId(){return(0<<24)+this.boneIndex}setFrame(s,t,e){s<<=1,this.frames[s]=t,this.frames[s+Gn.ROTATION]=e}apply(s,t,e,i,r,n,l){let a=this.frames,o=s.bones[this.boneIndex];if(e<a[0]){switch(n){case I.setup:o.rotation=o.data.rotation;return;case I.first:let m=o.data.rotation-o.rotation;o.rotation+=(m-(16384-(16384.499999999996-m/360|0))*360)*r}return}if(e>=a[a.length-Gn.ENTRIES]){let m=a[a.length+Gn.PREV_ROTATION];switch(n){case I.setup:o.rotation=o.data.rotation+m*r;break;case I.first:case I.replace:m+=o.data.rotation-o.rotation,m-=(16384-(16384.499999999996-m/360|0))*360;case I.add:o.rotation+=m*r}return}let h=$t.binarySearch(a,e,Gn.ENTRIES),c=a[h+Gn.PREV_ROTATION],u=a[h],d=this.getCurvePercent((h>>1)-1,1-(e-u)/(a[h+Gn.PREV_TIME]-u)),f=a[h+Gn.ROTATION]-c;switch(f=c+(f-(16384-(16384.499999999996-f/360|0))*360)*d,n){case I.setup:o.rotation=o.data.rotation+(f-(16384-(16384.499999999996-f/360|0))*360)*r;break;case I.first:case I.replace:f+=o.data.rotation-o.rotation;case I.add:o.rotation+=(f-(16384-(16384.499999999996-f/360|0))*360)*r}}},Ie=Gn;Ie.ENTRIES=2;Ie.PREV_TIME=-2;Ie.PREV_ROTATION=-1;Ie.ROTATION=1;var ss=class extends rs{constructor(s){super(s),this.frames=k.newFloatArray(s*ss.ENTRIES)}getPropertyId(){return(1<<24)+this.boneIndex}setFrame(s,t,e,i){s*=ss.ENTRIES,this.frames[s]=t,this.frames[s+ss.X]=e,this.frames[s+ss.Y]=i}apply(s,t,e,i,r,n,l){let a=this.frames,o=s.bones[this.boneIndex];if(e<a[0]){switch(n){case I.setup:o.x=o.data.x,o.y=o.data.y;return;case I.first:o.x+=(o.data.x-o.x)*r,o.y+=(o.data.y-o.y)*r}return}let h=0,c=0;if(e>=a[a.length-ss.ENTRIES])h=a[a.length+ss.PREV_X],c=a[a.length+ss.PREV_Y];else{let u=$t.binarySearch(a,e,ss.ENTRIES);h=a[u+ss.PREV_X],c=a[u+ss.PREV_Y];let d=a[u],f=this.getCurvePercent(u/ss.ENTRIES-1,1-(e-d)/(a[u+ss.PREV_TIME]-d));h+=(a[u+ss.X]-h)*f,c+=(a[u+ss.Y]-c)*f}switch(n){case I.setup:o.x=o.data.x+h*r,o.y=o.data.y+c*r;break;case I.first:case I.replace:o.x+=(o.data.x+h-o.x)*r,o.y+=(o.data.y+c-o.y)*r;break;case I.add:o.x+=h*r,o.y+=c*r}}},Gs=ss;Gs.ENTRIES=3;Gs.PREV_TIME=-3;Gs.PREV_X=-2;Gs.PREV_Y=-1;Gs.X=1;Gs.Y=2;var Pe=class extends Gs{constructor(t){super(t)}getPropertyId(){return(2<<24)+this.boneIndex}apply(t,e,i,r,n,l,a){let o=this.frames,h=t.bones[this.boneIndex];if(i<o[0]){switch(l){case I.setup:h.scaleX=h.data.scaleX,h.scaleY=h.data.scaleY;return;case I.first:h.scaleX+=(h.data.scaleX-h.scaleX)*n,h.scaleY+=(h.data.scaleY-h.scaleY)*n}return}let c=0,u=0;if(i>=o[o.length-Pe.ENTRIES])c=o[o.length+Pe.PREV_X]*h.data.scaleX,u=o[o.length+Pe.PREV_Y]*h.data.scaleY;else{let d=$t.binarySearch(o,i,Pe.ENTRIES);c=o[d+Pe.PREV_X],u=o[d+Pe.PREV_Y];let f=o[d],m=this.getCurvePercent(d/Pe.ENTRIES-1,1-(i-f)/(o[d+Pe.PREV_TIME]-f));c=(c+(o[d+Pe.X]-c)*m)*h.data.scaleX,u=(u+(o[d+Pe.Y]-u)*m)*h.data.scaleY}if(n==1)l==I.add?(h.scaleX+=c-h.data.scaleX,h.scaleY+=u-h.data.scaleY):(h.scaleX=c,h.scaleY=u);else{let d=0,f=0;if(a==at.mixOut)switch(l){case I.setup:d=h.data.scaleX,f=h.data.scaleY,h.scaleX=d+(Math.abs(c)*S.signum(d)-d)*n,h.scaleY=f+(Math.abs(u)*S.signum(f)-f)*n;break;case I.first:case I.replace:d=h.scaleX,f=h.scaleY,h.scaleX=d+(Math.abs(c)*S.signum(d)-d)*n,h.scaleY=f+(Math.abs(u)*S.signum(f)-f)*n;break;case I.add:d=h.scaleX,f=h.scaleY,h.scaleX=d+(Math.abs(c)*S.signum(d)-h.data.scaleX)*n,h.scaleY=f+(Math.abs(u)*S.signum(f)-h.data.scaleY)*n}else switch(l){case I.setup:d=Math.abs(h.data.scaleX)*S.signum(c),f=Math.abs(h.data.scaleY)*S.signum(u),h.scaleX=d+(c-d)*n,h.scaleY=f+(u-f)*n;break;case I.first:case I.replace:d=Math.abs(h.scaleX)*S.signum(c),f=Math.abs(h.scaleY)*S.signum(u),h.scaleX=d+(c-d)*n,h.scaleY=f+(u-f)*n;break;case I.add:d=S.signum(c),f=S.signum(u),h.scaleX=Math.abs(h.scaleX)*d+(c-Math.abs(h.data.scaleX)*d)*n,h.scaleY=Math.abs(h.scaleY)*f+(u-Math.abs(h.data.scaleY)*f)*n}}}},Oe=class extends Gs{constructor(t){super(t)}getPropertyId(){return(3<<24)+this.boneIndex}apply(t,e,i,r,n,l,a){let o=this.frames,h=t.bones[this.boneIndex];if(i<o[0]){switch(l){case I.setup:h.shearX=h.data.shearX,h.shearY=h.data.shearY;return;case I.first:h.shearX+=(h.data.shearX-h.shearX)*n,h.shearY+=(h.data.shearY-h.shearY)*n}return}let c=0,u=0;if(i>=o[o.length-Oe.ENTRIES])c=o[o.length+Oe.PREV_X],u=o[o.length+Oe.PREV_Y];else{let d=$t.binarySearch(o,i,Oe.ENTRIES);c=o[d+Oe.PREV_X],u=o[d+Oe.PREV_Y];let f=o[d],m=this.getCurvePercent(d/Oe.ENTRIES-1,1-(i-f)/(o[d+Oe.PREV_TIME]-f));c=c+(o[d+Oe.X]-c)*m,u=u+(o[d+Oe.Y]-u)*m}switch(l){case I.setup:h.shearX=h.data.shearX+c*n,h.shearY=h.data.shearY+u*n;break;case I.first:case I.replace:h.shearX+=(h.data.shearX+c-h.shearX)*n,h.shearY+=(h.data.shearY+u-h.shearY)*n;break;case I.add:h.shearX+=c*n,h.shearY+=u*n}}},Qt=class extends rs{constructor(s){super(s),this.frames=k.newFloatArray(s*Qt.ENTRIES)}getPropertyId(){return(5<<24)+this.slotIndex}setFrame(s,t,e,i,r,n){s*=Qt.ENTRIES,this.frames[s]=t,this.frames[s+Qt.R]=e,this.frames[s+Qt.G]=i,this.frames[s+Qt.B]=r,this.frames[s+Qt.A]=n}apply(s,t,e,i,r,n,l){let a=s.slots[this.slotIndex],o=this.frames;if(e<o[0]){switch(n){case I.setup:a.color.setFromColor(a.data.color);return;case I.first:let f=a.color,m=a.data.color;f.add((m.r-f.r)*r,(m.g-f.g)*r,(m.b-f.b)*r,(m.a-f.a)*r)}return}let h=0,c=0,u=0,d=0;if(e>=o[o.length-Qt.ENTRIES]){let f=o.length;h=o[f+Qt.PREV_R],c=o[f+Qt.PREV_G],u=o[f+Qt.PREV_B],d=o[f+Qt.PREV_A]}else{let f=$t.binarySearch(o,e,Qt.ENTRIES);h=o[f+Qt.PREV_R],c=o[f+Qt.PREV_G],u=o[f+Qt.PREV_B],d=o[f+Qt.PREV_A];let m=o[f],p=this.getCurvePercent(f/Qt.ENTRIES-1,1-(e-m)/(o[f+Qt.PREV_TIME]-m));h+=(o[f+Qt.R]-h)*p,c+=(o[f+Qt.G]-c)*p,u+=(o[f+Qt.B]-u)*p,d+=(o[f+Qt.A]-d)*p}if(r==1)a.color.set(h,c,u,d);else{let f=a.color;n==I.setup&&f.setFromColor(a.data.color),f.add((h-f.r)*r,(c-f.g)*r,(u-f.b)*r,(d-f.a)*r)}}},ns=Qt;ns.ENTRIES=5;ns.PREV_TIME=-5;ns.PREV_R=-4;ns.PREV_G=-3;ns.PREV_B=-2;ns.PREV_A=-1;ns.R=1;ns.G=2;ns.B=3;ns.A=4;var wt=class extends rs{constructor(s){super(s),this.frames=k.newFloatArray(s*wt.ENTRIES)}getPropertyId(){return(14<<24)+this.slotIndex}setFrame(s,t,e,i,r,n,l,a,o){s*=wt.ENTRIES,this.frames[s]=t,this.frames[s+wt.R]=e,this.frames[s+wt.G]=i,this.frames[s+wt.B]=r,this.frames[s+wt.A]=n,this.frames[s+wt.R2]=l,this.frames[s+wt.G2]=a,this.frames[s+wt.B2]=o}apply(s,t,e,i,r,n,l){let a=s.slots[this.slotIndex],o=this.frames;if(e<o[0]){switch(n){case I.setup:a.color.setFromColor(a.data.color),a.darkColor.setFromColor(a.data.darkColor);return;case I.first:let g=a.color,y=a.darkColor,_=a.data.color,b=a.data.darkColor;g.add((_.r-g.r)*r,(_.g-g.g)*r,(_.b-g.b)*r,(_.a-g.a)*r),y.add((b.r-y.r)*r,(b.g-y.g)*r,(b.b-y.b)*r,0)}return}let h=0,c=0,u=0,d=0,f=0,m=0,p=0;if(e>=o[o.length-wt.ENTRIES]){let g=o.length;h=o[g+wt.PREV_R],c=o[g+wt.PREV_G],u=o[g+wt.PREV_B],d=o[g+wt.PREV_A],f=o[g+wt.PREV_R2],m=o[g+wt.PREV_G2],p=o[g+wt.PREV_B2]}else{let g=$t.binarySearch(o,e,wt.ENTRIES);h=o[g+wt.PREV_R],c=o[g+wt.PREV_G],u=o[g+wt.PREV_B],d=o[g+wt.PREV_A],f=o[g+wt.PREV_R2],m=o[g+wt.PREV_G2],p=o[g+wt.PREV_B2];let y=o[g],_=this.getCurvePercent(g/wt.ENTRIES-1,1-(e-y)/(o[g+wt.PREV_TIME]-y));h+=(o[g+wt.R]-h)*_,c+=(o[g+wt.G]-c)*_,u+=(o[g+wt.B]-u)*_,d+=(o[g+wt.A]-d)*_,f+=(o[g+wt.R2]-f)*_,m+=(o[g+wt.G2]-m)*_,p+=(o[g+wt.B2]-p)*_}if(r==1)a.color.set(h,c,u,d),a.darkColor.set(f,m,p,1);else{let g=a.color,y=a.darkColor;n==I.setup&&(g.setFromColor(a.data.color),y.setFromColor(a.data.darkColor)),g.add((h-g.r)*r,(c-g.g)*r,(u-g.b)*r,(d-g.a)*r),y.add((f-y.r)*r,(m-y.g)*r,(p-y.b)*r,0)}}},ue=wt;ue.ENTRIES=8;ue.PREV_TIME=-8;ue.PREV_R=-7;ue.PREV_G=-6;ue.PREV_B=-5;ue.PREV_A=-4;ue.PREV_R2=-3;ue.PREV_G2=-2;ue.PREV_B2=-1;ue.R=1;ue.G=2;ue.B=3;ue.A=4;ue.R2=5;ue.G2=6;ue.B2=7;var Br=class{constructor(t){this.frames=k.newFloatArray(t),this.attachmentNames=new Array(t)}getPropertyId(){return(4<<24)+this.slotIndex}getFrameCount(){return this.frames.length}setFrame(t,e,i){this.frames[t]=e,this.attachmentNames[t]=i}apply(t,e,i,r,n,l,a){let o=t.slots[this.slotIndex];if(a==at.mixOut&&l==I.setup){let d=o.data.attachmentName;o.setAttachment(d==null?null:t.getAttachment(this.slotIndex,d));return}let h=this.frames;if(i<h[0]){if(l==I.setup||l==I.first){let d=o.data.attachmentName;o.setAttachment(d==null?null:t.getAttachment(this.slotIndex,d))}return}let c=0;i>=h[h.length-1]?c=h.length-1:c=$t.binarySearch(h,i,1)-1;let u=this.attachmentNames[c];t.slots[this.slotIndex].setAttachment(u==null?null:t.getAttachment(this.slotIndex,u))}},M0=null,ic=class extends rs{constructor(t){super(t),this.frames=k.newFloatArray(t),this.frameVertices=new Array(t),M0==null&&(M0=k.newFloatArray(64))}getPropertyId(){return(6<<27)+Number(this.attachment.id)+this.slotIndex}setFrame(t,e,i){this.frames[t]=e,this.frameVertices[t]=i}apply(t,e,i,r,n,l,a){let o=t.slots[this.slotIndex],h=o.getAttachment();if(!(h instanceof es)||!h.applyDeform(this.attachment))return;let c=o.attachmentVertices;c.length==0&&(l=I.setup);let u=this.frameVertices,d=u[0].length,f=this.frames;if(i<f[0]){let x=h;switch(l){case I.setup:c.length=0;return;case I.first:if(n==1){c.length=0;break}let v=k.setArraySize(c,d);if(x.bones==null){let w=x.vertices;for(let E=0;E<d;E++)v[E]+=(w[E]-v[E])*n}else{n=1-n;for(let w=0;w<d;w++)v[w]*=n}}return}let m=k.setArraySize(c,d);if(i>=f[f.length-1]){let x=u[f.length-1];if(n==1)if(l==I.add){let v=h;if(v.bones==null){let w=v.vertices;for(let E=0;E<d;E++)m[E]+=x[E]-w[E]}else for(let w=0;w<d;w++)m[w]+=x[w]}else k.arrayCopy(x,0,m,0,d);else switch(l){case I.setup:{let w=h;if(w.bones==null){let E=w.vertices;for(let A=0;A<d;A++){let T=E[A];m[A]=T+(x[A]-T)*n}}else for(let E=0;E<d;E++)m[E]=x[E]*n;break}case I.first:case I.replace:for(let w=0;w<d;w++)m[w]+=(x[w]-m[w])*n;case I.add:let v=h;if(v.bones==null){let w=v.vertices;for(let E=0;E<d;E++)m[E]+=(x[E]-w[E])*n}else for(let w=0;w<d;w++)m[w]+=x[w]*n}return}let p=$t.binarySearch(f,i),g=u[p-1],y=u[p],_=f[p],b=this.getCurvePercent(p-1,1-(i-_)/(f[p-1]-_));if(n==1)if(l==I.add){let x=h;if(x.bones==null){let v=x.vertices;for(let w=0;w<d;w++){let E=g[w];m[w]+=E+(y[w]-E)*b-v[w]}}else for(let v=0;v<d;v++){let w=g[v];m[v]+=w+(y[v]-w)*b}}else for(let x=0;x<d;x++){let v=g[x];m[x]=v+(y[x]-v)*b}else switch(l){case I.setup:{let v=h;if(v.bones==null){let w=v.vertices;for(let E=0;E<d;E++){let A=g[E],T=w[E];m[E]=T+(A+(y[E]-A)*b-T)*n}}else for(let w=0;w<d;w++){let E=g[w];m[w]=(E+(y[w]-E)*b)*n}break}case I.first:case I.replace:for(let v=0;v<d;v++){let w=g[v];m[v]+=(w+(y[v]-w)*b-m[v])*n}break;case I.add:let x=h;if(x.bones==null){let v=x.vertices;for(let w=0;w<d;w++){let E=g[w];m[w]+=(E+(y[w]-E)*b-v[w])*n}}else for(let v=0;v<d;v++){let w=g[v];m[v]+=(w+(y[v]-w)*b)*n}}}},rc=class{constructor(t){this.frames=k.newFloatArray(t),this.events=new Array(t)}getPropertyId(){return 7<<24}getFrameCount(){return this.frames.length}setFrame(t,e){this.frames[t]=e.time,this.events[t]=e}apply(t,e,i,r,n,l,a){if(r==null)return;let o=this.frames,h=this.frames.length;if(e>i)this.apply(t,e,Number.MAX_VALUE,r,n,l,a),e=-1;else if(e>=o[h-1])return;if(i<o[0])return;let c=0;if(e<o[0])c=0;else{c=$t.binarySearch(o,e);let u=o[c];for(;c>0&&o[c-1]==u;)c--}for(;c<h&&i>=o[c];c++)r.push(this.events[c])}},Lr=class{constructor(t){this.frames=k.newFloatArray(t),this.drawOrders=new Array(t)}getPropertyId(){return 8<<24}getFrameCount(){return this.frames.length}setFrame(t,e,i){this.frames[t]=e,this.drawOrders[t]=i}apply(t,e,i,r,n,l,a){let o=t.drawOrder,h=t.slots;if(a==at.mixOut&&l==I.setup){k.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}let c=this.frames;if(i<c[0]){(l==I.setup||l==I.first)&&k.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}let u=0;i>=c[c.length-1]?u=c.length-1:u=$t.binarySearch(c,i)-1;let d=this.drawOrders[u];if(d==null)k.arrayCopy(h,0,o,0,h.length);else for(let f=0,m=d.length;f<m;f++)o[f]=h[d[f]]}},Bt=class extends rs{constructor(s){super(s),this.frames=k.newFloatArray(s*Bt.ENTRIES)}getPropertyId(){return(9<<24)+this.ikConstraintIndex}setFrame(s,t,e,i,r,n){s*=Bt.ENTRIES,this.frames[s]=t,this.frames[s+Bt.MIX]=e,this.frames[s+Bt.BEND_DIRECTION]=i,this.frames[s+Bt.COMPRESS]=r?1:0,this.frames[s+Bt.STRETCH]=n?1:0}apply(s,t,e,i,r,n,l){let a=this.frames,o=s.ikConstraints[this.ikConstraintIndex];if(e<a[0]){switch(n){case I.setup:o.mix=o.data.mix,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch;return;case I.first:o.mix+=(o.data.mix-o.mix)*r,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch}return}if(e>=a[a.length-Bt.ENTRIES]){n==I.setup?(o.mix=o.data.mix+(a[a.length+Bt.PREV_MIX]-o.data.mix)*r,l==at.mixOut?(o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch):(o.bendDirection=a[a.length+Bt.PREV_BEND_DIRECTION],o.compress=a[a.length+Bt.PREV_COMPRESS]!=0,o.stretch=a[a.length+Bt.PREV_STRETCH]!=0)):(o.mix+=(a[a.length+Bt.PREV_MIX]-o.mix)*r,l==at.mixIn&&(o.bendDirection=a[a.length+Bt.PREV_BEND_DIRECTION],o.compress=a[a.length+Bt.PREV_COMPRESS]!=0,o.stretch=a[a.length+Bt.PREV_STRETCH]!=0));return}let h=$t.binarySearch(a,e,Bt.ENTRIES),c=a[h+Bt.PREV_MIX],u=a[h],d=this.getCurvePercent(h/Bt.ENTRIES-1,1-(e-u)/(a[h+Bt.PREV_TIME]-u));n==I.setup?(o.mix=o.data.mix+(c+(a[h+Bt.MIX]-c)*d-o.data.mix)*r,l==at.mixOut?(o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch):(o.bendDirection=a[h+Bt.PREV_BEND_DIRECTION],o.compress=a[h+Bt.PREV_COMPRESS]!=0,o.stretch=a[h+Bt.PREV_STRETCH]!=0)):(o.mix+=(c+(a[h+Bt.MIX]-c)*d-o.mix)*r,l==at.mixIn&&(o.bendDirection=a[h+Bt.PREV_BEND_DIRECTION],o.compress=a[h+Bt.PREV_COMPRESS]!=0,o.stretch=a[h+Bt.PREV_STRETCH]!=0))}},os=Bt;os.ENTRIES=5;os.PREV_TIME=-5;os.PREV_MIX=-4;os.PREV_BEND_DIRECTION=-3;os.PREV_COMPRESS=-2;os.PREV_STRETCH=-1;os.MIX=1;os.BEND_DIRECTION=2;os.COMPRESS=3;os.STRETCH=4;var Jt=class extends rs{constructor(s){super(s),this.frames=k.newFloatArray(s*Jt.ENTRIES)}getPropertyId(){return(10<<24)+this.transformConstraintIndex}setFrame(s,t,e,i,r,n){s*=Jt.ENTRIES,this.frames[s]=t,this.frames[s+Jt.ROTATE]=e,this.frames[s+Jt.TRANSLATE]=i,this.frames[s+Jt.SCALE]=r,this.frames[s+Jt.SHEAR]=n}apply(s,t,e,i,r,n,l){let a=this.frames,o=s.transformConstraints[this.transformConstraintIndex];if(e<a[0]){let f=o.data;switch(n){case I.setup:o.rotateMix=f.rotateMix,o.translateMix=f.translateMix,o.scaleMix=f.scaleMix,o.shearMix=f.shearMix;return;case I.first:o.rotateMix+=(f.rotateMix-o.rotateMix)*r,o.translateMix+=(f.translateMix-o.translateMix)*r,o.scaleMix+=(f.scaleMix-o.scaleMix)*r,o.shearMix+=(f.shearMix-o.shearMix)*r}return}let h=0,c=0,u=0,d=0;if(e>=a[a.length-Jt.ENTRIES]){let f=a.length;h=a[f+Jt.PREV_ROTATE],c=a[f+Jt.PREV_TRANSLATE],u=a[f+Jt.PREV_SCALE],d=a[f+Jt.PREV_SHEAR]}else{let f=$t.binarySearch(a,e,Jt.ENTRIES);h=a[f+Jt.PREV_ROTATE],c=a[f+Jt.PREV_TRANSLATE],u=a[f+Jt.PREV_SCALE],d=a[f+Jt.PREV_SHEAR];let m=a[f],p=this.getCurvePercent(f/Jt.ENTRIES-1,1-(e-m)/(a[f+Jt.PREV_TIME]-m));h+=(a[f+Jt.ROTATE]-h)*p,c+=(a[f+Jt.TRANSLATE]-c)*p,u+=(a[f+Jt.SCALE]-u)*p,d+=(a[f+Jt.SHEAR]-d)*p}if(n==I.setup){let f=o.data;o.rotateMix=f.rotateMix+(h-f.rotateMix)*r,o.translateMix=f.translateMix+(c-f.translateMix)*r,o.scaleMix=f.scaleMix+(u-f.scaleMix)*r,o.shearMix=f.shearMix+(d-f.shearMix)*r}else o.rotateMix+=(h-o.rotateMix)*r,o.translateMix+=(c-o.translateMix)*r,o.scaleMix+=(u-o.scaleMix)*r,o.shearMix+=(d-o.shearMix)*r}},as=Jt;as.ENTRIES=5;as.PREV_TIME=-5;as.PREV_ROTATE=-4;as.PREV_TRANSLATE=-3;as.PREV_SCALE=-2;as.PREV_SHEAR=-1;as.ROTATE=1;as.TRANSLATE=2;as.SCALE=3;as.SHEAR=4;var yi=class extends rs{constructor(s){super(s),this.frames=k.newFloatArray(s*yi.ENTRIES)}getPropertyId(){return(11<<24)+this.pathConstraintIndex}setFrame(s,t,e){s*=yi.ENTRIES,this.frames[s]=t,this.frames[s+yi.VALUE]=e}apply(s,t,e,i,r,n,l){let a=this.frames,o=s.pathConstraints[this.pathConstraintIndex];if(e<a[0]){switch(n){case I.setup:o.position=o.data.position;return;case I.first:o.position+=(o.data.position-o.position)*r}return}let h=0;if(e>=a[a.length-yi.ENTRIES])h=a[a.length+yi.PREV_VALUE];else{let c=$t.binarySearch(a,e,yi.ENTRIES);h=a[c+yi.PREV_VALUE];let u=a[c],d=this.getCurvePercent(c/yi.ENTRIES-1,1-(e-u)/(a[c+yi.PREV_TIME]-u));h+=(a[c+yi.VALUE]-h)*d}n==I.setup?o.position=o.data.position+(h-o.data.position)*r:o.position+=(h-o.position)*r}},Gi=yi;Gi.ENTRIES=2;Gi.PREV_TIME=-2;Gi.PREV_VALUE=-1;Gi.VALUE=1;var bs=class extends Gi{constructor(t){super(t)}getPropertyId(){return(12<<24)+this.pathConstraintIndex}apply(t,e,i,r,n,l,a){let o=this.frames,h=t.pathConstraints[this.pathConstraintIndex];if(i<o[0]){switch(l){case I.setup:h.spacing=h.data.spacing;return;case I.first:h.spacing+=(h.data.spacing-h.spacing)*n}return}let c=0;if(i>=o[o.length-bs.ENTRIES])c=o[o.length+bs.PREV_VALUE];else{let u=$t.binarySearch(o,i,bs.ENTRIES);c=o[u+bs.PREV_VALUE];let d=o[u],f=this.getCurvePercent(u/bs.ENTRIES-1,1-(i-d)/(o[u+bs.PREV_TIME]-d));c+=(o[u+bs.VALUE]-c)*f}l==I.setup?h.spacing=h.data.spacing+(c-h.data.spacing)*n:h.spacing+=(c-h.spacing)*n}},is=class extends rs{constructor(s){super(s),this.frames=k.newFloatArray(s*is.ENTRIES)}getPropertyId(){return(13<<24)+this.pathConstraintIndex}setFrame(s,t,e,i){s*=is.ENTRIES,this.frames[s]=t,this.frames[s+is.ROTATE]=e,this.frames[s+is.TRANSLATE]=i}apply(s,t,e,i,r,n,l){let a=this.frames,o=s.pathConstraints[this.pathConstraintIndex];if(e<a[0]){switch(n){case I.setup:o.rotateMix=o.data.rotateMix,o.translateMix=o.data.translateMix;return;case I.first:o.rotateMix+=(o.data.rotateMix-o.rotateMix)*r,o.translateMix+=(o.data.translateMix-o.translateMix)*r}return}let h=0,c=0;if(e>=a[a.length-is.ENTRIES])h=a[a.length+is.PREV_ROTATE],c=a[a.length+is.PREV_TRANSLATE];else{let u=$t.binarySearch(a,e,is.ENTRIES);h=a[u+is.PREV_ROTATE],c=a[u+is.PREV_TRANSLATE];let d=a[u],f=this.getCurvePercent(u/is.ENTRIES-1,1-(e-d)/(a[u+is.PREV_TIME]-d));h+=(a[u+is.ROTATE]-h)*f,c+=(a[u+is.TRANSLATE]-c)*f}n==I.setup?(o.rotateMix=o.data.rotateMix+(h-o.data.rotateMix)*r,o.translateMix=o.data.translateMix+(c-o.data.translateMix)*r):(o.rotateMix+=(h-o.rotateMix)*r,o.translateMix+=(c-o.translateMix)*r)}},vi=is;vi.ENTRIES=3;vi.PREV_TIME=-3;vi.PREV_ROTATE=-2;vi.PREV_TRANSLATE=-1;vi.ROTATE=1;vi.TRANSLATE=2;var Te=class{constructor(s){this.tracks=new Array,this.events=new Array,this.listeners=new Array,this.queue=new bm(this),this.propertyIDs=new pn,this.animationsChanged=!1,this.timeScale=1,this.trackEntryPool=new Js(()=>new nd),this.data=s}update(s){s*=this.timeScale;let t=this.tracks;for(let e=0,i=t.length;e<i;e++){let r=t[e];if(r==null)continue;r.animationLast=r.nextAnimationLast,r.trackLast=r.nextTrackLast;let n=s*r.timeScale;if(r.delay>0){if(r.delay-=n,r.delay>0)continue;n=-r.delay,r.delay=0}let l=r.next;if(l!=null){let a=r.trackLast-l.delay;if(a>=0){for(l.delay=0,l.trackTime=r.timeScale==0?0:(a/r.timeScale+s)*l.timeScale,r.trackTime+=n,this.setCurrent(e,l,!0);l.mixingFrom!=null;)l.mixTime+=s,l=l.mixingFrom;continue}}else if(r.trackLast>=r.trackEnd&&r.mixingFrom==null){t[e]=null,this.queue.end(r),this.disposeNext(r);continue}if(r.mixingFrom!=null&&this.updateMixingFrom(r,s)){let a=r.mixingFrom;for(r.mixingFrom=null,a!=null&&(a.mixingTo=null);a!=null;)this.queue.end(a),a=a.mixingFrom}r.trackTime+=n}this.queue.drain()}updateMixingFrom(s,t){let e=s.mixingFrom;if(e==null)return!0;let i=this.updateMixingFrom(e,t);return e.animationLast=e.nextAnimationLast,e.trackLast=e.nextTrackLast,s.mixTime>0&&s.mixTime>=s.mixDuration?((e.totalAlpha==0||s.mixDuration==0)&&(s.mixingFrom=e.mixingFrom,e.mixingFrom!=null&&(e.mixingFrom.mixingTo=s),s.interruptAlpha=e.interruptAlpha,this.queue.end(e)),i):(e.trackTime+=t*e.timeScale,s.mixTime+=t,!1)}apply(s){if(s==null)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();let t=this.events,e=this.tracks,i=!1;for(let r=0,n=e.length;r<n;r++){let l=e[r];if(l==null||l.delay>0)continue;i=!0;let a=r==0?I.first:l.mixBlend,o=l.alpha;l.mixingFrom!=null?o*=this.applyMixingFrom(l,s,a):l.trackTime>=l.trackEnd&&l.next==null&&(o=0);let h=l.animationLast,c=l.getAnimationTime(),u=l.animation.timelines.length,d=l.animation.timelines;if(r==0&&o==1||a==I.add)for(let f=0;f<u;f++)k.webkit602BugfixHelper(o,a),d[f].apply(s,h,c,t,o,a,at.mixIn);else{let f=l.timelineMode,m=l.timelinesRotation.length==0;m&&k.setArraySize(l.timelinesRotation,u<<1,null);let p=l.timelinesRotation;for(let g=0;g<u;g++){let y=d[g],_=f[g]==Te.SUBSEQUENT?a:I.setup;y instanceof Ie?this.applyRotateTimeline(y,s,c,o,_,p,g<<1,m):(k.webkit602BugfixHelper(o,a),y.apply(s,h,c,t,o,_,at.mixIn))}}this.queueEvents(l,c),t.length=0,l.nextAnimationLast=c,l.nextTrackLast=l.trackTime}return this.queue.drain(),i}applyMixingFrom(s,t,e){let i=s.mixingFrom;i.mixingFrom!=null&&this.applyMixingFrom(i,t,e);let r=0;s.mixDuration==0?(r=1,e==I.first&&(e=I.setup)):(r=s.mixTime/s.mixDuration,r>1&&(r=1),e!=I.first&&(e=i.mixBlend));let n=r<i.eventThreshold?this.events:null,l=r<i.attachmentThreshold,a=r<i.drawOrderThreshold,o=i.animationLast,h=i.getAnimationTime(),c=i.animation.timelines.length,u=i.animation.timelines,d=i.alpha*s.interruptAlpha,f=d*(1-r);if(e==I.add)for(let m=0;m<c;m++)u[m].apply(t,o,h,n,f,e,at.mixOut);else{let m=i.timelineMode,p=i.timelineHoldMix,g=i.timelinesRotation.length==0;g&&k.setArraySize(i.timelinesRotation,c<<1,null);let y=i.timelinesRotation;i.totalAlpha=0;for(let _=0;_<c;_++){let b=u[_],x=at.mixOut,v,w=0;switch(m[_]){case Te.SUBSEQUENT:if(!l&&b instanceof Br||!a&&b instanceof Lr)continue;v=e,w=f;break;case Te.FIRST:v=I.setup,w=f;break;case Te.HOLD:v=I.setup,w=d;break;default:v=I.setup;let E=p[_];w=d*Math.max(0,1-E.mixTime/E.mixDuration);break}i.totalAlpha+=w,b instanceof Ie?this.applyRotateTimeline(b,t,h,w,v,y,_<<1,g):(k.webkit602BugfixHelper(w,e),v==I.setup&&(b instanceof Br?l&&(x=at.mixOut):b instanceof Lr&&a&&(x=at.mixOut)),b.apply(t,o,h,n,w,v,x))}}return s.mixDuration>0&&this.queueEvents(i,h),this.events.length=0,i.nextAnimationLast=h,i.nextTrackLast=i.trackTime,r}applyRotateTimeline(s,t,e,i,r,n,l,a){if(a&&(n[l]=0),i==1){s.apply(t,0,e,null,1,r,at.mixIn);return}let o=s,h=o.frames,c=t.bones[o.boneIndex],u=0,d=0;if(e<h[0])switch(r){case I.setup:c.rotation=c.data.rotation;default:return;case I.first:u=c.rotation,d=c.data.rotation}else if(u=r==I.setup?c.data.rotation:c.rotation,e>=h[h.length-Ie.ENTRIES])d=c.data.rotation+h[h.length+Ie.PREV_ROTATION];else{let p=$t.binarySearch(h,e,Ie.ENTRIES),g=h[p+Ie.PREV_ROTATION],y=h[p],_=o.getCurvePercent((p>>1)-1,1-(e-y)/(h[p+Ie.PREV_TIME]-y));d=h[p+Ie.ROTATION]-g,d-=(16384-(16384.499999999996-d/360|0))*360,d=g+d*_+c.data.rotation,d-=(16384-(16384.499999999996-d/360|0))*360}let f=0,m=d-u;if(m-=(16384-(16384.499999999996-m/360|0))*360,m==0)f=n[l];else{let p=0,g=0;a?(p=0,g=m):(p=n[l],g=n[l+1]);let y=m>0,_=p>=0;S.signum(g)!=S.signum(m)&&Math.abs(g)<=90&&(Math.abs(p)>180&&(p+=360*S.signum(p)),_=y),f=m+p-p%360,_!=y&&(f+=360*S.signum(p)),n[l]=f}n[l+1]=m,u+=f*i,c.rotation=u-(16384-(16384.499999999996-u/360|0))*360}queueEvents(s,t){let e=s.animationStart,i=s.animationEnd,r=i-e,n=s.trackLast%r,l=this.events,a=0,o=l.length;for(;a<o;a++){let c=l[a];if(c.time<n)break;c.time>i||this.queue.event(s,c)}let h=!1;for(s.loop?h=r==0||n>s.trackTime%r:h=t>=i&&s.animationLast<i,h&&this.queue.complete(s);a<o;a++)l[a].time<e||this.queue.event(s,l[a])}clearTracks(){let s=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let t=0,e=this.tracks.length;t<e;t++)this.clearTrack(t);this.tracks.length=0,this.queue.drainDisabled=s,this.queue.drain()}clearTrack(s){if(s>=this.tracks.length)return;let t=this.tracks[s];if(t==null)return;this.queue.end(t),this.disposeNext(t);let e=t;for(;;){let i=e.mixingFrom;if(i==null)break;this.queue.end(i),e.mixingFrom=null,e.mixingTo=null,e=i}this.tracks[t.trackIndex]=null,this.queue.drain()}setCurrent(s,t,e){let i=this.expandToIndex(s);this.tracks[s]=t,i!=null&&(e&&this.queue.interrupt(i),t.mixingFrom=i,i.mixingTo=t,t.mixTime=0,i.mixingFrom!=null&&i.mixDuration>0&&(t.interruptAlpha*=Math.min(1,i.mixTime/i.mixDuration)),i.timelinesRotation.length=0),this.queue.start(t)}setAnimation(s,t,e){let i=this.data.skeletonData.findAnimation(t);if(i==null)throw new Error(`Animation not found: ${t}`);return this.setAnimationWith(s,i,e)}setAnimationWith(s,t,e){if(t==null)throw new Error("animation cannot be null.");let i=!0,r=this.expandToIndex(s);r!=null&&(r.nextTrackLast==-1?(this.tracks[s]=r.mixingFrom,this.queue.interrupt(r),this.queue.end(r),this.disposeNext(r),r=r.mixingFrom,i=!1):this.disposeNext(r));let n=this.trackEntry(s,t,e,r);return this.setCurrent(s,n,i),this.queue.drain(),n}addAnimation(s,t,e,i){let r=this.data.skeletonData.findAnimation(t);if(r==null)throw new Error(`Animation not found: ${t}`);return this.addAnimationWith(s,r,e,i)}addAnimationWith(s,t,e,i){if(t==null)throw new Error("animation cannot be null.");let r=this.expandToIndex(s);if(r!=null)for(;r.next!=null;)r=r.next;let n=this.trackEntry(s,t,e,r);if(r==null)this.setCurrent(s,n,!0),this.queue.drain();else if(r.next=n,i<=0){let l=r.animationEnd-r.animationStart;l!=0?(r.loop?i+=l*(1+(r.trackTime/l|0)):i+=Math.max(l,r.trackTime),i-=this.data.getMix(r.animation,t)):i=r.trackTime}return n.delay=i,n}setEmptyAnimation(s,t){let e=this.setAnimationWith(s,Te.emptyAnimation,!1);return e.mixDuration=t,e.trackEnd=t,e}addEmptyAnimation(s,t,e){e<=0&&(e-=t);let i=this.addAnimationWith(s,Te.emptyAnimation,!1,e);return i.mixDuration=t,i.trackEnd=t,i}setEmptyAnimations(s){let t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,i=this.tracks.length;e<i;e++){let r=this.tracks[e];r!=null&&this.setEmptyAnimation(r.trackIndex,s)}this.queue.drainDisabled=t,this.queue.drain()}expandToIndex(s){return s<this.tracks.length?this.tracks[s]:(k.ensureArrayCapacity(this.tracks,s-this.tracks.length+1,null),this.tracks.length=s+1,null)}trackEntry(s,t,e,i){let r=this.trackEntryPool.obtain();return r.trackIndex=s,r.animation=t,r.loop=e,r.holdPrevious=!1,r.eventThreshold=0,r.attachmentThreshold=0,r.drawOrderThreshold=0,r.animationStart=0,r.animationEnd=t.duration,r.animationLast=-1,r.nextAnimationLast=-1,r.delay=0,r.trackTime=0,r.trackLast=-1,r.nextTrackLast=-1,r.trackEnd=Number.MAX_VALUE,r.timeScale=1,r.alpha=1,r.interruptAlpha=1,r.mixTime=0,r.mixDuration=i==null?0:this.data.getMix(i.animation,t),r}disposeNext(s){let t=s.next;for(;t!=null;)this.queue.dispose(t),t=t.next;s.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();for(let s=0,t=this.tracks.length;s<t;s++){let e=this.tracks[s];if(e!=null){for(;e.mixingFrom!=null;)e=e.mixingFrom;do(e.mixingFrom==null||e.mixBlend!=I.add)&&this.setTimelineModes(e),e=e.mixingTo;while(e!=null)}}}setTimelineModes(s){let t=s.mixingTo,e=s.animation.timelines,i=s.animation.timelines.length,r=k.setArraySize(s.timelineMode,i);s.timelineHoldMix.length=0;let n=k.setArraySize(s.timelineHoldMix,i),l=this.propertyIDs;if(t!=null&&t.holdPrevious){for(let a=0;a<i;a++)l.add(e[a].getPropertyId()),r[a]=Te.HOLD;return}t:for(let a=0;a<i;a++){let o=e[a].getPropertyId();if(!l.add(o))r[a]=Te.SUBSEQUENT;else if(t==null||!this.hasTimeline(t,o))r[a]=Te.FIRST;else{for(let h=t.mixingTo;h!=null;h=h.mixingTo)if(!this.hasTimeline(h,o)){if(s.mixDuration>0){r[a]=Te.HOLD_MIX,n[a]=h;continue t}break}r[a]=Te.HOLD}}}hasTimeline(s,t){let e=s.animation.timelines;for(let i=0,r=e.length;i<r;i++)if(e[i].getPropertyId()==t)return!0;return!1}getCurrent(s){return s>=this.tracks.length?null:this.tracks[s]}addListener(s){if(s==null)throw new Error("listener cannot be null.");this.listeners.push(s)}removeListener(s){let t=this.listeners.indexOf(s);t>=0&&this.listeners.splice(t,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}setAnimationByName(s,t,e){Te.deprecatedWarning1||(Te.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(s,t,e)}addAnimationByName(s,t,e,i){Te.deprecatedWarning2||(Te.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(s,t,e,i)}hasAnimation(s){return this.data.skeletonData.findAnimation(s)!==null}hasAnimationByName(s){return Te.deprecatedWarning3||(Te.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(s)}},oi=Te;oi.emptyAnimation=new $t("<empty>",[],0);oi.SUBSEQUENT=0;oi.FIRST=1;oi.HOLD=2;oi.HOLD_MIX=3;oi.deprecatedWarning1=!1;oi.deprecatedWarning2=!1;oi.deprecatedWarning3=!1;var Ur=class{constructor(){this.mixBlend=I.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}reset(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){let s=this.animationEnd-this.animationStart;return s==0?this.animationStart:this.trackTime%s+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(s){this.animationLast=s,this.nextAnimationLast=s}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}get time(){return Ur.deprecatedWarning1||(Ur.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime}set time(s){Ur.deprecatedWarning1||(Ur.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=s}get endTime(){return Ur.deprecatedWarning2||(Ur.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime}set endTime(s){Ur.deprecatedWarning2||(Ur.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=s}loopsCount(){return Math.floor(this.trackTime/this.trackEnd)}},nd=Ur;nd.deprecatedWarning1=!1;nd.deprecatedWarning2=!1;var Ag=class{constructor(s){this.objects=[],this.drainDisabled=!1,this.animState=s}start(s){this.objects.push(ls.start),this.objects.push(s),this.animState.animationsChanged=!0}interrupt(s){this.objects.push(ls.interrupt),this.objects.push(s)}end(s){this.objects.push(ls.end),this.objects.push(s),this.animState.animationsChanged=!0}dispose(s){this.objects.push(ls.dispose),this.objects.push(s)}complete(s){this.objects.push(ls.complete),this.objects.push(s)}event(s,t){this.objects.push(ls.event),this.objects.push(s),this.objects.push(t)}deprecateStuff(){return Ag.deprecatedWarning1||(Ag.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: onComplete, onStart, onEnd, onEvent art deprecated, please use listeners from now on. 'state.addListener({ complete: function(track, event) { } })'")),!0}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;let s=this.objects,t=this.animState.listeners;for(let e=0;e<s.length;e+=2){let i=s[e],r=s[e+1];switch(i){case ls.start:r.listener!=null&&r.listener.start&&r.listener.start(r);for(let a=0;a<t.length;a++)t[a].start&&t[a].start(r);r.onStart&&this.deprecateStuff()&&r.onStart(r.trackIndex),this.animState.onStart&&this.deprecateStuff()&&this.deprecateStuff&&this.animState.onStart(r.trackIndex);break;case ls.interrupt:r.listener!=null&&r.listener.interrupt&&r.listener.interrupt(r);for(let a=0;a<t.length;a++)t[a].interrupt&&t[a].interrupt(r);break;case ls.end:r.listener!=null&&r.listener.end&&r.listener.end(r);for(let a=0;a<t.length;a++)t[a].end&&t[a].end(r);r.onEnd&&this.deprecateStuff()&&r.onEnd(r.trackIndex),this.animState.onEnd&&this.deprecateStuff()&&this.animState.onEnd(r.trackIndex);case ls.dispose:r.listener!=null&&r.listener.dispose&&r.listener.dispose(r);for(let a=0;a<t.length;a++)t[a].dispose&&t[a].dispose(r);this.animState.trackEntryPool.free(r);break;case ls.complete:r.listener!=null&&r.listener.complete&&r.listener.complete(r);for(let a=0;a<t.length;a++)t[a].complete&&t[a].complete(r);let n=S.toInt(r.loopsCount());r.onComplete&&this.deprecateStuff()&&r.onComplete(r.trackIndex,n),this.animState.onComplete&&this.deprecateStuff()&&this.animState.onComplete(r.trackIndex,n);break;case ls.event:let l=s[e+++2];r.listener!=null&&r.listener.event&&r.listener.event(r,l);for(let a=0;a<t.length;a++)t[a].event&&t[a].event(r,l);r.onEvent&&this.deprecateStuff()&&r.onEvent(r.trackIndex,l),this.animState.onEvent&&this.deprecateStuff()&&this.animState.onEvent(r.trackIndex,l);break}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}},bm=Ag;bm.deprecatedWarning1=!1;var ls=(s=>(s[s.start=0]="start",s[s.interrupt=1]="interrupt",s[s.end=2]="end",s[s.dispose=3]="dispose",s[s.complete=4]="complete",s[s.event=5]="event",s))(ls||{}),xm=class{start(t){}interrupt(t){}end(t){}dispose(t){}complete(t){}event(t,e){}};var Ig=class{constructor(s){if(this.animationToMixTime={},this.defaultMix=0,s==null)throw new Error("skeletonData cannot be null.");this.skeletonData=s}setMix(s,t,e){let i=this.skeletonData.findAnimation(s);if(i==null)throw new Error(`Animation not found: ${s}`);let r=this.skeletonData.findAnimation(t);if(r==null)throw new Error(`Animation not found: ${t}`);this.setMixWith(i,r,e)}setMixByName(s,t,e){Ig.deprecatedWarning1||(Ig.deprecatedWarning1=!0,console.warn("Deprecation Warning: AnimationStateData.setMixByName is deprecated, please use setMix from now on.")),this.setMix(s,t,e)}setMixWith(s,t,e){if(s==null)throw new Error("from cannot be null.");if(t==null)throw new Error("to cannot be null.");let i=`${s.name}.${t.name}`;this.animationToMixTime[i]=e}getMix(s,t){let e=`${s.name}.${t.name}`,i=this.animationToMixTime[e];return i===void 0?this.defaultMix:i}},od=Ig;od.deprecatedWarning1=!1;var nc=class{constructor(t){this.atlas=t}newRegionAttachment(t,e,i){let r=this.atlas.findRegion(i);if(r==null)throw new Error(`Region not found in atlas: ${i} (region attachment: ${e})`);let n=new ut(e);return n.region=r,n}newMeshAttachment(t,e,i){let r=this.atlas.findRegion(i);if(r==null)throw new Error(`Region not found in atlas: ${i} (mesh attachment: ${e})`);let n=new Dn(e);return n.region=r,n}newBoundingBoxAttachment(t,e){return new tc(e)}newPathAttachment(t,e){return new _i(e)}newPointAttachment(t,e){return new sc(e)}newClippingAttachment(t,e){return new ec(e)}};var wl=class{constructor(t,e,i){if(this.matrix=new mt,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.sorted=!1,this.active=!0,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=i,this.setToSetupPose()}get worldX(){return this.matrix.tx}get worldY(){return this.matrix.ty}update(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,e,i,r,n,l,a){this.ax=t,this.ay=e,this.arotation=i,this.ascaleX=r,this.ascaleY=n,this.ashearX=l,this.ashearY=a,this.appliedValid=!0;let o=this.parent,h=this.matrix,c=this.skeleton.scaleX,u=jt.yDown?-this.skeleton.scaleY:this.skeleton.scaleY;if(o==null){let g=this.skeleton,y=i+90+a;h.a=S.cosDeg(i+l)*r*c,h.c=S.cosDeg(y)*n*c,h.b=S.sinDeg(i+l)*r*u,h.d=S.sinDeg(y)*n*u,h.tx=t*c+g.x,h.ty=e*u+g.y;return}let d=o.matrix.a,f=o.matrix.c,m=o.matrix.b,p=o.matrix.d;switch(h.tx=d*t+f*e+o.matrix.tx,h.ty=m*t+p*e+o.matrix.ty,this.data.transformMode){case it.Normal:{let g=i+90+a,y=S.cosDeg(i+l)*r,_=S.cosDeg(g)*n,b=S.sinDeg(i+l)*r,x=S.sinDeg(g)*n;h.a=d*y+f*b,h.c=d*_+f*x,h.b=m*y+p*b,h.d=m*_+p*x;return}case it.OnlyTranslation:{let g=i+90+a;h.a=S.cosDeg(i+l)*r,h.c=S.cosDeg(g)*n,h.b=S.sinDeg(i+l)*r,h.d=S.sinDeg(g)*n;break}case it.NoRotationOrReflection:{let g=d*d+m*m,y=0;g>1e-4?(g=Math.abs(d*p-f*m)/g,f=m*g,p=d*g,y=Math.atan2(m,d)*S.radDeg):(d=0,m=0,y=90-Math.atan2(p,f)*S.radDeg);let _=i+l-y,b=i+a-y+90,x=S.cosDeg(_)*r,v=S.cosDeg(b)*n,w=S.sinDeg(_)*r,E=S.sinDeg(b)*n;h.a=d*x-f*w,h.c=d*v-f*E,h.b=m*x+p*w,h.d=m*v+p*E;break}case it.NoScale:case it.NoScaleOrReflection:{let g=S.cosDeg(i),y=S.sinDeg(i),_=(d*g+f*y)/c,b=(m*g+p*y)/u,x=Math.sqrt(_*_+b*b);x>1e-5&&(x=1/x),_*=x,b*=x,x=Math.sqrt(_*_+b*b),this.data.transformMode==it.NoScale&&d*p-f*m<0!=(jt.yDown?this.skeleton.scaleX<0!=this.skeleton.scaleY>0:this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(x=-x);let v=Math.PI/2+Math.atan2(b,_),w=Math.cos(v)*x,E=Math.sin(v)*x,A=S.cosDeg(l)*r,T=S.cosDeg(90+a)*n,C=S.sinDeg(l)*r,R=S.sinDeg(90+a)*n;h.a=_*A+w*C,h.c=_*T+w*R,h.b=b*A+E*C,h.d=b*T+E*R;break}}h.a*=c,h.c*=c,h.b*=u,h.d*=u}setToSetupPose(){let t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY}getWorldRotationX(){return Math.atan2(this.matrix.b,this.matrix.a)*S.radDeg}getWorldRotationY(){return Math.atan2(this.matrix.d,this.matrix.c)*S.radDeg}getWorldScaleX(){let t=this.matrix;return Math.sqrt(t.a*t.a+t.c*t.c)}getWorldScaleY(){let t=this.matrix;return Math.sqrt(t.b*t.b+t.d*t.d)}updateAppliedTransform(){this.appliedValid=!0;let t=this.parent,e=this.matrix;if(t==null){this.ax=e.tx,this.ay=e.ty,this.arotation=Math.atan2(e.b,e.a)*S.radDeg,this.ascaleX=Math.sqrt(e.a*e.a+e.b*e.b),this.ascaleY=Math.sqrt(e.c*e.c+e.d*e.d),this.ashearX=0,this.ashearY=Math.atan2(e.a*e.c+e.b*e.d,e.a*e.d-e.b*e.c)*S.radDeg;return}let i=t.matrix,r=1/(i.a*i.d-i.b*i.c),n=e.tx-i.tx,l=e.ty-i.ty;this.ax=n*i.d*r-l*i.c*r,this.ay=l*i.a*r-n*i.b*r;let a=r*i.d,o=r*i.a,h=r*i.c,c=r*i.b,u=a*e.a-h*e.b,d=a*e.c-h*e.d,f=o*e.b-c*e.a,m=o*e.d-c*e.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(u*u+f*f),this.ascaleX>1e-4){let p=u*m-d*f;this.ascaleY=p/this.ascaleX,this.ashearY=Math.atan2(u*d+f*m,p)*S.radDeg,this.arotation=Math.atan2(f,u)*S.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(d*d+m*m),this.ashearY=0,this.arotation=90-Math.atan2(m,d)*S.radDeg}worldToLocal(t){let e=this.matrix,i=e.a,r=e.c,n=e.b,l=e.d,a=1/(i*l-r*n),o=t.x-e.tx,h=t.y-e.ty;return t.x=o*l*a-h*r*a,t.y=h*i*a-o*n*a,t}localToWorld(t){let e=this.matrix,i=t.x,r=t.y;return t.x=i*e.a+r*e.c+e.tx,t.y=i*e.b+r*e.d+e.ty,t}worldToLocalRotation(t){let e=S.sinDeg(t),i=S.cosDeg(t),r=this.matrix;return Math.atan2(r.a*e-r.b*i,r.d*i-r.c*e)*S.radDeg}localToWorldRotation(t){let e=S.sinDeg(t),i=S.cosDeg(t),r=this.matrix;return Math.atan2(i*r.b+e*r.d,i*r.a+e*r.c)*S.radDeg}rotateWorld(t){let e=this.matrix,i=e.a,r=e.c,n=e.b,l=e.d,a=S.cosDeg(t),o=S.sinDeg(t);e.a=a*i-o*n,e.c=a*r-o*l,e.b=o*i+a*n,e.d=o*r+a*l,this.appliedValid=!1}};var oc=class{constructor(t,e,i){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=it.Normal,t<0)throw new Error("index must be >= 0.");if(e==null)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=i}};var ac=class{constructor(t,e){if(e==null)throw new Error("data cannot be null.");this.time=t,this.data=e}};var lc=class{constructor(t){this.name=t}};var hc=class{constructor(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(let i=0;i<t.bones.length;i++)this.bones.push(e.findBone(t.bones[i].name));this.target=e.findBone(t.target.name)}getOrder(){return this.data.order}apply(){this.update()}update(){let t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.mix);break}}apply1(t,e,i,r,n,l,a){t.appliedValid||t.updateAppliedTransform();let o=t.parent.matrix,h=1/(o.a*o.d-o.b*o.c),c=e-o.tx,u=i-o.ty,d=(c*o.d-u*o.c)*h-t.ax,f=(u*o.a-c*o.b)*h-t.ay,m=Math.atan2(f,d)*S.radDeg-t.ashearX-t.arotation;t.ascaleX<0&&(m+=180),m>180?m-=360:m<-180&&(m+=360);let p=t.ascaleX,g=t.ascaleY;if(r||n){let y=t.data.length*p,_=Math.sqrt(d*d+f*f);if(r&&_<y||n&&_>y&&y>1e-4){let b=(_/y-1)*a+1;p*=b,l&&(g*=b)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+m*a,p,g,t.ashearX,t.ashearY)}apply2(t,e,i,r,n,l,a){if(a==0){e.updateWorldTransform();return}t.appliedValid||t.updateAppliedTransform(),e.appliedValid||e.updateAppliedTransform();let o=t.ax,h=t.ay,c=t.ascaleX,u=c,d=t.ascaleY,f=e.ascaleX,m=t.matrix,p=0,g=0,y=0;c<0?(c=-c,p=180,y=-1):(p=0,y=1),d<0&&(d=-d,y=-y),f<0?(f=-f,g=180):g=0;let _=e.ax,b=0,x=0,v=0,w=m.a,E=m.c,A=m.b,T=m.d,C=Math.abs(c-d)<=1e-4;C?(b=e.ay,x=w*_+E*b+m.tx,v=A*_+T*b+m.ty):(b=0,x=w*_+m.tx,v=A*_+m.ty);let R=t.parent.matrix;w=R.a,E=R.c,A=R.b,T=R.d;let N=1/(w*T-E*A),P=i-R.tx,M=r-R.ty,D=(P*T-M*E)*N-o,q=(M*w-P*A)*N-h,X=D*D+q*q;P=x-R.tx,M=v-R.ty;let O=(P*T-M*E)*N-o,L=(M*w-P*A)*N-h,B=Math.sqrt(O*O+L*L),W=e.data.length*f,j=0,V=0;t:if(C){W*=c;let nt=(X-B*B-W*W)/(2*B*W);nt<-1?nt=-1:nt>1&&(nt=1,l&&B+W>1e-4&&(u*=(Math.sqrt(X)/(B+W)-1)*a+1)),V=Math.acos(nt)*n,w=B+W*nt,E=W*Math.sin(V),j=Math.atan2(q*w-D*E,D*w+q*E)}else{w=c*W,E=d*W;let nt=w*w,pt=E*E,At=Math.atan2(q,D);A=pt*B*B+nt*X-nt*pt;let ot=-2*pt*B,gt=pt-nt;if(T=ot*ot-4*gt*A,T>=0){let us=Math.sqrt(T);ot<0&&(us=-us),us=-(ot+us)/2;let As=us/gt,$r=A/us,Ne=Math.abs(As)<Math.abs($r)?As:$r;if(Ne*Ne<=X){M=Math.sqrt(X-Ne*Ne)*n,j=At-Math.atan2(M,Ne),V=Math.atan2(M/d,(Ne-B)/c);break t}}let yt=S.PI,Nt=B-w,Lt=Nt*Nt,Xe=0,ws=0,Es=B+w,$s=Es*Es,Hi=0;A=-w*B/(nt-pt),A>=-1&&A<=1&&(A=Math.acos(A),P=w*Math.cos(A)+B,M=E*Math.sin(A),T=P*P+M*M,T<Lt&&(yt=A,Lt=T,Nt=P,Xe=M),T>$s&&(ws=A,$s=T,Es=P,Hi=M)),X<=(Lt+$s)/2?(j=At-Math.atan2(Xe*n,Nt),V=yt*n):(j=At-Math.atan2(Hi*n,Es),V=ws*n)}let U=Math.atan2(b,_)*y,st=t.arotation;j=(j-U)*S.radDeg+p-st,j>180?j-=360:j<-180&&(j+=360),t.updateWorldTransformWith(o,h,st+j*a,u,t.ascaleY,0,0),st=e.arotation,V=((V+U)*S.radDeg-e.ashearX)*y+g-st,V>180?V-=360:V<-180&&(V+=360),e.updateWorldTransformWith(_,b,st+V*a,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}};var cc=class{constructor(t){this.order=0,this.bones=new Array,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.name=t}};var uc=class{constructor(t){this.order=0,this.bones=new Array,this.name=t}},_s=(s=>(s[s.Length=0]="Length",s[s.Fixed=1]="Fixed",s[s.Percent=2]="Percent",s))(_s||{});var El=class{constructor(s,t){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,s==null)throw new Error("data cannot be null.");if(t==null)throw new Error("skeleton cannot be null.");this.data=s,this.bones=new Array;for(let e=0,i=s.bones.length;e<i;e++)this.bones.push(t.findBone(s.bones[e].name));this.target=t.findSlot(s.target.name),this.position=s.position,this.spacing=s.spacing,this.rotateMix=s.rotateMix,this.translateMix=s.translateMix}apply(){this.update()}update(){let s=this.target.getAttachment();if(!(s instanceof _i))return;let t=this.rotateMix,e=this.translateMix,i=e>0,r=t>0;if(!i&&!r)return;let n=this.data,l=n.spacingMode,a=l==_s.Length,o=n.rotateMode,h=o==Pt.Tangent,c=o==Pt.ChainScale,u=this.bones.length,d=h?u:u+1,f=this.bones,m=k.setArraySize(this.spaces,d),p=null,g=this.spacing;if(c||a){c&&(p=k.setArraySize(this.lengths,u));for(let w=0,E=d-1;w<E;){let A=f[w],T=A.data.length;if(T<El.epsilon)c&&(p[w]=0),m[++w]=0;else{let C=T*A.matrix.a,R=T*A.matrix.b,N=Math.sqrt(C*C+R*R);c&&(p[w]=N),m[++w]=(a?T+g:g)*N/T}}}else for(let w=1;w<d;w++)m[w]=g;let y=this.computeWorldPositions(s,d,h,n.positionMode==It.Percent,l==_s.Percent),_=y[0],b=y[1],x=n.offsetRotation,v=!1;if(x==0)v=o==Pt.Chain;else{v=!1;let w=this.target.bone.matrix;x*=w.a*w.d-w.b*w.c>0?S.degRad:-S.degRad}for(let w=0,E=3;w<u;w++,E+=3){let A=f[w],T=A.matrix;T.tx+=(_-T.tx)*e,T.ty+=(b-T.ty)*e;let C=y[E],R=y[E+1],N=C-_,P=R-b;if(c){let M=p[w];if(M!=0){let D=(Math.sqrt(N*N+P*P)/M-1)*t+1;T.a*=D,T.b*=D}}if(_=C,b=R,r){let M=T.a,D=T.c,q=T.b,X=T.d,O=0,L=0,B=0;if(h&&(h?O=y[E-1]:m[w+1]==0?O=y[E+2]:O=Math.atan2(P,N)),O-=Math.atan2(q,M),v){L=Math.cos(O),B=Math.sin(O);let W=A.data.length;_+=(W*(L*M-B*q)-N)*t,b+=(W*(B*M+L*q)-P)*t}else O+=x;O>S.PI?O-=S.PI2:O<-S.PI&&(O+=S.PI2),O*=t,L=Math.cos(O),B=Math.sin(O),T.a=L*M-B*q,T.c=L*D-B*X,T.b=B*M+L*q,T.d=B*D+L*X}A.appliedValid=!1}}computeWorldPositions(s,t,e,i,r){let n=this.target,l=this.position,a=this.spaces,o=k.setArraySize(this.positions,t*3+2),h=null,c=s.closed,u=s.worldVerticesLength,d=u/6,f=El.NONE;if(!s.constantSpeed){let O=s.lengths;d-=c?1:2;let L=O[d];if(i&&(l*=L),r)for(let B=0;B<t;B++)a[B]*=L;h=k.setArraySize(this.world,8);for(let B=0,W=0,j=0;B<t;B++,W+=3){let V=a[B];l+=V;let U=l;if(c)U%=L,U<0&&(U+=L),j=0;else if(U<0){f!=El.BEFORE&&(f=El.BEFORE,s.computeWorldVertices(n,2,4,h,0,2)),this.addBeforePosition(U,h,0,o,W);continue}else if(U>L){f!=El.AFTER&&(f=El.AFTER,s.computeWorldVertices(n,u-6,4,h,0,2)),this.addAfterPosition(U-L,h,0,o,W);continue}for(;;j++){let st=O[j];if(!(U>st)){if(j==0)U/=st;else{let nt=O[j-1];U=(U-nt)/(st-nt)}break}}j!=f&&(f=j,c&&j==d?(s.computeWorldVertices(n,u-4,4,h,0,2),s.computeWorldVertices(n,0,4,h,4,2)):s.computeWorldVertices(n,j*6+2,8,h,0,2)),this.addCurvePosition(U,h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],o,W,e||B>0&&V==0)}return o}c?(u+=2,h=k.setArraySize(this.world,u),s.computeWorldVertices(n,2,u-4,h,0,2),s.computeWorldVertices(n,0,2,h,u-4,2),h[u-2]=h[0],h[u-1]=h[1]):(d--,u-=4,h=k.setArraySize(this.world,u),s.computeWorldVertices(n,2,u,h,0,2));let m=k.setArraySize(this.curves,d),p=0,g=h[0],y=h[1],_=0,b=0,x=0,v=0,w=0,E=0,A=0,T=0,C=0,R=0,N=0,P=0,M=0,D=0;for(let O=0,L=2;O<d;O++,L+=6)_=h[L],b=h[L+1],x=h[L+2],v=h[L+3],w=h[L+4],E=h[L+5],A=(g-_*2+x)*.1875,T=(y-b*2+v)*.1875,C=((_-x)*3-g+w)*.09375,R=((b-v)*3-y+E)*.09375,N=A*2+C,P=T*2+R,M=(_-g)*.75+A+C*.16666667,D=(b-y)*.75+T+R*.16666667,p+=Math.sqrt(M*M+D*D),M+=N,D+=P,N+=C,P+=R,p+=Math.sqrt(M*M+D*D),M+=N,D+=P,p+=Math.sqrt(M*M+D*D),M+=N+C,D+=P+R,p+=Math.sqrt(M*M+D*D),m[O]=p,g=w,y=E;if(i&&(l*=p),r)for(let O=0;O<t;O++)a[O]*=p;let q=this.segments,X=0;for(let O=0,L=0,B=0,W=0;O<t;O++,L+=3){let j=a[O];l+=j;let V=l;if(c)V%=p,V<0&&(V+=p),B=0;else if(V<0){this.addBeforePosition(V,h,0,o,L);continue}else if(V>p){this.addAfterPosition(V-p,h,u-4,o,L);continue}for(;;B++){let U=m[B];if(!(V>U)){if(B==0)V/=U;else{let st=m[B-1];V=(V-st)/(U-st)}break}}if(B!=f){f=B;let U=B*6;for(g=h[U],y=h[U+1],_=h[U+2],b=h[U+3],x=h[U+4],v=h[U+5],w=h[U+6],E=h[U+7],A=(g-_*2+x)*.03,T=(y-b*2+v)*.03,C=((_-x)*3-g+w)*.006,R=((b-v)*3-y+E)*.006,N=A*2+C,P=T*2+R,M=(_-g)*.3+A+C*.16666667,D=(b-y)*.3+T+R*.16666667,X=Math.sqrt(M*M+D*D),q[0]=X,U=1;U<8;U++)M+=N,D+=P,N+=C,P+=R,X+=Math.sqrt(M*M+D*D),q[U]=X;M+=N,D+=P,X+=Math.sqrt(M*M+D*D),q[8]=X,M+=N+C,D+=P+R,X+=Math.sqrt(M*M+D*D),q[9]=X,W=0}for(V*=X;;W++){let U=q[W];if(!(V>U)){if(W==0)V/=U;else{let st=q[W-1];V=W+(V-st)/(U-st)}break}}this.addCurvePosition(V*.1,g,y,_,b,x,v,w,E,o,L,e||O>0&&j==0)}return o}addBeforePosition(s,t,e,i,r){let n=t[e],l=t[e+1],a=t[e+2]-n,o=t[e+3]-l,h=Math.atan2(o,a);i[r]=n+s*Math.cos(h),i[r+1]=l+s*Math.sin(h),i[r+2]=h}addAfterPosition(s,t,e,i,r){let n=t[e+2],l=t[e+3],a=n-t[e],o=l-t[e+1],h=Math.atan2(o,a);i[r]=n+s*Math.cos(h),i[r+1]=l+s*Math.sin(h),i[r+2]=h}addCurvePosition(s,t,e,i,r,n,l,a,o,h,c,u){(s==0||isNaN(s))&&(s=1e-4);let d=s*s,f=d*s,m=1-s,p=m*m,g=p*m,y=m*s,_=y*3,b=m*_,x=_*s,v=t*g+i*b+n*x+a*f,w=e*g+r*b+l*x+o*f;h[c]=v,h[c+1]=w,u&&(h[c+2]=Math.atan2(w-(e*p+r*y*2+l*d),v-(t*p+i*y*2+n*d)))}getOrder(){return this.data.order}},Xn=El;Xn.NONE=-1;Xn.BEFORE=-2;Xn.AFTER=-3;Xn.epsilon=1e-5;var dc=class{constructor(t,e){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new Bs,t==null)throw new Error("data cannot be null.");if(e==null)throw new Error("skeleton cannot be null.");this.data=t,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix,this.scaleMix=t.scaleMix,this.shearMix=t.shearMix,this.bones=new Array;for(let i=0;i<t.bones.length;i++)this.bones.push(e.findBone(t.bones[i].name));this.target=e.findBone(t.target.name)}apply(){this.update()}update(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()}applyAbsoluteWorld(){let t=this.rotateMix,e=this.translateMix,i=this.scaleMix,r=this.shearMix,n=this.target,l=n.matrix,a=l.a,o=l.c,h=l.b,c=l.d,u=a*c-o*h>0?S.degRad:-S.degRad,d=this.data.offsetRotation*u,f=this.data.offsetShearY*u,m=this.bones;for(let p=0,g=m.length;p<g;p++){let y=m[p],_=!1,b=y.matrix;if(t!=0){let x=b.a,v=b.c,w=b.b,E=b.d,A=Math.atan2(h,a)-Math.atan2(w,x)+d;A>S.PI?A-=S.PI2:A<-S.PI&&(A+=S.PI2),A*=t;let T=Math.cos(A),C=Math.sin(A);b.a=T*x-C*w,b.c=T*v-C*E,b.b=C*x+T*w,b.d=C*v+T*E,_=!0}if(e!=0){let x=this.temp;n.localToWorld(x.set(this.data.offsetX,this.data.offsetY)),b.tx+=(x.x-b.tx)*e,b.ty+=(x.y-b.ty)*e,_=!0}if(i>0){let x=Math.sqrt(b.a*b.a+b.b*b.b),v=Math.sqrt(a*a+h*h);x>1e-5&&(x=(x+(v-x+this.data.offsetScaleX)*i)/x),b.a*=x,b.b*=x,x=Math.sqrt(b.c*b.c+b.d*b.d),v=Math.sqrt(o*o+c*c),x>1e-5&&(x=(x+(v-x+this.data.offsetScaleY)*i)/x),b.c*=x,b.d*=x,_=!0}if(r>0){let x=b.c,v=b.d,w=Math.atan2(v,x),E=Math.atan2(c,o)-Math.atan2(h,a)-(w-Math.atan2(b.b,b.a));E>S.PI?E-=S.PI2:E<-S.PI&&(E+=S.PI2),E=w+(E+f)*r;let A=Math.sqrt(x*x+v*v);b.c=Math.cos(E)*A,b.d=Math.sin(E)*A,_=!0}_&&(y.appliedValid=!1)}}applyRelativeWorld(){let t=this.rotateMix,e=this.translateMix,i=this.scaleMix,r=this.shearMix,n=this.target,l=n.matrix,a=l.a,o=l.c,h=l.b,c=l.d,u=a*c-o*h>0?S.degRad:-S.degRad,d=this.data.offsetRotation*u,f=this.data.offsetShearY*u,m=this.bones;for(let p=0,g=m.length;p<g;p++){let y=m[p],_=!1,b=y.matrix;if(t!=0){let x=b.a,v=b.c,w=b.b,E=b.d,A=Math.atan2(h,a)+d;A>S.PI?A-=S.PI2:A<-S.PI&&(A+=S.PI2),A*=t;let T=Math.cos(A),C=Math.sin(A);b.a=T*x-C*w,b.c=T*v-C*E,b.b=C*x+T*w,b.d=C*v+T*E,_=!0}if(e!=0){let x=this.temp;n.localToWorld(x.set(this.data.offsetX,this.data.offsetY)),b.tx+=x.x*e,b.ty+=x.y*e,_=!0}if(i>0){let x=(Math.sqrt(a*a+h*h)-1+this.data.offsetScaleX)*i+1;b.a*=x,b.b*=x,x=(Math.sqrt(o*o+c*c)-1+this.data.offsetScaleY)*i+1,b.c*=x,b.d*=x,_=!0}if(r>0){let x=Math.atan2(c,o)-Math.atan2(h,a);x>S.PI?x-=S.PI2:x<-S.PI&&(x+=S.PI2);let v=b.c,w=b.d;x=Math.atan2(w,v)+(x-S.PI/2+f)*r;let E=Math.sqrt(v*v+w*w);b.c=Math.cos(x)*E,b.d=Math.sin(x)*E,_=!0}_&&(y.appliedValid=!1)}}applyAbsoluteLocal(){let t=this.rotateMix,e=this.translateMix,i=this.scaleMix,r=this.shearMix,n=this.target;n.appliedValid||n.updateAppliedTransform();let l=this.bones;for(let a=0,o=l.length;a<o;a++){let h=l[a];h.appliedValid||h.updateAppliedTransform();let c=h.arotation;if(t!=0){let g=n.arotation-c+this.data.offsetRotation;g-=(16384-(16384.499999999996-g/360|0))*360,c+=g*t}let u=h.ax,d=h.ay;e!=0&&(u+=(n.ax-u+this.data.offsetX)*e,d+=(n.ay-d+this.data.offsetY)*e);let f=h.ascaleX,m=h.ascaleY;i>0&&(f>1e-5&&(f=(f+(n.ascaleX-f+this.data.offsetScaleX)*i)/f),m>1e-5&&(m=(m+(n.ascaleY-m+this.data.offsetScaleY)*i)/m));let p=h.ashearY;if(r>0){let g=n.ashearY-p+this.data.offsetShearY;g-=(16384-(16384.499999999996-g/360|0))*360,h.shearY+=g*r}h.updateWorldTransformWith(u,d,c,f,m,h.ashearX,p)}}applyRelativeLocal(){let t=this.rotateMix,e=this.translateMix,i=this.scaleMix,r=this.shearMix,n=this.target;n.appliedValid||n.updateAppliedTransform();let l=this.bones;for(let a=0,o=l.length;a<o;a++){let h=l[a];h.appliedValid||h.updateAppliedTransform();let c=h.arotation;t!=0&&(c+=(n.arotation+this.data.offsetRotation)*t);let u=h.ax,d=h.ay;e!=0&&(u+=(n.ax+this.data.offsetX)*e,d+=(n.ay+this.data.offsetY)*e);let f=h.ascaleX,m=h.ascaleY;i>0&&(f>1e-5&&(f*=(n.ascaleX-1+this.data.offsetScaleX)*i+1),m>1e-5&&(m*=(n.ascaleY-1+this.data.offsetScaleY)*i+1));let p=h.ashearY;r>0&&(p+=(n.ashearY+this.data.offsetShearY)*r),h.updateWorldTransformWith(u,d,c,f,m,h.ashearX,p)}}getOrder(){return this.data.order}};var ad=class{constructor(s){if(this._updateCache=new Array,this.updateCacheReset=new Array,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,s==null)throw new Error("data cannot be null.");this.data=s,this.bones=new Array;for(let t=0;t<s.bones.length;t++){let e=s.bones[t],i;if(e.parent==null)i=new wl(e,this,null);else{let r=this.bones[e.parent.index];i=new wl(e,this,r),r.children.push(i)}this.bones.push(i)}this.slots=new Array,this.drawOrder=new Array;for(let t=0;t<s.slots.length;t++){let e=s.slots[t],i=this.bones[e.boneData.index],r=new Vn(e,i);this.slots.push(r),this.drawOrder.push(r)}this.ikConstraints=new Array;for(let t=0;t<s.ikConstraints.length;t++){let e=s.ikConstraints[t];this.ikConstraints.push(new hc(e,this))}this.transformConstraints=new Array;for(let t=0;t<s.transformConstraints.length;t++){let e=s.transformConstraints[t];this.transformConstraints.push(new dc(e,this))}this.pathConstraints=new Array;for(let t=0;t<s.pathConstraints.length;t++){let e=s.pathConstraints[t];this.pathConstraints.push(new Xn(e,this))}this.color=new G(1,1,1,1),this.updateCache()}updateCache(){let s=this._updateCache;s.length=0,this.updateCacheReset.length=0;let t=this.bones;for(let h=0,c=t.length;h<c;h++)t[h].sorted=!1;let e=this.ikConstraints,i=this.transformConstraints,r=this.pathConstraints,n=e.length,l=i.length,a=r.length,o=n+l+a;t:for(let h=0;h<o;h++){for(let c=0;c<n;c++){let u=e[c];if(u.data.order==h){this.sortIkConstraint(u);continue t}}for(let c=0;c<l;c++){let u=i[c];if(u.data.order==h){this.sortTransformConstraint(u);continue t}}for(let c=0;c<a;c++){let u=r[c];if(u.data.order==h){this.sortPathConstraint(u);continue t}}}for(let h=0,c=t.length;h<c;h++)this.sortBone(t[h])}sortIkConstraint(s){let t=s.target;this.sortBone(t);let e=s.bones,i=e[0];if(this.sortBone(i),e.length>1){let r=e[e.length-1];this._updateCache.indexOf(r)>-1||this.updateCacheReset.push(r)}this._updateCache.push(s),this.sortReset(i.children),e[e.length-1].sorted=!0}sortPathConstraint(s){let t=s.target,e=t.data.index,i=t.bone;this.skin!=null&&this.sortPathConstraintAttachment(this.skin,e,i),this.data.defaultSkin!=null&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,e,i);for(let a=0,o=this.data.skins.length;a<o;a++)this.sortPathConstraintAttachment(this.data.skins[a],e,i);let r=t.getAttachment();r instanceof _i&&this.sortPathConstraintAttachmentWith(r,i);let n=s.bones,l=n.length;for(let a=0;a<l;a++)this.sortBone(n[a]);this._updateCache.push(s);for(let a=0;a<l;a++)this.sortReset(n[a].children);for(let a=0;a<l;a++)n[a].sorted=!0}sortTransformConstraint(s){this.sortBone(s.target);let t=s.bones,e=t.length;if(s.data.local)for(let i=0;i<e;i++){let r=t[i];this.sortBone(r.parent),this._updateCache.indexOf(r)>-1||this.updateCacheReset.push(r)}else for(let i=0;i<e;i++)this.sortBone(t[i]);this._updateCache.push(s);for(let i=0;i<e;i++)this.sortReset(t[i].children);for(let i=0;i<e;i++)t[i].sorted=!0}sortPathConstraintAttachment(s,t,e){let i=s.attachments[t];if(!!i)for(let r in i)this.sortPathConstraintAttachmentWith(i[r],e)}sortPathConstraintAttachmentWith(s,t){if(!(s instanceof _i))return;let e=s.bones;if(e==null)this.sortBone(t);else{let i=this.bones,r=0;for(;r<e.length;){let n=e[r++];for(let l=r+n;r<l;r++){let a=e[r];this.sortBone(i[a])}}}}sortBone(s){if(s.sorted)return;let t=s.parent;t!=null&&this.sortBone(t),s.sorted=!0,this._updateCache.push(s)}sortReset(s){for(let t=0,e=s.length;t<e;t++){let i=s[t];i.sorted&&this.sortReset(i.children),i.sorted=!1}}updateWorldTransform(){let s=this.updateCacheReset;for(let e=0,i=s.length;e<i;e++){let r=s[e];r.ax=r.x,r.ay=r.y,r.arotation=r.rotation,r.ascaleX=r.scaleX,r.ascaleY=r.scaleY,r.ashearX=r.shearX,r.ashearY=r.shearY,r.appliedValid=!0}let t=this._updateCache;for(let e=0,i=t.length;e<i;e++)t[e].update()}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){let s=this.bones;for(let r=0,n=s.length;r<n;r++)s[r].setToSetupPose();let t=this.ikConstraints;for(let r=0,n=t.length;r<n;r++){let l=t[r];l.bendDirection=l.data.bendDirection,l.mix=l.data.mix}let e=this.transformConstraints;for(let r=0,n=e.length;r<n;r++){let l=e[r],a=l.data;l.rotateMix=a.rotateMix,l.translateMix=a.translateMix,l.scaleMix=a.scaleMix,l.shearMix=a.shearMix}let i=this.pathConstraints;for(let r=0,n=i.length;r<n;r++){let l=i[r],a=l.data;l.position=a.position,l.spacing=a.spacing,l.rotateMix=a.rotateMix,l.translateMix=a.translateMix}}setSlotsToSetupPose(){let s=this.slots;k.arrayCopy(s,0,this.drawOrder,0,s.length);for(let t=0,e=s.length;t<e;t++)s[t].setToSetupPose()}getRootBone(){return this.bones.length==0?null:this.bones[0]}findBone(s){if(s==null)throw new Error("boneName cannot be null.");let t=this.bones;for(let e=0,i=t.length;e<i;e++){let r=t[e];if(r.data.name==s)return r}return null}findBoneIndex(s){if(s==null)throw new Error("boneName cannot be null.");let t=this.bones;for(let e=0,i=t.length;e<i;e++)if(t[e].data.name==s)return e;return-1}findSlot(s){if(s==null)throw new Error("slotName cannot be null.");let t=this.slots;for(let e=0,i=t.length;e<i;e++){let r=t[e];if(r.data.name==s)return r}return null}findSlotIndex(s){if(s==null)throw new Error("slotName cannot be null.");let t=this.slots;for(let e=0,i=t.length;e<i;e++)if(t[e].data.name==s)return e;return-1}setSkinByName(s){let t=this.data.findSkin(s);if(t==null)throw new Error(`Skin not found: ${s}`);this.setSkin(t)}setSkin(s){if(s!=null)if(this.skin!=null)s.attachAll(this,this.skin);else{let t=this.slots;for(let e=0,i=t.length;e<i;e++){let r=t[e],n=r.data.attachmentName;if(n!=null){let l=s.getAttachment(e,n);l!=null&&r.setAttachment(l)}}}this.skin=s}getAttachmentByName(s,t){return this.getAttachment(this.data.findSlotIndex(s),t)}getAttachment(s,t){if(t==null)throw new Error("attachmentName cannot be null.");if(this.skin!=null){let e=this.skin.getAttachment(s,t);if(e!=null)return e}return this.data.defaultSkin!=null?this.data.defaultSkin.getAttachment(s,t):null}setAttachment(s,t){if(s==null)throw new Error("slotName cannot be null.");let e=this.slots;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.data.name==s){let l=null;if(t!=null&&(l=this.getAttachment(i,t),l==null))throw new Error(`Attachment not found: ${t}, for slot: ${s}`);n.setAttachment(l);return}}throw new Error(`Slot not found: ${s}`)}findIkConstraint(s){if(s==null)throw new Error("constraintName cannot be null.");let t=this.ikConstraints;for(let e=0,i=t.length;e<i;e++){let r=t[e];if(r.data.name==s)return r}return null}findTransformConstraint(s){if(s==null)throw new Error("constraintName cannot be null.");let t=this.transformConstraints;for(let e=0,i=t.length;e<i;e++){let r=t[e];if(r.data.name==s)return r}return null}findPathConstraint(s){if(s==null)throw new Error("constraintName cannot be null.");let t=this.pathConstraints;for(let e=0,i=t.length;e<i;e++){let r=t[e];if(r.data.name==s)return r}return null}getBounds(s,t,e){if(s==null)throw new Error("offset cannot be null.");if(t==null)throw new Error("size cannot be null.");let i=this.drawOrder,r=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY;for(let o=0,h=i.length;o<h;o++){let c=i[o],u=0,d=null,f=c.getAttachment();if(f instanceof ut)u=8,d=k.setArraySize(e,u,0),f.computeWorldVertices(c.bone,d,0,2);else if(f instanceof Dn){let m=f;u=m.worldVerticesLength,d=k.setArraySize(e,u,0),m.computeWorldVertices(c,0,u,d,0,2)}if(d!=null)for(let m=0,p=d.length;m<p;m+=2){let g=d[m],y=d[m+1];r=Math.min(r,g),n=Math.min(n,y),l=Math.max(l,g),a=Math.max(a,y)}}s.set(r,n),t.set(l-r,a-n)}update(s){this.time+=s}get flipX(){return this.scaleX==-1}set flipX(s){ad.deprecatedWarning1||(ad.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=s?1:-1}get flipY(){return this.scaleY==-1}set flipY(s){ad.deprecatedWarning1||(ad.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=s?1:-1}},ld=ad;ld.deprecatedWarning1=!1;var _m=class extends ti{};var fc=class{constructor(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}findBone(t){if(t==null)throw new Error("boneName cannot be null.");let e=this.bones;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.name==t)return n}return null}findBoneIndex(t){if(t==null)throw new Error("boneName cannot be null.");let e=this.bones;for(let i=0,r=e.length;i<r;i++)if(e[i].name==t)return i;return-1}findSlot(t){if(t==null)throw new Error("slotName cannot be null.");let e=this.slots;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.name==t)return n}return null}findSlotIndex(t){if(t==null)throw new Error("slotName cannot be null.");let e=this.slots;for(let i=0,r=e.length;i<r;i++)if(e[i].name==t)return i;return-1}findSkin(t){if(t==null)throw new Error("skinName cannot be null.");let e=this.skins;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.name==t)return n}return null}findEvent(t){if(t==null)throw new Error("eventDataName cannot be null.");let e=this.events;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.name==t)return n}return null}findAnimation(t){if(t==null)throw new Error("animationName cannot be null.");let e=this.animations;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.name==t)return n}return null}findIkConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");let e=this.ikConstraints;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.name==t)return n}return null}findTransformConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");let e=this.transformConstraints;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.name==t)return n}return null}findPathConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");let e=this.pathConstraints;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.name==t)return n}return null}findPathConstraintIndex(t){if(t==null)throw new Error("pathConstraintName cannot be null.");let e=this.pathConstraints;for(let i=0,r=e.length;i<r;i++)if(e[i].name==t)return i;return-1}};var mc=class{constructor(t,e,i){if(this.color=new G(1,1,1,1),t<0)throw new Error("index must be >= 0.");if(e==null)throw new Error("name cannot be null.");if(i==null)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=i}};var pc=class{constructor(t){if(this.order=0,this.bones=new Array,this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1,t==null)throw new Error("name cannot be null.");this.name=t}};var gc=class{constructor(t){if(this.attachments=new Array,t==null)throw new Error("name cannot be null.");this.name=t}addAttachment(t,e,i){if(i==null)throw new Error("attachment cannot be null.");let r=this.attachments;t>=r.length&&(r.length=t+1),r[t]||(r[t]={}),r[t][e]=i}getAttachment(t,e){let i=this.attachments[t];return i?i[e]:null}attachAll(t,e){let i=0;for(let r=0;r<t.slots.length;r++){let n=t.slots[r],l=n.getAttachment();if(l&&i<e.attachments.length){let a=e.attachments[i];for(let o in a){let h=a[o];if(l==h){let c=this.getAttachment(i,o);c!=null&&n.setAttachment(c);break}}}i++}}};var ai=class{constructor(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){let e=this.scale,i=new fc,r=typeof t=="string"?JSON.parse(t):t,n=r.skeleton;if(n!=null&&(i.hash=n.hash,i.version=n.spine,i.width=n.width,i.height=n.height,i.fps=n.fps,i.imagesPath=n.images),r.bones)for(let l=0;l<r.bones.length;l++){let a=r.bones[l],o=null,h=this.getValue(a,"parent",null);if(h!=null&&(o=i.findBone(h),o==null))throw new Error(`Parent bone not found: ${h}`);let c=new oc(i.bones.length,a.name,o);c.length=this.getValue(a,"length",0)*e,c.x=this.getValue(a,"x",0)*e,c.y=this.getValue(a,"y",0)*e,c.rotation=this.getValue(a,"rotation",0),c.scaleX=this.getValue(a,"scaleX",1),c.scaleY=this.getValue(a,"scaleY",1),c.shearX=this.getValue(a,"shearX",0),c.shearY=this.getValue(a,"shearY",0),c.transformMode=ai.transformModeFromString(this.getValue(a,"transform","normal")),i.bones.push(c)}if(r.slots)for(let l=0;l<r.slots.length;l++){let a=r.slots[l],o=a.name,h=a.bone,c=i.findBone(h);if(c==null)throw new Error(`Slot bone not found: ${h}`);let u=new mc(i.slots.length,o,c),d=this.getValue(a,"color",null);d!=null&&u.color.setFromString(d);let f=this.getValue(a,"dark",null);f!=null&&(u.darkColor=new G(1,1,1,1),u.darkColor.setFromString(f)),u.attachmentName=this.getValue(a,"attachment",null),u.blendMode=ai.blendModeFromString(this.getValue(a,"blend","normal")),i.slots.push(u)}if(r.ik)for(let l=0;l<r.ik.length;l++){let a=r.ik[l],o=new cc(a.name);o.order=this.getValue(a,"order",0);for(let c=0;c<a.bones.length;c++){let u=a.bones[c],d=i.findBone(u);if(d==null)throw new Error(`IK bone not found: ${u}`);o.bones.push(d)}let h=a.target;if(o.target=i.findBone(h),o.target==null)throw new Error(`IK target bone not found: ${h}`);o.bendDirection=this.getValue(a,"bendPositive",!0)?1:-1,o.mix=this.getValue(a,"mix",1),i.ikConstraints.push(o)}if(r.transform)for(let l=0;l<r.transform.length;l++){let a=r.transform[l],o=new pc(a.name);o.order=this.getValue(a,"order",0);for(let c=0;c<a.bones.length;c++){let u=a.bones[c],d=i.findBone(u);if(d==null)throw new Error(`Transform constraint bone not found: ${u}`);o.bones.push(d)}let h=a.target;if(o.target=i.findBone(h),o.target==null)throw new Error(`Transform constraint target bone not found: ${h}`);o.local=this.getValue(a,"local",!1),o.relative=this.getValue(a,"relative",!1),o.offsetRotation=this.getValue(a,"rotation",0),o.offsetX=this.getValue(a,"x",0)*e,o.offsetY=this.getValue(a,"y",0)*e,o.offsetScaleX=this.getValue(a,"scaleX",0),o.offsetScaleY=this.getValue(a,"scaleY",0),o.offsetShearY=this.getValue(a,"shearY",0),o.rotateMix=this.getValue(a,"rotateMix",1),o.translateMix=this.getValue(a,"translateMix",1),o.scaleMix=this.getValue(a,"scaleMix",1),o.shearMix=this.getValue(a,"shearMix",1),i.transformConstraints.push(o)}if(r.path)for(let l=0;l<r.path.length;l++){let a=r.path[l],o=new uc(a.name);o.order=this.getValue(a,"order",0);for(let c=0;c<a.bones.length;c++){let u=a.bones[c],d=i.findBone(u);if(d==null)throw new Error(`Transform constraint bone not found: ${u}`);o.bones.push(d)}let h=a.target;if(o.target=i.findSlot(h),o.target==null)throw new Error(`Path target slot not found: ${h}`);o.positionMode=ai.positionModeFromString(this.getValue(a,"positionMode","percent")),o.spacingMode=ai.spacingModeFromString(this.getValue(a,"spacingMode","length")),o.rotateMode=ai.rotateModeFromString(this.getValue(a,"rotateMode","tangent")),o.offsetRotation=this.getValue(a,"rotation",0),o.position=this.getValue(a,"position",0),o.positionMode==It.Fixed&&(o.position*=e),o.spacing=this.getValue(a,"spacing",0),(o.spacingMode==_s.Length||o.spacingMode==_s.Fixed)&&(o.spacing*=e),o.rotateMix=this.getValue(a,"rotateMix",1),o.translateMix=this.getValue(a,"translateMix",1),i.pathConstraints.push(o)}if(r.skins)for(let l in r.skins){let a=r.skins[l],o=new gc(l);for(let h in a){let c=i.findSlotIndex(h);if(c==-1)throw new Error(`Slot not found: ${h}`);let u=a[h];for(let d in u){let f=this.readAttachment(u[d],o,c,d,i);f!=null&&o.addAttachment(c,d,f)}}i.skins.push(o),o.name=="default"&&(i.defaultSkin=o)}for(let l=0,a=this.linkedMeshes.length;l<a;l++){let o=this.linkedMeshes[l],h=o.skin==null?i.defaultSkin:i.findSkin(o.skin);if(h==null)throw new Error(`Skin not found: ${o.skin}`);let c=h.getAttachment(o.slotIndex,o.parent);if(c==null)throw new Error(`Parent mesh not found: ${o.parent}`);o.mesh.setParentMesh(c)}if(this.linkedMeshes.length=0,r.events)for(let l in r.events){let a=r.events[l],o=new lc(l);o.intValue=this.getValue(a,"int",0),o.floatValue=this.getValue(a,"float",0),o.stringValue=this.getValue(a,"string",""),o.audioPath=this.getValue(a,"audio",null),o.audioPath!=null&&(o.volume=this.getValue(a,"volume",1),o.balance=this.getValue(a,"balance",0)),i.events.push(o)}if(r.animations)for(let l in r.animations){let a=r.animations[l];this.readAnimation(a,l,i)}return i}readAttachment(t,e,i,r,n){let l=this.scale;switch(r=this.getValue(t,"name",r),this.getValue(t,"type","region")){case"region":{let o=this.getValue(t,"path",r),h=this.attachmentLoader.newRegionAttachment(e,r,o);if(h==null)return null;h.path=o,h.x=this.getValue(t,"x",0)*l,h.y=this.getValue(t,"y",0)*l,h.scaleX=this.getValue(t,"scaleX",1),h.scaleY=this.getValue(t,"scaleY",1),h.rotation=this.getValue(t,"rotation",0),h.width=t.width*l,h.height=t.height*l;let c=this.getValue(t,"color",null);return c!=null&&h.color.setFromString(c),h}case"boundingbox":{let o=this.attachmentLoader.newBoundingBoxAttachment(e,r);if(o==null)return null;this.readVertices(t,o,t.vertexCount<<1);let h=this.getValue(t,"color",null);return h!=null&&o.color.setFromString(h),o}case"mesh":case"linkedmesh":{let o=this.getValue(t,"path",r),h=this.attachmentLoader.newMeshAttachment(e,r,o);if(h==null)return null;h.path=o;let c=this.getValue(t,"color",null);c!=null&&h.color.setFromString(c);let u=this.getValue(t,"parent",null);if(u!=null)return h.inheritDeform=this.getValue(t,"deform",!0),this.linkedMeshes.push(new Tg(h,this.getValue(t,"skin",null),i,u)),h;let d=t.uvs;return this.readVertices(t,h,d.length),h.triangles=t.triangles,h.regionUVs=new Float32Array(d),h.hullLength=this.getValue(t,"hull",0)*2,h}case"path":{let o=this.attachmentLoader.newPathAttachment(e,r);if(o==null)return null;o.closed=this.getValue(t,"closed",!1),o.constantSpeed=this.getValue(t,"constantSpeed",!0);let h=t.vertexCount;this.readVertices(t,o,h<<1);let c=k.newArray(h/3,0);for(let d=0;d<t.lengths.length;d++)c[d]=t.lengths[d]*l;o.lengths=c;let u=this.getValue(t,"color",null);return u!=null&&o.color.setFromString(u),o}case"point":{let o=this.attachmentLoader.newPointAttachment(e,r);if(o==null)return null;o.x=this.getValue(t,"x",0)*l,o.y=this.getValue(t,"y",0)*l,o.rotation=this.getValue(t,"rotation",0);let h=this.getValue(t,"color",null);return h!=null&&o.color.setFromString(h),o}case"clipping":{let o=this.attachmentLoader.newClippingAttachment(e,r);if(o==null)return null;let h=this.getValue(t,"end",null);if(h!=null){let d=n.findSlot(h);if(d==null)throw new Error(`Clipping end slot not found: ${h}`);o.endSlot=d}let c=t.vertexCount;this.readVertices(t,o,c<<1);let u=this.getValue(t,"color",null);return u!=null&&o.color.setFromString(u),o}}return null}readVertices(t,e,i){let r=this.scale;e.worldVerticesLength=i;let n=t.vertices;if(i==n.length){let o=k.toFloatArray(n);if(r!=1)for(let h=0,c=n.length;h<c;h++)o[h]*=r;e.vertices=o;return}let l=new Array,a=new Array;for(let o=0,h=n.length;o<h;){let c=n[o++];a.push(c);for(let u=o+c*4;o<u;o+=4)a.push(n[o]),l.push(n[o+1]*r),l.push(n[o+2]*r),l.push(n[o+3])}e.bones=a,e.vertices=k.toFloatArray(l)}readAnimation(t,e,i){let r=this.scale,n=new Array,l=0;if(t.slots)for(let o in t.slots){let h=t.slots[o],c=i.findSlotIndex(o);if(c==-1)throw new Error(`Slot not found: ${o}`);for(let u in h){let d=h[u];if(u=="attachment"){let f=new Br(d.length);f.slotIndex=c;let m=0;for(let p=0;p<d.length;p++){let g=d[p];f.setFrame(m++,g.time,g.name)}n.push(f),l=Math.max(l,f.frames[f.getFrameCount()-1])}else if(u=="color"){let f=new ns(d.length);f.slotIndex=c;let m=0;for(let p=0;p<d.length;p++){let g=d[p],y=new G;y.setFromString(g.color||"ffffffff"),f.setFrame(m,g.time,y.r,y.g,y.b,y.a),this.readCurve(g,f,m),m++}n.push(f),l=Math.max(l,f.frames[(f.getFrameCount()-1)*ns.ENTRIES])}else if(u=="twoColor"){let f=new ue(d.length);f.slotIndex=c;let m=0;for(let p=0;p<d.length;p++){let g=d[p],y=new G,_=new G;y.setFromString(g.light),_.setFromString(g.dark),f.setFrame(m,g.time,y.r,y.g,y.b,y.a,_.r,_.g,_.b),this.readCurve(g,f,m),m++}n.push(f),l=Math.max(l,f.frames[(f.getFrameCount()-1)*ue.ENTRIES])}else throw new Error(`Invalid timeline type for a slot: ${u} (${o})`)}}if(t.bones)for(let o in t.bones){let h=t.bones[o],c=i.findBoneIndex(o);if(c==-1)throw new Error(`Bone not found: ${o}`);for(let u in h){let d=h[u];if(u==="rotate"){let f=new Ie(d.length);f.boneIndex=c;let m=0;for(let p=0;p<d.length;p++){let g=d[p];f.setFrame(m,g.time,g.angle),this.readCurve(g,f,m),m++}n.push(f),l=Math.max(l,f.frames[(f.getFrameCount()-1)*Ie.ENTRIES])}else if(u==="translate"||u==="scale"||u==="shear"){let f=null,m=1;u==="scale"?f=new Pe(d.length):u==="shear"?f=new Oe(d.length):(f=new Gs(d.length),m=r),f.boneIndex=c;let p=0;for(let g=0;g<d.length;g++){let y=d[g],_=this.getValue(y,"x",0),b=this.getValue(y,"y",0);f.setFrame(p,y.time,_*m,b*m),this.readCurve(y,f,p),p++}n.push(f),l=Math.max(l,f.frames[(f.getFrameCount()-1)*Gs.ENTRIES])}else throw new Error(`Invalid timeline type for a bone: ${u} (${o})`)}}if(t.ik)for(let o in t.ik){let h=t.ik[o],c=i.findIkConstraint(o),u=new os(h.length);u.ikConstraintIndex=i.ikConstraints.indexOf(c);let d=0;for(let f=0;f<h.length;f++){let m=h[f];u.setFrame(d,m.time,this.getValue(m,"mix",1),this.getValue(m,"bendPositive",!0)?1:-1,this.getValue(m,"compress",!1),this.getValue(m,"stretch",!1)),this.readCurve(m,u,d),d++}n.push(u),l=Math.max(l,u.frames[(u.getFrameCount()-1)*os.ENTRIES])}if(t.transform)for(let o in t.transform){let h=t.transform[o],c=i.findTransformConstraint(o),u=new as(h.length);u.transformConstraintIndex=i.transformConstraints.indexOf(c);let d=0;for(let f=0;f<h.length;f++){let m=h[f];u.setFrame(d,m.time,this.getValue(m,"rotateMix",1),this.getValue(m,"translateMix",1),this.getValue(m,"scaleMix",1),this.getValue(m,"shearMix",1)),this.readCurve(m,u,d),d++}n.push(u),l=Math.max(l,u.frames[(u.getFrameCount()-1)*as.ENTRIES])}if(t.paths)for(let o in t.paths){let h=t.paths[o],c=i.findPathConstraintIndex(o);if(c==-1)throw new Error(`Path constraint not found: ${o}`);let u=i.pathConstraints[c];for(let d in h){let f=h[d];if(d==="position"||d==="spacing"){let m=null,p=1;d==="spacing"?(m=new bs(f.length),(u.spacingMode==_s.Length||u.spacingMode==_s.Fixed)&&(p=r)):(m=new Gi(f.length),u.positionMode==It.Fixed&&(p=r)),m.pathConstraintIndex=c;let g=0;for(let y=0;y<f.length;y++){let _=f[y];m.setFrame(g,_.time,this.getValue(_,d,0)*p),this.readCurve(_,m,g),g++}n.push(m),l=Math.max(l,m.frames[(m.getFrameCount()-1)*Gi.ENTRIES])}else if(d==="mix"){let m=new vi(f.length);m.pathConstraintIndex=c;let p=0;for(let g=0;g<f.length;g++){let y=f[g];m.setFrame(p,y.time,this.getValue(y,"rotateMix",1),this.getValue(y,"translateMix",1)),this.readCurve(y,m,p),p++}n.push(m),l=Math.max(l,m.frames[(m.getFrameCount()-1)*vi.ENTRIES])}}}if(t.deform)for(let o in t.deform){let h=t.deform[o],c=i.findSkin(o);if(c==null){if(jt.FAIL_ON_NON_EXISTING_SKIN)throw new Error(`Skin not found: ${o}`);continue}for(let u in h){let d=h[u],f=i.findSlotIndex(u);if(f==-1)throw new Error(`Slot not found: ${d.name}`);for(let m in d){let p=d[m],g=c.getAttachment(f,m);if(g==null)throw new Error(`Deform attachment not found: ${p.name}`);let y=g.bones!=null,_=g.vertices,b=y?_.length/3*2:_.length,x=new ic(p.length);x.slotIndex=f,x.attachment=g;let v=0;for(let w=0;w<p.length;w++){let E=p[w],A,T=this.getValue(E,"vertices",null);if(T==null)A=y?k.newFloatArray(b):_;else{A=k.newFloatArray(b);let C=this.getValue(E,"offset",0);if(k.arrayCopy(T,0,A,C,T.length),r!=1)for(let R=C,N=R+T.length;R<N;R++)A[R]*=r;if(!y)for(let R=0;R<b;R++)A[R]+=_[R]}x.setFrame(v,E.time,A),this.readCurve(E,x,v),v++}n.push(x),l=Math.max(l,x.frames[x.getFrameCount()-1])}}}let a=t.drawOrder;if(a==null&&(a=t.draworder),a!=null){let o=new Lr(a.length),h=i.slots.length,c=0;for(let u=0;u<a.length;u++){let d=a[u],f=null,m=this.getValue(d,"offsets",null);if(m!=null){f=k.newArray(h,-1);let p=k.newArray(h-m.length,0),g=0,y=0;for(let _=0;_<m.length;_++){let b=m[_],x=i.findSlotIndex(b.slot);if(x==-1)throw new Error(`Slot not found: ${b.slot}`);for(;g!=x;)p[y++]=g++;f[g+b.offset]=g++}for(;g<h;)p[y++]=g++;for(let _=h-1;_>=0;_--)f[_]==-1&&(f[_]=p[--y])}o.setFrame(c++,d.time,f)}n.push(o),l=Math.max(l,o.frames[o.getFrameCount()-1])}if(t.events){let o=new rc(t.events.length),h=0;for(let c=0;c<t.events.length;c++){let u=t.events[c],d=i.findEvent(u.name);if(d==null)throw new Error(`Event not found: ${u.name}`);let f=new ac(k.toSinglePrecision(u.time),d);f.intValue=this.getValue(u,"int",d.intValue),f.floatValue=this.getValue(u,"float",d.floatValue),f.stringValue=this.getValue(u,"string",d.stringValue),f.data.audioPath!=null&&(f.volume=this.getValue(u,"volume",1),f.balance=this.getValue(u,"balance",0)),o.setFrame(h++,f)}n.push(o),l=Math.max(l,o.frames[o.getFrameCount()-1])}if(isNaN(l))throw new Error("Error while parsing animation, duration is NaN");i.animations.push(new $t(e,n,l))}readCurve(t,e,i){if(!!t.curve){if(t.curve==="stepped")e.setStepped(i);else if(Object.prototype.toString.call(t.curve)==="[object Array]"){let r=t.curve;e.setCurve(i,r[0],r[1],r[2],r[3])}}}getValue(t,e,i){return t[e]!==void 0?t[e]:i}static blendModeFromString(t){if(t=t.toLowerCase(),t=="normal")return Z.NORMAL;if(t=="additive")return Z.ADD;if(t=="multiply")return Z.MULTIPLY;if(t=="screen")return Z.SCREEN;throw new Error(`Unknown blend mode: ${t}`)}static positionModeFromString(t){if(t=t.toLowerCase(),t=="fixed")return It.Fixed;if(t=="percent")return It.Percent;throw new Error(`Unknown position mode: ${t}`)}static spacingModeFromString(t){if(t=t.toLowerCase(),t=="length")return _s.Length;if(t=="fixed")return _s.Fixed;if(t=="percent")return _s.Percent;throw new Error(`Unknown position mode: ${t}`)}static rotateModeFromString(t){if(t=t.toLowerCase(),t=="tangent")return Pt.Tangent;if(t=="chain")return Pt.Chain;if(t=="chainscale")return Pt.ChainScale;throw new Error(`Unknown rotate mode: ${t}`)}static transformModeFromString(t){if(t=t.toLowerCase(),t=="normal")return it.Normal;if(t=="onlytranslation")return it.OnlyTranslation;if(t=="norotationorreflection")return it.NoRotationOrReflection;if(t=="noscale")return it.NoScale;if(t=="noscaleorreflection")return it.NoScaleOrReflection;throw new Error(`Unknown transform mode: ${t}`)}},Tg=class{constructor(t,e,i,r){this.mesh=t,this.skin=e,this.slotIndex=i,this.parent=r}};var ym=class extends ii{createSkeleton(t){this.skeleton=new ld(t),this.skeleton.updateWorldTransform(),this.stateData=new od(t),this.state=new oi(this.stateData)}};var Im={};Tc(Im,{AlphaTimeline:()=>ro,Animation:()=>Xi,AnimationState:()=>mo,AnimationStateAdapter:()=>Em,AnimationStateData:()=>bc,AtlasAttachmentLoader:()=>Sl,Attachment:()=>Al,AttachmentTimeline:()=>Ws,Bone:()=>Cl,BoneData:()=>po,BoundingBoxAttachment:()=>Yn,ClippingAttachment:()=>jn,ConstraintData:()=>ji,CurveTimeline:()=>ys,CurveTimeline1:()=>vs,CurveTimeline2:()=>Tl,DeformTimeline:()=>ao,DrawOrderTimeline:()=>Ei,Event:()=>go,EventData:()=>xo,EventQueue:()=>hd,EventTimeline:()=>Dr,EventType:()=>hs,IkConstraint:()=>_c,IkConstraintData:()=>bo,IkConstraintTimeline:()=>lo,MeshAttachment:()=>Xs,PathAttachment:()=>Ys,PathConstraint:()=>yo,PathConstraintData:()=>_o,PathConstraintMixTimeline:()=>fo,PathConstraintPositionTimeline:()=>co,PathConstraintSpacingTimeline:()=>uo,PointAttachment:()=>Wn,RGB2Timeline:()=>oo,RGBA2Timeline:()=>no,RGBATimeline:()=>so,RGBTimeline:()=>io,RegionAttachment:()=>bt,RotateTimeline:()=>wi,ScaleTimeline:()=>Kn,ScaleXTimeline:()=>Zn,ScaleYTimeline:()=>Qn,Sequence:()=>Il,SequenceMode:()=>js,SequenceModeValues:()=>xc,SequenceTimeline:()=>Vr,ShearTimeline:()=>Jn,ShearXTimeline:()=>to,ShearYTimeline:()=>eo,Skeleton:()=>dd,SkeletonBinary:()=>Rl,SkeletonBounds:()=>Ec,SkeletonData:()=>vo,SkeletonJson:()=>Ao,Skin:()=>Yr,SkinEntry:()=>wc,Slot:()=>yc,SlotData:()=>wo,SpacingMode:()=>te,Spine:()=>Am,Timeline:()=>Xt,TrackEntry:()=>cd,TransformConstraint:()=>vc,TransformConstraintData:()=>Eo,TransformConstraintTimeline:()=>ho,TranslateTimeline:()=>Hn,TranslateXTimeline:()=>qn,TranslateYTimeline:()=>zn,VertexAttachment:()=>ye});var Al=class{constructor(t){if(!t)throw new Error("name cannot be null.");this.name=t}},k0=class extends Al{constructor(s){super(s),this.id=k0.nextID++,this.bones=null,this.vertices=[],this.worldVerticesLength=0,this.timelineAttachment=this}computeWorldVerticesOld(s,t){this.computeWorldVertices(s,0,this.worldVerticesLength,t,0,2)}computeWorldVertices(s,t,e,i,r,n){e=r+(e>>1)*n;let l=s.bone.skeleton,a=s.deform,o=this.vertices,h=this.bones;if(!h){a.length>0&&(o=a);let f=s.bone.matrix,m=f.tx,p=f.ty,g=f.a,y=f.c,_=f.b,b=f.d;for(let x=t,v=r;v<e;x+=2,v+=n){let w=o[x],E=o[x+1];i[v]=w*g+E*y+m,i[v+1]=w*_+E*b+p}return}let c=0,u=0;for(let f=0;f<t;f+=2){let m=h[c];c+=m+1,u+=m}let d=l.bones;if(a.length==0)for(let f=r,m=u*3;f<e;f+=n){let p=0,g=0,y=h[c++];for(y+=c;c<y;c++,m+=3){let _=d[h[c]].matrix,b=o[m],x=o[m+1],v=o[m+2];p+=(b*_.a+x*_.c+_.tx)*v,g+=(b*_.b+x*_.d+_.ty)*v}i[f]=p,i[f+1]=g}else{let f=a;for(let m=r,p=u*3,g=u<<1;m<e;m+=n){let y=0,_=0,b=h[c++];for(b+=c;c<b;c++,p+=3,g+=2){let x=d[h[c]].matrix,v=o[p]+f[g],w=o[p+1]+f[g+1],E=o[p+2];y+=(v*x.a+w*x.c+x.tx)*E,_+=(v*x.b+w*x.d+x.ty)*E}i[m]=y,i[m+1]=_}}}copyTo(s){this.bones?(s.bones=new Array(this.bones.length),k.arrayCopy(this.bones,0,s.bones,0,this.bones.length)):s.bones=null,this.vertices&&(s.vertices=k.newFloatArray(this.vertices.length),k.arrayCopy(this.vertices,0,s.vertices,0,this.vertices.length)),s.worldVerticesLength=this.worldVerticesLength,s.timelineAttachment=this.timelineAttachment}},ye=k0;ye.nextID=0;var Yn=class extends ye{constructor(t){super(t),this.type=tt.BoundingBox,this.color=new G(1,1,1,1)}copy(){let t=new Yn(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t}};var jn=class extends ye{constructor(t){super(t),this.type=tt.Clipping,this.endSlot=null,this.color=new G(.2275,.2275,.8078,1)}copy(){let t=new jn(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t}};var Xs=class extends ye{constructor(t,e){super(t),this.type=tt.Mesh,this.region=null,this.triangles=[],this.color=new G(1,1,1,1),this.width=0,this.height=0,this.hullLength=0,this.edges=[],this.parentMesh=null,this.sequence=null,this.tempColor=new G(0,0,0,0),this.path=e}getParentMesh(){return this.parentMesh}setParentMesh(t){this.parentMesh=t,t&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}copy(){if(this.parentMesh)return this.newLinkedMesh();let t=new Xs(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Float32Array(this.regionUVs.length),k.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.triangles=new Array(this.triangles.length),k.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,t.sequence=this.sequence!=null?this.sequence.copy():null,this.edges&&(t.edges=new Array(this.edges.length),k.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t}computeWorldVertices(t,e,i,r,n,l){this.sequence!=null&&this.sequence.apply(t,this),super.computeWorldVertices(t,e,i,r,n,l)}newLinkedMesh(){let t=new Xs(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),t.timelineAttachment=this.timelineAttachment,t.setParentMesh(this.parentMesh?this.parentMesh:this),t}};var Ys=class extends ye{constructor(t){super(t),this.type=tt.Path,this.lengths=[],this.closed=!1,this.constantSpeed=!1,this.color=new G(1,1,1,1)}copy(){let t=new Ys(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),k.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t}};var Wn=class extends ye{constructor(t){super(t),this.type=tt.Point,this.x=0,this.y=0,this.rotation=0,this.color=new G(.38,.94,0,1)}computeWorldPosition(t,e){let i=t.matrix;return e.x=this.x*i.a+this.y*i.c+t.worldX,e.y=this.x*i.b+this.y*i.d+t.worldY,e}computeWorldRotation(t){let e=t.matrix,i=S.cosDeg(this.rotation),r=S.sinDeg(this.rotation),n=i*e.a+r*e.c,l=i*e.b+r*e.d;return Math.atan2(l,n)*S.radDeg}copy(){let t=new Wn(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t}};var P0=class extends Al{constructor(s,t){super(s),this.type=tt.Region,this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new G(1,1,1,1),this.rendererObject=null,this.region=null,this.sequence=null,this.offset=k.newFloatArray(8),this.uvs=k.newFloatArray(8),this.tempColor=new G(1,1,1,1),this.path=t}updateRegion(){if(!this.region)throw new Error("Region not set.");let s=this.region,t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,i=-this.width/2*this.scaleX+this.region.offsetX*t,r=-this.height/2*this.scaleY+this.region.offsetY*e,n=i+this.region.width*t,l=r+this.region.height*e,a=this.rotation*Math.PI/180,o=Math.cos(a),h=Math.sin(a),c=this.x,u=this.y,d=i*o+c,f=i*h,m=r*o+u,p=r*h,g=n*o+c,y=n*h,_=l*o+u,b=l*h,x=this.offset;x[0]=d-p,x[1]=m+f,x[2]=d-b,x[3]=_+f,x[4]=g-b,x[5]=_+y,x[6]=g-p,x[7]=m+y;let v=this.uvs;s.degrees==90?(v[2]=s.u,v[3]=s.v2,v[4]=s.u,v[5]=s.v,v[6]=s.u2,v[7]=s.v,v[0]=s.u2,v[1]=s.v2):(v[0]=s.u,v[1]=s.v2,v[2]=s.u,v[3]=s.v,v[4]=s.u2,v[5]=s.v,v[6]=s.u2,v[7]=s.v2)}computeWorldVertices(s,t,e,i){this.sequence!=null&&this.sequence.apply(s,this);let r=s.bone,n=this.offset,l=r.matrix,a=l.tx,o=l.ty,h=l.a,c=l.c,u=l.b,d=l.d,f=0,m=0;f=n[0],m=n[1],t[e]=f*h+m*c+a,t[e+1]=f*u+m*d+o,e+=i,f=n[2],m=n[3],t[e]=f*h+m*c+a,t[e+1]=f*u+m*d+o,e+=i,f=n[4],m=n[5],t[e]=f*h+m*c+a,t[e+1]=f*u+m*d+o,e+=i,f=n[6],m=n[7],t[e]=f*h+m*c+a,t[e+1]=f*u+m*d+o}copy(){let s=new P0(this.name,this.path);return s.region=this.region,s.rendererObject=this.rendererObject,s.x=this.x,s.y=this.y,s.scaleX=this.scaleX,s.scaleY=this.scaleY,s.rotation=this.rotation,s.width=this.width,s.height=this.height,k.arrayCopy(this.uvs,0,s.uvs,0,8),k.arrayCopy(this.offset,0,s.offset,0,8),s.color.setFromColor(this.color),s.sequence=this.sequence!=null?this.sequence.copy():null,s}},bt=P0;bt.X1=0;bt.Y1=1;bt.C1R=2;bt.C1G=3;bt.C1B=4;bt.C1A=5;bt.U1=6;bt.V1=7;bt.X2=8;bt.Y2=9;bt.C2R=10;bt.C2G=11;bt.C2B=12;bt.C2A=13;bt.U2=14;bt.V2=15;bt.X3=16;bt.Y3=17;bt.C3R=18;bt.C3G=19;bt.C3B=20;bt.C3A=21;bt.U3=22;bt.V3=23;bt.X4=24;bt.Y4=25;bt.C4R=26;bt.C4G=27;bt.C4B=28;bt.C4A=29;bt.U4=30;bt.V4=31;var wm=class{constructor(s){this.id=wm.nextID(),this.start=0,this.digits=0,this.setupIndex=0,this.regions=new Array(s)}copy(){let s=new wm(this.regions.length);return k.arrayCopy(this.regions,0,s.regions,0,this.regions.length),s.start=this.start,s.digits=this.digits,s.setupIndex=this.setupIndex,s}apply(s,t){let e=s.sequenceIndex;e==-1&&(e=this.setupIndex),e>=this.regions.length&&(e=this.regions.length-1);let i=this.regions[e];t.region!=i&&(t.region=i)}getPath(s,t){let e=s,i=(this.start+t).toString();for(let r=this.digits-i.length;r>0;r--)e+="0";return e+=i,e}static nextID(){return wm._nextID++}},Il=wm;Il._nextID=0;var js=(s=>(s[s.hold=0]="hold",s[s.once=1]="once",s[s.loop=2]="loop",s[s.pingpong=3]="pingpong",s[s.onceReverse=4]="onceReverse",s[s.loopReverse=5]="loopReverse",s[s.pingpongReverse=6]="pingpongReverse",s))(js||{}),xc=[0,1,2,3,4,5,6];var Xi=class{constructor(t,e,i){if(this.timelines=[],this.timelineIds=new gn,!t)throw new Error("name cannot be null.");this.name=t,this.setTimelines(e),this.duration=i}setTimelines(t){if(!t)throw new Error("timelines cannot be null.");this.timelines=t,this.timelineIds.clear();for(let e=0;e<t.length;e++)this.timelineIds.addAll(t[e].getPropertyIds())}hasTimeline(t){for(let e=0;e<t.length;e++)if(this.timelineIds.contains(t[e]))return!0;return!1}apply(t,e,i,r,n,l,a,o){if(!t)throw new Error("skeleton cannot be null.");r&&this.duration!=0&&(i%=this.duration,e>0&&(e%=this.duration));let h=this.timelines;for(let c=0,u=h.length;c<u;c++)h[c].apply(t,e,i,n,l,a,o)}},Mt={rotate:0,x:1,y:2,scaleX:3,scaleY:4,shearX:5,shearY:6,rgb:7,alpha:8,rgb2:9,attachment:10,deform:11,event:12,drawOrder:13,ikConstraint:14,transformConstraint:15,pathConstraintPosition:16,pathConstraintSpacing:17,pathConstraintMix:18,sequence:19},Xt=class{constructor(t,e){this.propertyIds=e,this.frames=k.newFloatArray(t*this.getFrameEntries())}getPropertyIds(){return this.propertyIds}getFrameEntries(){return 1}getFrameCount(){return this.frames.length/this.getFrameEntries()}getDuration(){return this.frames[this.frames.length-this.getFrameEntries()]}static search1(t,e){let i=t.length;for(let r=1;r<i;r++)if(t[r]>e)return r-1;return i-1}static search(t,e,i){let r=t.length;for(let n=i;n<r;n+=i)if(t[n]>e)return n-i;return r-i}},ys=class extends Xt{constructor(t,e,i){super(t,i),this.curves=k.newFloatArray(t+e*18),this.curves[t-1]=1}setLinear(t){this.curves[t]=0}setStepped(t){this.curves[t]=1}shrink(t){let e=this.getFrameCount()+t*18;if(this.curves.length>e){let i=k.newFloatArray(e);k.arrayCopy(this.curves,0,i,0,e),this.curves=i}}setBezier(t,e,i,r,n,l,a,o,h,c,u){let d=this.curves,f=this.getFrameCount()+t*18;i==0&&(d[e]=2+f);let m=(r-l*2+o)*.03,p=(n-a*2+h)*.03,g=((l-o)*3-r+c)*.006,y=((a-h)*3-n+u)*.006,_=m*2+g,b=p*2+y,x=(l-r)*.3+m+g*.16666667,v=(a-n)*.3+p+y*.16666667,w=r+x,E=n+v;for(let A=f+18;f<A;f+=2)d[f]=w,d[f+1]=E,x+=_,v+=b,_+=g,b+=y,w+=x,E+=v}getBezierValue(t,e,i,r){let n=this.curves;if(n[r]>t){let h=this.frames[e],c=this.frames[e+i];return c+(t-h)/(n[r]-h)*(n[r+1]-c)}let l=r+18;for(r+=2;r<l;r+=2)if(n[r]>=t){let h=n[r-2],c=n[r-1];return c+(t-h)/(n[r]-h)*(n[r+1]-c)}e+=this.getFrameEntries();let a=n[l-2],o=n[l-1];return o+(t-a)/(this.frames[e]-a)*(this.frames[e+i]-o)}},vs=class extends ys{constructor(t,e,i){super(t,e,[i])}getFrameEntries(){return 2}setFrame(t,e,i){t<<=1,this.frames[t]=e,this.frames[t+1]=i}getCurveValue(t){let e=this.frames,i=e.length-2;for(let n=2;n<=i;n+=2)if(e[n]>t){i=n-2;break}let r=this.curves[i>>1];switch(r){case 0:let n=e[i],l=e[i+1];return l+(t-n)/(e[i+2]-n)*(e[i+2+1]-l);case 1:return e[i+1]}return this.getBezierValue(t,i,1,r-2)}},Tl=class extends ys{constructor(t,e,i,r){super(t,e,[i,r])}getFrameEntries(){return 3}setFrame(t,e,i,r){t*=3,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=r}},wi=class extends vs{constructor(t,e,i){super(t,e,`${Mt.rotate}|${i}`),this.boneIndex=0,this.boneIndex=i}apply(t,e,i,r,n,l,a){let o=t.bones[this.boneIndex];if(!o.active)return;let h=this.frames;if(i<h[0]){switch(l){case I.setup:o.rotation=o.data.rotation;return;case I.first:o.rotation+=(o.data.rotation-o.rotation)*n}return}let c=this.getCurveValue(i);switch(l){case I.setup:o.rotation=o.data.rotation+c*n;break;case I.first:case I.replace:c+=o.data.rotation-o.rotation;case I.add:o.rotation+=c*n}}},Hn=class extends Tl{constructor(t,e,i){super(t,e,`${Mt.x}|${i}`,`${Mt.y}|${i}`),this.boneIndex=0,this.boneIndex=i}apply(t,e,i,r,n,l,a){let o=t.bones[this.boneIndex];if(!o.active)return;let h=this.frames;if(i<h[0]){switch(l){case I.setup:o.x=o.data.x,o.y=o.data.y;return;case I.first:o.x+=(o.data.x-o.x)*n,o.y+=(o.data.y-o.y)*n}return}let c=0,u=0,d=Xt.search(h,i,3),f=this.curves[d/3];switch(f){case 0:let m=h[d];c=h[d+1],u=h[d+2];let p=(i-m)/(h[d+3]-m);c+=(h[d+3+1]-c)*p,u+=(h[d+3+2]-u)*p;break;case 1:c=h[d+1],u=h[d+2];break;default:c=this.getBezierValue(i,d,1,f-2),u=this.getBezierValue(i,d,2,f+18-2)}switch(l){case I.setup:o.x=o.data.x+c*n,o.y=o.data.y+u*n;break;case I.first:case I.replace:o.x+=(o.data.x+c-o.x)*n,o.y+=(o.data.y+u-o.y)*n;break;case I.add:o.x+=c*n,o.y+=u*n}}},qn=class extends vs{constructor(t,e,i){super(t,e,`${Mt.x}|${i}`),this.boneIndex=0,this.boneIndex=i}apply(t,e,i,r,n,l,a){let o=t.bones[this.boneIndex];if(!o.active)return;let h=this.frames;if(i<h[0]){switch(l){case I.setup:o.x=o.data.x;return;case I.first:o.x+=(o.data.x-o.x)*n}return}let c=this.getCurveValue(i);switch(l){case I.setup:o.x=o.data.x+c*n;break;case I.first:case I.replace:o.x+=(o.data.x+c-o.x)*n;break;case I.add:o.x+=c*n}}},zn=class extends vs{constructor(t,e,i){super(t,e,`${Mt.y}|${i}`),this.boneIndex=0,this.boneIndex=i}apply(t,e,i,r,n,l,a){let o=t.bones[this.boneIndex];if(!o.active)return;let h=this.frames;if(i<h[0]){switch(l){case I.setup:o.y=o.data.y;return;case I.first:o.y+=(o.data.y-o.y)*n}return}let c=this.getCurveValue(i);switch(l){case I.setup:o.y=o.data.y+c*n;break;case I.first:case I.replace:o.y+=(o.data.y+c-o.y)*n;break;case I.add:o.y+=c*n}}},Kn=class extends Tl{constructor(t,e,i){super(t,e,`${Mt.scaleX}|${i}`,`${Mt.scaleY}|${i}`),this.boneIndex=0,this.boneIndex=i}apply(t,e,i,r,n,l,a){let o=t.bones[this.boneIndex];if(!o.active)return;let h=this.frames;if(i<h[0]){switch(l){case I.setup:o.scaleX=o.data.scaleX,o.scaleY=o.data.scaleY;return;case I.first:o.scaleX+=(o.data.scaleX-o.scaleX)*n,o.scaleY+=(o.data.scaleY-o.scaleY)*n}return}let c,u,d=Xt.search(h,i,3),f=this.curves[d/3];switch(f){case 0:let m=h[d];c=h[d+1],u=h[d+2];let p=(i-m)/(h[d+3]-m);c+=(h[d+3+1]-c)*p,u+=(h[d+3+2]-u)*p;break;case 1:c=h[d+1],u=h[d+2];break;default:c=this.getBezierValue(i,d,1,f-2),u=this.getBezierValue(i,d,2,f+18-2)}if(c*=o.data.scaleX,u*=o.data.scaleY,n==1)l==I.add?(o.scaleX+=c-o.data.scaleX,o.scaleY+=u-o.data.scaleY):(o.scaleX=c,o.scaleY=u);else{let m=0,p=0;if(a==at.mixOut)switch(l){case I.setup:m=o.data.scaleX,p=o.data.scaleY,o.scaleX=m+(Math.abs(c)*S.signum(m)-m)*n,o.scaleY=p+(Math.abs(u)*S.signum(p)-p)*n;break;case I.first:case I.replace:m=o.scaleX,p=o.scaleY,o.scaleX=m+(Math.abs(c)*S.signum(m)-m)*n,o.scaleY=p+(Math.abs(u)*S.signum(p)-p)*n;break;case I.add:o.scaleX+=(c-o.data.scaleX)*n,o.scaleY+=(u-o.data.scaleY)*n}else switch(l){case I.setup:m=Math.abs(o.data.scaleX)*S.signum(c),p=Math.abs(o.data.scaleY)*S.signum(u),o.scaleX=m+(c-m)*n,o.scaleY=p+(u-p)*n;break;case I.first:case I.replace:m=Math.abs(o.scaleX)*S.signum(c),p=Math.abs(o.scaleY)*S.signum(u),o.scaleX=m+(c-m)*n,o.scaleY=p+(u-p)*n;break;case I.add:o.scaleX+=(c-o.data.scaleX)*n,o.scaleY+=(u-o.data.scaleY)*n}}}},Zn=class extends vs{constructor(t,e,i){super(t,e,`${Mt.scaleX}|${i}`),this.boneIndex=0,this.boneIndex=i}apply(t,e,i,r,n,l,a){let o=t.bones[this.boneIndex];if(!o.active)return;let h=this.frames;if(i<h[0]){switch(l){case I.setup:o.scaleX=o.data.scaleX;return;case I.first:o.scaleX+=(o.data.scaleX-o.scaleX)*n}return}let c=this.getCurveValue(i)*o.data.scaleX;if(n==1)l==I.add?o.scaleX+=c-o.data.scaleX:o.scaleX=c;else{let u=0;if(a==at.mixOut)switch(l){case I.setup:u=o.data.scaleX,o.scaleX=u+(Math.abs(c)*S.signum(u)-u)*n;break;case I.first:case I.replace:u=o.scaleX,o.scaleX=u+(Math.abs(c)*S.signum(u)-u)*n;break;case I.add:o.scaleX+=(c-o.data.scaleX)*n}else switch(l){case I.setup:u=Math.abs(o.data.scaleX)*S.signum(c),o.scaleX=u+(c-u)*n;break;case I.first:case I.replace:u=Math.abs(o.scaleX)*S.signum(c),o.scaleX=u+(c-u)*n;break;case I.add:o.scaleX+=(c-o.data.scaleX)*n}}}},Qn=class extends vs{constructor(t,e,i){super(t,e,`${Mt.scaleY}|${i}`),this.boneIndex=0,this.boneIndex=i}apply(t,e,i,r,n,l,a){let o=t.bones[this.boneIndex];if(!o.active)return;let h=this.frames;if(i<h[0]){switch(l){case I.setup:o.scaleY=o.data.scaleY;return;case I.first:o.scaleY+=(o.data.scaleY-o.scaleY)*n}return}let c=this.getCurveValue(i)*o.data.scaleY;if(n==1)l==I.add?o.scaleY+=c-o.data.scaleY:o.scaleY=c;else{let u=0;if(a==at.mixOut)switch(l){case I.setup:u=o.data.scaleY,o.scaleY=u+(Math.abs(c)*S.signum(u)-u)*n;break;case I.first:case I.replace:u=o.scaleY,o.scaleY=u+(Math.abs(c)*S.signum(u)-u)*n;break;case I.add:o.scaleY+=(c-o.data.scaleY)*n}else switch(l){case I.setup:u=Math.abs(o.data.scaleY)*S.signum(c),o.scaleY=u+(c-u)*n;break;case I.first:case I.replace:u=Math.abs(o.scaleY)*S.signum(c),o.scaleY=u+(c-u)*n;break;case I.add:o.scaleY+=(c-o.data.scaleY)*n}}}},Jn=class extends Tl{constructor(t,e,i){super(t,e,`${Mt.shearX}|${i}`,`${Mt.shearY}|${i}`),this.boneIndex=0,this.boneIndex=i}apply(t,e,i,r,n,l,a){let o=t.bones[this.boneIndex];if(!o.active)return;let h=this.frames;if(i<h[0]){switch(l){case I.setup:o.shearX=o.data.shearX,o.shearY=o.data.shearY;return;case I.first:o.shearX+=(o.data.shearX-o.shearX)*n,o.shearY+=(o.data.shearY-o.shearY)*n}return}let c=0,u=0,d=Xt.search(h,i,3),f=this.curves[d/3];switch(f){case 0:let m=h[d];c=h[d+1],u=h[d+2];let p=(i-m)/(h[d+3]-m);c+=(h[d+3+1]-c)*p,u+=(h[d+3+2]-u)*p;break;case 1:c=h[d+1],u=h[d+2];break;default:c=this.getBezierValue(i,d,1,f-2),u=this.getBezierValue(i,d,2,f+18-2)}switch(l){case I.setup:o.shearX=o.data.shearX+c*n,o.shearY=o.data.shearY+u*n;break;case I.first:case I.replace:o.shearX+=(o.data.shearX+c-o.shearX)*n,o.shearY+=(o.data.shearY+u-o.shearY)*n;break;case I.add:o.shearX+=c*n,o.shearY+=u*n}}},to=class extends vs{constructor(t,e,i){super(t,e,`${Mt.shearX}|${i}`),this.boneIndex=0,this.boneIndex=i}apply(t,e,i,r,n,l,a){let o=t.bones[this.boneIndex];if(!o.active)return;let h=this.frames;if(i<h[0]){switch(l){case I.setup:o.shearX=o.data.shearX;return;case I.first:o.shearX+=(o.data.shearX-o.shearX)*n}return}let c=this.getCurveValue(i);switch(l){case I.setup:o.shearX=o.data.shearX+c*n;break;case I.first:case I.replace:o.shearX+=(o.data.shearX+c-o.shearX)*n;break;case I.add:o.shearX+=c*n}}},eo=class extends vs{constructor(t,e,i){super(t,e,`${Mt.shearY}|${i}`),this.boneIndex=0,this.boneIndex=i}apply(t,e,i,r,n,l,a){let o=t.bones[this.boneIndex];if(!o.active)return;let h=this.frames;if(i<h[0]){switch(l){case I.setup:o.shearY=o.data.shearY;return;case I.first:o.shearY+=(o.data.shearY-o.shearY)*n}return}let c=this.getCurveValue(i);switch(l){case I.setup:o.shearY=o.data.shearY+c*n;break;case I.first:case I.replace:o.shearY+=(o.data.shearY+c-o.shearY)*n;break;case I.add:o.shearY+=c*n}}},so=class extends ys{constructor(t,e,i){super(t,e,[`${Mt.rgb}|${i}`,`${Mt.alpha}|${i}`]),this.slotIndex=0,this.slotIndex=i}getFrameEntries(){return 5}setFrame(t,e,i,r,n,l){t*=5,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=r,this.frames[t+3]=n,this.frames[t+4]=l}apply(t,e,i,r,n,l,a){let o=t.slots[this.slotIndex];if(!o.bone.active)return;let h=this.frames,c=o.color;if(i<h[0]){let y=o.data.color;switch(l){case I.setup:c.setFromColor(y);return;case I.first:c.add((y.r-c.r)*n,(y.g-c.g)*n,(y.b-c.b)*n,(y.a-c.a)*n)}return}let u=0,d=0,f=0,m=0,p=Xt.search(h,i,5),g=this.curves[p/5];switch(g){case 0:let y=h[p];u=h[p+1],d=h[p+2],f=h[p+3],m=h[p+4];let _=(i-y)/(h[p+5]-y);u+=(h[p+5+1]-u)*_,d+=(h[p+5+2]-d)*_,f+=(h[p+5+3]-f)*_,m+=(h[p+5+4]-m)*_;break;case 1:u=h[p+1],d=h[p+2],f=h[p+3],m=h[p+4];break;default:u=this.getBezierValue(i,p,1,g-2),d=this.getBezierValue(i,p,2,g+18-2),f=this.getBezierValue(i,p,3,g+18*2-2),m=this.getBezierValue(i,p,4,g+18*3-2)}n==1?c.set(u,d,f,m):(l==I.setup&&c.setFromColor(o.data.color),c.add((u-c.r)*n,(d-c.g)*n,(f-c.b)*n,(m-c.a)*n))}},io=class extends ys{constructor(t,e,i){super(t,e,[`${Mt.rgb}|${i}`]),this.slotIndex=0,this.slotIndex=i}getFrameEntries(){return 4}setFrame(t,e,i,r,n){t<<=2,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=r,this.frames[t+3]=n}apply(t,e,i,r,n,l,a){let o=t.slots[this.slotIndex];if(!o.bone.active)return;let h=this.frames,c=o.color;if(i<h[0]){let g=o.data.color;switch(l){case I.setup:c.r=g.r,c.g=g.g,c.b=g.b;return;case I.first:c.r+=(g.r-c.r)*n,c.g+=(g.g-c.g)*n,c.b+=(g.b-c.b)*n}return}let u=0,d=0,f=0,m=Xt.search(h,i,4),p=this.curves[m>>2];switch(p){case 0:let g=h[m];u=h[m+1],d=h[m+2],f=h[m+3];let y=(i-g)/(h[m+4]-g);u+=(h[m+4+1]-u)*y,d+=(h[m+4+2]-d)*y,f+=(h[m+4+3]-f)*y;break;case 1:u=h[m+1],d=h[m+2],f=h[m+3];break;default:u=this.getBezierValue(i,m,1,p-2),d=this.getBezierValue(i,m,2,p+18-2),f=this.getBezierValue(i,m,3,p+18*2-2)}if(n==1)c.r=u,c.g=d,c.b=f;else{if(l==I.setup){let g=o.data.color;c.r=g.r,c.g=g.g,c.b=g.b}c.r+=(u-c.r)*n,c.g+=(d-c.g)*n,c.b+=(f-c.b)*n}}},ro=class extends vs{constructor(t,e,i){super(t,e,`${Mt.alpha}|${i}`),this.slotIndex=0,this.slotIndex=i}apply(t,e,i,r,n,l,a){let o=t.slots[this.slotIndex];if(!o.bone.active)return;let h=o.color;if(i<this.frames[0]){let u=o.data.color;switch(l){case I.setup:h.a=u.a;return;case I.first:h.a+=(u.a-h.a)*n}return}let c=this.getCurveValue(i);n==1?h.a=c:(l==I.setup&&(h.a=o.data.color.a),h.a+=(c-h.a)*n)}},no=class extends ys{constructor(t,e,i){super(t,e,[`${Mt.rgb}|${i}`,`${Mt.alpha}|${i}`,`${Mt.rgb2}|${i}`]),this.slotIndex=0,this.slotIndex=i}getFrameEntries(){return 8}setFrame(t,e,i,r,n,l,a,o,h){t<<=3,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=r,this.frames[t+3]=n,this.frames[t+4]=l,this.frames[t+5]=a,this.frames[t+6]=o,this.frames[t+7]=h}apply(t,e,i,r,n,l,a){let o=t.slots[this.slotIndex];if(!o.bone.active)return;let h=this.frames,c=o.color,u=o.darkColor;if(i<h[0]){let v=o.data.color,w=o.data.darkColor;switch(l){case I.setup:c.setFromColor(v),u.r=w.r,u.g=w.g,u.b=w.b;return;case I.first:c.add((v.r-c.r)*n,(v.g-c.g)*n,(v.b-c.b)*n,(v.a-c.a)*n),u.r+=(w.r-u.r)*n,u.g+=(w.g-u.g)*n,u.b+=(w.b-u.b)*n}return}let d=0,f=0,m=0,p=0,g=0,y=0,_=0,b=Xt.search(h,i,8),x=this.curves[b>>3];switch(x){case 0:let v=h[b];d=h[b+1],f=h[b+2],m=h[b+3],p=h[b+4],g=h[b+5],y=h[b+6],_=h[b+7];let w=(i-v)/(h[b+8]-v);d+=(h[b+8+1]-d)*w,f+=(h[b+8+2]-f)*w,m+=(h[b+8+3]-m)*w,p+=(h[b+8+4]-p)*w,g+=(h[b+8+5]-g)*w,y+=(h[b+8+6]-y)*w,_+=(h[b+8+7]-_)*w;break;case 1:d=h[b+1],f=h[b+2],m=h[b+3],p=h[b+4],g=h[b+5],y=h[b+6],_=h[b+7];break;default:d=this.getBezierValue(i,b,1,x-2),f=this.getBezierValue(i,b,2,x+18-2),m=this.getBezierValue(i,b,3,x+18*2-2),p=this.getBezierValue(i,b,4,x+18*3-2),g=this.getBezierValue(i,b,5,x+18*4-2),y=this.getBezierValue(i,b,6,x+18*5-2),_=this.getBezierValue(i,b,7,x+18*6-2)}if(n==1)c.set(d,f,m,p),u.r=g,u.g=y,u.b=_;else{if(l==I.setup){c.setFromColor(o.data.color);let v=o.data.darkColor;u.r=v.r,u.g=v.g,u.b=v.b}c.add((d-c.r)*n,(f-c.g)*n,(m-c.b)*n,(p-c.a)*n),u.r+=(g-u.r)*n,u.g+=(y-u.g)*n,u.b+=(_-u.b)*n}}},oo=class extends ys{constructor(t,e,i){super(t,e,[`${Mt.rgb}|${i}`,`${Mt.rgb2}|${i}`]),this.slotIndex=0,this.slotIndex=i}getFrameEntries(){return 7}setFrame(t,e,i,r,n,l,a,o){t*=7,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=r,this.frames[t+3]=n,this.frames[t+4]=l,this.frames[t+5]=a,this.frames[t+6]=o}apply(t,e,i,r,n,l,a){let o=t.slots[this.slotIndex];if(!o.bone.active)return;let h=this.frames,c=o.color,u=o.darkColor;if(i<h[0]){let x=o.data.color,v=o.data.darkColor;switch(l){case I.setup:c.r=x.r,c.g=x.g,c.b=x.b,u.r=v.r,u.g=v.g,u.b=v.b;return;case I.first:c.r+=(x.r-c.r)*n,c.g+=(x.g-c.g)*n,c.b+=(x.b-c.b)*n,u.r+=(v.r-u.r)*n,u.g+=(v.g-u.g)*n,u.b+=(v.b-u.b)*n}return}let d=0,f=0,m=0,p=0,g=0,y=0,_=Xt.search(h,i,7),b=this.curves[_/7];switch(b){case 0:let x=h[_];d=h[_+1],f=h[_+2],m=h[_+3],p=h[_+4],g=h[_+5],y=h[_+6];let v=(i-x)/(h[_+7]-x);d+=(h[_+7+1]-d)*v,f+=(h[_+7+2]-f)*v,m+=(h[_+7+3]-m)*v,p+=(h[_+7+4]-p)*v,g+=(h[_+7+5]-g)*v,y+=(h[_+7+6]-y)*v;break;case 1:d=h[_+1],f=h[_+2],m=h[_+3],p=h[_+4],g=h[_+5],y=h[_+6];break;default:d=this.getBezierValue(i,_,1,b-2),f=this.getBezierValue(i,_,2,b+18-2),m=this.getBezierValue(i,_,3,b+18*2-2),p=this.getBezierValue(i,_,4,b+18*3-2),g=this.getBezierValue(i,_,5,b+18*4-2),y=this.getBezierValue(i,_,6,b+18*5-2)}if(n==1)c.r=d,c.g=f,c.b=m,u.r=p,u.g=g,u.b=y;else{if(l==I.setup){let x=o.data.color,v=o.data.darkColor;c.r=x.r,c.g=x.g,c.b=x.b,u.r=v.r,u.g=v.g,u.b=v.b}c.r+=(d-c.r)*n,c.g+=(f-c.g)*n,c.b+=(m-c.b)*n,u.r+=(p-u.r)*n,u.g+=(g-u.g)*n,u.b+=(y-u.b)*n}}},Ws=class extends Xt{constructor(t,e){super(t,[`${Mt.attachment}|${e}`]),this.slotIndex=0,this.slotIndex=e,this.attachmentNames=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,i){this.frames[t]=e,this.attachmentNames[t]=i}apply(t,e,i,r,n,l,a){let o=t.slots[this.slotIndex];if(!!o.bone.active){if(a==at.mixOut){l==I.setup&&this.setAttachment(t,o,o.data.attachmentName);return}if(i<this.frames[0]){(l==I.setup||l==I.first)&&this.setAttachment(t,o,o.data.attachmentName);return}this.setAttachment(t,o,this.attachmentNames[Xt.search1(this.frames,i)])}}setAttachment(t,e,i){e.setAttachment(i?t.getAttachment(this.slotIndex,i):null)}},ao=class extends ys{constructor(t,e,i,r){super(t,e,[`${Mt.deform}|${i}|${r.id}`]),this.slotIndex=0,this.slotIndex=i,this.attachment=r,this.vertices=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,e,i){this.frames[t]=e,this.vertices[t]=i}setBezier(t,e,i,r,n,l,a,o,h,c,u){let d=this.curves,f=this.getFrameCount()+t*18;i==0&&(d[e]=2+f);let m=(r-l*2+o)*.03,p=h*.03-a*.06,g=((l-o)*3-r+c)*.006,y=(a-h+.33333333)*.018,_=m*2+g,b=p*2+y,x=(l-r)*.3+m+g*.16666667,v=a*.3+p+y*.16666667,w=r+x,E=v;for(let A=f+18;f<A;f+=2)d[f]=w,d[f+1]=E,x+=_,v+=b,_+=g,b+=y,w+=x,E+=v}getCurvePercent(t,e){let i=this.curves,r=i[e];switch(r){case 0:let o=this.frames[e];return(t-o)/(this.frames[e+this.getFrameEntries()]-o);case 1:return 0}if(r-=2,i[r]>t){let o=this.frames[e];return i[r+1]*(t-o)/(i[r]-o)}let n=r+18;for(r+=2;r<n;r+=2)if(i[r]>=t){let o=i[r-2],h=i[r-1];return h+(t-o)/(i[r]-o)*(i[r+1]-h)}let l=i[n-2],a=i[n-1];return a+(1-a)*(t-l)/(this.frames[e+this.getFrameEntries()]-l)}apply(t,e,i,r,n,l,a){let o=t.slots[this.slotIndex];if(!o.bone.active)return;let h=o.getAttachment();if(!h||!(h instanceof ye)||h.timelineAttachment!=this.attachment)return;let c=o.deform;c.length==0&&(l=I.setup);let u=this.vertices,d=u[0].length,f=this.frames;if(i<f[0]){switch(l){case I.setup:c.length=0;return;case I.first:if(n==1){c.length=0;return}c.length=d;let _=h;if(_.bones){n=1-n;for(let b=0;b<d;b++)c[b]*=n}else{let b=_.vertices;for(let x=0;x<d;x++)c[x]+=(b[x]-c[x])*n}}return}if(c.length=d,i>=f[f.length-1]){let _=u[f.length-1];if(n==1)if(l==I.add){let b=h;if(b.bones)for(let x=0;x<d;x++)c[x]+=_[x];else{let x=b.vertices;for(let v=0;v<d;v++)c[v]+=_[v]-x[v]}}else k.arrayCopy(_,0,c,0,d);else switch(l){case I.setup:{let x=h;if(x.bones)for(let v=0;v<d;v++)c[v]=_[v]*n;else{let v=x.vertices;for(let w=0;w<d;w++){let E=v[w];c[w]=E+(_[w]-E)*n}}break}case I.first:case I.replace:for(let x=0;x<d;x++)c[x]+=(_[x]-c[x])*n;break;case I.add:let b=h;if(b.bones)for(let x=0;x<d;x++)c[x]+=_[x]*n;else{let x=b.vertices;for(let v=0;v<d;v++)c[v]+=(_[v]-x[v])*n}}return}let m=Xt.search1(f,i),p=this.getCurvePercent(i,m),g=u[m],y=u[m+1];if(n==1)if(l==I.add){let _=h;if(_.bones)for(let b=0;b<d;b++){let x=g[b];c[b]+=x+(y[b]-x)*p}else{let b=_.vertices;for(let x=0;x<d;x++){let v=g[x];c[x]+=v+(y[x]-v)*p-b[x]}}}else for(let _=0;_<d;_++){let b=g[_];c[_]=b+(y[_]-b)*p}else switch(l){case I.setup:{let b=h;if(b.bones)for(let x=0;x<d;x++){let v=g[x];c[x]=(v+(y[x]-v)*p)*n}else{let x=b.vertices;for(let v=0;v<d;v++){let w=g[v],E=x[v];c[v]=E+(w+(y[v]-w)*p-E)*n}}break}case I.first:case I.replace:for(let b=0;b<d;b++){let x=g[b];c[b]+=(x+(y[b]-x)*p-c[b])*n}break;case I.add:let _=h;if(_.bones)for(let b=0;b<d;b++){let x=g[b];c[b]+=(x+(y[b]-x)*p)*n}else{let b=_.vertices;for(let x=0;x<d;x++){let v=g[x];c[x]+=(v+(y[x]-v)*p-b[x])*n}}}}},O0=class extends Xt{constructor(s){super(s,O0.propertyIds),this.events=new Array(s)}getFrameCount(){return this.frames.length}setFrame(s,t){this.frames[s]=t.time,this.events[s]=t}apply(s,t,e,i,r,n,l){if(!i)return;let a=this.frames,o=this.frames.length;if(t>e)this.apply(s,t,Number.MAX_VALUE,i,r,n,l),t=-1;else if(t>=a[o-1])return;if(e<a[0])return;let h=0;if(t<a[0])h=0;else{h=Xt.search1(a,t)+1;let c=a[h];for(;h>0&&a[h-1]==c;)h--}for(;h<o&&e>=a[h];h++)i.push(this.events[h])}},Dr=O0;Dr.propertyIds=[`${Mt.event}`];var N0=class extends Xt{constructor(s){super(s,N0.propertyIds),this.drawOrders=new Array(s)}getFrameCount(){return this.frames.length}setFrame(s,t,e){this.frames[s]=t,this.drawOrders[s]=e}apply(s,t,e,i,r,n,l){if(l==at.mixOut){n==I.setup&&k.arrayCopy(s.slots,0,s.drawOrder,0,s.slots.length);return}if(e<this.frames[0]){(n==I.setup||n==I.first)&&k.arrayCopy(s.slots,0,s.drawOrder,0,s.slots.length);return}let a=Xt.search1(this.frames,e),o=this.drawOrders[a];if(!o)k.arrayCopy(s.slots,0,s.drawOrder,0,s.slots.length);else{let h=s.drawOrder,c=s.slots;for(let u=0,d=o.length;u<d;u++)h[u]=c[o[u]]}}},Ei=N0;Ei.propertyIds=[`${Mt.drawOrder}`];var lo=class extends ys{constructor(t,e,i){super(t,e,[`${Mt.ikConstraint}|${i}`]),this.ikConstraintIndex=0,this.ikConstraintIndex=i}getFrameEntries(){return 6}setFrame(t,e,i,r,n,l,a){t*=6,this.frames[t]=e,this.frames[t+1]=i,this.frames[t+2]=r,this.frames[t+3]=n,this.frames[t+4]=l?1:0,this.frames[t+5]=a?1:0}apply(t,e,i,r,n,l,a){let o=t.ikConstraints[this.ikConstraintIndex];if(!o.active)return;let h=this.frames;if(i<h[0]){switch(l){case I.setup:o.mix=o.data.mix,o.softness=o.data.softness,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch;return;case I.first:o.mix+=(o.data.mix-o.mix)*n,o.softness+=(o.data.softness-o.softness)*n,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch}return}let c=0,u=0,d=Xt.search(h,i,6),f=this.curves[d/6];switch(f){case 0:let m=h[d];c=h[d+1],u=h[d+2];let p=(i-m)/(h[d+6]-m);c+=(h[d+6+1]-c)*p,u+=(h[d+6+2]-u)*p;break;case 1:c=h[d+1],u=h[d+2];break;default:c=this.getBezierValue(i,d,1,f-2),u=this.getBezierValue(i,d,2,f+18-2)}l==I.setup?(o.mix=o.data.mix+(c-o.data.mix)*n,o.softness=o.data.softness+(u-o.data.softness)*n,a==at.mixOut?(o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch):(o.bendDirection=h[d+3],o.compress=h[d+4]!=0,o.stretch=h[d+5]!=0)):(o.mix+=(c-o.mix)*n,o.softness+=(u-o.softness)*n,a==at.mixIn&&(o.bendDirection=h[d+3],o.compress=h[d+4]!=0,o.stretch=h[d+5]!=0))}},ho=class extends ys{constructor(t,e,i){super(t,e,[`${Mt.transformConstraint}|${i}`]),this.transformConstraintIndex=0,this.transformConstraintIndex=i}getFrameEntries(){return 7}setFrame(t,e,i,r,n,l,a,o){let h=this.frames;t*=7,h[t]=e,h[t+1]=i,h[t+2]=r,h[t+3]=n,h[t+4]=l,h[t+5]=a,h[t+6]=o}apply(t,e,i,r,n,l,a){let o=t.transformConstraints[this.transformConstraintIndex];if(!o.active)return;let h=this.frames;if(i<h[0]){let _=o.data;switch(l){case I.setup:o.mixRotate=_.mixRotate,o.mixX=_.mixX,o.mixY=_.mixY,o.mixScaleX=_.mixScaleX,o.mixScaleY=_.mixScaleY,o.mixShearY=_.mixShearY;return;case I.first:o.mixRotate+=(_.mixRotate-o.mixRotate)*n,o.mixX+=(_.mixX-o.mixX)*n,o.mixY+=(_.mixY-o.mixY)*n,o.mixScaleX+=(_.mixScaleX-o.mixScaleX)*n,o.mixScaleY+=(_.mixScaleY-o.mixScaleY)*n,o.mixShearY+=(_.mixShearY-o.mixShearY)*n}return}let c,u,d,f,m,p,g=Xt.search(h,i,7),y=this.curves[g/7];switch(y){case 0:let _=h[g];c=h[g+1],u=h[g+2],d=h[g+3],f=h[g+4],m=h[g+5],p=h[g+6];let b=(i-_)/(h[g+7]-_);c+=(h[g+7+1]-c)*b,u+=(h[g+7+2]-u)*b,d+=(h[g+7+3]-d)*b,f+=(h[g+7+4]-f)*b,m+=(h[g+7+5]-m)*b,p+=(h[g+7+6]-p)*b;break;case 1:c=h[g+1],u=h[g+2],d=h[g+3],f=h[g+4],m=h[g+5],p=h[g+6];break;default:c=this.getBezierValue(i,g,1,y-2),u=this.getBezierValue(i,g,2,y+18-2),d=this.getBezierValue(i,g,3,y+18*2-2),f=this.getBezierValue(i,g,4,y+18*3-2),m=this.getBezierValue(i,g,5,y+18*4-2),p=this.getBezierValue(i,g,6,y+18*5-2)}if(l==I.setup){let _=o.data;o.mixRotate=_.mixRotate+(c-_.mixRotate)*n,o.mixX=_.mixX+(u-_.mixX)*n,o.mixY=_.mixY+(d-_.mixY)*n,o.mixScaleX=_.mixScaleX+(f-_.mixScaleX)*n,o.mixScaleY=_.mixScaleY+(m-_.mixScaleY)*n,o.mixShearY=_.mixShearY+(p-_.mixShearY)*n}else o.mixRotate+=(c-o.mixRotate)*n,o.mixX+=(u-o.mixX)*n,o.mixY+=(d-o.mixY)*n,o.mixScaleX+=(f-o.mixScaleX)*n,o.mixScaleY+=(m-o.mixScaleY)*n,o.mixShearY+=(p-o.mixShearY)*n}},co=class extends vs{constructor(t,e,i){super(t,e,`${Mt.pathConstraintPosition}|${i}`),this.pathConstraintIndex=0,this.pathConstraintIndex=i}apply(t,e,i,r,n,l,a){let o=t.pathConstraints[this.pathConstraintIndex];if(!o.active)return;let h=this.frames;if(i<h[0]){switch(l){case I.setup:o.position=o.data.position;return;case I.first:o.position+=(o.data.position-o.position)*n}return}let c=this.getCurveValue(i);l==I.setup?o.position=o.data.position+(c-o.data.position)*n:o.position+=(c-o.position)*n}},uo=class extends vs{constructor(t,e,i){super(t,e,`${Mt.pathConstraintSpacing}|${i}`),this.pathConstraintIndex=0,this.pathConstraintIndex=i}apply(t,e,i,r,n,l,a){let o=t.pathConstraints[this.pathConstraintIndex];if(!o.active)return;let h=this.frames;if(i<h[0]){switch(l){case I.setup:o.spacing=o.data.spacing;return;case I.first:o.spacing+=(o.data.spacing-o.spacing)*n}return}let c=this.getCurveValue(i);l==I.setup?o.spacing=o.data.spacing+(c-o.data.spacing)*n:o.spacing+=(c-o.spacing)*n}},fo=class extends ys{constructor(t,e,i){super(t,e,[`${Mt.pathConstraintMix}|${i}`]),this.pathConstraintIndex=0,this.pathConstraintIndex=i}getFrameEntries(){return 4}setFrame(t,e,i,r,n){let l=this.frames;t<<=2,l[t]=e,l[t+1]=i,l[t+2]=r,l[t+3]=n}apply(t,e,i,r,n,l,a){let o=t.pathConstraints[this.pathConstraintIndex];if(!o.active)return;let h=this.frames;if(i<h[0]){switch(l){case I.setup:o.mixRotate=o.data.mixRotate,o.mixX=o.data.mixX,o.mixY=o.data.mixY;return;case I.first:o.mixRotate+=(o.data.mixRotate-o.mixRotate)*n,o.mixX+=(o.data.mixX-o.mixX)*n,o.mixY+=(o.data.mixY-o.mixY)*n}return}let c,u,d,f=Xt.search(h,i,4),m=this.curves[f>>2];switch(m){case 0:let p=h[f];c=h[f+1],u=h[f+2],d=h[f+3];let g=(i-p)/(h[f+4]-p);c+=(h[f+4+1]-c)*g,u+=(h[f+4+2]-u)*g,d+=(h[f+4+3]-d)*g;break;case 1:c=h[f+1],u=h[f+2],d=h[f+3];break;default:c=this.getBezierValue(i,f,1,m-2),u=this.getBezierValue(i,f,2,m+18-2),d=this.getBezierValue(i,f,3,m+18*2-2)}if(l==I.setup){let p=o.data;o.mixRotate=p.mixRotate+(c-p.mixRotate)*n,o.mixX=p.mixX+(u-p.mixX)*n,o.mixY=p.mixY+(d-p.mixY)*n}else o.mixRotate+=(c-o.mixRotate)*n,o.mixX+=(u-o.mixX)*n,o.mixY+=(d-o.mixY)*n}},$n=class extends Xt{constructor(s,t,e){super(s,[`${Mt.sequence}|${t}|${e.sequence.id}`]),this.slotIndex=t,this.attachment=e}getFrameEntries(){return $n.ENTRIES}getSlotIndex(){return this.slotIndex}getAttachment(){return this.attachment}setFrame(s,t,e,i,r){let n=this.frames;s*=$n.ENTRIES,n[s]=t,n[s+$n.MODE]=e|i<<4,n[s+$n.DELAY]=r}apply(s,t,e,i,r,n,l){let a=s.slots[this.slotIndex];if(!a.bone.active)return;let o=a.attachment,h=this.attachment;if(o!=h&&(!(o instanceof ye)||o.timelineAttachment!=h))return;let c=this.frames;if(e<c[0]){(n==I.setup||n==I.first)&&(a.sequenceIndex=-1);return}let u=Xt.search(c,e,$n.ENTRIES),d=c[u],f=c[u+$n.MODE],m=c[u+$n.DELAY];if(!this.attachment.sequence)return;let p=f>>4,g=this.attachment.sequence.regions.length,y=xc[f&15];if(y!=js.hold)switch(p+=(e-d)/m+1e-5|0,y){case js.once:p=Math.min(g-1,p);break;case js.loop:p%=g;break;case js.pingpong:{let _=(g<<1)-2;p=_==0?0:p%_,p>=g&&(p=_-p);break}case js.onceReverse:p=Math.max(g-1-p,0);break;case js.loopReverse:p=g-1-p%g;break;case js.pingpongReverse:{let _=(g<<1)-2;p=_==0?0:(p+g-1)%_,p>=g&&(p=_-p)}}a.sequenceIndex=p}},Vr=$n;Vr.ENTRIES=3;Vr.MODE=1;Vr.DELAY=2;var Yi=class{constructor(s){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new hd(this),this.propertyIDs=new gn,this.animationsChanged=!1,this.trackEntryPool=new Js(()=>new cd),this.data=s}static emptyAnimation(){return Yi._emptyAnimation}update(s){s*=this.timeScale;let t=this.tracks;for(let e=0,i=t.length;e<i;e++){let r=t[e];if(!r)continue;r.animationLast=r.nextAnimationLast,r.trackLast=r.nextTrackLast;let n=s*r.timeScale;if(r.delay>0){if(r.delay-=n,r.delay>0)continue;n=-r.delay,r.delay=0}let l=r.next;if(l){let a=r.trackLast-l.delay;if(a>=0){for(l.delay=0,l.trackTime+=r.timeScale==0?0:(a/r.timeScale+s)*l.timeScale,r.trackTime+=n,this.setCurrent(e,l,!0);l.mixingFrom;)l.mixTime+=s,l=l.mixingFrom;continue}}else if(r.trackLast>=r.trackEnd&&!r.mixingFrom){t[e]=null,this.queue.end(r),this.clearNext(r);continue}if(r.mixingFrom&&this.updateMixingFrom(r,s)){let a=r.mixingFrom;for(r.mixingFrom=null,a&&(a.mixingTo=null);a;)this.queue.end(a),a=a.mixingFrom}r.trackTime+=n}this.queue.drain()}updateMixingFrom(s,t){let e=s.mixingFrom;if(!e)return!0;let i=this.updateMixingFrom(e,t);return e.animationLast=e.nextAnimationLast,e.trackLast=e.nextTrackLast,s.mixTime>0&&s.mixTime>=s.mixDuration?((e.totalAlpha==0||s.mixDuration==0)&&(s.mixingFrom=e.mixingFrom,e.mixingFrom&&(e.mixingFrom.mixingTo=s),s.interruptAlpha=e.interruptAlpha,this.queue.end(e)),i):(e.trackTime+=t*e.timeScale,s.mixTime+=t,!1)}apply(s){if(!s)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();let t=this.events,e=this.tracks,i=!1;for(let l=0,a=e.length;l<a;l++){let o=e[l];if(!o||o.delay>0)continue;i=!0;let h=l==0?I.first:o.mixBlend,c=o.alpha;o.mixingFrom?c*=this.applyMixingFrom(o,s,h):o.trackTime>=o.trackEnd&&!o.next&&(c=0);let u=o.animationLast,d=o.getAnimationTime(),f=d,m=t;o.reverse&&(f=o.animation.duration-f,m=null);let p=o.animation.timelines,g=p.length;if(l==0&&c==1||h==I.add)for(let y=0;y<g;y++){k.webkit602BugfixHelper(c,h);let _=p[y];_ instanceof Ws?this.applyAttachmentTimeline(_,s,f,h,!0):_.apply(s,u,f,m,c,h,at.mixIn)}else{let y=o.timelineMode,_=o.shortestRotation,b=!_&&o.timelinesRotation.length!=g<<1;b&&(o.timelinesRotation.length=g<<1);for(let x=0;x<g;x++){let v=p[x],w=y[x]==Sg?h:I.setup;!_&&v instanceof wi?this.applyRotateTimeline(v,s,f,c,w,o.timelinesRotation,x<<1,b):v instanceof Ws?this.applyAttachmentTimeline(v,s,f,h,!0):(k.webkit602BugfixHelper(c,h),v.apply(s,u,f,m,c,w,at.mixIn))}}this.queueEvents(o,d),t.length=0,o.nextAnimationLast=d,o.nextTrackLast=o.trackTime}let r=this.unkeyedState+L0,n=s.slots;for(let l=0,a=s.slots.length;l<a;l++){let o=n[l];if(o.attachmentState==r){let h=o.data.attachmentName;o.setAttachment(h?s.getAttachment(o.data.index,h):null)}}return this.unkeyedState+=2,this.queue.drain(),i}applyMixingFrom(s,t,e){let i=s.mixingFrom;i.mixingFrom&&this.applyMixingFrom(i,t,e);let r=0;s.mixDuration==0?(r=1,e==I.first&&(e=I.setup)):(r=s.mixTime/s.mixDuration,r>1&&(r=1),e!=I.first&&(e=i.mixBlend));let n=r<i.attachmentThreshold,l=r<i.drawOrderThreshold,a=i.animation.timelines,o=a.length,h=i.alpha*s.interruptAlpha,c=h*(1-r),u=i.animationLast,d=i.getAnimationTime(),f=d,m=null;if(i.reverse?f=i.animation.duration-f:r<i.eventThreshold&&(m=this.events),e==I.add)for(let p=0;p<o;p++)a[p].apply(t,u,f,m,c,e,at.mixOut);else{let p=i.timelineMode,g=i.timelineHoldMix,y=i.shortestRotation,_=!y&&i.timelinesRotation.length!=o<<1;_&&(i.timelinesRotation.length=o<<1),i.totalAlpha=0;for(let b=0;b<o;b++){let x=a[b],v=at.mixOut,w,E=0;switch(p[b]){case Sg:if(!l&&x instanceof Ei)continue;w=e,E=c;break;case F0:w=I.setup,E=c;break;case B0:w=e,E=h;break;case Cg:w=I.setup,E=h;break;default:w=I.setup;let A=g[b];E=h*Math.max(0,1-A.mixTime/A.mixDuration);break}i.totalAlpha+=E,!y&&x instanceof wi?this.applyRotateTimeline(x,t,f,E,w,i.timelinesRotation,b<<1,_):x instanceof Ws?this.applyAttachmentTimeline(x,t,f,w,n):(k.webkit602BugfixHelper(E,e),l&&x instanceof Ei&&w==I.setup&&(v=at.mixIn),x.apply(t,u,f,m,E,w,v))}}return s.mixDuration>0&&this.queueEvents(i,d),this.events.length=0,i.nextAnimationLast=d,i.nextTrackLast=i.trackTime,r}applyAttachmentTimeline(s,t,e,i,r){let n=t.slots[s.slotIndex];!n.bone.active||(e<s.frames[0]?(i==I.setup||i==I.first)&&this.setAttachment(t,n,n.data.attachmentName,r):this.setAttachment(t,n,s.attachmentNames[Xt.search1(s.frames,e)],r),n.attachmentState<=this.unkeyedState&&(n.attachmentState=this.unkeyedState+L0))}setAttachment(s,t,e,i){t.setAttachment(e?s.getAttachment(t.data.index,e):null),i&&(t.attachmentState=this.unkeyedState+RI)}applyRotateTimeline(s,t,e,i,r,n,l,a){if(a&&(n[l]=0),i==1){s.apply(t,0,e,null,1,r,at.mixIn);return}let o=t.bones[s.boneIndex];if(!o.active)return;let h=s.frames,c=0,u=0;if(e<h[0])switch(r){case I.setup:o.rotation=o.data.rotation;default:return;case I.first:c=o.rotation,u=o.data.rotation}else c=r==I.setup?o.data.rotation:o.rotation,u=o.data.rotation+s.getCurveValue(e);let d=0,f=u-c;if(f-=(16384-(16384.499999999996-f/360|0))*360,f==0)d=n[l];else{let m=0,p=0;a?(m=0,p=f):(m=n[l],p=n[l+1]);let g=f>0,y=m>=0;S.signum(p)!=S.signum(f)&&Math.abs(p)<=90&&(Math.abs(m)>180&&(m+=360*S.signum(m)),y=g),d=f+m-m%360,y!=g&&(d+=360*S.signum(m)),n[l]=d}n[l+1]=f,o.rotation=c+d*i}queueEvents(s,t){let e=s.animationStart,i=s.animationEnd,r=i-e,n=s.trackLast%r,l=this.events,a=0,o=l.length;for(;a<o;a++){let c=l[a];if(c.time<n)break;c.time>i||this.queue.event(s,c)}let h=!1;for(s.loop?h=r==0||n>s.trackTime%r:h=t>=i&&s.animationLast<i,h&&this.queue.complete(s);a<o;a++){let c=l[a];c.time<e||this.queue.event(s,c)}}clearTracks(){let s=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let t=0,e=this.tracks.length;t<e;t++)this.clearTrack(t);this.tracks.length=0,this.queue.drainDisabled=s,this.queue.drain()}clearTrack(s){if(s>=this.tracks.length)return;let t=this.tracks[s];if(!t)return;this.queue.end(t),this.clearNext(t);let e=t;for(;;){let i=e.mixingFrom;if(!i)break;this.queue.end(i),e.mixingFrom=null,e.mixingTo=null,e=i}this.tracks[t.trackIndex]=null,this.queue.drain()}setCurrent(s,t,e){let i=this.expandToIndex(s);this.tracks[s]=t,t.previous=null,i&&(e&&this.queue.interrupt(i),t.mixingFrom=i,i.mixingTo=t,t.mixTime=0,i.mixingFrom&&i.mixDuration>0&&(t.interruptAlpha*=Math.min(1,i.mixTime/i.mixDuration)),i.timelinesRotation.length=0),this.queue.start(t)}setAnimation(s,t,e=!1){let i=this.data.skeletonData.findAnimation(t);if(!i)throw new Error(`Animation not found: ${t}`);return this.setAnimationWith(s,i,e)}setAnimationWith(s,t,e=!1){if(!t)throw new Error("animation cannot be null.");let i=!0,r=this.expandToIndex(s);r&&(r.nextTrackLast==-1?(this.tracks[s]=r.mixingFrom,this.queue.interrupt(r),this.queue.end(r),this.clearNext(r),r=r.mixingFrom,i=!1):this.clearNext(r));let n=this.trackEntry(s,t,e,r);return this.setCurrent(s,n,i),this.queue.drain(),n}addAnimation(s,t,e=!1,i=0){let r=this.data.skeletonData.findAnimation(t);if(!r)throw new Error(`Animation not found: ${t}`);return this.addAnimationWith(s,r,e,i)}addAnimationWith(s,t,e=!1,i=0){if(!t)throw new Error("animation cannot be null.");let r=this.expandToIndex(s);if(r)for(;r.next;)r=r.next;let n=this.trackEntry(s,t,e,r);return r?(r.next=n,n.previous=r,i<=0&&(i+=r.getTrackComplete()-n.mixDuration)):(this.setCurrent(s,n,!0),this.queue.drain()),n.delay=i,n}setEmptyAnimation(s,t=0){let e=this.setAnimationWith(s,Yi.emptyAnimation(),!1);return e.mixDuration=t,e.trackEnd=t,e}addEmptyAnimation(s,t=0,e=0){let i=this.addAnimationWith(s,Yi.emptyAnimation(),!1,e);return e<=0&&(i.delay+=i.mixDuration-t),i.mixDuration=t,i.trackEnd=t,i}setEmptyAnimations(s=0){let t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,i=this.tracks.length;e<i;e++){let r=this.tracks[e];r&&this.setEmptyAnimation(r.trackIndex,s)}this.queue.drainDisabled=t,this.queue.drain()}expandToIndex(s){return s<this.tracks.length?this.tracks[s]:(k.ensureArrayCapacity(this.tracks,s+1,null),this.tracks.length=s+1,null)}trackEntry(s,t,e,i){let r=this.trackEntryPool.obtain();return r.reset(),r.trackIndex=s,r.animation=t,r.loop=e,r.holdPrevious=!1,r.reverse=!1,r.shortestRotation=!1,r.eventThreshold=0,r.attachmentThreshold=0,r.drawOrderThreshold=0,r.animationStart=0,r.animationEnd=t.duration,r.animationLast=-1,r.nextAnimationLast=-1,r.delay=0,r.trackTime=0,r.trackLast=-1,r.nextTrackLast=-1,r.trackEnd=Number.MAX_VALUE,r.timeScale=1,r.alpha=1,r.mixTime=0,r.mixDuration=i?this.data.getMix(i.animation,t):0,r.interruptAlpha=1,r.totalAlpha=0,r.mixBlend=I.replace,r}clearNext(s){let t=s.next;for(;t;)this.queue.dispose(t),t=t.next;s.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();let s=this.tracks;for(let t=0,e=s.length;t<e;t++){let i=s[t];if(!!i){for(;i.mixingFrom;)i=i.mixingFrom;do(!i.mixingTo||i.mixBlend!=I.add)&&this.computeHold(i),i=i.mixingTo;while(i)}}}computeHold(s){let t=s.mixingTo,e=s.animation.timelines,i=s.animation.timelines.length,r=s.timelineMode;r.length=i;let n=s.timelineHoldMix;n.length=0;let l=this.propertyIDs;if(t&&t.holdPrevious){for(let a=0;a<i;a++)r[a]=l.addAll(e[a].getPropertyIds())?Cg:B0;return}t:for(let a=0;a<i;a++){let o=e[a],h=o.getPropertyIds();if(!l.addAll(h))r[a]=Sg;else if(!t||o instanceof Ws||o instanceof Ei||o instanceof Dr||!t.animation.hasTimeline(h))r[a]=F0;else{for(let c=t.mixingTo;c;c=c.mixingTo)if(!c.animation.hasTimeline(h)){if(s.mixDuration>0){r[a]=CI,n[a]=c;continue t}break}r[a]=Cg}}}getCurrent(s){return s>=this.tracks.length?null:this.tracks[s]}addListener(s){if(!s)throw new Error("listener cannot be null.");this.listeners.push(s)}removeListener(s){let t=this.listeners.indexOf(s);t>=0&&this.listeners.splice(t,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}setAnimationByName(s,t,e){Yi.deprecatedWarning1||(Yi.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: AnimationState.setAnimationByName is deprecated, please use setAnimation from now on.")),this.setAnimation(s,t,e)}addAnimationByName(s,t,e,i){Yi.deprecatedWarning2||(Yi.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: AnimationState.addAnimationByName is deprecated, please use addAnimation from now on.")),this.addAnimation(s,t,e,i)}hasAnimation(s){return this.data.skeletonData.findAnimation(s)!==null}hasAnimationByName(s){return Yi.deprecatedWarning3||(Yi.deprecatedWarning3=!0,console.warn("Spine Deprecation Warning: AnimationState.hasAnimationByName is deprecated, please use hasAnimation from now on.")),this.hasAnimation(s)}},mo=Yi;mo._emptyAnimation=new Xi("<empty>",[],0);mo.deprecatedWarning1=!1;mo.deprecatedWarning2=!1;mo.deprecatedWarning3=!1;var Gr=class{constructor(){this.animation=null,this.previous=null,this.next=null,this.mixingFrom=null,this.mixingTo=null,this.listener=null,this.trackIndex=0,this.loop=!1,this.holdPrevious=!1,this.reverse=!1,this.shortestRotation=!1,this.eventThreshold=0,this.attachmentThreshold=0,this.drawOrderThreshold=0,this.animationStart=0,this.animationEnd=0,this.animationLast=0,this.nextAnimationLast=0,this.delay=0,this.trackTime=0,this.trackLast=0,this.nextTrackLast=0,this.trackEnd=0,this.timeScale=0,this.alpha=0,this.mixTime=0,this.mixDuration=0,this.interruptAlpha=0,this.totalAlpha=0,this.mixBlend=I.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}reset(){this.next=null,this.previous=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){let s=this.animationEnd-this.animationStart;return s==0?this.animationStart:this.trackTime%s+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(s){this.animationLast=s,this.nextAnimationLast=s}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}getTrackComplete(){let s=this.animationEnd-this.animationStart;if(s!=0){if(this.loop)return s*(1+(this.trackTime/s|0));if(this.trackTime<s)return s}return this.trackTime}get time(){return Gr.deprecatedWarning1||(Gr.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime}set time(s){Gr.deprecatedWarning1||(Gr.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: TrackEntry.time is deprecated, please use trackTime from now on.")),this.trackTime=s}get endTime(){return Gr.deprecatedWarning2||(Gr.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime}set endTime(s){Gr.deprecatedWarning2||(Gr.deprecatedWarning2=!0,console.warn("Spine Deprecation Warning: TrackEntry.endTime is deprecated, please use trackEnd from now on.")),this.trackTime=s}loopsCount(){return Math.floor(this.trackTime/this.trackEnd)}},cd=Gr;cd.deprecatedWarning1=!1;cd.deprecatedWarning2=!1;var hd=class{constructor(t){this.objects=[],this.drainDisabled=!1,this.animState=t}start(t){this.objects.push(hs.start),this.objects.push(t),this.animState.animationsChanged=!0}interrupt(t){this.objects.push(hs.interrupt),this.objects.push(t)}end(t){this.objects.push(hs.end),this.objects.push(t),this.animState.animationsChanged=!0}dispose(t){this.objects.push(hs.dispose),this.objects.push(t)}complete(t){this.objects.push(hs.complete),this.objects.push(t)}event(t,e){this.objects.push(hs.event),this.objects.push(t),this.objects.push(e)}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;let t=this.objects,e=this.animState.listeners;for(let i=0;i<t.length;i+=2){let r=t[i],n=t[i+1];switch(r){case hs.start:n.listener&&n.listener.start&&n.listener.start(n);for(let a=0;a<e.length;a++){let o=e[a];o.start&&o.start(n)}break;case hs.interrupt:n.listener&&n.listener.interrupt&&n.listener.interrupt(n);for(let a=0;a<e.length;a++){let o=e[a];o.interrupt&&o.interrupt(n)}break;case hs.end:n.listener&&n.listener.end&&n.listener.end(n);for(let a=0;a<e.length;a++){let o=e[a];o.end&&o.end(n)}case hs.dispose:n.listener&&n.listener.dispose&&n.listener.dispose(n);for(let a=0;a<e.length;a++){let o=e[a];o.dispose&&o.dispose(n)}this.animState.trackEntryPool.free(n);break;case hs.complete:n.listener&&n.listener.complete&&n.listener.complete(n);for(let a=0;a<e.length;a++){let o=e[a];o.complete&&o.complete(n)}break;case hs.event:let l=t[i+++2];n.listener&&n.listener.event&&n.listener.event(n,l);for(let a=0;a<e.length;a++){let o=e[a];o.event&&o.event(n,l)}break}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}},hs=(s=>(s[s.start=0]="start",s[s.interrupt=1]="interrupt",s[s.end=2]="end",s[s.dispose=3]="dispose",s[s.complete=4]="complete",s[s.event=5]="event",s))(hs||{}),Em=class{start(t){}interrupt(t){}end(t){}dispose(t){}complete(t){}event(t,e){}},Sg=0,F0=1,B0=2,Cg=3,CI=4,L0=1,RI=2;var bc=class{constructor(t){if(this.animationToMixTime={},this.defaultMix=0,!t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}setMix(t,e,i){let r=this.skeletonData.findAnimation(t);if(!r)throw new Error(`Animation not found: ${t}`);let n=this.skeletonData.findAnimation(e);if(!n)throw new Error(`Animation not found: ${e}`);this.setMixWith(r,n,i)}setMixWith(t,e,i){if(!t)throw new Error("from cannot be null.");if(!e)throw new Error("to cannot be null.");let r=`${t.name}.${e.name}`;this.animationToMixTime[r]=i}getMix(t,e){let i=`${t.name}.${e.name}`,r=this.animationToMixTime[i];return r===void 0?this.defaultMix:r}};var Sl=class{constructor(t){this.atlas=t}loadSequence(t,e,i){let r=i.regions;for(let n=0,l=r.length;n<l;n++){let a=i.getPath(e,n),o=this.atlas.findRegion(a);if(o==null)throw new Error(`Region not found in atlas: ${a} (sequence: ${t})`);r[n]=o,r[n].renderObject=r[n]}}newRegionAttachment(t,e,i,r){let n=new bt(e,i);if(r!=null)this.loadSequence(e,i,r);else{let l=this.atlas.findRegion(i);if(!l)throw new Error(`Region not found in atlas: ${i} (region attachment: ${e})`);l.renderObject=l,n.region=l}return n}newMeshAttachment(t,e,i,r){let n=new Xs(e,i);if(r!=null)this.loadSequence(e,i,r);else{let l=this.atlas.findRegion(i);if(!l)throw new Error(`Region not found in atlas: ${i} (mesh attachment: ${e})`);l.renderObject=l,n.region=l}return n}newBoundingBoxAttachment(t,e){return new Yn(e)}newPathAttachment(t,e){return new Ys(e)}newPointAttachment(t,e){return new Wn(e)}newClippingAttachment(t,e){return new jn(e)}};var Cl=class{constructor(t,e,i){if(this.matrix=new mt,this.parent=null,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.sorted=!1,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=i,this.setToSetupPose()}get worldX(){return this.matrix.tx}get worldY(){return this.matrix.ty}isActive(){return this.active}update(){this.updateWorldTransformWith(this.ax,this.ay,this.arotation,this.ascaleX,this.ascaleY,this.ashearX,this.ashearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,e,i,r,n,l,a){this.ax=t,this.ay=e,this.arotation=i,this.ascaleX=r,this.ascaleY=n,this.ashearX=l,this.ashearY=a;let o=this.parent,h=this.matrix,c=this.skeleton.scaleX,u=jt.yDown?-this.skeleton.scaleY:this.skeleton.scaleY;if(!o){let g=this.skeleton,y=i+90+a;h.a=S.cosDeg(i+l)*r*c,h.c=S.cosDeg(y)*n*c,h.b=S.sinDeg(i+l)*r*u,h.d=S.sinDeg(y)*n*u,h.tx=t*c+g.x,h.ty=e*u+g.y;return}let d=o.matrix.a,f=o.matrix.c,m=o.matrix.b,p=o.matrix.d;switch(h.tx=d*t+f*e+o.matrix.tx,h.ty=m*t+p*e+o.matrix.ty,this.data.transformMode){case it.Normal:{let g=i+90+a,y=S.cosDeg(i+l)*r,_=S.cosDeg(g)*n,b=S.sinDeg(i+l)*r,x=S.sinDeg(g)*n;h.a=d*y+f*b,h.c=d*_+f*x,h.b=m*y+p*b,h.d=m*_+p*x;return}case it.OnlyTranslation:{let g=i+90+a;h.a=S.cosDeg(i+l)*r,h.c=S.cosDeg(g)*n,h.b=S.sinDeg(i+l)*r,h.d=S.sinDeg(g)*n;break}case it.NoRotationOrReflection:{let g=d*d+m*m,y=0;g>1e-4?(g=Math.abs(d*p-f*m)/g,d/=c,m/=u,f=m*g,p=d*g,y=Math.atan2(m,d)*S.radDeg):(d=0,m=0,y=90-Math.atan2(p,f)*S.radDeg);let _=i+l-y,b=i+a-y+90,x=S.cosDeg(_)*r,v=S.cosDeg(b)*n,w=S.sinDeg(_)*r,E=S.sinDeg(b)*n;h.a=d*x-f*w,h.c=d*v-f*E,h.b=m*x+p*w,h.d=m*v+p*E;break}case it.NoScale:case it.NoScaleOrReflection:{let g=S.cosDeg(i),y=S.sinDeg(i),_=(d*g+f*y)/c,b=(m*g+p*y)/u,x=Math.sqrt(_*_+b*b);x>1e-5&&(x=1/x),_*=x,b*=x,x=Math.sqrt(_*_+b*b),this.data.transformMode==it.NoScale&&d*p-f*m<0!=(c<0!=u<0)&&(x=-x);let v=Math.PI/2+Math.atan2(b,_),w=Math.cos(v)*x,E=Math.sin(v)*x,A=S.cosDeg(l)*r,T=S.cosDeg(90+a)*n,C=S.sinDeg(l)*r,R=S.sinDeg(90+a)*n;h.a=_*A+w*C,h.c=_*T+w*R,h.b=b*A+E*C,h.d=b*T+E*R;break}}h.a*=c,h.c*=c,h.b*=u,h.d*=u}setToSetupPose(){let t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY}getWorldRotationX(){return Math.atan2(this.matrix.b,this.matrix.a)*S.radDeg}getWorldRotationY(){return Math.atan2(this.matrix.d,this.matrix.c)*S.radDeg}getWorldScaleX(){let t=this.matrix;return Math.sqrt(t.a*t.a+t.b*t.b)}getWorldScaleY(){let t=this.matrix;return Math.sqrt(t.c*t.c+t.d*t.d)}updateAppliedTransform(){let t=this.parent,e=this.matrix;if(!t){this.ax=e.tx-this.skeleton.x,this.ay=e.ty-this.skeleton.y,this.arotation=Math.atan2(e.b,e.a)*S.radDeg,this.ascaleX=Math.sqrt(e.a*e.a+e.b*e.b),this.ascaleY=Math.sqrt(e.c*e.c+e.d*e.d),this.ashearX=0,this.ashearY=Math.atan2(e.a*e.c+e.b*e.d,e.a*e.d-e.b*e.c)*S.radDeg;return}let i=t.matrix,r=1/(i.a*i.d-i.b*i.c),n=e.tx-i.tx,l=e.ty-i.ty;this.ax=n*i.d*r-l*i.c*r,this.ay=l*i.a*r-n*i.b*r;let a=r*i.d,o=r*i.a,h=r*i.c,c=r*i.b,u=a*e.a-h*e.b,d=a*e.c-h*e.d,f=o*e.b-c*e.a,m=o*e.d-c*e.c;if(this.ashearX=0,this.ascaleX=Math.sqrt(u*u+f*f),this.ascaleX>1e-4){let p=u*m-d*f;this.ascaleY=p/this.ascaleX,this.ashearY=Math.atan2(u*d+f*m,p)*S.radDeg,this.arotation=Math.atan2(f,u)*S.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(d*d+m*m),this.ashearY=0,this.arotation=90-Math.atan2(m,d)*S.radDeg}worldToLocal(t){let e=this.matrix,i=e.a,r=e.c,n=e.b,l=e.d,a=1/(i*l-r*n),o=t.x-e.tx,h=t.y-e.ty;return t.x=o*l*a-h*r*a,t.y=h*i*a-o*n*a,t}localToWorld(t){let e=this.matrix,i=t.x,r=t.y;return t.x=i*e.a+r*e.c+e.tx,t.y=i*e.b+r*e.d+e.ty,t}worldToLocalRotation(t){let e=S.sinDeg(t),i=S.cosDeg(t),r=this.matrix;return Math.atan2(r.a*e-r.b*i,r.d*i-r.c*e)*S.radDeg}localToWorldRotation(t){t-=this.rotation-this.shearX;let e=S.sinDeg(t),i=S.cosDeg(t),r=this.matrix;return Math.atan2(i*r.b+e*r.d,i*r.a+e*r.c)*S.radDeg}rotateWorld(t){let e=this.matrix,i=e.a,r=e.c,n=e.b,l=e.d,a=S.cosDeg(t),o=S.sinDeg(t);e.a=a*i-o*n,e.c=a*r-o*l,e.b=o*i+a*n,e.d=o*r+a*l}};var po=class{constructor(t,e,i){if(this.index=0,this.parent=null,this.length=0,this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=it.Normal,this.skinRequired=!1,this.color=new G,t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=i}};var ji=class{constructor(t,e,i){this.name=t,this.order=e,this.skinRequired=i}};var go=class{constructor(t,e){if(this.intValue=0,this.floatValue=0,this.stringValue=null,this.time=0,this.volume=0,this.balance=0,!e)throw new Error("data cannot be null.");this.time=t,this.data=e}};var xo=class{constructor(t){this.intValue=0,this.floatValue=0,this.stringValue=null,this.audioPath=null,this.volume=0,this.balance=0,this.name=t}};var _c=class{constructor(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(let r=0;r<t.bones.length;r++){let n=e.findBone(t.bones[r].name);if(!n)throw new Error(`Couldn't find bone ${t.bones[r].name}`);this.bones.push(n)}let i=e.findBone(t.target.name);if(!i)throw new Error(`Couldn't find bone ${t.target.name}`);this.target=i}isActive(){return this.active}update(){if(this.mix==0)return;let t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.data.uniform,this.softness,this.mix);break}}apply1(t,e,i,r,n,l,a){let o=t.parent.matrix;if(!o)throw new Error("IK bone must have parent.");let h=o.a,c=o.c,u=o.b,d=o.d,f=-t.ashearX-t.arotation,m=0,p=0,g=t.skeleton.scaleX,y=jt.yDown?-t.skeleton.scaleY:t.skeleton.scaleY;switch(t.data.transformMode){case it.OnlyTranslation:m=e-t.worldX,p=i-t.worldY,jt.yDown&&(p=-p);break;case it.NoRotationOrReflection:let x=Math.abs(h*d-c*u)/(h*h+u*u),v=h/g,w=u/y;c=-w*x*g,d=v*x*y,f+=Math.atan2(w,v)*S.radDeg;default:let E=e-o.tx,A=i-o.ty,T=h*d-c*u;m=(E*d-A*c)/T-t.ax,p=(A*h-E*u)/T-t.ay}f+=Math.atan2(p,m)*S.radDeg,t.ascaleX<0&&(f+=180),f>180?f-=360:f<-180&&(f+=360);let _=t.ascaleX,b=t.ascaleY;if(r||n){switch(t.data.transformMode){case it.NoScale:case it.NoScaleOrReflection:m=e-t.worldX,p=i-t.worldY}let x=t.data.length*_,v=Math.sqrt(m*m+p*p);if(r&&v<x||n&&v>x&&x>1e-4){let w=(v/x-1)*a+1;_*=w,l&&(b*=w)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+f*a,_,b,t.ashearX,t.ashearY)}apply2(t,e,i,r,n,l,a,o,h){let c=t.ax,u=t.ay,d=t.ascaleX,f=t.ascaleY,m=d,p=f,g=e.ascaleX,y=t.matrix,_=0,b=0,x=0;d<0?(d=-d,_=180,x=-1):(_=0,x=1),f<0&&(f=-f,x=-x),g<0?(g=-g,b=180):b=0;let v=e.ax,w=0,E=0,A=0,T=y.a,C=y.c,R=y.b,N=y.d,P=Math.abs(d-f)<=1e-4;!P||l?(w=0,E=T*v+y.tx,A=R*v+y.ty):(w=e.ay,E=T*v+C*w+y.tx,A=R*v+N*w+y.ty);let M=t.parent.matrix;if(!M)throw new Error("IK parent must itself have a parent.");T=M.a,C=M.c,R=M.b,N=M.d;let D=1/(T*N-C*R),q=E-M.tx,X=A-M.ty,O=(q*N-X*C)*D-c,L=(X*T-q*R)*D-u,B=Math.sqrt(O*O+L*L),W=e.data.length*g,j,V;if(B<1e-4){this.apply1(t,i,r,!1,l,!1,h),e.updateWorldTransformWith(v,w,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);return}q=i-M.tx,X=r-M.ty;let U=(q*N-X*C)*D-c,st=(X*T-q*R)*D-u,nt=U*U+st*st;if(o!=0){o*=d*(g+1)*.5;let ot=Math.sqrt(nt),gt=ot-B-W*d+o;if(gt>0){let yt=Math.min(1,gt/(o*2))-1;yt=(gt-o*(1-yt*yt))/ot,U-=yt*U,st-=yt*st,nt=U*U+st*st}}t:if(P){W*=d;let ot=(nt-B*B-W*W)/(2*B*W);ot<-1?(ot=-1,V=Math.PI*n):ot>1?(ot=1,V=0,l&&(T=(Math.sqrt(nt)/(B+W)-1)*h+1,m*=T,a&&(p*=T))):V=Math.acos(ot)*n,T=B+W*ot,C=W*Math.sin(V),j=Math.atan2(st*T-U*C,U*T+st*C)}else{T=d*W,C=f*W;let ot=T*T,gt=C*C,yt=Math.atan2(st,U);R=gt*B*B+ot*nt-ot*gt;let Nt=-2*gt*B,Lt=gt-ot;if(N=Nt*Nt-4*Lt*R,N>=0){let Ne=Math.sqrt(N);Nt<0&&(Ne=-Ne),Ne=-(Nt+Ne)*.5;let qi=Ne/Lt,$g=R/Ne,Ol=Math.abs(qi)<Math.abs($g)?qi:$g;if(Ol*Ol<=nt){X=Math.sqrt(nt-Ol*Ol)*n,j=yt-Math.atan2(X,Ol),V=Math.atan2(X/f,(Ol-B)/d);break t}}let Xe=S.PI,ws=B-T,Es=ws*ws,$s=0,Hi=0,us=B+T,As=us*us,$r=0;R=-T*B/(ot-gt),R>=-1&&R<=1&&(R=Math.acos(R),q=T*Math.cos(R)+B,X=C*Math.sin(R),N=q*q+X*X,N<Es&&(Xe=R,Es=N,ws=q,$s=X),N>As&&(Hi=R,As=N,us=q,$r=X)),nt<=(Es+As)*.5?(j=yt-Math.atan2($s*n,ws),V=Xe*n):(j=yt-Math.atan2($r*n,us),V=Hi*n)}let pt=Math.atan2(w,v)*x,At=t.arotation;j=(j-pt)*S.radDeg+_-At,j>180?j-=360:j<-180&&(j+=360),t.updateWorldTransformWith(c,u,At+j*h,m,p,0,0),At=e.arotation,V=((V+pt)*S.radDeg-e.ashearX)*x+b-At,V>180?V-=360:V<-180&&(V+=360),e.updateWorldTransformWith(v,w,At+V*h,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}};var bo=class extends ji{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.softness=0}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}};var _o=class extends ji{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.positionMode=It.Fixed,this.spacingMode=te.Fixed,this.rotateMode=Pt.Chain,this.offsetRotation=0,this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("SlotData not set.")}},te=(s=>(s[s.Length=0]="Length",s[s.Fixed=1]="Fixed",s[s.Percent=2]="Percent",s[s.Proportional=3]="Proportional",s))(te||{});var Xr=class{constructor(s,t){if(this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,!s)throw new Error("data cannot be null.");if(!t)throw new Error("skeleton cannot be null.");this.data=s,this.bones=new Array;for(let i=0,r=s.bones.length;i<r;i++){let n=t.findBone(s.bones[i].name);if(!n)throw new Error(`Couldn't find bone ${s.bones[i].name}.`);this.bones.push(n)}let e=t.findSlot(s.target.name);if(!e)throw new Error(`Couldn't find target bone ${s.target.name}`);this.target=e,this.position=s.position,this.spacing=s.spacing,this.mixRotate=s.mixRotate,this.mixX=s.mixX,this.mixY=s.mixY}isActive(){return this.active}update(){let s=this.target.getAttachment();if(!(s instanceof Ys))return;let t=this.mixRotate,e=this.mixX,i=this.mixY;if(t==0&&e==0&&i==0)return;let r=this.data,n=r.rotateMode==Pt.Tangent,l=r.rotateMode==Pt.ChainScale,a=this.bones,o=a.length,h=n?o:o+1,c=k.setArraySize(this.spaces,h),u=l?this.lengths=k.setArraySize(this.lengths,o):[],d=this.spacing;switch(r.spacingMode){case te.Percent:if(l)for(let x=0,v=h-1;x<v;x++){let w=a[x],E=w.data.length;if(E<Xr.epsilon)u[x]=0;else{let A=E*w.matrix.a,T=E*w.matrix.b;u[x]=Math.sqrt(A*A+T*T)}}k.arrayFill(c,1,h,d);break;case te.Proportional:let _=0;for(let x=0,v=h-1;x<v;){let w=a[x],E=w.data.length;if(E<Xr.epsilon)l&&(u[x]=0),c[++x]=d;else{let A=E*w.matrix.a,T=E*w.matrix.b,C=Math.sqrt(A*A+T*T);l&&(u[x]=C),c[++x]=C,_+=C}}if(_>0){_=h/_*d;for(let x=1;x<h;x++)c[x]*=_}break;default:let b=r.spacingMode==te.Length;for(let x=0,v=h-1;x<v;){let w=a[x],E=w.data.length;if(E<Xr.epsilon)l&&(u[x]=0),c[++x]=d;else{let A=E*w.matrix.a,T=E*w.matrix.b,C=Math.sqrt(A*A+T*T);l&&(u[x]=C),c[++x]=(b?E+d:d)*C/E}}}let f=this.computeWorldPositions(s,h,n),m=f[0],p=f[1],g=r.offsetRotation,y=!1;if(g==0)y=r.rotateMode==Pt.Chain;else{y=!1;let _=this.target.bone.matrix;g*=_.a*_.d-_.b*_.c>0?S.degRad:-S.degRad}for(let _=0,b=3;_<o;_++,b+=3){let x=a[_],v=x.matrix;v.tx+=(m-v.tx)*e,v.ty+=(p-v.ty)*i;let w=f[b],E=f[b+1],A=w-m,T=E-p;if(l){let C=u[_];if(C!=0){let R=(Math.sqrt(A*A+T*T)/C-1)*t+1;v.a*=R,v.b*=R}}if(m=w,p=E,t>0){let C=v.a,R=v.c,N=v.b,P=v.d,M=0,D=0,q=0;if(n?M=f[b-1]:c[_+1]==0?M=f[b+2]:M=Math.atan2(T,A),M-=Math.atan2(N,C),y){D=Math.cos(M),q=Math.sin(M);let X=x.data.length;m+=(X*(D*C-q*N)-A)*t,p+=(X*(q*C+D*N)-T)*t}else M+=g;M>S.PI?M-=S.PI2:M<-S.PI&&(M+=S.PI2),M*=t,D=Math.cos(M),q=Math.sin(M),v.a=D*C-q*N,v.c=D*R-q*P,v.b=q*C+D*N,v.d=q*R+D*P}x.updateAppliedTransform()}}computeWorldPositions(s,t,e){let i=this.target,r=this.position,n=this.spaces,l=k.setArraySize(this.positions,t*3+2),a=this.world,o=s.closed,h=s.worldVerticesLength,c=h/6,u=Xr.NONE;if(!s.constantSpeed){let X=s.lengths;c-=o?1:2;let O=X[c];this.data.positionMode==It.Percent&&(r*=O);let L;switch(this.data.spacingMode){case te.Percent:L=O;break;case te.Proportional:L=O/t;break;default:L=1}a=k.setArraySize(this.world,8);for(let B=0,W=0,j=0;B<t;B++,W+=3){let V=n[B]*L;r+=V;let U=r;if(o)U%=O,U<0&&(U+=O),j=0;else if(U<0){u!=Xr.BEFORE&&(u=Xr.BEFORE,s.computeWorldVertices(i,2,4,a,0,2)),this.addBeforePosition(U,a,0,l,W);continue}else if(U>O){u!=Xr.AFTER&&(u=Xr.AFTER,s.computeWorldVertices(i,h-6,4,a,0,2)),this.addAfterPosition(U-O,a,0,l,W);continue}for(;;j++){let st=X[j];if(!(U>st)){if(j==0)U/=st;else{let nt=X[j-1];U=(U-nt)/(st-nt)}break}}j!=u&&(u=j,o&&j==c?(s.computeWorldVertices(i,h-4,4,a,0,2),s.computeWorldVertices(i,0,4,a,4,2)):s.computeWorldVertices(i,j*6+2,8,a,0,2)),this.addCurvePosition(U,a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],l,W,e||B>0&&V==0)}return l}o?(h+=2,a=k.setArraySize(this.world,h),s.computeWorldVertices(i,2,h-4,a,0,2),s.computeWorldVertices(i,0,2,a,h-4,2),a[h-2]=a[0],a[h-1]=a[1]):(c--,h-=4,a=k.setArraySize(this.world,h),s.computeWorldVertices(i,2,h,a,0,2));let d=k.setArraySize(this.curves,c),f=0,m=a[0],p=a[1],g=0,y=0,_=0,b=0,x=0,v=0,w=0,E=0,A=0,T=0,C=0,R=0,N=0,P=0;for(let X=0,O=2;X<c;X++,O+=6)g=a[O],y=a[O+1],_=a[O+2],b=a[O+3],x=a[O+4],v=a[O+5],w=(m-g*2+_)*.1875,E=(p-y*2+b)*.1875,A=((g-_)*3-m+x)*.09375,T=((y-b)*3-p+v)*.09375,C=w*2+A,R=E*2+T,N=(g-m)*.75+w+A*.16666667,P=(y-p)*.75+E+T*.16666667,f+=Math.sqrt(N*N+P*P),N+=C,P+=R,C+=A,R+=T,f+=Math.sqrt(N*N+P*P),N+=C,P+=R,f+=Math.sqrt(N*N+P*P),N+=C+A,P+=R+T,f+=Math.sqrt(N*N+P*P),d[X]=f,m=x,p=v;this.data.positionMode==It.Percent&&(r*=f);let M;switch(this.data.spacingMode){case te.Percent:M=f;break;case te.Proportional:M=f/t;break;default:M=1}let D=this.segments,q=0;for(let X=0,O=0,L=0,B=0;X<t;X++,O+=3){let W=n[X]*M;r+=W;let j=r;if(o)j%=f,j<0&&(j+=f),L=0;else if(j<0){this.addBeforePosition(j,a,0,l,O);continue}else if(j>f){this.addAfterPosition(j-f,a,h-4,l,O);continue}for(;;L++){let V=d[L];if(!(j>V)){if(L==0)j/=V;else{let U=d[L-1];j=(j-U)/(V-U)}break}}if(L!=u){u=L;let V=L*6;for(m=a[V],p=a[V+1],g=a[V+2],y=a[V+3],_=a[V+4],b=a[V+5],x=a[V+6],v=a[V+7],w=(m-g*2+_)*.03,E=(p-y*2+b)*.03,A=((g-_)*3-m+x)*.006,T=((y-b)*3-p+v)*.006,C=w*2+A,R=E*2+T,N=(g-m)*.3+w+A*.16666667,P=(y-p)*.3+E+T*.16666667,q=Math.sqrt(N*N+P*P),D[0]=q,V=1;V<8;V++)N+=C,P+=R,C+=A,R+=T,q+=Math.sqrt(N*N+P*P),D[V]=q;N+=C,P+=R,q+=Math.sqrt(N*N+P*P),D[8]=q,N+=C+A,P+=R+T,q+=Math.sqrt(N*N+P*P),D[9]=q,B=0}for(j*=q;;B++){let V=D[B];if(!(j>V)){if(B==0)j/=V;else{let U=D[B-1];j=B+(j-U)/(V-U)}break}}this.addCurvePosition(j*.1,m,p,g,y,_,b,x,v,l,O,e||X>0&&W==0)}return l}addBeforePosition(s,t,e,i,r){let n=t[e],l=t[e+1],a=t[e+2]-n,o=t[e+3]-l,h=Math.atan2(o,a);i[r]=n+s*Math.cos(h),i[r+1]=l+s*Math.sin(h),i[r+2]=h}addAfterPosition(s,t,e,i,r){let n=t[e+2],l=t[e+3],a=n-t[e],o=l-t[e+1],h=Math.atan2(o,a);i[r]=n+s*Math.cos(h),i[r+1]=l+s*Math.sin(h),i[r+2]=h}addCurvePosition(s,t,e,i,r,n,l,a,o,h,c,u){if(s==0||isNaN(s)){h[c]=t,h[c+1]=e,h[c+2]=Math.atan2(r-e,i-t);return}let d=s*s,f=d*s,m=1-s,p=m*m,g=p*m,y=m*s,_=y*3,b=m*_,x=_*s,v=t*g+i*b+n*x+a*f,w=e*g+r*b+l*x+o*f;h[c]=v,h[c+1]=w,u&&(s<.001?h[c+2]=Math.atan2(r-e,i-t):h[c+2]=Math.atan2(w-(e*p+r*y*2+l*d),v-(t*p+i*y*2+n*d)))}},yo=Xr;yo.NONE=-1;yo.BEFORE=-2;yo.AFTER=-3;yo.epsilon=1e-5;var yc=class{constructor(t,e){if(this.darkColor=null,this.attachment=null,this.attachmentState=0,this.sequenceIndex=-1,this.deform=new Array,!t)throw new Error("data cannot be null.");if(!e)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new G,this.darkColor=t.darkColor?new G:null,this.setToSetupPose(),this.blendMode=this.data.blendMode}getSkeleton(){return this.bone.skeleton}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&((!(t instanceof ye)||!(this.attachment instanceof ye)||t.timelineAttachment!=this.attachment.timelineAttachment)&&(this.deform.length=0),this.attachment=t,this.sequenceIndex=-1)}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName?(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName))):this.attachment=null}};var vc=class{constructor(t,e){if(this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.temp=new Bs,this.active=!1,!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY,this.mixScaleX=t.mixScaleX,this.mixScaleY=t.mixScaleY,this.mixShearY=t.mixShearY,this.bones=new Array;for(let r=0;r<t.bones.length;r++){let n=e.findBone(t.bones[r].name);if(!n)throw new Error(`Couldn't find bone ${t.bones[r].name}.`);this.bones.push(n)}let i=e.findBone(t.target.name);if(!i)throw new Error(`Couldn't find target bone ${t.target.name}.`);this.target=i}isActive(){return this.active}update(){this.mixRotate==0&&this.mixX==0&&this.mixY==0&&this.mixScaleX==0&&this.mixScaleX==0&&this.mixShearY==0||(this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld())}applyAbsoluteWorld(){let t=this.mixRotate,e=this.mixX,i=this.mixY,r=this.mixScaleX,n=this.mixScaleY,l=this.mixShearY,a=e!=0||i!=0,o=this.target,h=o.matrix,c=h.a,u=h.c,d=h.b,f=h.d,m=c*f-u*d>0?S.degRad:-S.degRad,p=this.data.offsetRotation*m,g=this.data.offsetShearY*m,y=this.bones;for(let _=0,b=y.length;_<b;_++){let x=y[_],v=x.matrix;if(t!=0){let w=v.a,E=v.c,A=v.b,T=v.d,C=Math.atan2(d,c)-Math.atan2(A,w)+p;C>S.PI?C-=S.PI2:C<-S.PI&&(C+=S.PI2),C*=t;let R=Math.cos(C),N=Math.sin(C);v.a=R*w-N*A,v.c=R*E-N*T,v.b=N*w+R*A,v.d=N*E+R*T}if(a){let w=this.temp;o.localToWorld(w.set(this.data.offsetX,this.data.offsetY)),v.tx+=(w.x-v.tx)*e,v.ty+=(w.y-v.ty)*i}if(r!=0){let w=Math.sqrt(v.a*v.a+v.b*v.b);w!=0&&(w=(w+(Math.sqrt(c*c+d*d)-w+this.data.offsetScaleX)*r)/w),v.a*=w,v.b*=w}if(n!=0){let w=Math.sqrt(v.c*v.c+v.d*v.d);w!=0&&(w=(w+(Math.sqrt(u*u+f*f)-w+this.data.offsetScaleY)*n)/w),v.c*=w,v.d*=w}if(l>0){let w=v.c,E=v.d,A=Math.atan2(E,w),T=Math.atan2(f,u)-Math.atan2(d,c)-(A-Math.atan2(v.b,v.a));T>S.PI?T-=S.PI2:T<-S.PI&&(T+=S.PI2),T=A+(T+g)*l;let C=Math.sqrt(w*w+E*E);v.c=Math.cos(T)*C,v.d=Math.sin(T)*C}x.updateAppliedTransform()}}applyRelativeWorld(){let t=this.mixRotate,e=this.mixX,i=this.mixY,r=this.mixScaleX,n=this.mixScaleY,l=this.mixShearY,a=e!=0||i!=0,o=this.target,h=o.matrix,c=h.a,u=h.c,d=h.b,f=h.d,m=c*f-u*d>0?S.degRad:-S.degRad,p=this.data.offsetRotation*m,g=this.data.offsetShearY*m,y=this.bones;for(let _=0,b=y.length;_<b;_++){let x=y[_],v=x.matrix;if(t!=0){let w=v.a,E=v.c,A=v.b,T=v.d,C=Math.atan2(d,c)+p;C>S.PI?C-=S.PI2:C<-S.PI&&(C+=S.PI2),C*=t;let R=Math.cos(C),N=Math.sin(C);v.a=R*w-N*A,v.c=R*E-N*T,v.b=N*w+R*A,v.d=N*E+R*T}if(a){let w=this.temp;o.localToWorld(w.set(this.data.offsetX,this.data.offsetY)),v.tx+=w.x*e,v.ty+=w.y*i}if(r!=0){let w=(Math.sqrt(c*c+d*d)-1+this.data.offsetScaleX)*r+1;v.a*=w,v.b*=w}if(n!=0){let w=(Math.sqrt(u*u+f*f)-1+this.data.offsetScaleY)*n+1;v.c*=w,v.d*=w}if(l>0){let w=Math.atan2(f,u)-Math.atan2(d,c);w>S.PI?w-=S.PI2:w<-S.PI&&(w+=S.PI2);let E=v.c,A=v.d;w=Math.atan2(A,E)+(w-S.PI/2+g)*l;let T=Math.sqrt(E*E+A*A);v.c=Math.cos(w)*T,v.d=Math.sin(w)*T}x.updateAppliedTransform()}}applyAbsoluteLocal(){let t=this.mixRotate,e=this.mixX,i=this.mixY,r=this.mixScaleX,n=this.mixScaleY,l=this.mixShearY,a=this.target,o=this.bones;for(let h=0,c=o.length;h<c;h++){let u=o[h],d=u.arotation;if(t!=0){let _=a.arotation-d+this.data.offsetRotation;_-=(16384-(16384.499999999996-_/360|0))*360,d+=_*t}let f=u.ax,m=u.ay;f+=(a.ax-f+this.data.offsetX)*e,m+=(a.ay-m+this.data.offsetY)*i;let p=u.ascaleX,g=u.ascaleY;r!=0&&p!=0&&(p=(p+(a.ascaleX-p+this.data.offsetScaleX)*r)/p),n!=0&&g!=0&&(g=(g+(a.ascaleY-g+this.data.offsetScaleY)*n)/g);let y=u.ashearY;if(l!=0){let _=a.ashearY-y+this.data.offsetShearY;_-=(16384-(16384.499999999996-_/360|0))*360,y+=_*l}u.updateWorldTransformWith(f,m,d,p,g,u.ashearX,y)}}applyRelativeLocal(){let t=this.mixRotate,e=this.mixX,i=this.mixY,r=this.mixScaleX,n=this.mixScaleY,l=this.mixShearY,a=this.target,o=this.bones;for(let h=0,c=o.length;h<c;h++){let u=o[h],d=u.arotation+(a.arotation+this.data.offsetRotation)*t,f=u.ax+(a.ax+this.data.offsetX)*e,m=u.ay+(a.ay+this.data.offsetY)*i,p=u.ascaleX*((a.ascaleX-1+this.data.offsetScaleX)*r+1),g=u.ascaleY*((a.ascaleY-1+this.data.offsetScaleY)*n+1),y=u.ashearY+(a.ashearY+this.data.offsetShearY)*l;u.updateWorldTransformWith(f,m,d,p,g,u.ashearX,y)}}};var ud=class{constructor(s){if(this._updateCache=new Array,this.skin=null,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,!s)throw new Error("data cannot be null.");this.data=s,this.bones=new Array;for(let t=0;t<s.bones.length;t++){let e=s.bones[t],i;if(!e.parent)i=new Cl(e,this,null);else{let r=this.bones[e.parent.index];i=new Cl(e,this,r),r.children.push(i)}this.bones.push(i)}this.slots=new Array,this.drawOrder=new Array;for(let t=0;t<s.slots.length;t++){let e=s.slots[t],i=this.bones[e.boneData.index],r=new yc(e,i);this.slots.push(r),this.drawOrder.push(r)}this.ikConstraints=new Array;for(let t=0;t<s.ikConstraints.length;t++){let e=s.ikConstraints[t];this.ikConstraints.push(new _c(e,this))}this.transformConstraints=new Array;for(let t=0;t<s.transformConstraints.length;t++){let e=s.transformConstraints[t];this.transformConstraints.push(new vc(e,this))}this.pathConstraints=new Array;for(let t=0;t<s.pathConstraints.length;t++){let e=s.pathConstraints[t];this.pathConstraints.push(new yo(e,this))}this.color=new G(1,1,1,1),this.updateCache()}updateCache(){let s=this._updateCache;s.length=0;let t=this.bones;for(let h=0,c=t.length;h<c;h++){let u=t[h];u.sorted=u.data.skinRequired,u.active=!u.sorted}if(this.skin){let h=this.skin.bones;for(let c=0,u=this.skin.bones.length;c<u;c++){let d=this.bones[h[c].index];do d.sorted=!1,d.active=!0,d=d.parent;while(d)}}let e=this.ikConstraints,i=this.transformConstraints,r=this.pathConstraints,n=e.length,l=i.length,a=r.length,o=n+l+a;t:for(let h=0;h<o;h++){for(let c=0;c<n;c++){let u=e[c];if(u.data.order==h){this.sortIkConstraint(u);continue t}}for(let c=0;c<l;c++){let u=i[c];if(u.data.order==h){this.sortTransformConstraint(u);continue t}}for(let c=0;c<a;c++){let u=r[c];if(u.data.order==h){this.sortPathConstraint(u);continue t}}}for(let h=0,c=t.length;h<c;h++)this.sortBone(t[h])}sortIkConstraint(s){if(s.active=s.target.isActive()&&(!s.data.skinRequired||this.skin&&k.contains(this.skin.constraints,s.data,!0)),!s.active)return;let t=s.target;this.sortBone(t);let e=s.bones,i=e[0];if(this.sortBone(i),e.length==1)this._updateCache.push(s),this.sortReset(i.children);else{let r=e[e.length-1];this.sortBone(r),this._updateCache.push(s),this.sortReset(i.children),r.sorted=!0}}sortPathConstraint(s){if(s.active=s.target.bone.isActive()&&(!s.data.skinRequired||this.skin&&k.contains(this.skin.constraints,s.data,!0)),!s.active)return;let t=s.target,e=t.data.index,i=t.bone;this.skin&&this.sortPathConstraintAttachment(this.skin,e,i),this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,e,i);for(let a=0,o=this.data.skins.length;a<o;a++)this.sortPathConstraintAttachment(this.data.skins[a],e,i);let r=t.getAttachment();r instanceof Ys&&this.sortPathConstraintAttachmentWith(r,i);let n=s.bones,l=n.length;for(let a=0;a<l;a++)this.sortBone(n[a]);this._updateCache.push(s);for(let a=0;a<l;a++)this.sortReset(n[a].children);for(let a=0;a<l;a++)n[a].sorted=!0}sortTransformConstraint(s){if(s.active=s.target.isActive()&&(!s.data.skinRequired||this.skin&&k.contains(this.skin.constraints,s.data,!0)),!s.active)return;this.sortBone(s.target);let t=s.bones,e=t.length;if(s.data.local)for(let i=0;i<e;i++){let r=t[i];this.sortBone(r.parent),this.sortBone(r)}else for(let i=0;i<e;i++)this.sortBone(t[i]);this._updateCache.push(s);for(let i=0;i<e;i++)this.sortReset(t[i].children);for(let i=0;i<e;i++)t[i].sorted=!0}sortPathConstraintAttachment(s,t,e){let i=s.attachments[t];if(!!i)for(let r in i)this.sortPathConstraintAttachmentWith(i[r],e)}sortPathConstraintAttachmentWith(s,t){if(!(s instanceof Ys))return;let e=s.bones;if(!e)this.sortBone(t);else{let i=this.bones;for(let r=0,n=e.length;r<n;){let l=e[r++];for(l+=r;r<l;)this.sortBone(i[e[r++]])}}}sortBone(s){if(!s||s.sorted)return;let t=s.parent;t&&this.sortBone(t),s.sorted=!0,this._updateCache.push(s)}sortReset(s){for(let t=0,e=s.length;t<e;t++){let i=s[t];!i.active||(i.sorted&&this.sortReset(i.children),i.sorted=!1)}}updateWorldTransform(){let s=this.bones;for(let e=0,i=s.length;e<i;e++){let r=s[e];r.ax=r.x,r.ay=r.y,r.arotation=r.rotation,r.ascaleX=r.scaleX,r.ascaleY=r.scaleY,r.ashearX=r.shearX,r.ashearY=r.shearY}let t=this._updateCache;for(let e=0,i=t.length;e<i;e++)t[e].update()}updateWorldTransformWith(s){let t=this.getRootBone(),e=s.matrix.a,i=s.matrix.c,r=s.matrix.b,n=s.matrix.d;t.matrix.tx=e*this.x+i*this.y+s.worldX,t.matrix.ty=r*this.x+n*this.y+s.worldY;let l=t.rotation+90+t.shearY,a=S.cosDeg(t.rotation+t.shearX)*t.scaleX,o=S.cosDeg(l)*t.scaleY,h=S.sinDeg(t.rotation+t.shearX)*t.scaleX,c=S.sinDeg(l)*t.scaleY,u=this.scaleX,d=jt.yDown?-this.scaleY:this.scaleY;t.matrix.a=(e*a+i*h)*u,t.matrix.c=(e*o+i*c)*u,t.matrix.b=(r*a+n*h)*d,t.matrix.d=(r*o+n*c)*d;let f=this._updateCache;for(let m=0,p=f.length;m<p;m++){let g=f[m];g!=t&&g.update()}}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){let s=this.bones;for(let r=0,n=s.length;r<n;r++)s[r].setToSetupPose();let t=this.ikConstraints;for(let r=0,n=t.length;r<n;r++){let l=t[r];l.mix=l.data.mix,l.softness=l.data.softness,l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch}let e=this.transformConstraints;for(let r=0,n=e.length;r<n;r++){let l=e[r],a=l.data;l.mixRotate=a.mixRotate,l.mixX=a.mixX,l.mixY=a.mixY,l.mixScaleX=a.mixScaleX,l.mixScaleY=a.mixScaleY,l.mixShearY=a.mixShearY}let i=this.pathConstraints;for(let r=0,n=i.length;r<n;r++){let l=i[r],a=l.data;l.position=a.position,l.spacing=a.spacing,l.mixRotate=a.mixRotate,l.mixX=a.mixX,l.mixY=a.mixY}}setSlotsToSetupPose(){let s=this.slots;k.arrayCopy(s,0,this.drawOrder,0,s.length);for(let t=0,e=s.length;t<e;t++)s[t].setToSetupPose()}getRootBone(){return this.bones.length==0?null:this.bones[0]}findBone(s){if(!s)throw new Error("boneName cannot be null.");let t=this.bones;for(let e=0,i=t.length;e<i;e++){let r=t[e];if(r.data.name==s)return r}return null}findBoneIndex(s){if(!s)throw new Error("boneName cannot be null.");let t=this.bones;for(let e=0,i=t.length;e<i;e++)if(t[e].data.name==s)return e;return-1}findSlot(s){if(!s)throw new Error("slotName cannot be null.");let t=this.slots;for(let e=0,i=t.length;e<i;e++){let r=t[e];if(r.data.name==s)return r}return null}findSlotIndex(s){if(!s)throw new Error("slotName cannot be null.");let t=this.slots;for(let e=0,i=t.length;e<i;e++)if(t[e].data.name==s)return e;return-1}setSkinByName(s){let t=this.data.findSkin(s);if(!t)throw new Error(`Skin not found: ${s}`);this.setSkin(t)}setSkin(s){if(s!=this.skin){if(s)if(this.skin)s.attachAll(this,this.skin);else{let t=this.slots;for(let e=0,i=t.length;e<i;e++){let r=t[e],n=r.data.attachmentName;if(n){let l=s.getAttachment(e,n);l&&r.setAttachment(l)}}}this.skin=s,this.updateCache()}}getAttachmentByName(s,t){let e=this.data.findSlot(s);if(!e)throw new Error(`Can't find slot with name ${s}`);return this.getAttachment(e.index,t)}getAttachment(s,t){if(!t)throw new Error("attachmentName cannot be null.");if(this.skin){let e=this.skin.getAttachment(s,t);if(e)return e}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(s,t):null}setAttachment(s,t){if(!s)throw new Error("slotName cannot be null.");let e=this.slots;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.data.name==s){let l=null;if(t&&(l=this.getAttachment(i,t),!l))throw new Error(`Attachment not found: ${t}, for slot: ${s}`);n.setAttachment(l);return}}throw new Error(`Slot not found: ${s}`)}findIkConstraint(s){if(!s)throw new Error("constraintName cannot be null.");let t=this.ikConstraints;for(let e=0,i=t.length;e<i;e++){let r=t[e];if(r.data.name==s)return r}return null}findTransformConstraint(s){if(!s)throw new Error("constraintName cannot be null.");let t=this.transformConstraints;for(let e=0,i=t.length;e<i;e++){let r=t[e];if(r.data.name==s)return r}return null}findPathConstraint(s){if(!s)throw new Error("constraintName cannot be null.");let t=this.pathConstraints;for(let e=0,i=t.length;e<i;e++){let r=t[e];if(r.data.name==s)return r}return null}getBoundsRect(){let s=new Bs,t=new Bs;return this.getBounds(s,t),{x:s.x,y:s.y,width:t.x,height:t.y}}getBounds(s,t,e=new Array(2)){if(!s)throw new Error("offset cannot be null.");if(!t)throw new Error("size cannot be null.");let i=this.drawOrder,r=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY;for(let o=0,h=i.length;o<h;o++){let c=i[o];if(!c.bone.active)continue;let u=0,d=null,f=c.getAttachment();if(f instanceof bt)u=8,d=k.setArraySize(e,u,0),f.computeWorldVertices(c,d,0,2);else if(f instanceof Xs){let m=f;u=m.worldVerticesLength,d=k.setArraySize(e,u,0),m.computeWorldVertices(c,0,u,d,0,2)}if(d)for(let m=0,p=d.length;m<p;m+=2){let g=d[m],y=d[m+1];r=Math.min(r,g),n=Math.min(n,y),l=Math.max(l,g),a=Math.max(a,y)}}s.set(r,n),t.set(l-r,a-n)}get flipX(){return this.scaleX==-1}set flipX(s){ud.deprecatedWarning1||(ud.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleX=s?1:-1}get flipY(){return this.scaleY==-1}set flipY(s){ud.deprecatedWarning1||(ud.deprecatedWarning1=!0,console.warn("Spine Deprecation Warning: `Skeleton.flipX/flipY` was deprecated, please use scaleX/scaleY")),this.scaleY=s?1:-1}},dd=ud;dd.deprecatedWarning1=!1;var vo=class{constructor(){this.name=null,this.bones=new Array,this.slots=new Array,this.skins=new Array,this.defaultSkin=null,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.x=0,this.y=0,this.width=0,this.height=0,this.version=null,this.hash=null,this.fps=0,this.imagesPath=null,this.audioPath=null}findBone(t){if(!t)throw new Error("boneName cannot be null.");let e=this.bones;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.name==t)return n}return null}findBoneIndex(t){if(!t)throw new Error("boneName cannot be null.");let e=this.bones;for(let i=0,r=e.length;i<r;i++)if(e[i].name==t)return i;return-1}findSlot(t){if(!t)throw new Error("slotName cannot be null.");let e=this.slots;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.name==t)return n}return null}findSlotIndex(t){if(!t)throw new Error("slotName cannot be null.");let e=this.slots;for(let i=0,r=e.length;i<r;i++)if(e[i].name==t)return i;return-1}findSkin(t){if(!t)throw new Error("skinName cannot be null.");let e=this.skins;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.name==t)return n}return null}findEvent(t){if(!t)throw new Error("eventDataName cannot be null.");let e=this.events;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.name==t)return n}return null}findAnimation(t){if(!t)throw new Error("animationName cannot be null.");let e=this.animations;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.name==t)return n}return null}findIkConstraint(t){if(!t)throw new Error("constraintName cannot be null.");let e=this.ikConstraints;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.name==t)return n}return null}findTransformConstraint(t){if(!t)throw new Error("constraintName cannot be null.");let e=this.transformConstraints;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.name==t)return n}return null}findPathConstraint(t){if(!t)throw new Error("constraintName cannot be null.");let e=this.pathConstraints;for(let i=0,r=e.length;i<r;i++){let n=e[i];if(n.name==t)return n}return null}findPathConstraintIndex(t){if(t==null)throw new Error("pathConstraintName cannot be null.");let e=this.pathConstraints;for(let i=0,r=e.length;i<r;i++)if(e[i].name==t)return i;return-1}};var wo=class{constructor(t,e,i){if(this.index=0,this.color=new G(1,1,1,1),this.darkColor=null,this.attachmentName=null,this.blendMode=Z.NORMAL,t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");if(!i)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=i}};var Eo=class extends ji{constructor(t){super(t,0,!1),this.bones=new Array,this._target=null,this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}};var wc=class{constructor(t,e,i){this.slotIndex=t,this.name=e,this.attachment=i}},Yr=class{constructor(t){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,!t)throw new Error("name cannot be null.");this.name=t}setAttachment(t,e,i){if(!i)throw new Error("attachment cannot be null.");let r=this.attachments;t>=r.length&&(r.length=t+1),r[t]||(r[t]={}),r[t][e]=i}addSkin(t){for(let i=0;i<t.bones.length;i++){let r=t.bones[i],n=!1;for(let l=0;l<this.bones.length;l++)if(this.bones[l]==r){n=!0;break}n||this.bones.push(r)}for(let i=0;i<t.constraints.length;i++){let r=t.constraints[i],n=!1;for(let l=0;l<this.constraints.length;l++)if(this.constraints[l]==r){n=!0;break}n||this.constraints.push(r)}let e=t.getAttachments();for(let i=0;i<e.length;i++){let r=e[i];this.setAttachment(r.slotIndex,r.name,r.attachment)}}copySkin(t){for(let i=0;i<t.bones.length;i++){let r=t.bones[i],n=!1;for(let l=0;l<this.bones.length;l++)if(this.bones[l]==r){n=!0;break}n||this.bones.push(r)}for(let i=0;i<t.constraints.length;i++){let r=t.constraints[i],n=!1;for(let l=0;l<this.constraints.length;l++)if(this.constraints[l]==r){n=!0;break}n||this.constraints.push(r)}let e=t.getAttachments();for(let i=0;i<e.length;i++){let r=e[i];!r.attachment||(r.attachment instanceof Xs?(r.attachment=r.attachment.newLinkedMesh(),this.setAttachment(r.slotIndex,r.name,r.attachment)):(r.attachment=r.attachment.copy(),this.setAttachment(r.slotIndex,r.name,r.attachment)))}}getAttachment(t,e){let i=this.attachments[t];return i?i[e]:null}removeAttachment(t,e){let i=this.attachments[t];i&&delete i[e]}getAttachments(){let t=new Array;for(let e=0;e<this.attachments.length;e++){let i=this.attachments[e];if(i)for(let r in i){let n=i[r];n&&t.push(new wc(e,r,n))}}return t}getAttachmentsForSlot(t,e){let i=this.attachments[t];if(i)for(let r in i){let n=i[r];n&&e.push(new wc(t,r,n))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(t,e){let i=0;for(let r=0;r<t.slots.length;r++){let n=t.slots[r],l=n.getAttachment();if(l&&i<e.attachments.length){let a=e.attachments[i];for(let o in a){let h=a[o];if(l==h){let c=this.getAttachment(i,o);c&&n.setAttachment(c);break}}}i++}}};var Rl=class{constructor(t){this.ver40=!1,this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){let e=this.scale,i=new vo;i.name="";let r=new fi(t),n=r.readInt32(),l=r.readInt32();i.hash=l==0&&n==0?null:l.toString(16)+n.toString(16),i.version=r.readString();let a=i.version.substr(0,3);if(a!=="4.0"&&a!=="4.1"){let u=`Spine 4.1 loader cant load version ${i.version}. Please configure your pixi-spine bundle`;console.error(u)}this.ver40=a==="4.0",i.x=r.readFloat(),i.y=r.readFloat(),i.width=r.readFloat(),i.height=r.readFloat();let o=r.readBoolean();o&&(i.fps=r.readFloat(),i.imagesPath=r.readString(),i.audioPath=r.readString());let h=0;h=r.readInt(!0);for(let u=0;u<h;u++){let d=r.readString();if(!d)throw new Error("String in string table must not be null.");r.strings.push(d)}h=r.readInt(!0);for(let u=0;u<h;u++){let d=r.readString();if(!d)throw new Error("Bone name must not be null.");let f=u==0?null:i.bones[r.readInt(!0)],m=new po(u,d,f);m.rotation=r.readFloat(),m.x=r.readFloat()*e,m.y=r.readFloat()*e,m.scaleX=r.readFloat(),m.scaleY=r.readFloat(),m.shearX=r.readFloat(),m.shearY=r.readFloat(),m.length=r.readFloat()*e,m.transformMode=r.readInt(!0),m.skinRequired=r.readBoolean(),o&&G.rgba8888ToColor(m.color,r.readInt32()),i.bones.push(m)}h=r.readInt(!0);for(let u=0;u<h;u++){let d=r.readString();if(!d)throw new Error("Slot name must not be null.");let f=i.bones[r.readInt(!0)],m=new wo(u,d,f);G.rgba8888ToColor(m.color,r.readInt32());let p=r.readInt32();p!=-1&&G.rgb888ToColor(m.darkColor=new G,p),m.attachmentName=r.readStringRef(),m.blendMode=r.readInt(!0),i.slots.push(m)}h=r.readInt(!0);for(let u=0,d;u<h;u++){let f=r.readString();if(!f)throw new Error("IK constraint data name must not be null.");let m=new bo(f);m.order=r.readInt(!0),m.skinRequired=r.readBoolean(),d=r.readInt(!0);for(let p=0;p<d;p++)m.bones.push(i.bones[r.readInt(!0)]);m.target=i.bones[r.readInt(!0)],m.mix=r.readFloat(),m.softness=r.readFloat()*e,m.bendDirection=r.readByte(),m.compress=r.readBoolean(),m.stretch=r.readBoolean(),m.uniform=r.readBoolean(),i.ikConstraints.push(m)}h=r.readInt(!0);for(let u=0,d;u<h;u++){let f=r.readString();if(!f)throw new Error("Transform constraint data name must not be null.");let m=new Eo(f);m.order=r.readInt(!0),m.skinRequired=r.readBoolean(),d=r.readInt(!0);for(let p=0;p<d;p++)m.bones.push(i.bones[r.readInt(!0)]);m.target=i.bones[r.readInt(!0)],m.local=r.readBoolean(),m.relative=r.readBoolean(),m.offsetRotation=r.readFloat(),m.offsetX=r.readFloat()*e,m.offsetY=r.readFloat()*e,m.offsetScaleX=r.readFloat(),m.offsetScaleY=r.readFloat(),m.offsetShearY=r.readFloat(),m.mixRotate=r.readFloat(),m.mixX=r.readFloat(),m.mixY=r.readFloat(),m.mixScaleX=r.readFloat(),m.mixScaleY=r.readFloat(),m.mixShearY=r.readFloat(),i.transformConstraints.push(m)}h=r.readInt(!0);for(let u=0,d;u<h;u++){let f=r.readString();if(!f)throw new Error("Path constraint data name must not be null.");let m=new _o(f);m.order=r.readInt(!0),m.skinRequired=r.readBoolean(),d=r.readInt(!0);for(let p=0;p<d;p++)m.bones.push(i.bones[r.readInt(!0)]);m.target=i.slots[r.readInt(!0)],m.positionMode=r.readInt(!0),m.spacingMode=r.readInt(!0),m.rotateMode=r.readInt(!0),m.offsetRotation=r.readFloat(),m.position=r.readFloat(),m.positionMode==It.Fixed&&(m.position*=e),m.spacing=r.readFloat(),(m.spacingMode==te.Length||m.spacingMode==te.Fixed)&&(m.spacing*=e),m.mixRotate=r.readFloat(),m.mixX=r.readFloat(),m.mixY=r.readFloat(),i.pathConstraints.push(m)}let c=this.readSkin(r,i,!0,o);c&&(i.defaultSkin=c,i.skins.push(c));{let u=i.skins.length;for(k.setArraySize(i.skins,h=u+r.readInt(!0));u<h;u++){let d=this.readSkin(r,i,!1,o);if(!d)throw new Error("readSkin() should not have returned null.");i.skins[u]=d}}h=this.linkedMeshes.length;for(let u=0;u<h;u++){let d=this.linkedMeshes[u],f=d.skin?i.findSkin(d.skin):i.defaultSkin;if(!f)throw new Error("Not skin found for linked mesh.");if(!d.parent)throw new Error("Linked mesh parent must not be null");let m=f.getAttachment(d.slotIndex,d.parent);if(!m)throw new Error(`Parent mesh not found: ${d.parent}`);d.mesh.timelineAttachment=d.inheritTimeline?m:d.mesh,d.mesh.setParentMesh(m)}this.linkedMeshes.length=0,h=r.readInt(!0);for(let u=0;u<h;u++){let d=r.readStringRef();if(!d)throw new Error;let f=new xo(d);f.intValue=r.readInt(!1),f.floatValue=r.readFloat(),f.stringValue=r.readString(),f.audioPath=r.readString(),f.audioPath&&(f.volume=r.readFloat(),f.balance=r.readFloat()),i.events.push(f)}h=r.readInt(!0);for(let u=0;u<h;u++){let d=r.readString();if(!d)throw new Error("Animatio name must not be null.");i.animations.push(this.readAnimation(r,d,i))}return i}readSkin(t,e,i,r){let n=null,l=0;if(i){if(l=t.readInt(!0),l==0)return null;n=new Yr("default")}else{let a=t.readStringRef();if(!a)throw new Error("Skin name must not be null.");n=new Yr(a),n.bones.length=t.readInt(!0);for(let o=0,h=n.bones.length;o<h;o++)n.bones[o]=e.bones[t.readInt(!0)];for(let o=0,h=t.readInt(!0);o<h;o++)n.constraints.push(e.ikConstraints[t.readInt(!0)]);for(let o=0,h=t.readInt(!0);o<h;o++)n.constraints.push(e.transformConstraints[t.readInt(!0)]);for(let o=0,h=t.readInt(!0);o<h;o++)n.constraints.push(e.pathConstraints[t.readInt(!0)]);l=t.readInt(!0)}for(let a=0;a<l;a++){let o=t.readInt(!0);for(let h=0,c=t.readInt(!0);h<c;h++){let u=t.readStringRef();if(!u)throw new Error("Attachment name must not be null");let d=this.readAttachment(t,e,n,o,u,r);d&&n.setAttachment(o,u,d)}}return n}readAttachment(t,e,i,r,n,l){let a=this.scale,o=t.readStringRef();switch(o||(o=n),t.readByte()){case tt.Region:{let h=t.readStringRef(),c=t.readFloat(),u=t.readFloat(),d=t.readFloat(),f=t.readFloat(),m=t.readFloat(),p=t.readFloat(),g=t.readFloat(),y=t.readInt32(),_=this.readSequence(t);h||(h=o);let b=this.attachmentLoader.newRegionAttachment(i,o,h,_);return b?(b.path=h,b.x=u*a,b.y=d*a,b.scaleX=f,b.scaleY=m,b.rotation=c,b.width=p*a,b.height=g*a,G.rgba8888ToColor(b.color,y),b.sequence=_,_==null&&b.updateRegion(),b):null}case tt.BoundingBox:{let h=t.readInt(!0),c=this.readVertices(t,h),u=l?t.readInt32():0,d=this.attachmentLoader.newBoundingBoxAttachment(i,o);return d?(d.worldVerticesLength=h<<1,d.vertices=c.vertices,d.bones=c.bones,l&&G.rgba8888ToColor(d.color,u),d):null}case tt.Mesh:{let h=t.readStringRef(),c=t.readInt32(),u=t.readInt(!0),d=this.readFloatArray(t,u<<1,1),f=this.readShortArray(t),m=this.readVertices(t,u),p=t.readInt(!0),g=this.readSequence(t),y=[],_=0,b=0;l&&(y=this.readShortArray(t),_=t.readFloat(),b=t.readFloat()),h||(h=o);let x=this.attachmentLoader.newMeshAttachment(i,o,h,g);return x?(x.path=h,G.rgba8888ToColor(x.color,c),x.bones=m.bones,x.vertices=m.vertices,x.worldVerticesLength=u<<1,x.triangles=f,x.regionUVs=new Float32Array(d),x.hullLength=p<<1,x.sequence=g,l&&(x.edges=y,x.width=_*a,x.height=b*a),x):null}case tt.LinkedMesh:{let h=t.readStringRef(),c=t.readInt32(),u=t.readStringRef(),d=t.readStringRef(),f=t.readBoolean(),m=this.readSequence(t),p=0,g=0;l&&(p=t.readFloat(),g=t.readFloat()),h||(h=o);let y=this.attachmentLoader.newMeshAttachment(i,o,h,m);return y?(y.path=h,G.rgba8888ToColor(y.color,c),y.sequence=m,l&&(y.width=p*a,y.height=g*a),this.linkedMeshes.push(new Mg(y,u,r,d,f)),y):null}case tt.Path:{let h=t.readBoolean(),c=t.readBoolean(),u=t.readInt(!0),d=this.readVertices(t,u),f=k.newArray(u/3,0);for(let g=0,y=f.length;g<y;g++)f[g]=t.readFloat()*a;let m=l?t.readInt32():0,p=this.attachmentLoader.newPathAttachment(i,o);return p?(p.closed=h,p.constantSpeed=c,p.worldVerticesLength=u<<1,p.vertices=d.vertices,p.bones=d.bones,p.lengths=f,l&&G.rgba8888ToColor(p.color,m),p):null}case tt.Point:{let h=t.readFloat(),c=t.readFloat(),u=t.readFloat(),d=l?t.readInt32():0,f=this.attachmentLoader.newPointAttachment(i,o);return f?(f.x=c*a,f.y=u*a,f.rotation=h,l&&G.rgba8888ToColor(f.color,d),f):null}case tt.Clipping:{let h=t.readInt(!0),c=t.readInt(!0),u=this.readVertices(t,c),d=l?t.readInt32():0,f=this.attachmentLoader.newClippingAttachment(i,o);return f?(f.endSlot=e.slots[h],f.worldVerticesLength=c<<1,f.vertices=u.vertices,f.bones=u.bones,l&&G.rgba8888ToColor(f.color,d),f):null}}return null}readSequence(t){if(this.ver40||!t.readBoolean())return null;let e=new Il(t.readInt(!0));return e.start=t.readInt(!0),e.digits=t.readInt(!0),e.setupIndex=t.readInt(!0),e}readDeformTimelineType(t){return this.ver40?U0:t.readByte()}readVertices(t,e){let i=this.scale,r=e<<1,n=new kg;if(!t.readBoolean())return n.vertices=this.readFloatArray(t,r,i),n;let l=new Array,a=new Array;for(let o=0;o<e;o++){let h=t.readInt(!0);a.push(h);for(let c=0;c<h;c++)a.push(t.readInt(!0)),l.push(t.readFloat()*i),l.push(t.readFloat()*i),l.push(t.readFloat())}return n.vertices=k.toFloatArray(l),n.bones=a,n}readFloatArray(t,e,i){let r=new Array(e);if(i==1)for(let n=0;n<e;n++)r[n]=t.readFloat();else for(let n=0;n<e;n++)r[n]=t.readFloat()*i;return r}readShortArray(t){let e=t.readInt(!0),i=new Array(e);for(let r=0;r<e;r++)i[r]=t.readShort();return i}readAnimation(t,e,i){t.readInt(!0);let r=new Array,n=this.scale;for(let h=0,c=t.readInt(!0);h<c;h++){let u=t.readInt(!0);for(let d=0,f=t.readInt(!0);d<f;d++){let m=t.readByte(),p=t.readInt(!0),g=p-1;switch(m){case VI:{let y=new Ws(p,u);for(let _=0;_<p;_++)y.setFrame(_,t.readFloat(),t.readStringRef());r.push(y);break}case GI:{let y=t.readInt(!0),_=new so(p,y,u),b=t.readFloat(),x=t.readUnsignedByte()/255,v=t.readUnsignedByte()/255,w=t.readUnsignedByte()/255,E=t.readUnsignedByte()/255;for(let A=0,T=0;_.setFrame(A,b,x,v,w,E),A!=g;A++){let C=t.readFloat(),R=t.readUnsignedByte()/255,N=t.readUnsignedByte()/255,P=t.readUnsignedByte()/255,M=t.readUnsignedByte()/255;switch(t.readByte()){case Ai:_.setStepped(A);break;case Ii:_t(t,_,T++,A,0,b,C,x,R,1),_t(t,_,T++,A,1,b,C,v,N,1),_t(t,_,T++,A,2,b,C,w,P,1),_t(t,_,T++,A,3,b,C,E,M,1)}b=C,x=R,v=N,w=P,E=M}r.push(_);break}case XI:{let y=t.readInt(!0),_=new io(p,y,u),b=t.readFloat(),x=t.readUnsignedByte()/255,v=t.readUnsignedByte()/255,w=t.readUnsignedByte()/255;for(let E=0,A=0;_.setFrame(E,b,x,v,w),E!=g;E++){let T=t.readFloat(),C=t.readUnsignedByte()/255,R=t.readUnsignedByte()/255,N=t.readUnsignedByte()/255;switch(t.readByte()){case Ai:_.setStepped(E);break;case Ii:_t(t,_,A++,E,0,b,T,x,C,1),_t(t,_,A++,E,1,b,T,v,R,1),_t(t,_,A++,E,2,b,T,w,N,1)}b=T,x=C,v=R,w=N}r.push(_);break}case YI:{let y=t.readInt(!0),_=new no(p,y,u),b=t.readFloat(),x=t.readUnsignedByte()/255,v=t.readUnsignedByte()/255,w=t.readUnsignedByte()/255,E=t.readUnsignedByte()/255,A=t.readUnsignedByte()/255,T=t.readUnsignedByte()/255,C=t.readUnsignedByte()/255;for(let R=0,N=0;_.setFrame(R,b,x,v,w,E,A,T,C),R!=g;R++){let P=t.readFloat(),M=t.readUnsignedByte()/255,D=t.readUnsignedByte()/255,q=t.readUnsignedByte()/255,X=t.readUnsignedByte()/255,O=t.readUnsignedByte()/255,L=t.readUnsignedByte()/255,B=t.readUnsignedByte()/255;switch(t.readByte()){case Ai:_.setStepped(R);break;case Ii:_t(t,_,N++,R,0,b,P,x,M,1),_t(t,_,N++,R,1,b,P,v,D,1),_t(t,_,N++,R,2,b,P,w,q,1),_t(t,_,N++,R,3,b,P,E,X,1),_t(t,_,N++,R,4,b,P,A,O,1),_t(t,_,N++,R,5,b,P,T,L,1),_t(t,_,N++,R,6,b,P,C,B,1)}b=P,x=M,v=D,w=q,E=X,A=O,T=L,C=B}r.push(_);break}case jI:{let y=t.readInt(!0),_=new oo(p,y,u),b=t.readFloat(),x=t.readUnsignedByte()/255,v=t.readUnsignedByte()/255,w=t.readUnsignedByte()/255,E=t.readUnsignedByte()/255,A=t.readUnsignedByte()/255,T=t.readUnsignedByte()/255;for(let C=0,R=0;_.setFrame(C,b,x,v,w,E,A,T),C!=g;C++){let N=t.readFloat(),P=t.readUnsignedByte()/255,M=t.readUnsignedByte()/255,D=t.readUnsignedByte()/255,q=t.readUnsignedByte()/255,X=t.readUnsignedByte()/255,O=t.readUnsignedByte()/255;switch(t.readByte()){case Ai:_.setStepped(C);break;case Ii:_t(t,_,R++,C,0,b,N,x,P,1),_t(t,_,R++,C,1,b,N,v,M,1),_t(t,_,R++,C,2,b,N,w,D,1),_t(t,_,R++,C,3,b,N,E,q,1),_t(t,_,R++,C,4,b,N,A,X,1),_t(t,_,R++,C,5,b,N,T,O,1)}b=N,x=P,v=M,w=D,E=q,A=X,T=O}r.push(_);break}case WI:{let y=new ro(p,t.readInt(!0),u),_=t.readFloat(),b=t.readUnsignedByte()/255;for(let x=0,v=0;y.setFrame(x,_,b),x!=g;x++){let w=t.readFloat(),E=t.readUnsignedByte()/255;switch(t.readByte()){case Ai:y.setStepped(x);break;case Ii:_t(t,y,v++,x,0,_,w,b,E,1)}_=w,b=E}r.push(y)}}}}for(let h=0,c=t.readInt(!0);h<c;h++){let u=t.readInt(!0);for(let d=0,f=t.readInt(!0);d<f;d++){let m=t.readByte(),p=t.readInt(!0),g=t.readInt(!0);switch(m){case MI:r.push(jr(t,new wi(p,g,u),1));break;case kI:r.push(Rg(t,new Hn(p,g,u),n));break;case PI:r.push(jr(t,new qn(p,g,u),n));break;case OI:r.push(jr(t,new zn(p,g,u),n));break;case NI:r.push(Rg(t,new Kn(p,g,u),1));break;case FI:r.push(jr(t,new Zn(p,g,u),1));break;case BI:r.push(jr(t,new Qn(p,g,u),1));break;case LI:r.push(Rg(t,new Jn(p,g,u),1));break;case UI:r.push(jr(t,new to(p,g,u),1));break;case DI:r.push(jr(t,new eo(p,g,u),1))}}}for(let h=0,c=t.readInt(!0);h<c;h++){let u=t.readInt(!0),d=t.readInt(!0),f=d-1,m=new lo(d,t.readInt(!0),u),p=t.readFloat(),g=t.readFloat(),y=t.readFloat()*n;for(let _=0,b=0;m.setFrame(_,p,g,y,t.readByte(),t.readBoolean(),t.readBoolean()),_!=f;_++){let x=t.readFloat(),v=t.readFloat(),w=t.readFloat()*n;switch(t.readByte()){case Ai:m.setStepped(_);break;case Ii:_t(t,m,b++,_,0,p,x,g,v,1),_t(t,m,b++,_,1,p,x,y,w,n)}p=x,g=v,y=w}r.push(m)}for(let h=0,c=t.readInt(!0);h<c;h++){let u=t.readInt(!0),d=t.readInt(!0),f=d-1,m=new ho(d,t.readInt(!0),u),p=t.readFloat(),g=t.readFloat(),y=t.readFloat(),_=t.readFloat(),b=t.readFloat(),x=t.readFloat(),v=t.readFloat();for(let w=0,E=0;m.setFrame(w,p,g,y,_,b,x,v),w!=f;w++){let A=t.readFloat(),T=t.readFloat(),C=t.readFloat(),R=t.readFloat(),N=t.readFloat(),P=t.readFloat(),M=t.readFloat();switch(t.readByte()){case Ai:m.setStepped(w);break;case Ii:_t(t,m,E++,w,0,p,A,g,T,1),_t(t,m,E++,w,1,p,A,y,C,1),_t(t,m,E++,w,2,p,A,_,R,1),_t(t,m,E++,w,3,p,A,b,N,1),_t(t,m,E++,w,4,p,A,x,P,1),_t(t,m,E++,w,5,p,A,v,M,1)}p=A,g=T,y=C,_=R,b=N,x=P,v=M}r.push(m)}for(let h=0,c=t.readInt(!0);h<c;h++){let u=t.readInt(!0),d=i.pathConstraints[u];for(let f=0,m=t.readInt(!0);f<m;f++)switch(t.readByte()){case HI:r.push(jr(t,new co(t.readInt(!0),t.readInt(!0),u),d.positionMode==It.Fixed?n:1));break;case qI:r.push(jr(t,new uo(t.readInt(!0),t.readInt(!0),u),d.spacingMode==te.Length||d.spacingMode==te.Fixed?n:1));break;case zI:let p=new fo(t.readInt(!0),t.readInt(!0),u),g=t.readFloat(),y=t.readFloat(),_=t.readFloat(),b=t.readFloat();for(let x=0,v=0,w=p.getFrameCount()-1;p.setFrame(x,g,y,_,b),x!=w;x++){let E=t.readFloat(),A=t.readFloat(),T=t.readFloat(),C=t.readFloat();switch(t.readByte()){case Ai:p.setStepped(x);break;case Ii:_t(t,p,v++,x,0,g,E,y,A,1),_t(t,p,v++,x,1,g,E,_,T,1),_t(t,p,v++,x,2,g,E,b,C,1)}g=E,y=A,_=T,b=C}r.push(p)}}for(let h=0,c=t.readInt(!0);h<c;h++){let u=i.skins[t.readInt(!0)];for(let d=0,f=t.readInt(!0);d<f;d++){let m=t.readInt(!0);for(let p=0,g=t.readInt(!0);p<g;p++){let y=t.readStringRef();if(!y)throw new Error("attachmentName must not be null.");let _=u.getAttachment(m,y),b=this.readDeformTimelineType(t),x=t.readInt(!0),v=x-1;switch(b){case U0:{let w=_,E=w.bones,A=w.vertices,T=E?A.length/3*2:A.length,C=t.readInt(!0),R=new ao(x,C,m,w),N=t.readFloat();for(let P=0,M=0;;P++){let D,q=t.readInt(!0);if(q==0)D=E?k.newFloatArray(T):A;else{D=k.newFloatArray(T);let O=t.readInt(!0);if(q+=O,n==1)for(let L=O;L<q;L++)D[L]=t.readFloat();else for(let L=O;L<q;L++)D[L]=t.readFloat()*n;if(!E)for(let L=0,B=D.length;L<B;L++)D[L]+=A[L]}if(R.setFrame(P,N,D),P==v)break;let X=t.readFloat();switch(t.readByte()){case Ai:R.setStepped(P);break;case Ii:_t(t,R,M++,P,0,N,X,0,1,1)}N=X}r.push(R);break}case $I:{let w=new Vr(x,m,_);for(let E=0;E<x;E++){let A=t.readFloat(),T=t.readInt32();w.setFrame(E,A,xc[T&15],T>>4,t.readFloat())}r.push(w);break}}}}}let l=t.readInt(!0);if(l>0){let h=new Ei(l),c=i.slots.length;for(let u=0;u<l;u++){let d=t.readFloat(),f=t.readInt(!0),m=k.newArray(c,0);for(let _=c-1;_>=0;_--)m[_]=-1;let p=k.newArray(c-f,0),g=0,y=0;for(let _=0;_<f;_++){let b=t.readInt(!0);for(;g!=b;)p[y++]=g++;m[g+t.readInt(!0)]=g++}for(;g<c;)p[y++]=g++;for(let _=c-1;_>=0;_--)m[_]==-1&&(m[_]=p[--y]);h.setFrame(u,d,m)}r.push(h)}let a=t.readInt(!0);if(a>0){let h=new Dr(a);for(let c=0;c<a;c++){let u=t.readFloat(),d=i.events[t.readInt(!0)],f=new go(u,d);f.intValue=t.readInt(!1),f.floatValue=t.readFloat(),f.stringValue=t.readBoolean()?t.readString():d.stringValue,f.data.audioPath&&(f.volume=t.readFloat(),f.balance=t.readFloat()),h.setFrame(c,f)}r.push(h)}let o=0;for(let h=0,c=r.length;h<c;h++)o=Math.max(o,r[h].getDuration());return new Xi(e,r,o)}};Rl.BlendModeValues=[Z.NORMAL,Z.ADD,Z.MULTIPLY,Z.SCREEN];var Mg=class{constructor(t,e,i,r,n){this.mesh=t,this.skin=e,this.slotIndex=i,this.parent=r,this.inheritTimeline=n}},kg=class{constructor(t=null,e=null){this.bones=t,this.vertices=e}};function jr(s,t,e){let i=s.readFloat(),r=s.readFloat()*e;for(let n=0,l=0,a=t.getFrameCount()-1;t.setFrame(n,i,r),n!=a;n++){let o=s.readFloat(),h=s.readFloat()*e;switch(s.readByte()){case Ai:t.setStepped(n);break;case Ii:_t(s,t,l++,n,0,i,o,r,h,e)}i=o,r=h}return t}function Rg(s,t,e){let i=s.readFloat(),r=s.readFloat()*e,n=s.readFloat()*e;for(let l=0,a=0,o=t.getFrameCount()-1;t.setFrame(l,i,r,n),l!=o;l++){let h=s.readFloat(),c=s.readFloat()*e,u=s.readFloat()*e;switch(s.readByte()){case Ai:t.setStepped(l);break;case Ii:_t(s,t,a++,l,0,i,h,r,c,e),_t(s,t,a++,l,1,i,h,n,u,e)}i=h,r=c,n=u}return t}function _t(s,t,e,i,r,n,l,a,o,h){t.setBezier(e,i,r,n,a,s.readFloat(),s.readFloat()*h,s.readFloat(),s.readFloat()*h,l,o)}var MI=0,kI=1,PI=2,OI=3,NI=4,FI=5,BI=6,LI=7,UI=8,DI=9,VI=0,GI=1,XI=2,YI=3,jI=4,WI=5,U0=0,$I=1,HI=0,qI=1,zI=2,Ai=1,Ii=2;var Ec=class extends ti{};var Ao=class{constructor(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}readSkeletonData(t){let e=this.scale,i=new vo,r=typeof t=="string"?JSON.parse(t):t,n=r.skeleton;if(n){i.hash=n.hash,i.version=n.spine;let l=i.version.substr(0,3);if(l!=="4.0"&&l!=="4.1"){let a=`Spine 4.1 loader cant load version ${n.spine}. Please configure your pixi-spine bundle`;console.error(a)}i.x=n.x,i.y=n.y,i.width=n.width,i.height=n.height,i.fps=n.fps,i.imagesPath=n.images}if(r.bones)for(let l=0;l<r.bones.length;l++){let a=r.bones[l],o=null,h=F(a,"parent",null);if(h!=null&&(o=i.findBone(h),o==null))throw new Error(`Parent bone not found: ${h}`);let c=new po(i.bones.length,a.name,o);c.length=F(a,"length",0)*e,c.x=F(a,"x",0)*e,c.y=F(a,"y",0)*e,c.rotation=F(a,"rotation",0),c.scaleX=F(a,"scaleX",1),c.scaleY=F(a,"scaleY",1),c.shearX=F(a,"shearX",0),c.shearY=F(a,"shearY",0),c.transformMode=k.enumValue(it,F(a,"transform","Normal")),c.skinRequired=F(a,"skin",!1);let u=F(a,"color",null);u&&c.color.setFromString(u),i.bones.push(c)}if(r.slots)for(let l=0;l<r.slots.length;l++){let a=r.slots[l],o=i.findBone(a.bone);if(!o)throw new Error(`Couldn't find bone ${a.bone} for slot ${a.name}`);let h=new wo(i.slots.length,a.name,o),c=F(a,"color",null);c&&h.color.setFromString(c);let u=F(a,"dark",null);u&&(h.darkColor=G.fromString(u)),h.attachmentName=F(a,"attachment",null),h.blendMode=Ao.blendModeFromString(F(a,"blend","normal")),i.slots.push(h)}if(r.ik)for(let l=0;l<r.ik.length;l++){let a=r.ik[l],o=new bo(a.name);o.order=F(a,"order",0),o.skinRequired=F(a,"skin",!1);for(let h=0;h<a.bones.length;h++){let c=a.bones[h],u=i.findBone(c);if(u==null)throw new Error(`IK bone not found: ${c}`);o.bones.push(u)}o.target=i.findBone(a.target),o.mix=F(a,"mix",1),o.softness=F(a,"softness",0)*e,o.bendDirection=F(a,"bendPositive",!0)?1:-1,o.compress=F(a,"compress",!1),o.stretch=F(a,"stretch",!1),o.uniform=F(a,"uniform",!1),i.ikConstraints.push(o)}if(r.transform)for(let l=0;l<r.transform.length;l++){let a=r.transform[l],o=new Eo(a.name);o.order=F(a,"order",0),o.skinRequired=F(a,"skin",!1);for(let u=0;u<a.bones.length;u++){let d=a.bones[u],f=i.findBone(d);if(!f)throw new Error(`Couldn't find bone ${d} for transform constraint ${a.name}.`);o.bones.push(f)}let h=a.target,c=i.findBone(h);if(!c)throw new Error(`Couldn't find target bone ${h} for transform constraint ${a.name}.`);o.target=c,o.local=F(a,"local",!1),o.relative=F(a,"relative",!1),o.offsetRotation=F(a,"rotation",0),o.offsetX=F(a,"x",0)*e,o.offsetY=F(a,"y",0)*e,o.offsetScaleX=F(a,"scaleX",0),o.offsetScaleY=F(a,"scaleY",0),o.offsetShearY=F(a,"shearY",0),o.mixRotate=F(a,"mixRotate",1),o.mixX=F(a,"mixX",1),o.mixY=F(a,"mixY",o.mixX),o.mixScaleX=F(a,"mixScaleX",1),o.mixScaleY=F(a,"mixScaleY",o.mixScaleX),o.mixShearY=F(a,"mixShearY",1),i.transformConstraints.push(o)}if(r.path)for(let l=0;l<r.path.length;l++){let a=r.path[l],o=new _o(a.name);o.order=F(a,"order",0),o.skinRequired=F(a,"skin",!1);for(let u=0;u<a.bones.length;u++){let d=a.bones[u],f=i.findBone(d);if(!f)throw new Error(`Couldn't find bone ${d} for path constraint ${a.name}.`);o.bones.push(f)}let h=a.target,c=i.findSlot(h);if(!c)throw new Error(`Couldn't find target slot ${h} for path constraint ${a.name}.`);o.target=c,o.positionMode=k.enumValue(It,F(a,"positionMode","Percent")),o.spacingMode=k.enumValue(te,F(a,"spacingMode","Length")),o.rotateMode=k.enumValue(Pt,F(a,"rotateMode","Tangent")),o.offsetRotation=F(a,"rotation",0),o.position=F(a,"position",0),o.positionMode==It.Fixed&&(o.position*=e),o.spacing=F(a,"spacing",0),(o.spacingMode==te.Length||o.spacingMode==te.Fixed)&&(o.spacing*=e),o.mixRotate=F(a,"mixRotate",1),o.mixX=F(a,"mixX",1),o.mixY=F(a,"mixY",o.mixX),i.pathConstraints.push(o)}if(r.skins)for(let l=0;l<r.skins.length;l++){let a=r.skins[l],o=new Yr(a.name);if(a.bones)for(let h=0;h<a.bones.length;h++){let c=a.bones[h],u=i.findBone(c);if(!u)throw new Error(`Couldn't find bone ${c} for skin ${a.name}.`);o.bones.push(u)}if(a.ik)for(let h=0;h<a.ik.length;h++){let c=a.ik[h],u=i.findIkConstraint(c);if(!u)throw new Error(`Couldn't find IK constraint ${c} for skin ${a.name}.`);o.constraints.push(u)}if(a.transform)for(let h=0;h<a.transform.length;h++){let c=a.transform[h],u=i.findTransformConstraint(c);if(!u)throw new Error(`Couldn't find transform constraint ${c} for skin ${a.name}.`);o.constraints.push(u)}if(a.path)for(let h=0;h<a.path.length;h++){let c=a.path[h],u=i.findPathConstraint(c);if(!u)throw new Error(`Couldn't find path constraint ${c} for skin ${a.name}.`);o.constraints.push(u)}for(let h in a.attachments){let c=i.findSlot(h);if(!c)throw new Error(`Couldn't find slot ${h} for skin ${a.name}.`);let u=a.attachments[h];for(let d in u){let f=this.readAttachment(u[d],o,c.index,d,i);f&&o.setAttachment(c.index,d,f)}}i.skins.push(o),o.name=="default"&&(i.defaultSkin=o)}for(let l=0,a=this.linkedMeshes.length;l<a;l++){let o=this.linkedMeshes[l],h=o.skin?i.findSkin(o.skin):i.defaultSkin;if(!h)throw new Error(`Skin not found: ${o.skin}`);let c=h.getAttachment(o.slotIndex,o.parent);if(!c)throw new Error(`Parent mesh not found: ${o.parent}`);o.mesh.timelineAttachment=o.inheritTimeline?c:o.mesh,o.mesh.setParentMesh(c)}if(this.linkedMeshes.length=0,r.events)for(let l in r.events){let a=r.events[l],o=new xo(l);o.intValue=F(a,"int",0),o.floatValue=F(a,"float",0),o.stringValue=F(a,"string",""),o.audioPath=F(a,"audio",null),o.audioPath&&(o.volume=F(a,"volume",1),o.balance=F(a,"balance",0)),i.events.push(o)}if(r.animations)for(let l in r.animations){let a=r.animations[l];this.readAnimation(a,l,i)}return i}readAttachment(t,e,i,r,n){let l=this.scale;switch(r=F(t,"name",r),F(t,"type","region")){case"region":{let a=F(t,"path",r),o=this.readSequence(F(t,"sequence",null)),h=this.attachmentLoader.newRegionAttachment(e,r,a,o);if(!h)return null;h.path=a,h.x=F(t,"x",0)*l,h.y=F(t,"y",0)*l,h.scaleX=F(t,"scaleX",1),h.scaleY=F(t,"scaleY",1),h.rotation=F(t,"rotation",0),h.width=t.width*l,h.height=t.height*l,h.sequence=o;let c=F(t,"color",null);return c&&h.color.setFromString(c),h}case"boundingbox":{let a=this.attachmentLoader.newBoundingBoxAttachment(e,r);if(!a)return null;this.readVertices(t,a,t.vertexCount<<1);let o=F(t,"color",null);return o&&a.color.setFromString(o),a}case"mesh":case"linkedmesh":{let a=F(t,"path",r),o=this.readSequence(F(t,"sequence",null)),h=this.attachmentLoader.newMeshAttachment(e,r,a,o);if(!h)return null;h.path=a;let c=F(t,"color",null);c&&h.color.setFromString(c),h.width=F(t,"width",0)*l,h.height=F(t,"height",0)*l,h.sequence=o;let u=F(t,"parent",null);if(u)return this.linkedMeshes.push(new Og(h,F(t,"skin",null),i,u,F(t,"timelines",!0))),h;let d=t.uvs;return this.readVertices(t,h,d.length),h.triangles=t.triangles,h.regionUVs=new Float32Array(d),h.edges=F(t,"edges",null),h.hullLength=F(t,"hull",0)*2,h}case"path":{let a=this.attachmentLoader.newPathAttachment(e,r);if(!a)return null;a.closed=F(t,"closed",!1),a.constantSpeed=F(t,"constantSpeed",!0);let o=t.vertexCount;this.readVertices(t,a,o<<1);let h=k.newArray(o/3,0);for(let u=0;u<t.lengths.length;u++)h[u]=t.lengths[u]*l;a.lengths=h;let c=F(t,"color",null);return c&&a.color.setFromString(c),a}case"point":{let a=this.attachmentLoader.newPointAttachment(e,r);if(!a)return null;a.x=F(t,"x",0)*l,a.y=F(t,"y",0)*l,a.rotation=F(t,"rotation",0);let o=F(t,"color",null);return o&&a.color.setFromString(o),a}case"clipping":{let a=this.attachmentLoader.newClippingAttachment(e,r);if(!a)return null;let o=F(t,"end",null);if(o!=null){let u=n.findSlot(o);if(u==null)throw new Error(`Clipping end slot not found: ${o}`);a.endSlot=u}let h=t.vertexCount;this.readVertices(t,a,h<<1);let c=F(t,"color",null);return c&&a.color.setFromString(c),a}}return null}readSequence(t){if(t==null)return null;let e=new Il(F(t,"count",0));return e.start=F(t,"start",1),e.digits=F(t,"digits",0),e.setupIndex=F(t,"setup",0),e}readVertices(t,e,i){let r=this.scale;e.worldVerticesLength=i;let n=t.vertices;if(i==n.length){let o=k.toFloatArray(n);if(r!=1)for(let h=0,c=n.length;h<c;h++)o[h]*=r;e.vertices=o;return}let l=new Array,a=new Array;for(let o=0,h=n.length;o<h;){let c=n[o++];a.push(c);for(let u=o+c*4;o<u;o+=4)a.push(n[o]),l.push(n[o+1]*r),l.push(n[o+2]*r),l.push(n[o+3])}e.bones=a,e.vertices=k.toFloatArray(l)}readAnimation(t,e,i){let r=this.scale,n=new Array;if(t.slots)for(let a in t.slots){let o=t.slots[a],h=i.findSlot(a);if(!h)throw new Error(`Slot not found: ${a}`);let c=h.index;for(let u in o){let d=o[u];if(!d)continue;let f=d.length;if(u=="attachment"){let m=new Ws(f,c);for(let p=0;p<f;p++){let g=d[p];m.setFrame(p,F(g,"time",0),F(g,"name",null))}n.push(m)}else if(u=="rgba"){let m=new so(f,f<<2,c),p=d[0],g=F(p,"time",0),y=G.fromString(p.color);for(let _=0,b=0;;_++){m.setFrame(_,g,y.r,y.g,y.b,y.a);let x=d[_+1];if(!x){m.shrink(b);break}let v=F(x,"time",0),w=G.fromString(x.color),E=p.curve;E&&(b=Et(E,m,b,_,0,g,v,y.r,w.r,1),b=Et(E,m,b,_,1,g,v,y.g,w.g,1),b=Et(E,m,b,_,2,g,v,y.b,w.b,1),b=Et(E,m,b,_,3,g,v,y.a,w.a,1)),g=v,y=w,p=x}n.push(m)}else if(u=="rgb"){let m=new io(f,f*3,c),p=d[0],g=F(p,"time",0),y=G.fromString(p.color);for(let _=0,b=0;;_++){m.setFrame(_,g,y.r,y.g,y.b);let x=d[_+1];if(!x){m.shrink(b);break}let v=F(x,"time",0),w=G.fromString(x.color),E=p.curve;E&&(b=Et(E,m,b,_,0,g,v,y.r,w.r,1),b=Et(E,m,b,_,1,g,v,y.g,w.g,1),b=Et(E,m,b,_,2,g,v,y.b,w.b,1)),g=v,y=w,p=x}n.push(m)}else if(u=="alpha")n.push(Wi(d,new ro(f,f,c),0,1));else if(u=="rgba2"){let m=new no(f,f*7,c),p=d[0],g=F(p,"time",0),y=G.fromString(p.light),_=G.fromString(p.dark);for(let b=0,x=0;;b++){m.setFrame(b,g,y.r,y.g,y.b,y.a,_.r,_.g,_.b);let v=d[b+1];if(!v){m.shrink(x);break}let w=F(v,"time",0),E=G.fromString(v.light),A=G.fromString(v.dark),T=p.curve;T&&(x=Et(T,m,x,b,0,g,w,y.r,E.r,1),x=Et(T,m,x,b,1,g,w,y.g,E.g,1),x=Et(T,m,x,b,2,g,w,y.b,E.b,1),x=Et(T,m,x,b,3,g,w,y.a,E.a,1),x=Et(T,m,x,b,4,g,w,_.r,A.r,1),x=Et(T,m,x,b,5,g,w,_.g,A.g,1),x=Et(T,m,x,b,6,g,w,_.b,A.b,1)),g=w,y=E,_=A,p=v}n.push(m)}else if(u=="rgb2"){let m=new oo(f,f*6,c),p=d[0],g=F(p,"time",0),y=G.fromString(p.light),_=G.fromString(p.dark);for(let b=0,x=0;;b++){m.setFrame(b,g,y.r,y.g,y.b,_.r,_.g,_.b);let v=d[b+1];if(!v){m.shrink(x);break}let w=F(v,"time",0),E=G.fromString(v.light),A=G.fromString(v.dark),T=p.curve;T&&(x=Et(T,m,x,b,0,g,w,y.r,E.r,1),x=Et(T,m,x,b,1,g,w,y.g,E.g,1),x=Et(T,m,x,b,2,g,w,y.b,E.b,1),x=Et(T,m,x,b,3,g,w,_.r,A.r,1),x=Et(T,m,x,b,4,g,w,_.g,A.g,1),x=Et(T,m,x,b,5,g,w,_.b,A.b,1)),g=w,y=E,_=A,p=v}n.push(m)}}}if(t.bones)for(let a in t.bones){let o=t.bones[a],h=i.findBone(a);if(!h)throw new Error(`Bone not found: ${a}`);let c=h.index;for(let u in o){let d=o[u],f=d.length;if(f!=0){if(u==="rotate")n.push(Wi(d,new wi(f,f,c),0,1));else if(u==="translate"){let m=new Hn(f,f<<1,c);n.push(Pg(d,m,"x","y",0,r))}else if(u==="translatex"){let m=new qn(f,f,c);n.push(Wi(d,m,0,r))}else if(u==="translatey"){let m=new zn(f,f,c);n.push(Wi(d,m,0,r))}else if(u==="scale"){let m=new Kn(f,f<<1,c);n.push(Pg(d,m,"x","y",1,1))}else if(u==="scalex"){let m=new Zn(f,f,c);n.push(Wi(d,m,1,1))}else if(u==="scaley"){let m=new Qn(f,f,c);n.push(Wi(d,m,1,1))}else if(u==="shear"){let m=new Jn(f,f<<1,c);n.push(Pg(d,m,"x","y",0,1))}else if(u==="shearx"){let m=new to(f,f,c);n.push(Wi(d,m,0,1))}else if(u==="sheary"){let m=new eo(f,f,c);n.push(Wi(d,m,0,1))}}}}if(t.ik)for(let a in t.ik){let o=t.ik[a],h=o[0];if(!h)continue;let c=i.findIkConstraint(a);if(!c)throw new Error(`IK Constraint not found: ${a}`);let u=i.ikConstraints.indexOf(c),d=new lo(o.length,o.length<<1,u),f=F(h,"time",0),m=F(h,"mix",1),p=F(h,"softness",0)*r;for(let g=0,y=0;;g++){d.setFrame(g,f,m,p,F(h,"bendPositive",!0)?1:-1,F(h,"compress",!1),F(h,"stretch",!1));let _=o[g+1];if(!_){d.shrink(y);break}let b=F(_,"time",0),x=F(_,"mix",1),v=F(_,"softness",0)*r,w=h.curve;w&&(y=Et(w,d,y,g,0,f,b,m,x,1),y=Et(w,d,y,g,1,f,b,p,v,r)),f=b,m=x,p=v,h=_}n.push(d)}if(t.transform)for(let a in t.transform){let o=t.transform[a],h=o[0];if(!h)continue;let c=i.findTransformConstraint(a);if(!c)throw new Error(`Transform constraint not found: ${a}`);let u=i.transformConstraints.indexOf(c),d=new ho(o.length,o.length*6,u),f=F(h,"time",0),m=F(h,"mixRotate",1),p=F(h,"mixX",1),g=F(h,"mixY",p),y=F(h,"mixScaleX",1),_=F(h,"mixScaleY",y),b=F(h,"mixShearY",1);for(let x=0,v=0;;x++){d.setFrame(x,f,m,p,g,y,_,b);let w=o[x+1];if(!w){d.shrink(v);break}let E=F(w,"time",0),A=F(w,"mixRotate",1),T=F(w,"mixX",1),C=F(w,"mixY",T),R=F(w,"mixScaleX",1),N=F(w,"mixScaleY",R),P=F(w,"mixShearY",1),M=h.curve;M&&(v=Et(M,d,v,x,0,f,E,m,A,1),v=Et(M,d,v,x,1,f,E,p,T,1),v=Et(M,d,v,x,2,f,E,g,C,1),v=Et(M,d,v,x,3,f,E,y,R,1),v=Et(M,d,v,x,4,f,E,_,N,1),v=Et(M,d,v,x,5,f,E,b,P,1)),f=E,m=A,p=T,g=C,y=R,_=N,y=R,h=w}n.push(d)}if(t.path)for(let a in t.path){let o=t.path[a],h=i.findPathConstraint(a);if(!h)throw new Error(`Path constraint not found: ${a}`);let c=i.pathConstraints.indexOf(h);for(let u in o){let d=o[u],f=d[0];if(!f)continue;let m=d.length;if(u==="position"){let p=new co(m,m,c);n.push(Wi(d,p,0,h.positionMode==It.Fixed?r:1))}else if(u==="spacing"){let p=new uo(m,m,c);n.push(Wi(d,p,0,h.spacingMode==te.Length||h.spacingMode==te.Fixed?r:1))}else if(u==="mix"){let p=new fo(m,m*3,c),g=F(f,"time",0),y=F(f,"mixRotate",1),_=F(f,"mixX",1),b=F(f,"mixY",_);for(let x=0,v=0;;x++){p.setFrame(x,g,y,_,b);let w=d[x+1];if(!w){p.shrink(v);break}let E=F(w,"time",0),A=F(w,"mixRotate",1),T=F(w,"mixX",1),C=F(w,"mixY",T),R=f.curve;R&&(v=Et(R,p,v,x,0,g,E,y,A,1),v=Et(R,p,v,x,1,g,E,_,T,1),v=Et(R,p,v,x,2,g,E,b,C,1)),g=E,y=A,_=T,b=C,f=w}n.push(p)}}}if(t.deform){t.attachments={};for(let a in t.deform){let o=t.deform[a],h=t.attachments[a]={};for(let c in o){let u=o[c],d=h[c]={};for(let f in u)d[f]={deform:u[f]}}}}if(t.attachments)for(let a in t.attachments){let o=t.attachments[a],h=i.findSkin(a);if(h==null){if(jt.FAIL_ON_NON_EXISTING_SKIN)throw new Error(`Skin not found: ${a}`);continue}for(let c in o){let u=o[c],d=i.findSlot(c);if(!d)throw new Error(`Slot not found: ${c}`);let f=d.index;for(let m in u){let p=u[m],g=h.getAttachment(f,m);for(let y in p){let _=p[y],b=_[0];if(!!b){if(y=="deform"){let x=g.bones,v=g.vertices,w=x?v.length/3*2:v.length,E=new ao(_.length,_.length,f,g),A=F(b,"time",0);for(let T=0,C=0;;T++){let R,N=F(b,"vertices",null);if(!N)R=x?k.newFloatArray(w):v;else{R=k.newFloatArray(w);let q=F(b,"offset",0);if(k.arrayCopy(N,0,R,q,N.length),r!=1)for(let X=q,O=X+N.length;X<O;X++)R[X]*=r;if(!x)for(let X=0;X<w;X++)R[X]+=v[X]}E.setFrame(T,A,R);let P=_[T+1];if(!P){E.shrink(C);break}let M=F(P,"time",0),D=b.curve;D&&(C=Et(D,E,C,T,0,A,M,0,1,1)),A=M,b=P}n.push(E)}else if(y=="sequence"){let x=new Vr(_.length,f,g),v=0;for(let w=0;w<_.length;w++){let E=F(b,"delay",v),A=F(b,"time",0),T=js[F(b,"mode","hold")],C=F(b,"index",0);x.setFrame(w,A,T,C,E),v=E,b=_[w+1]}n.push(x)}}}}}}if(t.drawOrder){let a=new Ei(t.drawOrder.length),o=i.slots.length,h=0;for(let c=0;c<t.drawOrder.length;c++,h++){let u=t.drawOrder[c],d=null,f=F(u,"offsets",null);if(f){d=k.newArray(o,-1);let m=k.newArray(o-f.length,0),p=0,g=0;for(let y=0;y<f.length;y++){let _=f[y],b=i.findSlot(_.slot);if(!b)throw new Error(`Slot not found: ${b}`);let x=b.index;for(;p!=x;)m[g++]=p++;d[p+_.offset]=p++}for(;p<o;)m[g++]=p++;for(let y=o-1;y>=0;y--)d[y]==-1&&(d[y]=m[--g])}a.setFrame(h,F(u,"time",0),d)}n.push(a)}if(t.events){let a=new Dr(t.events.length),o=0;for(let h=0;h<t.events.length;h++,o++){let c=t.events[h],u=i.findEvent(c.name);if(!u)throw new Error(`Event not found: ${c.name}`);let d=new go(k.toSinglePrecision(F(c,"time",0)),u);d.intValue=F(c,"int",u.intValue),d.floatValue=F(c,"float",u.floatValue),d.stringValue=F(c,"string",u.stringValue),d.data.audioPath&&(d.volume=F(c,"volume",1),d.balance=F(c,"balance",0)),a.setFrame(o,d)}n.push(a)}let l=0;for(let a=0,o=n.length;a<o;a++)l=Math.max(l,n[a].getDuration());if(isNaN(l))throw new Error("Error while parsing animation, duration is NaN");i.animations.push(new Xi(e,n,l))}static blendModeFromString(t){if(t=t.toLowerCase(),t=="normal")return Z.NORMAL;if(t=="additive")return Z.ADD;if(t=="multiply")return Z.MULTIPLY;if(t=="screen")return Z.SCREEN;throw new Error(`Unknown blend mode: ${t}`)}},Og=class{constructor(t,e,i,r,n){this.mesh=t,this.skin=e,this.slotIndex=i,this.parent=r,this.inheritTimeline=n}};function Wi(s,t,e,i){let r=s[0],n=F(r,"time",0),l=F(r,"value",e)*i,a=0;for(let o=0;;o++){t.setFrame(o,n,l);let h=s[o+1];if(!h)return t.shrink(a),t;let c=F(h,"time",0),u=F(h,"value",e)*i;r.curve&&(a=Et(r.curve,t,a,o,0,n,c,l,u,i)),n=c,l=u,r=h}}function Pg(s,t,e,i,r,n){let l=s[0],a=F(l,"time",0),o=F(l,e,r)*n,h=F(l,i,r)*n,c=0;for(let u=0;;u++){t.setFrame(u,a,o,h);let d=s[u+1];if(!d)return t.shrink(c),t;let f=F(d,"time",0),m=F(d,e,r)*n,p=F(d,i,r)*n,g=l.curve;g&&(c=Et(g,t,c,u,0,a,f,o,m,n),c=Et(g,t,c,u,1,a,f,h,p,n)),a=f,o=m,h=p,l=d}}function Et(s,t,e,i,r,n,l,a,o,h){if(s=="stepped")return t.setStepped(i),e;let c=r<<2,u=s[c],d=s[c+1]*h,f=s[c+2],m=s[c+3]*h;return t.setBezier(e,i,r,n,a,u,d,f,m,l,o),e+1}function F(s,t,e){return s[t]!==void 0?s[t]:e}var Am=class extends ii{createSkeleton(t){this.skeleton=new dd(t),this.skeleton.updateWorldTransform(),this.stateData=new bc(t),this.state=new mo(this.stateData)}};var cs=(s=>(s[s.UNKNOWN=0]="UNKNOWN",s[s.VER37=37]="VER37",s[s.VER38=38]="VER38",s[s.VER40=40]="VER40",s[s.VER41=41]="VER41",s))(cs||{});function Ml(s){let t=s.substr(0,3),e=Math.floor(Number(t)*10+.001);return t==="3.7"?37:t==="3.8"?38:t==="4.0"?40:t==="4.1"?41:e<37?37:0}var Ng=class{constructor(){this.scale=1}readSkeletonData(t,e){let i=null,r=this.readVersionOldFormat(e),n=Ml(r);if(n===cs.VER38&&(i=new Zt(new bl(t))),r=this.readVersionNewFormat(e),n=Ml(r),(n===cs.VER40||n===cs.VER41)&&(i=new Rl(new Sl(t))),!i){let l=`Unsupported version of spine model ${r}, please update pixi-spine`;console.error(l)}return i.scale=this.scale,i.readSkeletonData(e)}readVersionOldFormat(t){let e=new fi(t),i;try{e.readString(),i=e.readString()}catch(r){i=""}return i||""}readVersionNewFormat(t){let e=new fi(t);e.readInt32(),e.readInt32();let i;try{i=e.readString()}catch(r){i=""}return i||""}},Fg=class{constructor(){this.scale=1}readSkeletonData(t,e){let i=e.skeleton.spine,r=Ml(i),n=null;if(r===cs.VER37&&(n=new ai(new nc(t))),r===cs.VER38&&(n=new ni(new bl(t))),(r===cs.VER40||r===cs.VER41)&&(n=new Ao(new Sl(t))),!n){let l=`Unsupported version of spine model ${i}, please update pixi-spine`;console.error(l)}return n.scale=this.scale,n.readSkeletonData(e)}},Tm=class extends td{createBinaryParser(){return new Ng}createJsonParser(){return new Fg}parseData(t,e,i){return{spineData:t.readSkeletonData(e,i),spineAtlas:e}}};var fd=class extends ii{createSkeleton(t){let e=Ml(t.version),i=null;if(e===cs.VER37&&(i=vm),e===cs.VER38&&(i=pm),(e===cs.VER40||e===cs.VER41)&&(i=Im),!i){let r=`Cant detect version of spine model ${t.version}`;console.error(r)}this.skeleton=new i.Skeleton(t),this.skeleton.updateWorldTransform(),this.stateData=new i.AnimationStateData(t),this.state=new i.AnimationState(this.stateData)}};new Tm().installLoader();var K0;function KI(s){return K0=s,s}function kl(){return K0}var ZI=0,Lg=class extends et.EventEmitter{constructor(s){super(),this.id=ZI++,this.init(s)}set(s,t){if(this[s]===void 0)throw new Error(`Property with name ${s} does not exist.`);switch(s){case"speed":this.speed=t;break;case"volume":this.volume=t;break;case"paused":this.paused=t;break;case"loop":this.loop=t;break;case"muted":this.muted=t;break}return this}get progress(){let{currentTime:s}=this._source;return s/this._duration}get paused(){return this._paused}set paused(s){this._paused=s,this.refreshPaused()}_onPlay(){this._playing=!0}_onPause(){this._playing=!1}init(s){this._playing=!1,this._duration=s.source.duration;let t=this._source=s.source.cloneNode(!1);t.src=s.parent.url,t.onplay=this._onPlay.bind(this),t.onpause=this._onPause.bind(this),s.context.on("refresh",this.refresh,this),s.context.on("refreshPaused",this.refreshPaused,this),this._media=s}_internalStop(){this._source&&this._playing&&(this._source.onended=null,this._source.pause())}stop(){this._internalStop(),this._source&&this.emit("stop")}get speed(){return this._speed}set speed(s){this._speed=s,this.refresh()}get volume(){return this._volume}set volume(s){this._volume=s,this.refresh()}get loop(){return this._loop}set loop(s){this._loop=s,this.refresh()}get muted(){return this._muted}set muted(s){this._muted=s,this.refresh()}get filters(){return console.warn("HTML Audio does not support filters"),null}set filters(s){console.warn("HTML Audio does not support filters")}refresh(){let s=this._media.context,t=this._media.parent;this._source.loop=this._loop||t.loop;let e=s.volume*(s.muted?0:1),i=t.volume*(t.muted?0:1),r=this._volume*(this._muted?0:1);this._source.volume=r*e*i,this._source.playbackRate=this._speed*s.speed*t.speed}refreshPaused(){let s=this._media.context,t=this._media.parent,e=this._paused||t.paused||s.paused;e!==this._pausedReal&&(this._pausedReal=e,e?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._source.currentTime,end:this._end,volume:this._volume,speed:this._speed,loop:this._loop})),this.emit("pause",e))}play(s){let{start:t,end:e,speed:i,loop:r,volume:n,muted:l}=s;e&&console.assert(e>t,"End time is before start time"),this._speed=i,this._volume=n,this._loop=!!r,this._muted=l,this.refresh(),this.loop&&e!==null&&(console.warn('Looping not support when specifying an "end" time'),this.loop=!1),this._start=t,this._end=e||this._duration,this._start=Math.max(0,this._start-Lg.PADDING),this._end=Math.min(this._end+Lg.PADDING,this._duration),this._source.onloadedmetadata=()=>{this._source&&(this._source.currentTime=t,this._source.onloadedmetadata=null,this.emit("progress",t,this._duration),oe.shared.add(this._onUpdate,this))},this._source.onended=this._onComplete.bind(this),this._source.play(),this.emit("start")}_onUpdate(){this.emit("progress",this.progress,this._duration),this._source.currentTime>=this._end&&!this._source.loop&&this._onComplete()}_onComplete(){oe.shared.remove(this._onUpdate,this),this._internalStop(),this.emit("progress",1,this._duration),this.emit("end",this)}destroy(){oe.shared.remove(this._onUpdate,this),this.removeAllListeners();let s=this._source;s&&(s.onended=null,s.onplay=null,s.onpause=null,this._internalStop()),this._source=null,this._speed=1,this._volume=1,this._loop=!1,this._end=null,this._start=0,this._duration=0,this._playing=!1,this._pausedReal=!1,this._paused=!1,this._muted=!1,this._media&&(this._media.context.off("refresh",this.refresh,this),this._media.context.off("refreshPaused",this.refreshPaused,this),this._media=null)}toString(){return`[HTMLAudioInstance id=${this.id}]`}},Z0=Lg;Z0.PADDING=.1;var Ug=class extends et.EventEmitter{init(t){this.parent=t,this._source=t.options.source||new Audio,t.url&&(this._source.src=t.url)}create(){return new Z0(this)}get isPlayable(){return!!this._source&&this._source.readyState===4}get duration(){return this._source.duration}get context(){return this.parent.context}get filters(){return null}set filters(t){console.warn("HTML Audio does not support filters")}destroy(){this.removeAllListeners(),this.parent=null,this._source&&(this._source.src="",this._source.load(),this._source=null)}get source(){return this._source}load(t){let e=this._source,i=this.parent;if(e.readyState===4){i.isLoaded=!0;let o=i.autoPlayStart();t&&setTimeout(()=>{t(null,i,o)},0);return}if(!i.url){t(new Error("sound.url or sound.source must be set"));return}e.src=i.url;let r=()=>{a(),i.isLoaded=!0;let o=i.autoPlayStart();t&&t(null,i,o)},n=()=>{a(),t&&t(new Error("Sound loading has been aborted"))},l=()=>{a();let o=`Failed to load audio element (code: ${e.error.code})`;t?t(new Error(o)):console.error(o)},a=()=>{e.removeEventListener("canplaythrough",r),e.removeEventListener("load",r),e.removeEventListener("abort",n),e.removeEventListener("error",l)};e.addEventListener("canplaythrough",r,!1),e.addEventListener("load",r,!1),e.addEventListener("abort",n,!1),e.addEventListener("error",l,!1),e.load()}},Dg=class{constructor(t,e){this.parent=t,Object.assign(this,e),this.duration=this.end-this.start,console.assert(this.duration>0,"End time must be after start time")}play(t){return this.parent.play({complete:t,speed:this.speed||this.parent.speed,end:this.end,start:this.start,loop:this.loop})}destroy(){this.parent=null}},Wr=class{static setParamValue(t,e){if(t.setValueAtTime){let i=kl().context;t.setValueAtTime(e,i.audioContext.currentTime)}else t.value=e;return e}},QI=0,Vg=class extends et.EventEmitter{constructor(t){super(),this.id=QI++,this._media=null,this._paused=!1,this._muted=!1,this._elapsed=0,this.init(t)}set(t,e){if(this[t]===void 0)throw new Error(`Property with name ${t} does not exist.`);switch(t){case"speed":this.speed=e;break;case"volume":this.volume=e;break;case"muted":this.muted=e;break;case"loop":this.loop=e;break;case"paused":this.paused=e;break}return this}stop(){this._source&&(this._internalStop(),this.emit("stop"))}get speed(){return this._speed}set speed(t){this._speed=t,this.refresh(),this._update(!0)}get volume(){return this._volume}set volume(t){this._volume=t,this.refresh()}get muted(){return this._muted}set muted(t){this._muted=t,this.refresh()}get loop(){return this._loop}set loop(t){this._loop=t,this.refresh()}get filters(){return this._filters}set filters(t){var e;this._filters&&((e=this._filters)==null||e.filter(i=>i).forEach(i=>i.disconnect()),this._filters=null,this._source.connect(this._gain)),this._filters=t!=null&&t.length?t.slice(0):null,this.refresh()}refresh(){if(!this._source)return;let t=this._media.context,e=this._media.parent;this._source.loop=this._loop||e.loop;let i=t.volume*(t.muted?0:1),r=e.volume*(e.muted?0:1),n=this._volume*(this._muted?0:1);Wr.setParamValue(this._gain.gain,n*r*i),Wr.setParamValue(this._source.playbackRate,this._speed*e.speed*t.speed),this.applyFilters()}applyFilters(){var t;if((t=this._filters)!=null&&t.length){this._source.disconnect();let e=this._source;this._filters.forEach(i=>{e.connect(i.destination),e=i}),e.connect(this._gain)}}refreshPaused(){let t=this._media.context,e=this._media.parent,i=this._paused||e.paused||t.paused;i!==this._pausedReal&&(this._pausedReal=i,i?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._elapsed%this._duration,end:this._end,speed:this._speed,loop:this._loop,volume:this._volume})),this.emit("pause",i))}play(t){let{start:e,end:i,speed:r,loop:n,volume:l,muted:a,filters:o}=t;i&&console.assert(i>e,"End time is before start time"),this._paused=!1;let{source:h,gain:c}=this._media.nodes.cloneBufferSource();this._source=h,this._gain=c,this._speed=r,this._volume=l,this._loop=!!n,this._muted=a,this._filters=o,this.refresh();let u=this._source.buffer.duration;this._duration=u,this._end=i,this._lastUpdate=this._now(),this._elapsed=e,this._source.onended=this._onComplete.bind(this),this._loop?(this._source.loopEnd=i,this._source.loopStart=e,this._source.start(0,e)):i?this._source.start(0,e,i-e):this._source.start(0,e),this.emit("start"),this._update(!0),this.enableTicker(!0)}enableTicker(t){oe.shared.remove(this._updateListener,this),t&&oe.shared.add(this._updateListener,this)}get progress(){return this._progress}get paused(){return this._paused}set paused(t){this._paused=t,this.refreshPaused()}destroy(){var t;this.removeAllListeners(),this._internalStop(),this._gain&&(this._gain.disconnect(),this._gain=null),this._media&&(this._media.context.events.off("refresh",this.refresh,this),this._media.context.events.off("refreshPaused",this.refreshPaused,this),this._media=null),(t=this._filters)==null||t.forEach(e=>e.disconnect()),this._filters=null,this._end=null,this._speed=1,this._volume=1,this._loop=!1,this._elapsed=0,this._duration=0,this._paused=!1,this._muted=!1,this._pausedReal=!1}toString(){return`[WebAudioInstance id=${this.id}]`}_now(){return this._media.context.audioContext.currentTime}_updateListener(){this._update()}_update(t=!1){if(this._source){let e=this._now(),i=e-this._lastUpdate;if(i>0||t){let r=this._source.playbackRate.value;this._elapsed+=i*r,this._lastUpdate=e;let n=this._duration,l;if(this._source.loopStart){let a=this._source.loopEnd-this._source.loopStart;l=(this._source.loopStart+this._elapsed%a)/n}else l=this._elapsed%n/n;this._progress=l,this.emit("progress",this._progress,n)}}}init(t){this._media=t,t.context.events.on("refresh",this.refresh,this),t.context.events.on("refreshPaused",this.refreshPaused,this)}_internalStop(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.stop(0),this._source.disconnect();try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}this._source=null}}_onComplete(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.disconnect();try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}}this._source=null,this._progress=1,this.emit("progress",1,this._duration),this.emit("end",this)}},Sm=class{constructor(t,e){this._output=e,this._input=t}get destination(){return this._input}get filters(){return this._filters}set filters(t){if(this._filters&&(this._filters.forEach(e=>{e&&e.disconnect()}),this._filters=null,this._input.connect(this._output)),t&&t.length){this._filters=t.slice(0),this._input.disconnect();let e=null;t.forEach(i=>{e===null?this._input.connect(i.destination):e.connect(i.destination),e=i}),e.connect(this._output)}}destroy(){this.filters=null,this._input=null,this._output=null}},Q0=class extends Sm{constructor(s){let t=s.audioContext,e=t.createBufferSource(),i=t.createGain(),r=t.createAnalyser();e.connect(r),r.connect(i),i.connect(s.destination),super(r,i),this.context=s,this.bufferSource=e,this.gain=i,this.analyser=r}get script(){return this._script||(this._script=this.context.audioContext.createScriptProcessor(Q0.BUFFER_SIZE),this._script.connect(this.context.destination)),this._script}destroy(){super.destroy(),this.bufferSource.disconnect(),this._script&&this._script.disconnect(),this.gain.disconnect(),this.analyser.disconnect(),this.bufferSource=null,this._script=null,this.gain=null,this.analyser=null,this.context=null}cloneBufferSource(){let s=this.bufferSource,t=this.context.audioContext.createBufferSource();t.buffer=s.buffer,Wr.setParamValue(t.playbackRate,s.playbackRate.value),t.loop=s.loop;let e=this.context.audioContext.createGain();return t.connect(e),e.connect(this.destination),{source:t,gain:e}}get bufferSize(){return this.script.bufferSize}},J0=Q0;J0.BUFFER_SIZE=0;var Gg=class{init(t){this.parent=t,this._nodes=new J0(this.context),this._source=this._nodes.bufferSource,this.source=t.options.source}destroy(){this.parent=null,this._nodes.destroy(),this._nodes=null;try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}this._source=null,this.source=null}create(){return new Vg(this)}get context(){return this.parent.context}get isPlayable(){return!!this._source&&!!this._source.buffer}get filters(){return this._nodes.filters}set filters(t){this._nodes.filters=t}get duration(){return console.assert(this.isPlayable,"Sound not yet playable, no duration"),this._source.buffer.duration}get buffer(){return this._source.buffer}set buffer(t){this._source.buffer=t}get nodes(){return this._nodes}load(t){this.source?this._decode(this.source,t):this.parent.url?this._loadUrl(t):t?t(new Error("sound.url or sound.source must be set")):console.error("sound.url or sound.source must be set")}_loadUrl(t){return $(this,null,function*(){let e=this.parent.url,i=yield z.ADAPTER.fetch(e);this._decode(yield i.arrayBuffer(),t)})}_decode(t,e){let i=(r,n)=>{if(r)e&&e(r);else{this.parent.isLoaded=!0,this.buffer=n;let l=this.parent.autoPlayStart();e&&e(null,this.parent,l)}};t instanceof AudioBuffer?i(null,t):this.parent.context.decode(t,i)}},JI=Object.defineProperty,D0=Object.getOwnPropertySymbols,tT=Object.prototype.hasOwnProperty,eT=Object.prototype.propertyIsEnumerable,V0=(s,t,e)=>t in s?JI(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,G0=(s,t)=>{for(var e in t||(t={}))tT.call(t,e)&&V0(s,e,t[e]);if(D0)for(var e of D0(t))eT.call(t,e)&&V0(s,e,t[e]);return s},Ac=class{static from(s){let t={};typeof s=="string"?t.url=s:s instanceof ArrayBuffer||s instanceof AudioBuffer||s instanceof HTMLAudioElement?t.source=s:t=s,t=G0({autoPlay:!1,singleInstance:!1,url:null,source:null,preload:!1,volume:1,speed:1,complete:null,loaded:null,loop:!1},t),Object.freeze(t);let e=kl().useLegacy?new Ug:new Gg;return new Ac(e,t)}constructor(s,t){this.media=s,this.options=t,this._instances=[],this._sprites={},this.media.init(this);let e=t.complete;this._autoPlayOptions=e?{complete:e}:null,this.isLoaded=!1,this.isPlaying=!1,this.autoPlay=t.autoPlay,this.singleInstance=t.singleInstance,this.preload=t.preload||this.autoPlay,this.url=t.url,this.speed=t.speed,this.volume=t.volume,this.loop=t.loop,t.sprites&&this.addSprites(t.sprites),this.preload&&this._preload(t.loaded)}get context(){return kl().context}pause(){return this.isPlaying=!1,this.paused=!0,this}resume(){return this.isPlaying=this._instances.length>0,this.paused=!1,this}get paused(){return this._paused}set paused(s){this._paused=s,this.refreshPaused()}get speed(){return this._speed}set speed(s){this._speed=s,this.refresh()}get filters(){return this.media.filters}set filters(s){this.media.filters=s}addSprites(s,t){if(typeof s=="object"){let i={};for(let r in s)i[r]=this.addSprites(r,s[r]);return i}console.assert(!this._sprites[s],`Alias ${s} is already taken`);let e=new Dg(this,t);return this._sprites[s]=e,e}destroy(){this._removeInstances(),this.removeSprites(),this.media.destroy(),this.media=null,this._sprites=null,this._instances=null}removeSprites(s){if(s){let t=this._sprites[s];t!==void 0&&(t.destroy(),delete this._sprites[s])}else for(let t in this._sprites)this.removeSprites(t);return this}get isPlayable(){return this.isLoaded&&this.media&&this.media.isPlayable}stop(){if(!this.isPlayable)return this.autoPlay=!1,this._autoPlayOptions=null,this;this.isPlaying=!1;for(let s=this._instances.length-1;s>=0;s--)this._instances[s].stop();return this}play(s,t){let e;if(typeof s=="string"?e={sprite:s,loop:this.loop,complete:t}:typeof s=="function"?(e={},e.complete=s):e=s,e=G0({complete:null,loaded:null,sprite:null,end:null,start:0,volume:1,speed:1,muted:!1,loop:!1},e||{}),e.sprite){let r=e.sprite;console.assert(!!this._sprites[r],`Alias ${r} is not available`);let n=this._sprites[r];e.start=n.start+(e.start||0),e.end=n.end,e.speed=n.speed||1,e.loop=n.loop||e.loop,delete e.sprite}if(e.offset&&(e.start=e.offset),!this.isLoaded)return new Promise((r,n)=>{this.autoPlay=!0,this._autoPlayOptions=e,this._preload((l,a,o)=>{l?n(l):(e.loaded&&e.loaded(l,a,o),r(o))})});(this.singleInstance||e.singleInstance)&&this._removeInstances();let i=this._createInstance();return this._instances.push(i),this.isPlaying=!0,i.once("end",()=>{e.complete&&e.complete(this),this._onComplete(i)}),i.once("stop",()=>{this._onComplete(i)}),i.play(e),i}refresh(){let s=this._instances.length;for(let t=0;t<s;t++)this._instances[t].refresh()}refreshPaused(){let s=this._instances.length;for(let t=0;t<s;t++)this._instances[t].refreshPaused()}get volume(){return this._volume}set volume(s){this._volume=s,this.refresh()}get muted(){return this._muted}set muted(s){this._muted=s,this.refresh()}get loop(){return this._loop}set loop(s){this._loop=s,this.refresh()}_preload(s){this.media.load(s)}get instances(){return this._instances}get sprites(){return this._sprites}get duration(){return this.media.duration}autoPlayStart(){let s;return this.autoPlay&&(s=this.play(this._autoPlayOptions)),s}_removeInstances(){for(let s=this._instances.length-1;s>=0;s--)this._poolInstance(this._instances[s]);this._instances.length=0}_onComplete(s){if(this._instances){let t=this._instances.indexOf(s);t>-1&&this._instances.splice(t,1),this.isPlaying=this._instances.length>0}this._poolInstance(s)}_createInstance(){if(Ac._pool.length>0){let s=Ac._pool.pop();return s.init(this.media),s}return this.media.create()}_poolInstance(s){s.destroy(),Ac._pool.indexOf(s)<0&&Ac._pool.push(s)}},Cm=Ac;Cm._pool=[];var Xg=class extends et.EventEmitter{constructor(){super(...arguments),this.speed=1,this.muted=!1,this.volume=1,this.paused=!1}refresh(){this.emit("refresh")}refreshPaused(){this.emit("refreshPaused")}get filters(){return console.warn("HTML Audio does not support filters"),null}set filters(t){console.warn("HTML Audio does not support filters")}get audioContext(){return console.warn("HTML Audio does not support audioContext"),null}toggleMute(){return this.muted=!this.muted,this.refresh(),this.muted}togglePause(){return this.paused=!this.paused,this.refreshPaused(),this.paused}destroy(){this.removeAllListeners()}},Pl=class extends Sm{constructor(){let t=window,e=new Pl.AudioContext,i=e.createDynamicsCompressor(),r=e.createAnalyser();r.connect(i),i.connect(e.destination),super(r,i),this._ctx=e,this._offlineCtx=new Pl.OfflineAudioContext(1,2,t.OfflineAudioContext?Math.max(8e3,Math.min(96e3,e.sampleRate)):44100),this._unlocked=!1,this.compressor=i,this.analyser=r,this.events=new et.EventEmitter,this.volume=1,this.speed=1,this.muted=!1,this.paused=!1,e.state!=="running"&&(this._unlock(),this._unlock=this._unlock.bind(this),document.addEventListener("mousedown",this._unlock,!0),document.addEventListener("touchstart",this._unlock,!0),document.addEventListener("touchend",this._unlock,!0))}_unlock(){this._unlocked||(this.playEmptySound(),this._ctx.state==="running"&&(document.removeEventListener("mousedown",this._unlock,!0),document.removeEventListener("touchend",this._unlock,!0),document.removeEventListener("touchstart",this._unlock,!0),this._unlocked=!0))}playEmptySound(){let t=this._ctx.createBufferSource();t.buffer=this._ctx.createBuffer(1,1,22050),t.connect(this._ctx.destination),t.start(0,0,0),t.context.state==="suspended"&&t.context.resume()}static get AudioContext(){let t=window;return t.AudioContext||t.webkitAudioContext||null}static get OfflineAudioContext(){let t=window;return t.OfflineAudioContext||t.webkitOfflineAudioContext||null}destroy(){super.destroy();let t=this._ctx;typeof t.close!="undefined"&&t.close(),this.events.removeAllListeners(),this.analyser.disconnect(),this.compressor.disconnect(),this.analyser=null,this.compressor=null,this.events=null,this._offlineCtx=null,this._ctx=null}get audioContext(){return this._ctx}get offlineContext(){return this._offlineCtx}set paused(t){t&&this._ctx.state==="running"?this._ctx.suspend():!t&&this._ctx.state==="suspended"&&this._ctx.resume(),this._paused=t}get paused(){return this._paused}refresh(){this.events.emit("refresh")}refreshPaused(){this.events.emit("refreshPaused")}toggleMute(){return this.muted=!this.muted,this.refresh(),this.muted}togglePause(){return this.paused=!this.paused,this.refreshPaused(),this._paused}decode(t,e){let i=n=>{e(new Error((n==null?void 0:n.message)||"Unable to decode file"))},r=this._offlineCtx.decodeAudioData(t,n=>{e(null,n)},i);r&&r.catch(i)}},sT=Object.defineProperty,X0=Object.getOwnPropertySymbols,iT=Object.prototype.hasOwnProperty,rT=Object.prototype.propertyIsEnumerable,Y0=(s,t,e)=>t in s?sT(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,j0=(s,t)=>{for(var e in t||(t={}))iT.call(t,e)&&Y0(s,e,t[e]);if(X0)for(var e of X0(t))rT.call(t,e)&&Y0(s,e,t[e]);return s},Yg=class{constructor(){this.init()}init(){return this.supported&&(this._webAudioContext=new Pl),this._htmlAudioContext=new Xg,this._sounds={},this.useLegacy=!this.supported,this}get context(){return this._context}get filtersAll(){return this.useLegacy?[]:this._context.filters}set filtersAll(t){this.useLegacy||(this._context.filters=t)}get supported(){return Pl.AudioContext!==null}add(t,e){if(typeof t=="object"){let n={};for(let l in t){let a=this._getOptions(t[l],e);n[l]=this.add(l,a)}return n}if(console.assert(!this._sounds[t],`Sound with alias ${t} already exists.`),e instanceof Cm)return this._sounds[t]=e,e;let i=this._getOptions(e),r=Cm.from(i);return this._sounds[t]=r,r}_getOptions(t,e){let i;return typeof t=="string"?i={url:t}:t instanceof ArrayBuffer||t instanceof AudioBuffer||t instanceof HTMLAudioElement?i={source:t}:i=t,i=j0(j0({},i),e||{}),i}get useLegacy(){return this._useLegacy}set useLegacy(t){this._useLegacy=t,this._context=!t&&this.supported?this._webAudioContext:this._htmlAudioContext}remove(t){return this.exists(t,!0),this._sounds[t].destroy(),delete this._sounds[t],this}get volumeAll(){return this._context.volume}set volumeAll(t){this._context.volume=t,this._context.refresh()}get speedAll(){return this._context.speed}set speedAll(t){this._context.speed=t,this._context.refresh()}togglePauseAll(){return this._context.togglePause()}pauseAll(){return this._context.paused=!0,this._context.refreshPaused(),this}resumeAll(){return this._context.paused=!1,this._context.refreshPaused(),this}toggleMuteAll(){return this._context.toggleMute()}muteAll(){return this._context.muted=!0,this._context.refresh(),this}unmuteAll(){return this._context.muted=!1,this._context.refresh(),this}removeAll(){for(let t in this._sounds)this._sounds[t].destroy(),delete this._sounds[t];return this}stopAll(){for(let t in this._sounds)this._sounds[t].stop();return this}exists(t,e=!1){let i=!!this._sounds[t];return e&&console.assert(i,`No sound matching alias '${t}'.`),i}find(t){return this.exists(t,!0),this._sounds[t]}play(t,e){return this.find(t).play(e)}stop(t){return this.find(t).stop()}pause(t){return this.find(t).pause()}resume(t){return this.find(t).resume()}volume(t,e){let i=this.find(t);return e!==void 0&&(i.volume=e),i.volume}speed(t,e){let i=this.find(t);return e!==void 0&&(i.speed=e),i.speed}duration(t){return this.find(t).duration}close(){return this.removeAll(),this._sounds=null,this._webAudioContext&&(this._webAudioContext.destroy(),this._webAudioContext=null),this._htmlAudioContext&&(this._htmlAudioContext.destroy(),this._htmlAudioContext=null),this._context=null,this}};var jg=class{constructor(t,e){this.init(t,e)}init(t,e){this.destination=t,this.source=e||t}connect(t){this.source.connect(t)}disconnect(){this.source.disconnect()}destroy(){this.disconnect(),this.destination=null,this.source=null}},Ot=class extends jg{constructor(s=0,t=0,e=0,i=0,r=0,n=0,l=0,a=0,o=0,h=0){var c=(...d)=>{super(...d)};if(kl().useLegacy){c(null);return}let u=[{f:Ot.F32,type:"lowshelf",gain:s},{f:Ot.F64,type:"peaking",gain:t},{f:Ot.F125,type:"peaking",gain:e},{f:Ot.F250,type:"peaking",gain:i},{f:Ot.F500,type:"peaking",gain:r},{f:Ot.F1K,type:"peaking",gain:n},{f:Ot.F2K,type:"peaking",gain:l},{f:Ot.F4K,type:"peaking",gain:a},{f:Ot.F8K,type:"peaking",gain:o},{f:Ot.F16K,type:"highshelf",gain:h}].map(d=>{let f=kl().context.audioContext.createBiquadFilter();return f.type=d.type,Wr.setParamValue(f.Q,1),f.frequency.value=d.f,Wr.setParamValue(f.gain,d.gain),f});c(u[0],u[u.length-1]),this.bands=u,this.bandsMap={};for(let d=0;d<this.bands.length;d++){let f=this.bands[d];d>0&&this.bands[d-1].connect(f),this.bandsMap[f.frequency.value]=f}}setGain(s,t=0){if(!this.bandsMap[s])throw new Error(`No band found for frequency ${s}`);Wr.setParamValue(this.bandsMap[s].gain,t)}getGain(s){if(!this.bandsMap[s])throw new Error(`No band found for frequency ${s}`);return this.bandsMap[s].gain.value}set f32(s){this.setGain(Ot.F32,s)}get f32(){return this.getGain(Ot.F32)}set f64(s){this.setGain(Ot.F64,s)}get f64(){return this.getGain(Ot.F64)}set f125(s){this.setGain(Ot.F125,s)}get f125(){return this.getGain(Ot.F125)}set f250(s){this.setGain(Ot.F250,s)}get f250(){return this.getGain(Ot.F250)}set f500(s){this.setGain(Ot.F500,s)}get f500(){return this.getGain(Ot.F500)}set f1k(s){this.setGain(Ot.F1K,s)}get f1k(){return this.getGain(Ot.F1K)}set f2k(s){this.setGain(Ot.F2K,s)}get f2k(){return this.getGain(Ot.F2K)}set f4k(s){this.setGain(Ot.F4K,s)}get f4k(){return this.getGain(Ot.F4K)}set f8k(s){this.setGain(Ot.F8K,s)}get f8k(){return this.getGain(Ot.F8K)}set f16k(s){this.setGain(Ot.F16K,s)}get f16k(){return this.getGain(Ot.F16K)}reset(){this.bands.forEach(s=>{Wr.setParamValue(s.gain,0)})}destroy(){this.bands.forEach(s=>{s.disconnect()}),this.bands=null,this.bandsMap=null}},$i=Ot;$i.F32=32,$i.F64=64,$i.F125=125,$i.F250=250,$i.F500=500,$i.F1K=1e3,$i.F2K=2e3,$i.F4K=4e3,$i.F8K=8e3,$i.F16K=16e3;var nT=Object.defineProperty,W0=Object.getOwnPropertySymbols,oT=Object.prototype.hasOwnProperty,aT=Object.prototype.propertyIsEnumerable,$0=(s,t,e)=>t in s?nT(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,lT=(s,t)=>{for(var e in t||(t={}))oT.call(t,e)&&$0(s,e,t[e]);if(W0)for(var e of W0(t))aT.call(t,e)&&$0(s,e,t[e]);return s},ty=["mp3","ogg","oga","opus","mpeg","wav","m4a","aiff","wma","mid","caf"],Wg={};function hT(s){let t=lT({m4a:"audio/mp4",oga:"audio/ogg",opus:'audio/ogg; codecs="opus"',caf:'audio/x-caf; codecs="opus"'},s||{}),e=document.createElement("audio"),i={},r=/^no$/;ty.forEach(n=>{let l=e.canPlayType(`audio/${n}`).replace(r,""),a=t[n]?e.canPlayType(t[n]).replace(r,""):"";i[n]=!!l||!!a}),Object.assign(Wg,i)}hT();var cT=Object.defineProperty,uT=Object.defineProperties,dT=Object.getOwnPropertyDescriptors,H0=Object.getOwnPropertySymbols,fT=Object.prototype.hasOwnProperty,mT=Object.prototype.propertyIsEnumerable,q0=(s,t,e)=>t in s?cT(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,pT=(s,t)=>{for(var e in t||(t={}))fT.call(t,e)&&q0(s,e,t[e]);if(H0)for(var e of H0(t))mT.call(t,e)&&q0(s,e,t[e]);return s},gT=(s,t)=>uT(s,dT(t)),z0=s=>{var t,e;let i=s.src;return(e=(t=s==null?void 0:s.alias)==null?void 0:t[0])!=null?e:et.path.basename(i,et.path.extname(i))},xT={extension:H.Asset,detection:{test:()=>$(void 0,null,function*(){return!0}),add:s=>$(void 0,null,function*(){return[...s,...ty.filter(t=>Wg[t])]}),remove:s=>$(void 0,null,function*(){return s.filter(t=>s.includes(t))})},loader:{extension:{type:[H.LoadParser],priority:xe.High},test(s){let t=et.path.extname(s).slice(1);return!!Wg[t]},load(s,t){return $(this,null,function*(){let e=yield new Promise((i,r)=>Cm.from(gT(pT({},t.data),{url:s,preload:!0,loaded(n,l){var a,o;n?r(n):i(l),(o=(a=t.data)==null?void 0:a.loaded)==null||o.call(a,n,l)}})));return kl().add(z0(t),e),e})},unload(s,t){return $(this,null,function*(){kl().remove(z0(t))})}}};K.add(xT);var ey=KI(new Yg);globalThis&&(globalThis.game=Y.inst,globalThis._canvas=document.getElementById("root"),globalThis._ui=document.getElementById("ui"));console.log(ey);console.log("\u6D4B\u8BD5\u7248\u672C          ");console.log("anything?",PIXI.spine,Bg);new Y;})();
/*!
 * @pixi/sound - v5.0.0
 * https://github.com/pixijs/pixi-sound
 * Compiled Wed, 21 Sep 2022 19:56:41 UTC
 *
 * @pixi/sound is licensed under the MIT license.
 * http://www.opensource.org/licenses/mit-license
 */
/*! https://mths.be/punycode v1.3.2 by @mathias */
